function pm(Z,J){for(var N=0;N<J.length;N++){const re=J[N];if(typeof re!="string"&&!Array.isArray(re)){for(const ce in re)if(ce!=="default"&&!(ce in Z)){const Me=Object.getOwnPropertyDescriptor(re,ce);Me&&Object.defineProperty(Z,ce,Me.get?Me:{enumerable:!0,get:()=>re[ce]})}}}return Object.freeze(Object.defineProperty(Z,Symbol.toStringTag,{value:"Module"}))}(function(){const J=document.createElement("link").relList;if(J&&J.supports&&J.supports("modulepreload"))return;for(const ce of document.querySelectorAll('link[rel="modulepreload"]'))re(ce);new MutationObserver(ce=>{for(const Me of ce)if(Me.type==="childList")for(const O of Me.addedNodes)O.tagName==="LINK"&&O.rel==="modulepreload"&&re(O)}).observe(document,{childList:!0,subtree:!0});function N(ce){const Me={};return ce.integrity&&(Me.integrity=ce.integrity),ce.referrerPolicy&&(Me.referrerPolicy=ce.referrerPolicy),ce.crossOrigin==="use-credentials"?Me.credentials="include":ce.crossOrigin==="anonymous"?Me.credentials="omit":Me.credentials="same-origin",Me}function re(ce){if(ce.ep)return;ce.ep=!0;const Me=N(ce);fetch(ce.href,Me)}})();function Rf(Z){return Z&&Z.__esModule&&Object.prototype.hasOwnProperty.call(Z,"default")?Z.default:Z}var bf={exports:{}},Wh={},Sf={exports:{}},Ri={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ip;function mm(){if(ip)return Ri;ip=1;var Z=Symbol.for("react.element"),J=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),re=Symbol.for("react.strict_mode"),ce=Symbol.for("react.profiler"),Me=Symbol.for("react.provider"),O=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),ze=Symbol.for("react.suspense"),nt=Symbol.for("react.memo"),tt=Symbol.for("react.lazy"),xe=Symbol.iterator;function me(ge){return ge===null||typeof ge!="object"?null:(ge=xe&&ge[xe]||ge["@@iterator"],typeof ge=="function"?ge:null)}var Ot={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},st=Object.assign,Ue={};function Je(ge,Ne,Ft){this.props=ge,this.context=Ne,this.refs=Ue,this.updater=Ft||Ot}Je.prototype.isReactComponent={},Je.prototype.setState=function(ge,Ne){if(typeof ge!="object"&&typeof ge!="function"&&ge!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ge,Ne,"setState")},Je.prototype.forceUpdate=function(ge){this.updater.enqueueForceUpdate(this,ge,"forceUpdate")};function $t(){}$t.prototype=Je.prototype;function Qt(ge,Ne,Ft){this.props=ge,this.context=Ne,this.refs=Ue,this.updater=Ft||Ot}var Mt=Qt.prototype=new $t;Mt.constructor=Qt,st(Mt,Je.prototype),Mt.isPureReactComponent=!0;var hi=Array.isArray,li=Object.prototype.hasOwnProperty,Ii={current:null},_i={key:!0,ref:!0,__self:!0,__source:!0};function nn(ge,Ne,Ft){var It,Tt={},wt=null,ii=null;if(Ne!=null)for(It in Ne.ref!==void 0&&(ii=Ne.ref),Ne.key!==void 0&&(wt=""+Ne.key),Ne)li.call(Ne,It)&&!_i.hasOwnProperty(It)&&(Tt[It]=Ne[It]);var ni=arguments.length-2;if(ni===1)Tt.children=Ft;else if(1<ni){for(var Oi=Array(ni),wn=0;wn<ni;wn++)Oi[wn]=arguments[wn+2];Tt.children=Oi}if(ge&&ge.defaultProps)for(It in ni=ge.defaultProps,ni)Tt[It]===void 0&&(Tt[It]=ni[It]);return{$$typeof:Z,type:ge,key:wt,ref:ii,props:Tt,_owner:Ii.current}}function an(ge,Ne){return{$$typeof:Z,type:ge.type,key:Ne,ref:ge.ref,props:ge.props,_owner:ge._owner}}function Zn(ge){return typeof ge=="object"&&ge!==null&&ge.$$typeof===Z}function qt(ge){var Ne={"=":"=0",":":"=2"};return"$"+ge.replace(/[=:]/g,function(Ft){return Ne[Ft]})}var Hi=/\/+/g;function Di(ge,Ne){return typeof ge=="object"&&ge!==null&&ge.key!=null?qt(""+ge.key):Ne.toString(36)}function xi(ge,Ne,Ft,It,Tt){var wt=typeof ge;(wt==="undefined"||wt==="boolean")&&(ge=null);var ii=!1;if(ge===null)ii=!0;else switch(wt){case"string":case"number":ii=!0;break;case"object":switch(ge.$$typeof){case Z:case J:ii=!0}}if(ii)return ii=ge,Tt=Tt(ii),ge=It===""?"."+Di(ii,0):It,hi(Tt)?(Ft="",ge!=null&&(Ft=ge.replace(Hi,"$&/")+"/"),xi(Tt,Ne,Ft,"",function(wn){return wn})):Tt!=null&&(Zn(Tt)&&(Tt=an(Tt,Ft+(!Tt.key||ii&&ii.key===Tt.key?"":(""+Tt.key).replace(Hi,"$&/")+"/")+ge)),Ne.push(Tt)),1;if(ii=0,It=It===""?".":It+":",hi(ge))for(var ni=0;ni<ge.length;ni++){wt=ge[ni];var Oi=It+Di(wt,ni);ii+=xi(wt,Ne,Ft,Oi,Tt)}else if(Oi=me(ge),typeof Oi=="function")for(ge=Oi.call(ge),ni=0;!(wt=ge.next()).done;)wt=wt.value,Oi=It+Di(wt,ni++),ii+=xi(wt,Ne,Ft,Oi,Tt);else if(wt==="object")throw Ne=String(ge),Error("Objects are not valid as a React child (found: "+(Ne==="[object Object]"?"object with keys {"+Object.keys(ge).join(", ")+"}":Ne)+"). If you meant to render a collection of children, use an array instead.");return ii}function Bn(ge,Ne,Ft){if(ge==null)return ge;var It=[],Tt=0;return xi(ge,It,"","",function(wt){return Ne.call(Ft,wt,Tt++)}),It}function Bi(ge){if(ge._status===-1){var Ne=ge._result;Ne=Ne(),Ne.then(function(Ft){(ge._status===0||ge._status===-1)&&(ge._status=1,ge._result=Ft)},function(Ft){(ge._status===0||ge._status===-1)&&(ge._status=2,ge._result=Ft)}),ge._status===-1&&(ge._status=0,ge._result=Ne)}if(ge._status===1)return ge._result.default;throw ge._result}var Ei={current:null},qe={transition:null},Nt={ReactCurrentDispatcher:Ei,ReactCurrentBatchConfig:qe,ReactCurrentOwner:Ii};function He(){throw Error("act(...) is not supported in production builds of React.")}return Ri.Children={map:Bn,forEach:function(ge,Ne,Ft){Bn(ge,function(){Ne.apply(this,arguments)},Ft)},count:function(ge){var Ne=0;return Bn(ge,function(){Ne++}),Ne},toArray:function(ge){return Bn(ge,function(Ne){return Ne})||[]},only:function(ge){if(!Zn(ge))throw Error("React.Children.only expected to receive a single React element child.");return ge}},Ri.Component=Je,Ri.Fragment=N,Ri.Profiler=ce,Ri.PureComponent=Qt,Ri.StrictMode=re,Ri.Suspense=ze,Ri.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nt,Ri.act=He,Ri.cloneElement=function(ge,Ne,Ft){if(ge==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+ge+".");var It=st({},ge.props),Tt=ge.key,wt=ge.ref,ii=ge._owner;if(Ne!=null){if(Ne.ref!==void 0&&(wt=Ne.ref,ii=Ii.current),Ne.key!==void 0&&(Tt=""+Ne.key),ge.type&&ge.type.defaultProps)var ni=ge.type.defaultProps;for(Oi in Ne)li.call(Ne,Oi)&&!_i.hasOwnProperty(Oi)&&(It[Oi]=Ne[Oi]===void 0&&ni!==void 0?ni[Oi]:Ne[Oi])}var Oi=arguments.length-2;if(Oi===1)It.children=Ft;else if(1<Oi){ni=Array(Oi);for(var wn=0;wn<Oi;wn++)ni[wn]=arguments[wn+2];It.children=ni}return{$$typeof:Z,type:ge.type,key:Tt,ref:wt,props:It,_owner:ii}},Ri.createContext=function(ge){return ge={$$typeof:O,_currentValue:ge,_currentValue2:ge,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},ge.Provider={$$typeof:Me,_context:ge},ge.Consumer=ge},Ri.createElement=nn,Ri.createFactory=function(ge){var Ne=nn.bind(null,ge);return Ne.type=ge,Ne},Ri.createRef=function(){return{current:null}},Ri.forwardRef=function(ge){return{$$typeof:g,render:ge}},Ri.isValidElement=Zn,Ri.lazy=function(ge){return{$$typeof:tt,_payload:{_status:-1,_result:ge},_init:Bi}},Ri.memo=function(ge,Ne){return{$$typeof:nt,type:ge,compare:Ne===void 0?null:Ne}},Ri.startTransition=function(ge){var Ne=qe.transition;qe.transition={};try{ge()}finally{qe.transition=Ne}},Ri.unstable_act=He,Ri.useCallback=function(ge,Ne){return Ei.current.useCallback(ge,Ne)},Ri.useContext=function(ge){return Ei.current.useContext(ge)},Ri.useDebugValue=function(){},Ri.useDeferredValue=function(ge){return Ei.current.useDeferredValue(ge)},Ri.useEffect=function(ge,Ne){return Ei.current.useEffect(ge,Ne)},Ri.useId=function(){return Ei.current.useId()},Ri.useImperativeHandle=function(ge,Ne,Ft){return Ei.current.useImperativeHandle(ge,Ne,Ft)},Ri.useInsertionEffect=function(ge,Ne){return Ei.current.useInsertionEffect(ge,Ne)},Ri.useLayoutEffect=function(ge,Ne){return Ei.current.useLayoutEffect(ge,Ne)},Ri.useMemo=function(ge,Ne){return Ei.current.useMemo(ge,Ne)},Ri.useReducer=function(ge,Ne,Ft){return Ei.current.useReducer(ge,Ne,Ft)},Ri.useRef=function(ge){return Ei.current.useRef(ge)},Ri.useState=function(ge){return Ei.current.useState(ge)},Ri.useSyncExternalStore=function(ge,Ne,Ft){return Ei.current.useSyncExternalStore(ge,Ne,Ft)},Ri.useTransition=function(){return Ei.current.useTransition()},Ri.version="18.3.1",Ri}var np;function Bf(){return np||(np=1,Sf.exports=mm()),Sf.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rp;function _m(){if(rp)return Wh;rp=1;var Z=Bf(),J=Symbol.for("react.element"),N=Symbol.for("react.fragment"),re=Object.prototype.hasOwnProperty,ce=Z.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Me={key:!0,ref:!0,__self:!0,__source:!0};function O(g,ze,nt){var tt,xe={},me=null,Ot=null;nt!==void 0&&(me=""+nt),ze.key!==void 0&&(me=""+ze.key),ze.ref!==void 0&&(Ot=ze.ref);for(tt in ze)re.call(ze,tt)&&!Me.hasOwnProperty(tt)&&(xe[tt]=ze[tt]);if(g&&g.defaultProps)for(tt in ze=g.defaultProps,ze)xe[tt]===void 0&&(xe[tt]=ze[tt]);return{$$typeof:J,type:g,key:me,ref:Ot,props:xe,_owner:ce.current}}return Wh.Fragment=N,Wh.jsx=O,Wh.jsxs=O,Wh}var sp;function gm(){return sp||(sp=1,bf.exports=_m()),bf.exports}var Ge=gm(),Xe=Bf();const Hd=Rf(Xe),ym=pm({__proto__:null,default:Hd},[Xe]);var Zd={},Tf={exports:{}},na={},Pf={exports:{}},kf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var op;function vm(){return op||(op=1,function(Z){function J(qe,Nt){var He=qe.length;qe.push(Nt);e:for(;0<He;){var ge=He-1>>>1,Ne=qe[ge];if(0<ce(Ne,Nt))qe[ge]=Nt,qe[He]=Ne,He=ge;else break e}}function N(qe){return qe.length===0?null:qe[0]}function re(qe){if(qe.length===0)return null;var Nt=qe[0],He=qe.pop();if(He!==Nt){qe[0]=He;e:for(var ge=0,Ne=qe.length,Ft=Ne>>>1;ge<Ft;){var It=2*(ge+1)-1,Tt=qe[It],wt=It+1,ii=qe[wt];if(0>ce(Tt,He))wt<Ne&&0>ce(ii,Tt)?(qe[ge]=ii,qe[wt]=He,ge=wt):(qe[ge]=Tt,qe[It]=He,ge=It);else if(wt<Ne&&0>ce(ii,He))qe[ge]=ii,qe[wt]=He,ge=wt;else break e}}return Nt}function ce(qe,Nt){var He=qe.sortIndex-Nt.sortIndex;return He!==0?He:qe.id-Nt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var Me=performance;Z.unstable_now=function(){return Me.now()}}else{var O=Date,g=O.now();Z.unstable_now=function(){return O.now()-g}}var ze=[],nt=[],tt=1,xe=null,me=3,Ot=!1,st=!1,Ue=!1,Je=typeof setTimeout=="function"?setTimeout:null,$t=typeof clearTimeout=="function"?clearTimeout:null,Qt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Mt(qe){for(var Nt=N(nt);Nt!==null;){if(Nt.callback===null)re(nt);else if(Nt.startTime<=qe)re(nt),Nt.sortIndex=Nt.expirationTime,J(ze,Nt);else break;Nt=N(nt)}}function hi(qe){if(Ue=!1,Mt(qe),!st)if(N(ze)!==null)st=!0,Bi(li);else{var Nt=N(nt);Nt!==null&&Ei(hi,Nt.startTime-qe)}}function li(qe,Nt){st=!1,Ue&&(Ue=!1,$t(nn),nn=-1),Ot=!0;var He=me;try{for(Mt(Nt),xe=N(ze);xe!==null&&(!(xe.expirationTime>Nt)||qe&&!qt());){var ge=xe.callback;if(typeof ge=="function"){xe.callback=null,me=xe.priorityLevel;var Ne=ge(xe.expirationTime<=Nt);Nt=Z.unstable_now(),typeof Ne=="function"?xe.callback=Ne:xe===N(ze)&&re(ze),Mt(Nt)}else re(ze);xe=N(ze)}if(xe!==null)var Ft=!0;else{var It=N(nt);It!==null&&Ei(hi,It.startTime-Nt),Ft=!1}return Ft}finally{xe=null,me=He,Ot=!1}}var Ii=!1,_i=null,nn=-1,an=5,Zn=-1;function qt(){return!(Z.unstable_now()-Zn<an)}function Hi(){if(_i!==null){var qe=Z.unstable_now();Zn=qe;var Nt=!0;try{Nt=_i(!0,qe)}finally{Nt?Di():(Ii=!1,_i=null)}}else Ii=!1}var Di;if(typeof Qt=="function")Di=function(){Qt(Hi)};else if(typeof MessageChannel<"u"){var xi=new MessageChannel,Bn=xi.port2;xi.port1.onmessage=Hi,Di=function(){Bn.postMessage(null)}}else Di=function(){Je(Hi,0)};function Bi(qe){_i=qe,Ii||(Ii=!0,Di())}function Ei(qe,Nt){nn=Je(function(){qe(Z.unstable_now())},Nt)}Z.unstable_IdlePriority=5,Z.unstable_ImmediatePriority=1,Z.unstable_LowPriority=4,Z.unstable_NormalPriority=3,Z.unstable_Profiling=null,Z.unstable_UserBlockingPriority=2,Z.unstable_cancelCallback=function(qe){qe.callback=null},Z.unstable_continueExecution=function(){st||Ot||(st=!0,Bi(li))},Z.unstable_forceFrameRate=function(qe){0>qe||125<qe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):an=0<qe?Math.floor(1e3/qe):5},Z.unstable_getCurrentPriorityLevel=function(){return me},Z.unstable_getFirstCallbackNode=function(){return N(ze)},Z.unstable_next=function(qe){switch(me){case 1:case 2:case 3:var Nt=3;break;default:Nt=me}var He=me;me=Nt;try{return qe()}finally{me=He}},Z.unstable_pauseExecution=function(){},Z.unstable_requestPaint=function(){},Z.unstable_runWithPriority=function(qe,Nt){switch(qe){case 1:case 2:case 3:case 4:case 5:break;default:qe=3}var He=me;me=qe;try{return Nt()}finally{me=He}},Z.unstable_scheduleCallback=function(qe,Nt,He){var ge=Z.unstable_now();switch(typeof He=="object"&&He!==null?(He=He.delay,He=typeof He=="number"&&0<He?ge+He:ge):He=ge,qe){case 1:var Ne=-1;break;case 2:Ne=250;break;case 5:Ne=1073741823;break;case 4:Ne=1e4;break;default:Ne=5e3}return Ne=He+Ne,qe={id:tt++,callback:Nt,priorityLevel:qe,startTime:He,expirationTime:Ne,sortIndex:-1},He>ge?(qe.sortIndex=He,J(nt,qe),N(ze)===null&&qe===N(nt)&&(Ue?($t(nn),nn=-1):Ue=!0,Ei(hi,He-ge))):(qe.sortIndex=Ne,J(ze,qe),st||Ot||(st=!0,Bi(li))),qe},Z.unstable_shouldYield=qt,Z.unstable_wrapCallback=function(qe){var Nt=me;return function(){var He=me;me=Nt;try{return qe.apply(this,arguments)}finally{me=He}}}}(kf)),kf}var ap;function xm(){return ap||(ap=1,Pf.exports=vm()),Pf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lp;function wm(){if(lp)return na;lp=1;var Z=Bf(),J=xm();function N(r){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+r,f=1;f<arguments.length;f++)a+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+r+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var re=new Set,ce={};function Me(r,a){O(r,a),O(r+"Capture",a)}function O(r,a){for(ce[r]=a,r=0;r<a.length;r++)re.add(a[r])}var g=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ze=Object.prototype.hasOwnProperty,nt=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,tt={},xe={};function me(r){return ze.call(xe,r)?!0:ze.call(tt,r)?!1:nt.test(r)?xe[r]=!0:(tt[r]=!0,!1)}function Ot(r,a,f,x){if(f!==null&&f.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return x?!1:f!==null?!f.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function st(r,a,f,x){if(a===null||typeof a>"u"||Ot(r,a,f,x))return!0;if(x)return!1;if(f!==null)switch(f.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function Ue(r,a,f,x,k,E,q){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=x,this.attributeNamespace=k,this.mustUseProperty=f,this.propertyName=r,this.type=a,this.sanitizeURL=E,this.removeEmptyString=q}var Je={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){Je[r]=new Ue(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var a=r[0];Je[a]=new Ue(a,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){Je[r]=new Ue(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){Je[r]=new Ue(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){Je[r]=new Ue(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){Je[r]=new Ue(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){Je[r]=new Ue(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){Je[r]=new Ue(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){Je[r]=new Ue(r,5,!1,r.toLowerCase(),null,!1,!1)});var $t=/[\-:]([a-z])/g;function Qt(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var a=r.replace($t,Qt);Je[a]=new Ue(a,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var a=r.replace($t,Qt);Je[a]=new Ue(a,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var a=r.replace($t,Qt);Je[a]=new Ue(a,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){Je[r]=new Ue(r,1,!1,r.toLowerCase(),null,!1,!1)}),Je.xlinkHref=new Ue("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){Je[r]=new Ue(r,1,!1,r.toLowerCase(),null,!0,!0)});function Mt(r,a,f,x){var k=Je.hasOwnProperty(a)?Je[a]:null;(k!==null?k.type!==0:x||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(st(a,f,k,x)&&(f=null),x||k===null?me(a)&&(f===null?r.removeAttribute(a):r.setAttribute(a,""+f)):k.mustUseProperty?r[k.propertyName]=f===null?k.type===3?!1:"":f:(a=k.attributeName,x=k.attributeNamespace,f===null?r.removeAttribute(a):(k=k.type,f=k===3||k===4&&f===!0?"":""+f,x?r.setAttributeNS(x,a,f):r.setAttribute(a,f))))}var hi=Z.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,li=Symbol.for("react.element"),Ii=Symbol.for("react.portal"),_i=Symbol.for("react.fragment"),nn=Symbol.for("react.strict_mode"),an=Symbol.for("react.profiler"),Zn=Symbol.for("react.provider"),qt=Symbol.for("react.context"),Hi=Symbol.for("react.forward_ref"),Di=Symbol.for("react.suspense"),xi=Symbol.for("react.suspense_list"),Bn=Symbol.for("react.memo"),Bi=Symbol.for("react.lazy"),Ei=Symbol.for("react.offscreen"),qe=Symbol.iterator;function Nt(r){return r===null||typeof r!="object"?null:(r=qe&&r[qe]||r["@@iterator"],typeof r=="function"?r:null)}var He=Object.assign,ge;function Ne(r){if(ge===void 0)try{throw Error()}catch(f){var a=f.stack.trim().match(/\n( *(at )?)/);ge=a&&a[1]||""}return`
`+ge+r}var Ft=!1;function It(r,a){if(!r||Ft)return"";Ft=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(Oe){var x=Oe}Reflect.construct(r,[],a)}else{try{a.call()}catch(Oe){x=Oe}r.call(a.prototype)}else{try{throw Error()}catch(Oe){x=Oe}r()}}catch(Oe){if(Oe&&x&&typeof Oe.stack=="string"){for(var k=Oe.stack.split(`
`),E=x.stack.split(`
`),q=k.length-1,ae=E.length-1;1<=q&&0<=ae&&k[q]!==E[ae];)ae--;for(;1<=q&&0<=ae;q--,ae--)if(k[q]!==E[ae]){if(q!==1||ae!==1)do if(q--,ae--,0>ae||k[q]!==E[ae]){var _e=`
`+k[q].replace(" at new "," at ");return r.displayName&&_e.includes("<anonymous>")&&(_e=_e.replace("<anonymous>",r.displayName)),_e}while(1<=q&&0<=ae);break}}}finally{Ft=!1,Error.prepareStackTrace=f}return(r=r?r.displayName||r.name:"")?Ne(r):""}function Tt(r){switch(r.tag){case 5:return Ne(r.type);case 16:return Ne("Lazy");case 13:return Ne("Suspense");case 19:return Ne("SuspenseList");case 0:case 2:case 15:return r=It(r.type,!1),r;case 11:return r=It(r.type.render,!1),r;case 1:return r=It(r.type,!0),r;default:return""}}function wt(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case _i:return"Fragment";case Ii:return"Portal";case an:return"Profiler";case nn:return"StrictMode";case Di:return"Suspense";case xi:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case qt:return(r.displayName||"Context")+".Consumer";case Zn:return(r._context.displayName||"Context")+".Provider";case Hi:var a=r.render;return r=r.displayName,r||(r=a.displayName||a.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case Bn:return a=r.displayName||null,a!==null?a:wt(r.type)||"Memo";case Bi:a=r._payload,r=r._init;try{return wt(r(a))}catch{}}return null}function ii(r){var a=r.type;switch(r.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=a.render,r=r.displayName||r.name||"",a.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return wt(a);case 8:return a===nn?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function ni(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Oi(r){var a=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function wn(r){var a=Oi(r)?"checked":"value",f=Object.getOwnPropertyDescriptor(r.constructor.prototype,a),x=""+r[a];if(!r.hasOwnProperty(a)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var k=f.get,E=f.set;return Object.defineProperty(r,a,{configurable:!0,get:function(){return k.call(this)},set:function(q){x=""+q,E.call(this,q)}}),Object.defineProperty(r,a,{enumerable:f.enumerable}),{getValue:function(){return x},setValue:function(q){x=""+q},stopTracking:function(){r._valueTracker=null,delete r[a]}}}}function js(r){r._valueTracker||(r._valueTracker=wn(r))}function wr(r){if(!r)return!1;var a=r._valueTracker;if(!a)return!0;var f=a.getValue(),x="";return r&&(x=Oi(r)?r.checked?"true":"false":r.value),r=x,r!==f?(a.setValue(r),!0):!1}function Fr(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function Vs(r,a){var f=a.checked;return He({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??r._wrapperState.initialChecked})}function Bo(r,a){var f=a.defaultValue==null?"":a.defaultValue,x=a.checked!=null?a.checked:a.defaultChecked;f=ni(a.value!=null?a.value:f),r._wrapperState={initialChecked:x,initialValue:f,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function Le(r,a){a=a.checked,a!=null&&Mt(r,"checked",a,!1)}function ps(r,a){Le(r,a);var f=ni(a.value),x=a.type;if(f!=null)x==="number"?(f===0&&r.value===""||r.value!=f)&&(r.value=""+f):r.value!==""+f&&(r.value=""+f);else if(x==="submit"||x==="reset"){r.removeAttribute("value");return}a.hasOwnProperty("value")?Mi(r,a.type,f):a.hasOwnProperty("defaultValue")&&Mi(r,a.type,ni(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(r.defaultChecked=!!a.defaultChecked)}function uo(r,a,f){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var x=a.type;if(!(x!=="submit"&&x!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+r._wrapperState.initialValue,f||a===r.value||(r.value=a),r.defaultValue=a}f=r.name,f!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,f!==""&&(r.name=f)}function Mi(r,a,f){(a!=="number"||Fr(r.ownerDocument)!==r)&&(f==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+f&&(r.defaultValue=""+f))}var $i=Array.isArray;function Kr(r,a,f,x){if(r=r.options,a){a={};for(var k=0;k<f.length;k++)a["$"+f[k]]=!0;for(f=0;f<r.length;f++)k=a.hasOwnProperty("$"+r[f].value),r[f].selected!==k&&(r[f].selected=k),k&&x&&(r[f].defaultSelected=!0)}else{for(f=""+ni(f),a=null,k=0;k<r.length;k++){if(r[k].value===f){r[k].selected=!0,x&&(r[k].defaultSelected=!0);return}a!==null||r[k].disabled||(a=r[k])}a!==null&&(a.selected=!0)}}function ms(r,a){if(a.dangerouslySetInnerHTML!=null)throw Error(N(91));return He({},a,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function _s(r,a){var f=a.value;if(f==null){if(f=a.children,a=a.defaultValue,f!=null){if(a!=null)throw Error(N(92));if($i(f)){if(1<f.length)throw Error(N(93));f=f[0]}a=f}a==null&&(a=""),f=a}r._wrapperState={initialValue:ni(f)}}function ra(r,a){var f=ni(a.value),x=ni(a.defaultValue);f!=null&&(f=""+f,f!==r.value&&(r.value=f),a.defaultValue==null&&r.defaultValue!==f&&(r.defaultValue=f)),x!=null&&(r.defaultValue=""+x)}function Nr(r){var a=r.textContent;a===r._wrapperState.initialValue&&a!==""&&a!==null&&(r.value=a)}function Oo(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Fo(r,a){return r==null||r==="http://www.w3.org/1999/xhtml"?Oo(a):r==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var Qe,gs=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,f,x,k){MSApp.execUnsafeLocalFunction(function(){return r(a,f,x,k)})}:r}(function(r,a){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=a;else{for(Qe=Qe||document.createElement("div"),Qe.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=Qe.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;a.firstChild;)r.appendChild(a.firstChild)}});function Tn(r,a){if(a){var f=r.firstChild;if(f&&f===r.lastChild&&f.nodeType===3){f.nodeValue=a;return}}r.textContent=a}var ur={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},No=["Webkit","ms","Moz","O"];Object.keys(ur).forEach(function(r){No.forEach(function(a){a=a+r.charAt(0).toUpperCase()+r.substring(1),ur[a]=ur[r]})});function ot(r,a,f){return a==null||typeof a=="boolean"||a===""?"":f||typeof a!="number"||a===0||ur.hasOwnProperty(r)&&ur[r]?(""+a).trim():a+"px"}function ri(r,a){r=r.style;for(var f in a)if(a.hasOwnProperty(f)){var x=f.indexOf("--")===0,k=ot(f,a[f],x);f==="float"&&(f="cssFloat"),x?r.setProperty(f,k):r[f]=k}}var Ut=He({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function tr(r,a){if(a){if(Ut[r]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(N(137,r));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(N(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(N(61))}if(a.style!=null&&typeof a.style!="object")throw Error(N(62))}}function $n(r,a){if(r.indexOf("-")===-1)return typeof a.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wt=null;function Jr(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Yr=null,br=null,ir=null;function se(r){if(r=_a(r)){if(typeof Yr!="function")throw Error(N(280));var a=r.stateNode;a&&(a=ll(a),Yr(r.stateNode,r.type,a))}}function V(r){br?ir?ir.push(r):ir=[r]:br=r}function j(){if(br){var r=br,a=ir;if(ir=br=null,se(r),a)for(r=0;r<a.length;r++)se(a[r])}}function W(r,a){return r(a)}function te(){}var fe=!1;function ve(r,a,f){if(fe)return r(a,f);fe=!0;try{return W(r,a,f)}finally{fe=!1,(br!==null||ir!==null)&&(te(),j())}}function Se(r,a){var f=r.stateNode;if(f===null)return null;var x=ll(f);if(x===null)return null;f=x[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(r=r.type,x=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!x;break e;default:r=!1}if(r)return null;if(f&&typeof f!="function")throw Error(N(231,a,typeof f));return f}var he=!1;if(g)try{var Be={};Object.defineProperty(Be,"passive",{get:function(){he=!0}}),window.addEventListener("test",Be,Be),window.removeEventListener("test",Be,Be)}catch{he=!1}function Ze(r,a,f,x,k,E,q,ae,_e){var Oe=Array.prototype.slice.call(arguments,3);try{a.apply(f,Oe)}catch(Ye){this.onError(Ye)}}var Ie=!1,De=null,Pt=!1,zt=null,ki={onError:function(r){Ie=!0,De=r}};function ei(r,a,f,x,k,E,q,ae,_e){Ie=!1,De=null,Ze.apply(ki,arguments)}function bi(r,a,f,x,k,E,q,ae,_e){if(ei.apply(this,arguments),Ie){if(Ie){var Oe=De;Ie=!1,De=null}else throw Error(N(198));Pt||(Pt=!0,zt=Oe)}}function si(r){var a=r,f=r;if(r.alternate)for(;a.return;)a=a.return;else{r=a;do a=r,(a.flags&4098)!==0&&(f=a.return),r=a.return;while(r)}return a.tag===3?f:null}function Xi(r){if(r.tag===13){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function rn(r){if(si(r)!==r)throw Error(N(188))}function fi(r){var a=r.alternate;if(!a){if(a=si(r),a===null)throw Error(N(188));return a!==r?null:r}for(var f=r,x=a;;){var k=f.return;if(k===null)break;var E=k.alternate;if(E===null){if(x=k.return,x!==null){f=x;continue}break}if(k.child===E.child){for(E=k.child;E;){if(E===f)return rn(k),r;if(E===x)return rn(k),a;E=E.sibling}throw Error(N(188))}if(f.return!==x.return)f=k,x=E;else{for(var q=!1,ae=k.child;ae;){if(ae===f){q=!0,f=k,x=E;break}if(ae===x){q=!0,x=k,f=E;break}ae=ae.sibling}if(!q){for(ae=E.child;ae;){if(ae===f){q=!0,f=E,x=k;break}if(ae===x){q=!0,x=E,f=k;break}ae=ae.sibling}if(!q)throw Error(N(189))}}if(f.alternate!==x)throw Error(N(190))}if(f.tag!==3)throw Error(N(188));return f.stateNode.current===f?r:a}function Fi(r){return r=fi(r),r!==null?Ki(r):null}function Ki(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var a=Ki(r);if(a!==null)return a;r=r.sibling}return null}var En=J.unstable_scheduleCallback,Mn=J.unstable_cancelCallback,cr=J.unstable_shouldYield,co=J.unstable_requestPaint,Xt=J.unstable_now,Kl=J.unstable_getCurrentPriorityLevel,Ha=J.unstable_ImmediatePriority,Sr=J.unstable_UserBlockingPriority,nr=J.unstable_NormalPriority,Jl=J.unstable_LowPriority,qn=J.unstable_IdlePriority,Hn=null,rr=null;function ys(r){if(rr&&typeof rr.onCommitFiberRoot=="function")try{rr.onCommitFiberRoot(Hn,r,void 0,(r.current.flags&128)===128)}catch{}}var Lt=Math.clz32?Math.clz32:Ji,Gi=Math.log,Tr=Math.LN2;function Ji(r){return r>>>=0,r===0?32:31-(Gi(r)/Tr|0)|0}var Qr=64,sr=4194304;function oi(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function Ai(r,a){var f=r.pendingLanes;if(f===0)return 0;var x=0,k=r.suspendedLanes,E=r.pingedLanes,q=f&268435455;if(q!==0){var ae=q&~k;ae!==0?x=oi(ae):(E&=q,E!==0&&(x=oi(E)))}else q=f&~k,q!==0?x=oi(q):E!==0&&(x=oi(E));if(x===0)return 0;if(a!==0&&a!==x&&(a&k)===0&&(k=x&-x,E=a&-a,k>=E||k===16&&(E&4194240)!==0))return a;if((x&4)!==0&&(x|=f&16),a=r.entangledLanes,a!==0)for(r=r.entanglements,a&=x;0<a;)f=31-Lt(a),k=1<<f,x|=r[f],a&=~k;return x}function Yl(r,a){switch(r){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sa(r,a){for(var f=r.suspendedLanes,x=r.pingedLanes,k=r.expirationTimes,E=r.pendingLanes;0<E;){var q=31-Lt(E),ae=1<<q,_e=k[q];_e===-1?((ae&f)===0||(ae&x)!==0)&&(k[q]=Yl(ae,a)):_e<=a&&(r.expiredLanes|=ae),E&=~ae}}function Pn(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function ho(){var r=Qr;return Qr<<=1,(Qr&4194240)===0&&(Qr=64),r}function wi(r){for(var a=[],f=0;31>f;f++)a.push(r);return a}function jr(r,a,f){r.pendingLanes|=a,a!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,a=31-Lt(a),r[a]=f}function mn(r,a){var f=r.pendingLanes&~a;r.pendingLanes=a,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=a,r.mutableReadLanes&=a,r.entangledLanes&=a,a=r.entanglements;var x=r.eventTimes;for(r=r.expirationTimes;0<f;){var k=31-Lt(f),E=1<<k;a[k]=0,x[k]=-1,r[k]=-1,f&=~E}}function Pr(r,a){var f=r.entangledLanes|=a;for(r=r.entanglements;f;){var x=31-Lt(f),k=1<<x;k&a|r[x]&a&&(r[x]|=a),f&=~k}}var zi=0;function fo(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var jo,Us,po,Ga,Wa,Ia=!1,Ea=[],Gn=null,Vr=null,dn=null,On=new Map,Jt=new Map,kn=[],Ui="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _l(r,a){switch(r){case"focusin":case"focusout":Gn=null;break;case"dragenter":case"dragleave":Vr=null;break;case"mouseover":case"mouseout":dn=null;break;case"pointerover":case"pointerout":On.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Jt.delete(a.pointerId)}}function es(r,a,f,x,k,E){return r===null||r.nativeEvent!==E?(r={blockedOn:a,domEventName:f,eventSystemFlags:x,nativeEvent:E,targetContainers:[k]},a!==null&&(a=_a(a),a!==null&&Us(a)),r):(r.eventSystemFlags|=x,a=r.targetContainers,k!==null&&a.indexOf(k)===-1&&a.push(k),r)}function Ql(r,a,f,x,k){switch(a){case"focusin":return Gn=es(Gn,r,a,f,x,k),!0;case"dragenter":return Vr=es(Vr,r,a,f,x,k),!0;case"mouseover":return dn=es(dn,r,a,f,x,k),!0;case"pointerover":var E=k.pointerId;return On.set(E,es(On.get(E)||null,r,a,f,x,k)),!0;case"gotpointercapture":return E=k.pointerId,Jt.set(E,es(Jt.get(E)||null,r,a,f,x,k)),!0}return!1}function Xa(r){var a=To(r.target);if(a!==null){var f=si(a);if(f!==null){if(a=f.tag,a===13){if(a=Xi(f),a!==null){r.blockedOn=a,Wa(r.priority,function(){po(f)});return}}else if(a===3&&f.stateNode.current.memoizedState.isDehydrated){r.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}r.blockedOn=null}function vs(r){if(r.blockedOn!==null)return!1;for(var a=r.targetContainers;0<a.length;){var f=Ma(r.domEventName,r.eventSystemFlags,a[0],r.nativeEvent);if(f===null){f=r.nativeEvent;var x=new f.constructor(f.type,f);Wt=x,f.target.dispatchEvent(x),Wt=null}else return a=_a(f),a!==null&&Us(a),r.blockedOn=f,!1;a.shift()}return!0}function gl(r,a,f){vs(r)&&f.delete(a)}function Ka(){Ia=!1,Gn!==null&&vs(Gn)&&(Gn=null),Vr!==null&&vs(Vr)&&(Vr=null),dn!==null&&vs(dn)&&(dn=null),On.forEach(gl),Jt.forEach(gl)}function _n(r,a){r.blockedOn===a&&(r.blockedOn=null,Ia||(Ia=!0,J.unstable_scheduleCallback(J.unstable_NormalPriority,Ka)))}function hr(r){function a(k){return _n(k,r)}if(0<Ea.length){_n(Ea[0],r);for(var f=1;f<Ea.length;f++){var x=Ea[f];x.blockedOn===r&&(x.blockedOn=null)}}for(Gn!==null&&_n(Gn,r),Vr!==null&&_n(Vr,r),dn!==null&&_n(dn,r),On.forEach(a),Jt.forEach(a),f=0;f<kn.length;f++)x=kn[f],x.blockedOn===r&&(x.blockedOn=null);for(;0<kn.length&&(f=kn[0],f.blockedOn===null);)Xa(f),f.blockedOn===null&&kn.shift()}var mo=hi.ReactCurrentBatchConfig,Vo=!0;function eu(r,a,f,x){var k=zi,E=mo.transition;mo.transition=null;try{zi=1,kr(r,a,f,x)}finally{zi=k,mo.transition=E}}function yl(r,a,f,x){var k=zi,E=mo.transition;mo.transition=null;try{zi=4,kr(r,a,f,x)}finally{zi=k,mo.transition=E}}function kr(r,a,f,x){if(Vo){var k=Ma(r,a,f,x);if(k===null)s(r,a,x,vl,f),_l(r,x);else if(Ql(k,r,a,f,x))x.stopPropagation();else if(_l(r,x),a&4&&-1<Ui.indexOf(r)){for(;k!==null;){var E=_a(k);if(E!==null&&jo(E),E=Ma(r,a,f,x),E===null&&s(r,a,x,vl,f),E===k)break;k=E}k!==null&&x.stopPropagation()}else s(r,a,x,null,f)}}var vl=null;function Ma(r,a,f,x){if(vl=null,r=Jr(x),r=To(r),r!==null)if(a=si(r),a===null)r=null;else if(f=a.tag,f===13){if(r=Xi(a),r!==null)return r;r=null}else if(f===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;r=null}else a!==r&&(r=null);return vl=r,null}function gi(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Kl()){case Ha:return 1;case Sr:return 4;case nr:case Jl:return 16;case qn:return 536870912;default:return 16}default:return 16}}var dr=null,ui=null,xs=null;function tu(){if(xs)return xs;var r,a=ui,f=a.length,x,k="value"in dr?dr.value:dr.textContent,E=k.length;for(r=0;r<f&&a[r]===k[r];r++);var q=f-r;for(x=1;x<=q&&a[f-x]===k[E-x];x++);return xs=k.slice(r,1<x?1-x:void 0)}function _o(r){var a=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&a===13&&(r=13)):r=a,r===10&&(r=13),32<=r||r===13?r:0}function za(){return!0}function iu(){return!1}function Cr(r){function a(f,x,k,E,q){this._reactName=f,this._targetInst=k,this.type=x,this.nativeEvent=E,this.target=q,this.currentTarget=null;for(var ae in r)r.hasOwnProperty(ae)&&(f=r[ae],this[ae]=f?f(E):E[ae]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?za:iu,this.isPropagationStopped=iu,this}return He(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=za)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=za)},persist:function(){},isPersistent:za}),a}var oa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ja=Cr(oa),Uo=He({},oa,{view:0,detail:0}),Eu=Cr(Uo),Ur,xl,ts,is=He({},Uo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:go,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==ts&&(ts&&r.type==="mousemove"?(Ur=r.screenX-ts.screenX,xl=r.screenY-ts.screenY):xl=Ur=0,ts=r),Ur)},movementY:function(r){return"movementY"in r?r.movementY:xl}}),nu=Cr(is),ru=He({},is,{dataTransfer:0}),aa=Cr(ru),Xu=He({},Uo,{relatedTarget:0}),la=Cr(Xu),Mu=He({},oa,{animationName:0,elapsedTime:0,pseudoElement:0}),Ku=Cr(Mu),zu=He({},oa,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),wl=Cr(zu),Au=He({},oa,{data:0}),Ya=Cr(Au),su={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ua={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ou(r){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(r):(r=fr[r])?!!a[r]:!1}function go(){return ou}var Ir=He({},Uo,{key:function(r){if(r.key){var a=su[r.key]||r.key;if(a!=="Unidentified")return a}return r.type==="keypress"?(r=_o(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?ua[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:go,charCode:function(r){return r.type==="keypress"?_o(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?_o(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Qa=Cr(Ir),bl=He({},is,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zo=Cr(bl),el=He({},Uo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:go}),au=Cr(el),gn=He({},oa,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ju=Cr(gn),pi=He({},is,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Sl=Cr(pi),Si=[9,13,27,32],Ci=g&&"CompositionEvent"in window,ws=null;g&&"documentMode"in document&&(ws=document.documentMode);var Zr=g&&"TextEvent"in window&&!ws,Aa=g&&(!Ci||ws&&8<ws&&11>=ws),yo=" ",$o=!1;function bs(r,a){switch(r){case"keyup":return Si.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Er(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Ss=!1;function lu(r,a){switch(r){case"compositionend":return Er(a);case"keypress":return a.which!==32?null:($o=!0,yo);case"textInput":return r=a.data,r===yo&&$o?null:r;default:return null}}function Zs(r,a){if(Ss)return r==="compositionend"||!Ci&&bs(r,a)?(r=tu(),xs=ui=dr=null,Ss=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Aa&&a.locale!=="ko"?null:a.data;default:return null}}var $s={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function La(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a==="input"?!!$s[r.type]:a==="textarea"}function qo(r,a,f,x){V(x),a=v(a,"onChange"),0<a.length&&(f=new Ja("onChange","change",null,f,x),r.push({event:f,listeners:a}))}var qs=null,Wn=null;function Tl(r){al(r,0)}function Mr(r){var a=rs(r);if(wr(a))return r}function Da(r,a){if(r==="change")return a}var Ts=!1;if(g){var Ho;if(g){var Ti="oninput"in document;if(!Ti){var ca=document.createElement("div");ca.setAttribute("oninput","return;"),Ti=typeof ca.oninput=="function"}Ho=Ti}else Ho=!1;Ts=Ho&&(!document.documentMode||9<document.documentMode)}function tl(){qs&&(qs.detachEvent("onpropertychange",il),Wn=qs=null)}function il(r){if(r.propertyName==="value"&&Mr(Wn)){var a=[];qo(a,Wn,r,Jr(r)),ve(Tl,a)}}function vo(r,a,f){r==="focusin"?(tl(),qs=a,Wn=f,qs.attachEvent("onpropertychange",il)):r==="focusout"&&tl()}function ha(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Mr(Wn)}function da(r,a){if(r==="click")return Mr(a)}function Pl(r,a){if(r==="input"||r==="change")return Mr(a)}function uu(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}var zr=typeof Object.is=="function"?Object.is:uu;function Ps(r,a){if(zr(r,a))return!0;if(typeof r!="object"||r===null||typeof a!="object"||a===null)return!1;var f=Object.keys(r),x=Object.keys(a);if(f.length!==x.length)return!1;for(x=0;x<f.length;x++){var k=f[x];if(!ze.call(a,k)||!zr(r[k],a[k]))return!1}return!0}function fa(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Go(r,a){var f=fa(r);r=0;for(var x;f;){if(f.nodeType===3){if(x=r+f.textContent.length,r<=a&&x>=a)return{node:f,offset:a-r};r=x}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=fa(f)}}function pa(r,a){return r&&a?r===a?!0:r&&r.nodeType===3?!1:a&&a.nodeType===3?pa(r,a.parentNode):"contains"in r?r.contains(a):r.compareDocumentPosition?!!(r.compareDocumentPosition(a)&16):!1:!1}function nl(){for(var r=window,a=Fr();a instanceof r.HTMLIFrameElement;){try{var f=typeof a.contentWindow.location.href=="string"}catch{f=!1}if(f)r=a.contentWindow;else break;a=Fr(r.document)}return a}function Wo(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a&&(a==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||a==="textarea"||r.contentEditable==="true")}function Ar(r){var a=nl(),f=r.focusedElem,x=r.selectionRange;if(a!==f&&f&&f.ownerDocument&&pa(f.ownerDocument.documentElement,f)){if(x!==null&&Wo(f)){if(a=x.start,r=x.end,r===void 0&&(r=a),"selectionStart"in f)f.selectionStart=a,f.selectionEnd=Math.min(r,f.value.length);else if(r=(a=f.ownerDocument||document)&&a.defaultView||window,r.getSelection){r=r.getSelection();var k=f.textContent.length,E=Math.min(x.start,k);x=x.end===void 0?E:Math.min(x.end,k),!r.extend&&E>x&&(k=x,x=E,E=k),k=Go(f,E);var q=Go(f,x);k&&q&&(r.rangeCount!==1||r.anchorNode!==k.node||r.anchorOffset!==k.offset||r.focusNode!==q.node||r.focusOffset!==q.offset)&&(a=a.createRange(),a.setStart(k.node,k.offset),r.removeAllRanges(),E>x?(r.addRange(a),r.extend(q.node,q.offset)):(a.setEnd(q.node,q.offset),r.addRange(a)))}}for(a=[],r=f;r=r.parentNode;)r.nodeType===1&&a.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<a.length;f++)r=a[f],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var ma=g&&"documentMode"in document&&11>=document.documentMode,xo=null,Xo=null,rl=null,sl=!1;function ol(r,a,f){var x=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;sl||xo==null||xo!==Fr(x)||(x=xo,"selectionStart"in x&&Wo(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),rl&&Ps(rl,x)||(rl=x,x=v(Xo,"onSelect"),0<x.length&&(a=new Ja("onSelect","select",null,a,f),r.push({event:a,listeners:x}),a.target=xo)))}function Hs(r,a){var f={};return f[r.toLowerCase()]=a.toLowerCase(),f["Webkit"+r]="webkit"+a,f["Moz"+r]="moz"+a,f}var Gs={animationend:Hs("Animation","AnimationEnd"),animationiteration:Hs("Animation","AnimationIteration"),animationstart:Hs("Animation","AnimationStart"),transitionend:Hs("Transition","TransitionEnd")},ns={},Fn={};g&&(Fn=document.createElement("div").style,"AnimationEvent"in window||(delete Gs.animationend.animation,delete Gs.animationiteration.animation,delete Gs.animationstart.animation),"TransitionEvent"in window||delete Gs.transitionend.transition);function ks(r){if(ns[r])return ns[r];if(!Gs[r])return r;var a=Gs[r],f;for(f in a)if(a.hasOwnProperty(f)&&f in Fn)return ns[r]=a[f];return r}var cu=ks("animationend"),Cs=ks("animationiteration"),ln=ks("animationstart"),$r=ks("transitionend"),Nn=new Map,Ra="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qr(r,a){Nn.set(r,a),Me(a,[r])}for(var Ws=0;Ws<Ra.length;Ws++){var wo=Ra[Ws],Xs=wo.toLowerCase(),hu=wo[0].toUpperCase()+wo.slice(1);qr(Xs,"on"+hu)}qr(cu,"onAnimationEnd"),qr(Cs,"onAnimationIteration"),qr(ln,"onAnimationStart"),qr("dblclick","onDoubleClick"),qr("focusin","onFocus"),qr("focusout","onBlur"),qr($r,"onTransitionEnd"),O("onMouseEnter",["mouseout","mouseover"]),O("onMouseLeave",["mouseout","mouseover"]),O("onPointerEnter",["pointerout","pointerover"]),O("onPointerLeave",["pointerout","pointerover"]),Me("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Me("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Me("onBeforeInput",["compositionend","keypress","textInput","paste"]),Me("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Me("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Me("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kl=new Set("cancel close invalid load scroll toggle".split(" ").concat(bo));function Ba(r,a,f){var x=r.type||"unknown-event";r.currentTarget=f,bi(x,a,void 0,r),r.currentTarget=null}function al(r,a){a=(a&4)!==0;for(var f=0;f<r.length;f++){var x=r[f],k=x.event;x=x.listeners;e:{var E=void 0;if(a)for(var q=x.length-1;0<=q;q--){var ae=x[q],_e=ae.instance,Oe=ae.currentTarget;if(ae=ae.listener,_e!==E&&k.isPropagationStopped())break e;Ba(k,ae,Oe),E=_e}else for(q=0;q<x.length;q++){if(ae=x[q],_e=ae.instance,Oe=ae.currentTarget,ae=ae.listener,_e!==E&&k.isPropagationStopped())break e;Ba(k,ae,Oe),E=_e}}}if(Pt)throw r=zt,Pt=!1,zt=null,r}function qi(r,a){var f=a[di];f===void 0&&(f=a[di]=new Set);var x=r+"__bubble";f.has(x)||(Cl(a,r,2,!1),f.add(x))}function So(r,a,f){var x=0;a&&(x|=4),Cl(f,r,x,a)}var Ko="_reactListening"+Math.random().toString(36).slice(2);function Ks(r){if(!r[Ko]){r[Ko]=!0,re.forEach(function(f){f!=="selectionchange"&&(kl.has(f)||So(f,!1,r),So(f,!0,r))});var a=r.nodeType===9?r:r.ownerDocument;a===null||a[Ko]||(a[Ko]=!0,So("selectionchange",!1,a))}}function Cl(r,a,f,x){switch(gi(a)){case 1:var k=eu;break;case 4:k=yl;break;default:k=kr}f=k.bind(null,a,f,r),k=void 0,!he||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(k=!0),x?k!==void 0?r.addEventListener(a,f,{capture:!0,passive:k}):r.addEventListener(a,f,!0):k!==void 0?r.addEventListener(a,f,{passive:k}):r.addEventListener(a,f,!1)}function s(r,a,f,x,k){var E=x;if((a&1)===0&&(a&2)===0&&x!==null)e:for(;;){if(x===null)return;var q=x.tag;if(q===3||q===4){var ae=x.stateNode.containerInfo;if(ae===k||ae.nodeType===8&&ae.parentNode===k)break;if(q===4)for(q=x.return;q!==null;){var _e=q.tag;if((_e===3||_e===4)&&(_e=q.stateNode.containerInfo,_e===k||_e.nodeType===8&&_e.parentNode===k))return;q=q.return}for(;ae!==null;){if(q=To(ae),q===null)return;if(_e=q.tag,_e===5||_e===6){x=E=q;continue e}ae=ae.parentNode}}x=x.return}ve(function(){var Oe=E,Ye=Jr(f),it=[];e:{var Ke=Nn.get(r);if(Ke!==void 0){var mt=Ja,kt=r;switch(r){case"keypress":if(_o(f)===0)break e;case"keydown":case"keyup":mt=Qa;break;case"focusin":kt="focus",mt=la;break;case"focusout":kt="blur",mt=la;break;case"beforeblur":case"afterblur":mt=la;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":mt=nu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":mt=aa;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":mt=au;break;case cu:case Cs:case ln:mt=Ku;break;case $r:mt=Ju;break;case"scroll":mt=Eu;break;case"wheel":mt=Sl;break;case"copy":case"cut":case"paste":mt=wl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":mt=Zo}var Rt=(a&4)!==0,Vn=!Rt&&r==="scroll",Ee=Rt?Ke!==null?Ke+"Capture":null:Ke;Rt=[];for(var we=Oe,Ae;we!==null;){Ae=we;var ct=Ae.stateNode;if(Ae.tag===5&&ct!==null&&(Ae=ct,Ee!==null&&(ct=Se(we,Ee),ct!=null&&Rt.push(d(we,ct,Ae)))),Vn)break;we=we.return}0<Rt.length&&(Ke=new mt(Ke,kt,null,f,Ye),it.push({event:Ke,listeners:Rt}))}}if((a&7)===0){e:{if(Ke=r==="mouseover"||r==="pointerover",mt=r==="mouseout"||r==="pointerout",Ke&&f!==Wt&&(kt=f.relatedTarget||f.fromElement)&&(To(kt)||kt[Ni]))break e;if((mt||Ke)&&(Ke=Ye.window===Ye?Ye:(Ke=Ye.ownerDocument)?Ke.defaultView||Ke.parentWindow:window,mt?(kt=f.relatedTarget||f.toElement,mt=Oe,kt=kt?To(kt):null,kt!==null&&(Vn=si(kt),kt!==Vn||kt.tag!==5&&kt.tag!==6)&&(kt=null)):(mt=null,kt=Oe),mt!==kt)){if(Rt=nu,ct="onMouseLeave",Ee="onMouseEnter",we="mouse",(r==="pointerout"||r==="pointerover")&&(Rt=Zo,ct="onPointerLeave",Ee="onPointerEnter",we="pointer"),Vn=mt==null?Ke:rs(mt),Ae=kt==null?Ke:rs(kt),Ke=new Rt(ct,we+"leave",mt,f,Ye),Ke.target=Vn,Ke.relatedTarget=Ae,ct=null,To(Ye)===Oe&&(Rt=new Rt(Ee,we+"enter",kt,f,Ye),Rt.target=Ae,Rt.relatedTarget=Vn,ct=Rt),Vn=ct,mt&&kt)t:{for(Rt=mt,Ee=kt,we=0,Ae=Rt;Ae;Ae=P(Ae))we++;for(Ae=0,ct=Ee;ct;ct=P(ct))Ae++;for(;0<we-Ae;)Rt=P(Rt),we--;for(;0<Ae-we;)Ee=P(Ee),Ae--;for(;we--;){if(Rt===Ee||Ee!==null&&Rt===Ee.alternate)break t;Rt=P(Rt),Ee=P(Ee)}Rt=null}else Rt=null;mt!==null&&A(it,Ke,mt,Rt,!1),kt!==null&&Vn!==null&&A(it,Vn,kt,Rt,!0)}}e:{if(Ke=Oe?rs(Oe):window,mt=Ke.nodeName&&Ke.nodeName.toLowerCase(),mt==="select"||mt==="input"&&Ke.type==="file")var jt=Da;else if(La(Ke))if(Ts)jt=Pl;else{jt=ha;var Yt=vo}else(mt=Ke.nodeName)&&mt.toLowerCase()==="input"&&(Ke.type==="checkbox"||Ke.type==="radio")&&(jt=da);if(jt&&(jt=jt(r,Oe))){qo(it,jt,f,Ye);break e}Yt&&Yt(r,Ke,Oe),r==="focusout"&&(Yt=Ke._wrapperState)&&Yt.controlled&&Ke.type==="number"&&Mi(Ke,"number",Ke.value)}switch(Yt=Oe?rs(Oe):window,r){case"focusin":(La(Yt)||Yt.contentEditable==="true")&&(xo=Yt,Xo=Oe,rl=null);break;case"focusout":rl=Xo=xo=null;break;case"mousedown":sl=!0;break;case"contextmenu":case"mouseup":case"dragend":sl=!1,ol(it,f,Ye);break;case"selectionchange":if(ma)break;case"keydown":case"keyup":ol(it,f,Ye)}var Vt;if(Ci)e:{switch(r){case"compositionstart":var ci="onCompositionStart";break e;case"compositionend":ci="onCompositionEnd";break e;case"compositionupdate":ci="onCompositionUpdate";break e}ci=void 0}else Ss?bs(r,f)&&(ci="onCompositionEnd"):r==="keydown"&&f.keyCode===229&&(ci="onCompositionStart");ci&&(Aa&&f.locale!=="ko"&&(Ss||ci!=="onCompositionStart"?ci==="onCompositionEnd"&&Ss&&(Vt=tu()):(dr=Ye,ui="value"in dr?dr.value:dr.textContent,Ss=!0)),Yt=v(Oe,ci),0<Yt.length&&(ci=new Ya(ci,r,null,f,Ye),it.push({event:ci,listeners:Yt}),Vt?ci.data=Vt:(Vt=Er(f),Vt!==null&&(ci.data=Vt)))),(Vt=Zr?lu(r,f):Zs(r,f))&&(Oe=v(Oe,"onBeforeInput"),0<Oe.length&&(Ye=new Ya("onBeforeInput","beforeinput",null,f,Ye),it.push({event:Ye,listeners:Oe}),Ye.data=Vt))}al(it,a)})}function d(r,a,f){return{instance:r,listener:a,currentTarget:f}}function v(r,a){for(var f=a+"Capture",x=[];r!==null;){var k=r,E=k.stateNode;k.tag===5&&E!==null&&(k=E,E=Se(r,f),E!=null&&x.unshift(d(r,E,k)),E=Se(r,a),E!=null&&x.push(d(r,E,k))),r=r.return}return x}function P(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function A(r,a,f,x,k){for(var E=a._reactName,q=[];f!==null&&f!==x;){var ae=f,_e=ae.alternate,Oe=ae.stateNode;if(_e!==null&&_e===x)break;ae.tag===5&&Oe!==null&&(ae=Oe,k?(_e=Se(f,E),_e!=null&&q.unshift(d(f,_e,ae))):k||(_e=Se(f,E),_e!=null&&q.push(d(f,_e,ae)))),f=f.return}q.length!==0&&r.push({event:a,listeners:q})}var G=/\r\n?/g,ue=/\u0000|\uFFFD/g;function Pe(r){return(typeof r=="string"?r:""+r).replace(G,`
`).replace(ue,"")}function Re(r,a,f){if(a=Pe(a),Pe(r)!==a&&f)throw Error(N(425))}function $e(){}var ft=null,Ht=null;function yi(r,a){return r==="textarea"||r==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var jn=typeof setTimeout=="function"?setTimeout:void 0,zn=typeof clearTimeout=="function"?clearTimeout:void 0,pr=typeof Promise=="function"?Promise:void 0,An=typeof queueMicrotask=="function"?queueMicrotask:typeof pr<"u"?function(r){return pr.resolve(null).then(r).catch(Xn)}:jn;function Xn(r){setTimeout(function(){throw r})}function gt(r,a){var f=a,x=0;do{var k=f.nextSibling;if(r.removeChild(f),k&&k.nodeType===8)if(f=k.data,f==="/$"){if(x===0){r.removeChild(k),hr(a);return}x--}else f!=="$"&&f!=="$?"&&f!=="$!"||x++;f=k}while(f);hr(a)}function Is(r){for(;r!=null;r=r.nextSibling){var a=r.nodeType;if(a===1||a===3)break;if(a===8){if(a=r.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return r}function Il(r){r=r.previousSibling;for(var a=0;r;){if(r.nodeType===8){var f=r.data;if(f==="$"||f==="$!"||f==="$?"){if(a===0)return r;a--}else f==="/$"&&a++}r=r.previousSibling}return null}var Jo=Math.random().toString(36).slice(2),mr="__reactFiber$"+Jo,Es="__reactProps$"+Jo,Ni="__reactContainer$"+Jo,di="__reactEvents$"+Jo,du="__reactListeners$"+Jo,Yu="__reactHandles$"+Jo;function To(r){var a=r[mr];if(a)return a;for(var f=r.parentNode;f;){if(a=f[Ni]||f[mr]){if(f=a.alternate,a.child!==null||f!==null&&f.child!==null)for(r=Il(r);r!==null;){if(f=r[mr])return f;r=Il(r)}return a}r=f,f=r.parentNode}return null}function _a(r){return r=r[mr]||r[Ni],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function rs(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(N(33))}function ll(r){return r[Es]||null}var fu=[],ul=-1;function Oa(r){return{current:r}}function sn(r){0>ul||(r.current=fu[ul],fu[ul]=null,ul--)}function un(r,a){ul++,fu[ul]=r.current,r.current=a}var Fa={},Yi=Oa(Fa),Pi=Oa(!1),Js=Fa;function ga(r,a){var f=r.type.contextTypes;if(!f)return Fa;var x=r.stateNode;if(x&&x.__reactInternalMemoizedUnmaskedChildContext===a)return x.__reactInternalMemoizedMaskedChildContext;var k={},E;for(E in f)k[E]=a[E];return x&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=a,r.__reactInternalMemoizedMaskedChildContext=k),k}function _r(r){return r=r.childContextTypes,r!=null}function pu(){sn(Pi),sn(Yi)}function El(r,a,f){if(Yi.current!==Fa)throw Error(N(168));un(Yi,a),un(Pi,f)}function Ml(r,a,f){var x=r.stateNode;if(a=a.childContextTypes,typeof x.getChildContext!="function")return f;x=x.getChildContext();for(var k in x)if(!(k in a))throw Error(N(108,ii(r)||"Unknown",k));return He({},f,x)}function Ms(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Fa,Js=Yi.current,un(Yi,r),un(Pi,Pi.current),!0}function zl(r,a,f){var x=r.stateNode;if(!x)throw Error(N(169));f?(r=Ml(r,a,Js),x.__reactInternalMemoizedMergedChildContext=r,sn(Pi),sn(Yi),un(Yi,r)):sn(Pi),un(Pi,f)}var vt=null,Bt=!1,Al=!1;function mu(r){vt===null?vt=[r]:vt.push(r)}function Qu(r){Bt=!0,mu(r)}function m(){if(!Al&&vt!==null){Al=!0;var r=0,a=zi;try{var f=vt;for(zi=1;r<f.length;r++){var x=f[r];do x=x(!0);while(x!==null)}vt=null,Bt=!1}catch(k){throw vt!==null&&(vt=vt.slice(r+1)),En(Ha,m),k}finally{zi=a,Al=!1}}return null}var e=[],o=0,u=null,c=0,p=[],b=0,T=null,C=1,M="";function R(r,a){e[o++]=c,e[o++]=u,u=r,c=a}function B(r,a,f){p[b++]=C,p[b++]=M,p[b++]=T,T=r;var x=C;r=M;var k=32-Lt(x)-1;x&=~(1<<k),f+=1;var E=32-Lt(a)+k;if(30<E){var q=k-k%5;E=(x&(1<<q)-1).toString(32),x>>=q,k-=q,C=1<<32-Lt(a)+k|f<<k|x,M=E+r}else C=1<<E|f<<k|x,M=r}function $(r){r.return!==null&&(R(r,1),B(r,1,0))}function X(r){for(;r===u;)u=e[--o],e[o]=null,c=e[--o],e[o]=null;for(;r===T;)T=p[--b],p[b]=null,M=p[--b],p[b]=null,C=p[--b],p[b]=null}var Y=null,Q=null,ie=!1,oe=null;function de(r,a){var f=ro(5,null,null,0);f.elementType="DELETED",f.stateNode=a,f.return=r,a=r.deletions,a===null?(r.deletions=[f],r.flags|=16):a.push(f)}function ee(r,a){switch(r.tag){case 5:var f=r.type;return a=a.nodeType!==1||f.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(r.stateNode=a,Y=r,Q=Is(a.firstChild),!0):!1;case 6:return a=r.pendingProps===""||a.nodeType!==3?null:a,a!==null?(r.stateNode=a,Y=r,Q=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(f=T!==null?{id:C,overflow:M}:null,r.memoizedState={dehydrated:a,treeContext:f,retryLane:1073741824},f=ro(18,null,null,0),f.stateNode=a,f.return=r,r.child=f,Y=r,Q=null,!0):!1;default:return!1}}function ye(r){return(r.mode&1)!==0&&(r.flags&128)===0}function be(r){if(ie){var a=Q;if(a){var f=a;if(!ee(r,a)){if(ye(r))throw Error(N(418));a=Is(f.nextSibling);var x=Y;a&&ee(r,a)?de(x,f):(r.flags=r.flags&-4097|2,ie=!1,Y=r)}}else{if(ye(r))throw Error(N(418));r.flags=r.flags&-4097|2,ie=!1,Y=r}}}function Ce(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;Y=r}function Ve(r){if(r!==Y)return!1;if(!ie)return Ce(r),ie=!0,!1;var a;if((a=r.tag!==3)&&!(a=r.tag!==5)&&(a=r.type,a=a!=="head"&&a!=="body"&&!yi(r.type,r.memoizedProps)),a&&(a=Q)){if(ye(r))throw et(),Error(N(418));for(;a;)de(r,a),a=Is(a.nextSibling)}if(Ce(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(N(317));e:{for(r=r.nextSibling,a=0;r;){if(r.nodeType===8){var f=r.data;if(f==="/$"){if(a===0){Q=Is(r.nextSibling);break e}a--}else f!=="$"&&f!=="$!"&&f!=="$?"||a++}r=r.nextSibling}Q=null}}else Q=Y?Is(r.stateNode.nextSibling):null;return!0}function et(){for(var r=Q;r;)r=Is(r.nextSibling)}function at(){Q=Y=null,ie=!1}function pt(r){oe===null?oe=[r]:oe.push(r)}var lt=hi.ReactCurrentBatchConfig;function rt(r,a,f){if(r=f.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(N(309));var x=f.stateNode}if(!x)throw Error(N(147,r));var k=x,E=""+r;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===E?a.ref:(a=function(q){var ae=k.refs;q===null?delete ae[E]:ae[E]=q},a._stringRef=E,a)}if(typeof r!="string")throw Error(N(284));if(!f._owner)throw Error(N(290,r))}return r}function bt(r,a){throw r=Object.prototype.toString.call(a),Error(N(31,r==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":r))}function Kt(r){var a=r._init;return a(r._payload)}function ut(r){function a(Ee,we){if(r){var Ae=Ee.deletions;Ae===null?(Ee.deletions=[we],Ee.flags|=16):Ae.push(we)}}function f(Ee,we){if(!r)return null;for(;we!==null;)a(Ee,we),we=we.sibling;return null}function x(Ee,we){for(Ee=new Map;we!==null;)we.key!==null?Ee.set(we.key,we):Ee.set(we.index,we),we=we.sibling;return Ee}function k(Ee,we){return Ee=$l(Ee,we),Ee.index=0,Ee.sibling=null,Ee}function E(Ee,we,Ae){return Ee.index=Ae,r?(Ae=Ee.alternate,Ae!==null?(Ae=Ae.index,Ae<we?(Ee.flags|=2,we):Ae):(Ee.flags|=2,we)):(Ee.flags|=1048576,we)}function q(Ee){return r&&Ee.alternate===null&&(Ee.flags|=2),Ee}function ae(Ee,we,Ae,ct){return we===null||we.tag!==6?(we=ta(Ae,Ee.mode,ct),we.return=Ee,we):(we=k(we,Ae),we.return=Ee,we)}function _e(Ee,we,Ae,ct){var jt=Ae.type;return jt===_i?Ye(Ee,we,Ae.props.children,ct,Ae.key):we!==null&&(we.elementType===jt||typeof jt=="object"&&jt!==null&&jt.$$typeof===Bi&&Kt(jt)===we.type)?(ct=k(we,Ae.props),ct.ref=rt(Ee,we,Ae),ct.return=Ee,ct):(ct=Cc(Ae.type,Ae.key,Ae.props,null,Ee.mode,ct),ct.ref=rt(Ee,we,Ae),ct.return=Ee,ct)}function Oe(Ee,we,Ae,ct){return we===null||we.tag!==4||we.stateNode.containerInfo!==Ae.containerInfo||we.stateNode.implementation!==Ae.implementation?(we=Za(Ae,Ee.mode,ct),we.return=Ee,we):(we=k(we,Ae.children||[]),we.return=Ee,we)}function Ye(Ee,we,Ae,ct,jt){return we===null||we.tag!==7?(we=ql(Ae,Ee.mode,ct,jt),we.return=Ee,we):(we=k(we,Ae),we.return=Ee,we)}function it(Ee,we,Ae){if(typeof we=="string"&&we!==""||typeof we=="number")return we=ta(""+we,Ee.mode,Ae),we.return=Ee,we;if(typeof we=="object"&&we!==null){switch(we.$$typeof){case li:return Ae=Cc(we.type,we.key,we.props,null,Ee.mode,Ae),Ae.ref=rt(Ee,null,we),Ae.return=Ee,Ae;case Ii:return we=Za(we,Ee.mode,Ae),we.return=Ee,we;case Bi:var ct=we._init;return it(Ee,ct(we._payload),Ae)}if($i(we)||Nt(we))return we=ql(we,Ee.mode,Ae,null),we.return=Ee,we;bt(Ee,we)}return null}function Ke(Ee,we,Ae,ct){var jt=we!==null?we.key:null;if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number")return jt!==null?null:ae(Ee,we,""+Ae,ct);if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case li:return Ae.key===jt?_e(Ee,we,Ae,ct):null;case Ii:return Ae.key===jt?Oe(Ee,we,Ae,ct):null;case Bi:return jt=Ae._init,Ke(Ee,we,jt(Ae._payload),ct)}if($i(Ae)||Nt(Ae))return jt!==null?null:Ye(Ee,we,Ae,ct,null);bt(Ee,Ae)}return null}function mt(Ee,we,Ae,ct,jt){if(typeof ct=="string"&&ct!==""||typeof ct=="number")return Ee=Ee.get(Ae)||null,ae(we,Ee,""+ct,jt);if(typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case li:return Ee=Ee.get(ct.key===null?Ae:ct.key)||null,_e(we,Ee,ct,jt);case Ii:return Ee=Ee.get(ct.key===null?Ae:ct.key)||null,Oe(we,Ee,ct,jt);case Bi:var Yt=ct._init;return mt(Ee,we,Ae,Yt(ct._payload),jt)}if($i(ct)||Nt(ct))return Ee=Ee.get(Ae)||null,Ye(we,Ee,ct,jt,null);bt(we,ct)}return null}function kt(Ee,we,Ae,ct){for(var jt=null,Yt=null,Vt=we,ci=we=0,xr=null;Vt!==null&&ci<Ae.length;ci++){Vt.index>ci?(xr=Vt,Vt=null):xr=Vt.sibling;var Zi=Ke(Ee,Vt,Ae[ci],ct);if(Zi===null){Vt===null&&(Vt=xr);break}r&&Vt&&Zi.alternate===null&&a(Ee,Vt),we=E(Zi,we,ci),Yt===null?jt=Zi:Yt.sibling=Zi,Yt=Zi,Vt=xr}if(ci===Ae.length)return f(Ee,Vt),ie&&R(Ee,ci),jt;if(Vt===null){for(;ci<Ae.length;ci++)Vt=it(Ee,Ae[ci],ct),Vt!==null&&(we=E(Vt,we,ci),Yt===null?jt=Vt:Yt.sibling=Vt,Yt=Vt);return ie&&R(Ee,ci),jt}for(Vt=x(Ee,Vt);ci<Ae.length;ci++)xr=mt(Vt,Ee,ci,Ae[ci],ct),xr!==null&&(r&&xr.alternate!==null&&Vt.delete(xr.key===null?ci:xr.key),we=E(xr,we,ci),Yt===null?jt=xr:Yt.sibling=xr,Yt=xr);return r&&Vt.forEach(function(fl){return a(Ee,fl)}),ie&&R(Ee,ci),jt}function Rt(Ee,we,Ae,ct){var jt=Nt(Ae);if(typeof jt!="function")throw Error(N(150));if(Ae=jt.call(Ae),Ae==null)throw Error(N(151));for(var Yt=jt=null,Vt=we,ci=we=0,xr=null,Zi=Ae.next();Vt!==null&&!Zi.done;ci++,Zi=Ae.next()){Vt.index>ci?(xr=Vt,Vt=null):xr=Vt.sibling;var fl=Ke(Ee,Vt,Zi.value,ct);if(fl===null){Vt===null&&(Vt=xr);break}r&&Vt&&fl.alternate===null&&a(Ee,Vt),we=E(fl,we,ci),Yt===null?jt=fl:Yt.sibling=fl,Yt=fl,Vt=xr}if(Zi.done)return f(Ee,Vt),ie&&R(Ee,ci),jt;if(Vt===null){for(;!Zi.done;ci++,Zi=Ae.next())Zi=it(Ee,Zi.value,ct),Zi!==null&&(we=E(Zi,we,ci),Yt===null?jt=Zi:Yt.sibling=Zi,Yt=Zi);return ie&&R(Ee,ci),jt}for(Vt=x(Ee,Vt);!Zi.done;ci++,Zi=Ae.next())Zi=mt(Vt,Ee,ci,Zi.value,ct),Zi!==null&&(r&&Zi.alternate!==null&&Vt.delete(Zi.key===null?ci:Zi.key),we=E(Zi,we,ci),Yt===null?jt=Zi:Yt.sibling=Zi,Yt=Zi);return r&&Vt.forEach(function(cf){return a(Ee,cf)}),ie&&R(Ee,ci),jt}function Vn(Ee,we,Ae,ct){if(typeof Ae=="object"&&Ae!==null&&Ae.type===_i&&Ae.key===null&&(Ae=Ae.props.children),typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case li:e:{for(var jt=Ae.key,Yt=we;Yt!==null;){if(Yt.key===jt){if(jt=Ae.type,jt===_i){if(Yt.tag===7){f(Ee,Yt.sibling),we=k(Yt,Ae.props.children),we.return=Ee,Ee=we;break e}}else if(Yt.elementType===jt||typeof jt=="object"&&jt!==null&&jt.$$typeof===Bi&&Kt(jt)===Yt.type){f(Ee,Yt.sibling),we=k(Yt,Ae.props),we.ref=rt(Ee,Yt,Ae),we.return=Ee,Ee=we;break e}f(Ee,Yt);break}else a(Ee,Yt);Yt=Yt.sibling}Ae.type===_i?(we=ql(Ae.props.children,Ee.mode,ct,Ae.key),we.return=Ee,Ee=we):(ct=Cc(Ae.type,Ae.key,Ae.props,null,Ee.mode,ct),ct.ref=rt(Ee,we,Ae),ct.return=Ee,Ee=ct)}return q(Ee);case Ii:e:{for(Yt=Ae.key;we!==null;){if(we.key===Yt)if(we.tag===4&&we.stateNode.containerInfo===Ae.containerInfo&&we.stateNode.implementation===Ae.implementation){f(Ee,we.sibling),we=k(we,Ae.children||[]),we.return=Ee,Ee=we;break e}else{f(Ee,we);break}else a(Ee,we);we=we.sibling}we=Za(Ae,Ee.mode,ct),we.return=Ee,Ee=we}return q(Ee);case Bi:return Yt=Ae._init,Vn(Ee,we,Yt(Ae._payload),ct)}if($i(Ae))return kt(Ee,we,Ae,ct);if(Nt(Ae))return Rt(Ee,we,Ae,ct);bt(Ee,Ae)}return typeof Ae=="string"&&Ae!==""||typeof Ae=="number"?(Ae=""+Ae,we!==null&&we.tag===6?(f(Ee,we.sibling),we=k(we,Ae),we.return=Ee,Ee=we):(f(Ee,we),we=ta(Ae,Ee.mode,ct),we.return=Ee,Ee=we),q(Ee)):f(Ee,we)}return Vn}var ht=ut(!0),Gt=ut(!1),Wi=Oa(null),ai=null,mi=null,Qi=null;function or(){Qi=mi=ai=null}function zs(r){var a=Wi.current;sn(Wi),r._currentValue=a}function en(r,a,f){for(;r!==null;){var x=r.alternate;if((r.childLanes&a)!==a?(r.childLanes|=a,x!==null&&(x.childLanes|=a)):x!==null&&(x.childLanes&a)!==a&&(x.childLanes|=a),r===f)break;r=r.return}}function Kn(r,a){ai=r,Qi=mi=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&a)!==0&&(Rs=!0),r.firstContext=null)}function cn(r){var a=r._currentValue;if(Qi!==r)if(r={context:r,memoizedValue:a,next:null},mi===null){if(ai===null)throw Error(N(308));mi=r,ai.dependencies={lanes:0,firstContext:r}}else mi=mi.next=r;return a}var Cn=null;function gr(r){Cn===null?Cn=[r]:Cn.push(r)}function Po(r,a,f,x){var k=a.interleaved;return k===null?(f.next=f,gr(a)):(f.next=k.next,k.next=f),a.interleaved=f,ss(r,x)}function ss(r,a){r.lanes|=a;var f=r.alternate;for(f!==null&&(f.lanes|=a),f=r,r=r.return;r!==null;)r.childLanes|=a,f=r.alternate,f!==null&&(f.childLanes|=a),f=r,r=r.return;return f.tag===3?f.stateNode:null}var ko=!1;function Na(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function As(r,a){r=r.updateQueue,a.updateQueue===r&&(a.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function Ys(r,a){return{eventTime:r,lane:a,tag:0,payload:null,callback:null,next:null}}function Yo(r,a,f){var x=r.updateQueue;if(x===null)return null;if(x=x.shared,(ji&2)!==0){var k=x.pending;return k===null?a.next=a:(a.next=k.next,k.next=a),x.pending=a,ss(r,f)}return k=x.interleaved,k===null?(a.next=a,gr(x)):(a.next=k.next,k.next=a),x.interleaved=a,ss(r,f)}function Hr(r,a,f){if(a=a.updateQueue,a!==null&&(a=a.shared,(f&4194240)!==0)){var x=a.lanes;x&=r.pendingLanes,f|=x,a.lanes=f,Pr(r,f)}}function Ls(r,a){var f=r.updateQueue,x=r.alternate;if(x!==null&&(x=x.updateQueue,f===x)){var k=null,E=null;if(f=f.firstBaseUpdate,f!==null){do{var q={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};E===null?k=E=q:E=E.next=q,f=f.next}while(f!==null);E===null?k=E=a:E=E.next=a}else k=E=a;f={baseState:x.baseState,firstBaseUpdate:k,lastBaseUpdate:E,shared:x.shared,effects:x.effects},r.updateQueue=f;return}r=f.lastBaseUpdate,r===null?f.firstBaseUpdate=a:r.next=a,f.lastBaseUpdate=a}function Co(r,a,f,x){var k=r.updateQueue;ko=!1;var E=k.firstBaseUpdate,q=k.lastBaseUpdate,ae=k.shared.pending;if(ae!==null){k.shared.pending=null;var _e=ae,Oe=_e.next;_e.next=null,q===null?E=Oe:q.next=Oe,q=_e;var Ye=r.alternate;Ye!==null&&(Ye=Ye.updateQueue,ae=Ye.lastBaseUpdate,ae!==q&&(ae===null?Ye.firstBaseUpdate=Oe:ae.next=Oe,Ye.lastBaseUpdate=_e))}if(E!==null){var it=k.baseState;q=0,Ye=Oe=_e=null,ae=E;do{var Ke=ae.lane,mt=ae.eventTime;if((x&Ke)===Ke){Ye!==null&&(Ye=Ye.next={eventTime:mt,lane:0,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null});e:{var kt=r,Rt=ae;switch(Ke=a,mt=f,Rt.tag){case 1:if(kt=Rt.payload,typeof kt=="function"){it=kt.call(mt,it,Ke);break e}it=kt;break e;case 3:kt.flags=kt.flags&-65537|128;case 0:if(kt=Rt.payload,Ke=typeof kt=="function"?kt.call(mt,it,Ke):kt,Ke==null)break e;it=He({},it,Ke);break e;case 2:ko=!0}}ae.callback!==null&&ae.lane!==0&&(r.flags|=64,Ke=k.effects,Ke===null?k.effects=[ae]:Ke.push(ae))}else mt={eventTime:mt,lane:Ke,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null},Ye===null?(Oe=Ye=mt,_e=it):Ye=Ye.next=mt,q|=Ke;if(ae=ae.next,ae===null){if(ae=k.shared.pending,ae===null)break;Ke=ae,ae=Ke.next,Ke.next=null,k.lastBaseUpdate=Ke,k.shared.pending=null}}while(!0);if(Ye===null&&(_e=it),k.baseState=_e,k.firstBaseUpdate=Oe,k.lastBaseUpdate=Ye,a=k.shared.interleaved,a!==null){k=a;do q|=k.lane,k=k.next;while(k!==a)}else E===null&&(k.shared.lanes=0);wu|=q,r.lanes=q,r.memoizedState=it}}function Qs(r,a,f){if(r=a.effects,a.effects=null,r!==null)for(a=0;a<r.length;a++){var x=r[a],k=x.callback;if(k!==null){if(x.callback=null,x=f,typeof k!="function")throw Error(N(191,k));k.call(x)}}}var Ln={},fn=Oa(Ln),yr=Oa(Ln),vi=Oa(Ln);function Ds(r){if(r===Ln)throw Error(N(174));return r}function ja(r,a){switch(un(vi,a),un(yr,r),un(fn,Ln),r=a.nodeType,r){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:Fo(null,"");break;default:r=r===8?a.parentNode:a,a=r.namespaceURI||null,r=r.tagName,a=Fo(a,r)}sn(fn),un(fn,a)}function Io(){sn(fn),sn(yr),sn(vi)}function ec(r){Ds(vi.current);var a=Ds(fn.current),f=Fo(a,r.type);a!==f&&(un(yr,r),un(fn,f))}function tc(r){yr.current===r&&(sn(fn),sn(yr))}var yn=Oa(0);function Eo(r){for(var a=r;a!==null;){if(a.tag===13){var f=a.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Lu=[];function Ll(){for(var r=0;r<Lu.length;r++)Lu[r]._workInProgressVersionPrimary=null;Lu.length=0}var Va=hi.ReactCurrentDispatcher,Dl=hi.ReactCurrentBatchConfig,Qo=0,tn=null,bn=null,Jn=null,ic=!1,Du=!1,nc=0,vh=0;function ar(){throw Error(N(321))}function Rl(r,a){if(a===null)return!1;for(var f=0;f<a.length&&f<r.length;f++)if(!zr(r[f],a[f]))return!1;return!0}function ya(r,a,f,x,k,E){if(Qo=E,tn=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Va.current=r===null||r.memoizedState===null?Zc:Jd,r=f(x,k),Du){E=0;do{if(Du=!1,nc=0,25<=E)throw Error(N(301));E+=1,Jn=bn=null,a.updateQueue=null,Va.current=nd,r=f(x,k)}while(Du)}if(Va.current=Uc,a=bn!==null&&bn.next!==null,Qo=0,Jn=bn=tn=null,ic=!1,a)throw Error(N(300));return r}function Mo(){var r=nc!==0;return nc=0,r}function Gr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jn===null?tn.memoizedState=Jn=r:Jn=Jn.next=r,Jn}function zo(){if(bn===null){var r=tn.alternate;r=r!==null?r.memoizedState:null}else r=bn.next;var a=Jn===null?tn.memoizedState:Jn.next;if(a!==null)Jn=a,bn=r;else{if(r===null)throw Error(N(310));bn=r,r={memoizedState:bn.memoizedState,baseState:bn.baseState,baseQueue:bn.baseQueue,queue:bn.queue,next:null},Jn===null?tn.memoizedState=Jn=r:Jn=Jn.next=r}return Jn}function va(r,a){return typeof a=="function"?a(r):a}function xh(r){var a=zo(),f=a.queue;if(f===null)throw Error(N(311));f.lastRenderedReducer=r;var x=bn,k=x.baseQueue,E=f.pending;if(E!==null){if(k!==null){var q=k.next;k.next=E.next,E.next=q}x.baseQueue=k=E,f.pending=null}if(k!==null){E=k.next,x=x.baseState;var ae=q=null,_e=null,Oe=E;do{var Ye=Oe.lane;if((Qo&Ye)===Ye)_e!==null&&(_e=_e.next={lane:0,action:Oe.action,hasEagerState:Oe.hasEagerState,eagerState:Oe.eagerState,next:null}),x=Oe.hasEagerState?Oe.eagerState:r(x,Oe.action);else{var it={lane:Ye,action:Oe.action,hasEagerState:Oe.hasEagerState,eagerState:Oe.eagerState,next:null};_e===null?(ae=_e=it,q=x):_e=_e.next=it,tn.lanes|=Ye,wu|=Ye}Oe=Oe.next}while(Oe!==null&&Oe!==E);_e===null?q=x:_e.next=ae,zr(x,a.memoizedState)||(Rs=!0),a.memoizedState=x,a.baseState=q,a.baseQueue=_e,f.lastRenderedState=x}if(r=f.interleaved,r!==null){k=r;do E=k.lane,tn.lanes|=E,wu|=E,k=k.next;while(k!==r)}else k===null&&(f.lanes=0);return[a.memoizedState,f.dispatch]}function Oc(r){var a=zo(),f=a.queue;if(f===null)throw Error(N(311));f.lastRenderedReducer=r;var x=f.dispatch,k=f.pending,E=a.memoizedState;if(k!==null){f.pending=null;var q=k=k.next;do E=r(E,q.action),q=q.next;while(q!==k);zr(E,a.memoizedState)||(Rs=!0),a.memoizedState=E,a.baseQueue===null&&(a.baseState=E),f.lastRenderedState=E}return[E,x]}function Dn(){}function Fc(r,a){var f=tn,x=zo(),k=a(),E=!zr(x.memoizedState,k);if(E&&(x.memoizedState=k,Rs=!0),x=x.queue,oc(Ol.bind(null,f,x,r),[r]),x.getSnapshot!==a||E||Jn!==null&&Jn.memoizedState.tag&1){if(f.flags|=2048,sc(9,Bl.bind(null,f,x,k,a),void 0,null),vr===null)throw Error(N(349));(Qo&30)!==0||wh(f,a,k)}return k}function wh(r,a,f){r.flags|=16384,r={getSnapshot:a,value:f},a=tn.updateQueue,a===null?(a={lastEffect:null,stores:null},tn.updateQueue=a,a.stores=[r]):(f=a.stores,f===null?a.stores=[r]:f.push(r))}function Bl(r,a,f,x){a.value=f,a.getSnapshot=x,rc(a)&&Nc(r)}function Ol(r,a,f){return f(function(){rc(a)&&Nc(r)})}function rc(r){var a=r.getSnapshot;r=r.value;try{var f=a();return!zr(r,f)}catch{return!0}}function Nc(r){var a=ss(r,1);a!==null&&wa(a,r,1,-1)}function bh(r){var a=Gr();return typeof r=="function"&&(r=r()),a.memoizedState=a.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:va,lastRenderedState:r},a.queue=r,r=r.dispatch=Bu.bind(null,tn,r),[a.memoizedState,r]}function sc(r,a,f,x){return r={tag:r,create:a,destroy:f,deps:x,next:null},a=tn.updateQueue,a===null?(a={lastEffect:null,stores:null},tn.updateQueue=a,a.lastEffect=r.next=r):(f=a.lastEffect,f===null?a.lastEffect=r.next=r:(x=f.next,f.next=r,r.next=x,a.lastEffect=r)),r}function Sh(){return zo().memoizedState}function jc(r,a,f,x){var k=Gr();tn.flags|=r,k.memoizedState=sc(1|a,f,void 0,x===void 0?null:x)}function Ru(r,a,f,x){var k=zo();x=x===void 0?null:x;var E=void 0;if(bn!==null){var q=bn.memoizedState;if(E=q.destroy,x!==null&&Rl(x,q.deps)){k.memoizedState=sc(a,f,E,x);return}}tn.flags|=r,k.memoizedState=sc(1|a,f,E,x)}function Qh(r,a){return jc(8390656,8,r,a)}function oc(r,a){return Ru(2048,8,r,a)}function Th(r,a){return Ru(4,2,r,a)}function Ph(r,a){return Ru(4,4,r,a)}function _u(r,a){if(typeof a=="function")return r=r(),a(r),function(){a(null)};if(a!=null)return r=r(),a.current=r,function(){a.current=null}}function ed(r,a,f){return f=f!=null?f.concat([r]):null,Ru(4,4,_u.bind(null,a,r),f)}function gu(){}function ac(r,a){var f=zo();a=a===void 0?null:a;var x=f.memoizedState;return x!==null&&a!==null&&Rl(a,x[1])?x[0]:(f.memoizedState=[r,a],r)}function lc(r,a){var f=zo();a=a===void 0?null:a;var x=f.memoizedState;return x!==null&&a!==null&&Rl(a,x[1])?x[0]:(r=r(),f.memoizedState=[r,a],r)}function kh(r,a,f){return(Qo&21)===0?(r.baseState&&(r.baseState=!1,Rs=!0),r.memoizedState=f):(zr(f,a)||(f=ho(),tn.lanes|=f,wu|=f,r.baseState=!0),a)}function td(r,a){var f=zi;zi=f!==0&&4>f?f:4,r(!0);var x=Dl.transition;Dl.transition={};try{r(!1),a()}finally{zi=f,Dl.transition=x}}function id(){return zo().memoizedState}function os(r,a,f){var x=Zl(r);if(f={lane:x,action:f,hasEagerState:!1,eagerState:null,next:null},Vc(r))Ch(a,f);else if(f=Po(r,a,f,x),f!==null){var k=Bs();wa(f,r,x,k),Ou(f,a,x)}}function Bu(r,a,f){var x=Zl(r),k={lane:x,action:f,hasEagerState:!1,eagerState:null,next:null};if(Vc(r))Ch(a,k);else{var E=r.alternate;if(r.lanes===0&&(E===null||E.lanes===0)&&(E=a.lastRenderedReducer,E!==null))try{var q=a.lastRenderedState,ae=E(q,f);if(k.hasEagerState=!0,k.eagerState=ae,zr(ae,q)){var _e=a.interleaved;_e===null?(k.next=k,gr(a)):(k.next=_e.next,_e.next=k),a.interleaved=k;return}}catch{}finally{}f=Po(r,a,k,x),f!==null&&(k=Bs(),wa(f,r,x,k),Ou(f,a,x))}}function Vc(r){var a=r.alternate;return r===tn||a!==null&&a===tn}function Ch(r,a){Du=ic=!0;var f=r.pending;f===null?a.next=a:(a.next=f.next,f.next=a),r.pending=a}function Ou(r,a,f){if((f&4194240)!==0){var x=a.lanes;x&=r.pendingLanes,f|=x,a.lanes=f,Pr(r,f)}}var Uc={readContext:cn,useCallback:ar,useContext:ar,useEffect:ar,useImperativeHandle:ar,useInsertionEffect:ar,useLayoutEffect:ar,useMemo:ar,useReducer:ar,useRef:ar,useState:ar,useDebugValue:ar,useDeferredValue:ar,useTransition:ar,useMutableSource:ar,useSyncExternalStore:ar,useId:ar,unstable_isNewReconciler:!1},Zc={readContext:cn,useCallback:function(r,a){return Gr().memoizedState=[r,a===void 0?null:a],r},useContext:cn,useEffect:Qh,useImperativeHandle:function(r,a,f){return f=f!=null?f.concat([r]):null,jc(4194308,4,_u.bind(null,a,r),f)},useLayoutEffect:function(r,a){return jc(4194308,4,r,a)},useInsertionEffect:function(r,a){return jc(4,2,r,a)},useMemo:function(r,a){var f=Gr();return a=a===void 0?null:a,r=r(),f.memoizedState=[r,a],r},useReducer:function(r,a,f){var x=Gr();return a=f!==void 0?f(a):a,x.memoizedState=x.baseState=a,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:a},x.queue=r,r=r.dispatch=os.bind(null,tn,r),[x.memoizedState,r]},useRef:function(r){var a=Gr();return r={current:r},a.memoizedState=r},useState:bh,useDebugValue:gu,useDeferredValue:function(r){return Gr().memoizedState=r},useTransition:function(){var r=bh(!1),a=r[0];return r=td.bind(null,r[1]),Gr().memoizedState=r,[a,r]},useMutableSource:function(){},useSyncExternalStore:function(r,a,f){var x=tn,k=Gr();if(ie){if(f===void 0)throw Error(N(407));f=f()}else{if(f=a(),vr===null)throw Error(N(349));(Qo&30)!==0||wh(x,a,f)}k.memoizedState=f;var E={value:f,getSnapshot:a};return k.queue=E,Qh(Ol.bind(null,x,E,r),[r]),x.flags|=2048,sc(9,Bl.bind(null,x,E,f,a),void 0,null),f},useId:function(){var r=Gr(),a=vr.identifierPrefix;if(ie){var f=M,x=C;f=(x&~(1<<32-Lt(x)-1)).toString(32)+f,a=":"+a+"R"+f,f=nc++,0<f&&(a+="H"+f.toString(32)),a+=":"}else f=vh++,a=":"+a+"r"+f.toString(32)+":";return r.memoizedState=a},unstable_isNewReconciler:!1},Jd={readContext:cn,useCallback:ac,useContext:cn,useEffect:oc,useImperativeHandle:ed,useInsertionEffect:Th,useLayoutEffect:Ph,useMemo:lc,useReducer:xh,useRef:Sh,useState:function(){return xh(va)},useDebugValue:gu,useDeferredValue:function(r){var a=zo();return kh(a,bn.memoizedState,r)},useTransition:function(){var r=xh(va)[0],a=zo().memoizedState;return[r,a]},useMutableSource:Dn,useSyncExternalStore:Fc,useId:id,unstable_isNewReconciler:!1},nd={readContext:cn,useCallback:ac,useContext:cn,useEffect:oc,useImperativeHandle:ed,useInsertionEffect:Th,useLayoutEffect:Ph,useMemo:lc,useReducer:Oc,useRef:Sh,useState:function(){return Oc(va)},useDebugValue:gu,useDeferredValue:function(r){var a=zo();return bn===null?a.memoizedState=r:kh(a,bn.memoizedState,r)},useTransition:function(){var r=Oc(va)[0],a=zo().memoizedState;return[r,a]},useMutableSource:Dn,useSyncExternalStore:Fc,useId:id,unstable_isNewReconciler:!1};function ea(r,a){if(r&&r.defaultProps){a=He({},a),r=r.defaultProps;for(var f in r)a[f]===void 0&&(a[f]=r[f]);return a}return a}function $c(r,a,f,x){a=r.memoizedState,f=f(x,a),f=f==null?a:He({},a,f),r.memoizedState=f,r.lanes===0&&(r.updateQueue.baseState=f)}var qc={isMounted:function(r){return(r=r._reactInternals)?si(r)===r:!1},enqueueSetState:function(r,a,f){r=r._reactInternals;var x=Bs(),k=Zl(r),E=Ys(x,k);E.payload=a,f!=null&&(E.callback=f),a=Yo(r,E,k),a!==null&&(wa(a,r,k,x),Hr(a,r,k))},enqueueReplaceState:function(r,a,f){r=r._reactInternals;var x=Bs(),k=Zl(r),E=Ys(x,k);E.tag=1,E.payload=a,f!=null&&(E.callback=f),a=Yo(r,E,k),a!==null&&(wa(a,r,k,x),Hr(a,r,k))},enqueueForceUpdate:function(r,a){r=r._reactInternals;var f=Bs(),x=Zl(r),k=Ys(f,x);k.tag=2,a!=null&&(k.callback=a),a=Yo(r,k,x),a!==null&&(wa(a,r,x,f),Hr(a,r,x))}};function Hc(r,a,f,x,k,E,q){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(x,E,q):a.prototype&&a.prototype.isPureReactComponent?!Ps(f,x)||!Ps(k,E):!0}function Ih(r,a,f){var x=!1,k=Fa,E=a.contextType;return typeof E=="object"&&E!==null?E=cn(E):(k=_r(a)?Js:Yi.current,x=a.contextTypes,E=(x=x!=null)?ga(r,k):Fa),a=new a(f,E),r.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=qc,r.stateNode=a,a._reactInternals=r,x&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=k,r.__reactInternalMemoizedMaskedChildContext=E),a}function Gc(r,a,f,x){r=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(f,x),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(f,x),a.state!==r&&qc.enqueueReplaceState(a,a.state,null)}function yu(r,a,f,x){var k=r.stateNode;k.props=f,k.state=r.memoizedState,k.refs={},Na(r);var E=a.contextType;typeof E=="object"&&E!==null?k.context=cn(E):(E=_r(a)?Js:Yi.current,k.context=ga(r,E)),k.state=r.memoizedState,E=a.getDerivedStateFromProps,typeof E=="function"&&($c(r,a,E,f),k.state=r.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(a=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),a!==k.state&&qc.enqueueReplaceState(k,k.state,null),Co(r,f,k,x),k.state=r.memoizedState),typeof k.componentDidMount=="function"&&(r.flags|=4194308)}function Lr(r,a){try{var f="",x=a;do f+=Tt(x),x=x.return;while(x);var k=f}catch(E){k=`
Error generating stack: `+E.message+`
`+E.stack}return{value:r,source:a,stack:k,digest:null}}function Wc(r,a,f){return{value:r,source:null,stack:f??null,digest:a??null}}function uc(r,a){try{console.error(a.value)}catch(f){setTimeout(function(){throw f})}}var Yd=typeof WeakMap=="function"?WeakMap:Map;function Eh(r,a,f){f=Ys(-1,f),f.tag=3,f.payload={element:null};var x=a.value;return f.callback=function(){vc||(vc=!0,sh=x),uc(r,a)},f}function rd(r,a,f){f=Ys(-1,f),f.tag=3;var x=r.type.getDerivedStateFromError;if(typeof x=="function"){var k=a.value;f.payload=function(){return x(k)},f.callback=function(){uc(r,a)}}var E=r.stateNode;return E!==null&&typeof E.componentDidCatch=="function"&&(f.callback=function(){uc(r,a),typeof x!="function"&&(Li===null?Li=new Set([this]):Li.add(this));var q=a.stack;this.componentDidCatch(a.value,{componentStack:q!==null?q:""})}),f}function sd(r,a,f){var x=r.pingCache;if(x===null){x=r.pingCache=new Yd;var k=new Set;x.set(a,k)}else k=x.get(a),k===void 0&&(k=new Set,x.set(a,k));k.has(f)||(k.add(f),r=sf.bind(null,r,a,f),a.then(r,r))}function od(r){do{var a;if((a=r.tag===13)&&(a=r.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return r;r=r.return}while(r!==null);return null}function ad(r,a,f,x,k){return(r.mode&1)===0?(r===a?r.flags|=65536:(r.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(a=Ys(-1,1),a.tag=2,Yo(f,a,1))),f.lanes|=1),r):(r.flags|=65536,r.lanes=k,r)}var ld=hi.ReactCurrentOwner,Rs=!1;function Yn(r,a,f,x){a.child=r===null?Gt(a,null,f,x):ht(a,r.child,f,x)}function Fu(r,a,f,x,k){f=f.render;var E=a.ref;return Kn(a,k),x=ya(r,a,f,x,E,k),f=Mo(),r!==null&&!Rs?(a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~k,Ao(r,a,k)):(ie&&f&&$(a),a.flags|=1,Yn(r,a,x,k),a.child)}function ud(r,a,f,x,k){if(r===null){var E=f.type;return typeof E=="function"&&!kc(E)&&E.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(a.tag=15,a.type=E,cd(r,a,E,x,k)):(r=Cc(f.type,null,x,a,a.mode,k),r.ref=a.ref,r.return=a,a.child=r)}if(E=r.child,(r.lanes&k)===0){var q=E.memoizedProps;if(f=f.compare,f=f!==null?f:Ps,f(q,x)&&r.ref===a.ref)return Ao(r,a,k)}return a.flags|=1,r=$l(E,x),r.ref=a.ref,r.return=a,a.child=r}function cd(r,a,f,x,k){if(r!==null){var E=r.memoizedProps;if(Ps(E,x)&&r.ref===a.ref)if(Rs=!1,a.pendingProps=x=E,(r.lanes&k)!==0)(r.flags&131072)!==0&&(Rs=!0);else return a.lanes=r.lanes,Ao(r,a,k)}return Mh(r,a,f,x,k)}function hd(r,a,f){var x=a.pendingProps,k=x.children,E=r!==null?r.memoizedState:null;if(x.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},un(Vu,us),us|=f;else{if((f&1073741824)===0)return r=E!==null?E.baseLanes|f:f,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:r,cachePool:null,transitions:null},a.updateQueue=null,un(Vu,us),us|=r,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},x=E!==null?E.baseLanes:f,un(Vu,us),us|=x}else E!==null?(x=E.baseLanes|f,a.memoizedState=null):x=f,un(Vu,us),us|=x;return Yn(r,a,k,f),a.child}function dd(r,a){var f=a.ref;(r===null&&f!==null||r!==null&&r.ref!==f)&&(a.flags|=512,a.flags|=2097152)}function Mh(r,a,f,x,k){var E=_r(f)?Js:Yi.current;return E=ga(a,E),Kn(a,k),f=ya(r,a,f,x,E,k),x=Mo(),r!==null&&!Rs?(a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~k,Ao(r,a,k)):(ie&&x&&$(a),a.flags|=1,Yn(r,a,f,k),a.child)}function fd(r,a,f,x,k){if(_r(f)){var E=!0;Ms(a)}else E=!1;if(Kn(a,k),a.stateNode===null)dc(r,a),Ih(a,f,x),yu(a,f,x,k),x=!0;else if(r===null){var q=a.stateNode,ae=a.memoizedProps;q.props=ae;var _e=q.context,Oe=f.contextType;typeof Oe=="object"&&Oe!==null?Oe=cn(Oe):(Oe=_r(f)?Js:Yi.current,Oe=ga(a,Oe));var Ye=f.getDerivedStateFromProps,it=typeof Ye=="function"||typeof q.getSnapshotBeforeUpdate=="function";it||typeof q.UNSAFE_componentWillReceiveProps!="function"&&typeof q.componentWillReceiveProps!="function"||(ae!==x||_e!==Oe)&&Gc(a,q,x,Oe),ko=!1;var Ke=a.memoizedState;q.state=Ke,Co(a,x,q,k),_e=a.memoizedState,ae!==x||Ke!==_e||Pi.current||ko?(typeof Ye=="function"&&($c(a,f,Ye,x),_e=a.memoizedState),(ae=ko||Hc(a,f,ae,x,Ke,_e,Oe))?(it||typeof q.UNSAFE_componentWillMount!="function"&&typeof q.componentWillMount!="function"||(typeof q.componentWillMount=="function"&&q.componentWillMount(),typeof q.UNSAFE_componentWillMount=="function"&&q.UNSAFE_componentWillMount()),typeof q.componentDidMount=="function"&&(a.flags|=4194308)):(typeof q.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=x,a.memoizedState=_e),q.props=x,q.state=_e,q.context=Oe,x=ae):(typeof q.componentDidMount=="function"&&(a.flags|=4194308),x=!1)}else{q=a.stateNode,As(r,a),ae=a.memoizedProps,Oe=a.type===a.elementType?ae:ea(a.type,ae),q.props=Oe,it=a.pendingProps,Ke=q.context,_e=f.contextType,typeof _e=="object"&&_e!==null?_e=cn(_e):(_e=_r(f)?Js:Yi.current,_e=ga(a,_e));var mt=f.getDerivedStateFromProps;(Ye=typeof mt=="function"||typeof q.getSnapshotBeforeUpdate=="function")||typeof q.UNSAFE_componentWillReceiveProps!="function"&&typeof q.componentWillReceiveProps!="function"||(ae!==it||Ke!==_e)&&Gc(a,q,x,_e),ko=!1,Ke=a.memoizedState,q.state=Ke,Co(a,x,q,k);var kt=a.memoizedState;ae!==it||Ke!==kt||Pi.current||ko?(typeof mt=="function"&&($c(a,f,mt,x),kt=a.memoizedState),(Oe=ko||Hc(a,f,Oe,x,Ke,kt,_e)||!1)?(Ye||typeof q.UNSAFE_componentWillUpdate!="function"&&typeof q.componentWillUpdate!="function"||(typeof q.componentWillUpdate=="function"&&q.componentWillUpdate(x,kt,_e),typeof q.UNSAFE_componentWillUpdate=="function"&&q.UNSAFE_componentWillUpdate(x,kt,_e)),typeof q.componentDidUpdate=="function"&&(a.flags|=4),typeof q.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof q.componentDidUpdate!="function"||ae===r.memoizedProps&&Ke===r.memoizedState||(a.flags|=4),typeof q.getSnapshotBeforeUpdate!="function"||ae===r.memoizedProps&&Ke===r.memoizedState||(a.flags|=1024),a.memoizedProps=x,a.memoizedState=kt),q.props=x,q.state=kt,q.context=_e,x=Oe):(typeof q.componentDidUpdate!="function"||ae===r.memoizedProps&&Ke===r.memoizedState||(a.flags|=4),typeof q.getSnapshotBeforeUpdate!="function"||ae===r.memoizedProps&&Ke===r.memoizedState||(a.flags|=1024),x=!1)}return zh(r,a,f,x,E,k)}function zh(r,a,f,x,k,E){dd(r,a);var q=(a.flags&128)!==0;if(!x&&!q)return k&&zl(a,f,!1),Ao(r,a,E);x=a.stateNode,ld.current=a;var ae=q&&typeof f.getDerivedStateFromError!="function"?null:x.render();return a.flags|=1,r!==null&&q?(a.child=ht(a,r.child,null,E),a.child=ht(a,null,ae,E)):Yn(r,a,ae,E),a.memoizedState=x.state,k&&zl(a,f,!0),a.child}function Xc(r){var a=r.stateNode;a.pendingContext?El(r,a.pendingContext,a.pendingContext!==a.context):a.context&&El(r,a.context,!1),ja(r,a.containerInfo)}function pd(r,a,f,x,k){return at(),pt(k),a.flags|=256,Yn(r,a,f,x),a.child}var Fl={dehydrated:null,treeContext:null,retryLane:0};function Ah(r){return{baseLanes:r,cachePool:null,transitions:null}}function In(r,a,f){var x=a.pendingProps,k=yn.current,E=!1,q=(a.flags&128)!==0,ae;if((ae=q)||(ae=r!==null&&r.memoizedState===null?!1:(k&2)!==0),ae?(E=!0,a.flags&=-129):(r===null||r.memoizedState!==null)&&(k|=1),un(yn,k&1),r===null)return be(a),r=a.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((a.mode&1)===0?a.lanes=1:r.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(q=x.children,r=x.fallback,E?(x=a.mode,E=a.child,q={mode:"hidden",children:q},(x&1)===0&&E!==null?(E.childLanes=0,E.pendingProps=q):E=Hl(q,x,0,null),r=ql(r,x,f,null),E.return=a,r.return=a,E.sibling=r,a.child=E,a.child.memoizedState=Ah(f),a.memoizedState=Fl,r):Nu(a,q));if(k=r.memoizedState,k!==null&&(ae=k.dehydrated,ae!==null))return Kc(r,a,q,x,ae,k,f);if(E){E=x.fallback,q=a.mode,k=r.child,ae=k.sibling;var _e={mode:"hidden",children:x.children};return(q&1)===0&&a.child!==k?(x=a.child,x.childLanes=0,x.pendingProps=_e,a.deletions=null):(x=$l(k,_e),x.subtreeFlags=k.subtreeFlags&14680064),ae!==null?E=$l(ae,E):(E=ql(E,q,f,null),E.flags|=2),E.return=a,x.return=a,x.sibling=E,a.child=x,x=E,E=a.child,q=r.child.memoizedState,q=q===null?Ah(f):{baseLanes:q.baseLanes|f,cachePool:null,transitions:q.transitions},E.memoizedState=q,E.childLanes=r.childLanes&~f,a.memoizedState=Fl,x}return E=r.child,r=E.sibling,x=$l(E,{mode:"visible",children:x.children}),(a.mode&1)===0&&(x.lanes=f),x.return=a,x.sibling=null,r!==null&&(f=a.deletions,f===null?(a.deletions=[r],a.flags|=16):f.push(r)),a.child=x,a.memoizedState=null,x}function Nu(r,a){return a=Hl({mode:"visible",children:a},r.mode,0,null),a.return=r,r.child=a}function cc(r,a,f,x){return x!==null&&pt(x),ht(a,r.child,null,f),r=Nu(a,a.pendingProps.children),r.flags|=2,a.memoizedState=null,r}function Kc(r,a,f,x,k,E,q){if(f)return a.flags&256?(a.flags&=-257,x=Wc(Error(N(422))),cc(r,a,q,x)):a.memoizedState!==null?(a.child=r.child,a.flags|=128,null):(E=x.fallback,k=a.mode,x=Hl({mode:"visible",children:x.children},k,0,null),E=ql(E,k,q,null),E.flags|=2,x.return=a,E.return=a,x.sibling=E,a.child=x,(a.mode&1)!==0&&ht(a,r.child,null,q),a.child.memoizedState=Ah(q),a.memoizedState=Fl,E);if((a.mode&1)===0)return cc(r,a,q,null);if(k.data==="$!"){if(x=k.nextSibling&&k.nextSibling.dataset,x)var ae=x.dgst;return x=ae,E=Error(N(419)),x=Wc(E,x,void 0),cc(r,a,q,x)}if(ae=(q&r.childLanes)!==0,Rs||ae){if(x=vr,x!==null){switch(q&-q){case 4:k=2;break;case 16:k=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:k=32;break;case 536870912:k=268435456;break;default:k=0}k=(k&(x.suspendedLanes|q))!==0?0:k,k!==0&&k!==E.retryLane&&(E.retryLane=k,ss(r,k),wa(x,r,k,-1))}return lh(),x=Wc(Error(N(421))),cc(r,a,q,x)}return k.data==="$?"?(a.flags|=128,a.child=r.child,a=Md.bind(null,r),k._reactRetry=a,null):(r=E.treeContext,Q=Is(k.nextSibling),Y=a,ie=!0,oe=null,r!==null&&(p[b++]=C,p[b++]=M,p[b++]=T,C=r.id,M=r.overflow,T=a),a=Nu(a,x.children),a.flags|=4096,a)}function hc(r,a,f){r.lanes|=a;var x=r.alternate;x!==null&&(x.lanes|=a),en(r.return,a,f)}function vu(r,a,f,x,k){var E=r.memoizedState;E===null?r.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:x,tail:f,tailMode:k}:(E.isBackwards=a,E.rendering=null,E.renderingStartTime=0,E.last=x,E.tail=f,E.tailMode=k)}function Lh(r,a,f){var x=a.pendingProps,k=x.revealOrder,E=x.tail;if(Yn(r,a,x.children,f),x=yn.current,(x&2)!==0)x=x&1|2,a.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=a.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&hc(r,f,a);else if(r.tag===19)hc(r,f,a);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break e;for(;r.sibling===null;){if(r.return===null||r.return===a)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}x&=1}if(un(yn,x),(a.mode&1)===0)a.memoizedState=null;else switch(k){case"forwards":for(f=a.child,k=null;f!==null;)r=f.alternate,r!==null&&Eo(r)===null&&(k=f),f=f.sibling;f=k,f===null?(k=a.child,a.child=null):(k=f.sibling,f.sibling=null),vu(a,!1,k,f,E);break;case"backwards":for(f=null,k=a.child,a.child=null;k!==null;){if(r=k.alternate,r!==null&&Eo(r)===null){a.child=k;break}r=k.sibling,k.sibling=f,f=k,k=r}vu(a,!0,f,null,E);break;case"together":vu(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function dc(r,a){(a.mode&1)===0&&r!==null&&(r.alternate=null,a.alternate=null,a.flags|=2)}function Ao(r,a,f){if(r!==null&&(a.dependencies=r.dependencies),wu|=a.lanes,(f&a.childLanes)===0)return null;if(r!==null&&a.child!==r.child)throw Error(N(153));if(a.child!==null){for(r=a.child,f=$l(r,r.pendingProps),a.child=f,f.return=a;r.sibling!==null;)r=r.sibling,f=f.sibling=$l(r,r.pendingProps),f.return=a;f.sibling=null}return a.child}function Dh(r,a,f){switch(a.tag){case 3:Xc(a),at();break;case 5:ec(a);break;case 1:_r(a.type)&&Ms(a);break;case 4:ja(a,a.stateNode.containerInfo);break;case 10:var x=a.type._context,k=a.memoizedProps.value;un(Wi,x._currentValue),x._currentValue=k;break;case 13:if(x=a.memoizedState,x!==null)return x.dehydrated!==null?(un(yn,yn.current&1),a.flags|=128,null):(f&a.child.childLanes)!==0?In(r,a,f):(un(yn,yn.current&1),r=Ao(r,a,f),r!==null?r.sibling:null);un(yn,yn.current&1);break;case 19:if(x=(f&a.childLanes)!==0,(r.flags&128)!==0){if(x)return Lh(r,a,f);a.flags|=128}if(k=a.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),un(yn,yn.current),x)break;return null;case 22:case 23:return a.lanes=0,hd(r,a,f)}return Ao(r,a,f)}var Jc,fc,Yc,Rh;Jc=function(r,a){for(var f=a.child;f!==null;){if(f.tag===5||f.tag===6)r.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===a)break;for(;f.sibling===null;){if(f.return===null||f.return===a)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},fc=function(){},Yc=function(r,a,f,x){var k=r.memoizedProps;if(k!==x){r=a.stateNode,Ds(fn.current);var E=null;switch(f){case"input":k=Vs(r,k),x=Vs(r,x),E=[];break;case"select":k=He({},k,{value:void 0}),x=He({},x,{value:void 0}),E=[];break;case"textarea":k=ms(r,k),x=ms(r,x),E=[];break;default:typeof k.onClick!="function"&&typeof x.onClick=="function"&&(r.onclick=$e)}tr(f,x);var q;f=null;for(Oe in k)if(!x.hasOwnProperty(Oe)&&k.hasOwnProperty(Oe)&&k[Oe]!=null)if(Oe==="style"){var ae=k[Oe];for(q in ae)ae.hasOwnProperty(q)&&(f||(f={}),f[q]="")}else Oe!=="dangerouslySetInnerHTML"&&Oe!=="children"&&Oe!=="suppressContentEditableWarning"&&Oe!=="suppressHydrationWarning"&&Oe!=="autoFocus"&&(ce.hasOwnProperty(Oe)?E||(E=[]):(E=E||[]).push(Oe,null));for(Oe in x){var _e=x[Oe];if(ae=k?.[Oe],x.hasOwnProperty(Oe)&&_e!==ae&&(_e!=null||ae!=null))if(Oe==="style")if(ae){for(q in ae)!ae.hasOwnProperty(q)||_e&&_e.hasOwnProperty(q)||(f||(f={}),f[q]="");for(q in _e)_e.hasOwnProperty(q)&&ae[q]!==_e[q]&&(f||(f={}),f[q]=_e[q])}else f||(E||(E=[]),E.push(Oe,f)),f=_e;else Oe==="dangerouslySetInnerHTML"?(_e=_e?_e.__html:void 0,ae=ae?ae.__html:void 0,_e!=null&&ae!==_e&&(E=E||[]).push(Oe,_e)):Oe==="children"?typeof _e!="string"&&typeof _e!="number"||(E=E||[]).push(Oe,""+_e):Oe!=="suppressContentEditableWarning"&&Oe!=="suppressHydrationWarning"&&(ce.hasOwnProperty(Oe)?(_e!=null&&Oe==="onScroll"&&qi("scroll",r),E||ae===_e||(E=[])):(E=E||[]).push(Oe,_e))}f&&(E=E||[]).push("style",f);var Oe=E;(a.updateQueue=Oe)&&(a.flags|=4)}},Rh=function(r,a,f,x){f!==x&&(a.flags|=4)};function ju(r,a){if(!ie)switch(r.tailMode){case"hidden":a=r.tail;for(var f=null;a!==null;)a.alternate!==null&&(f=a),a=a.sibling;f===null?r.tail=null:f.sibling=null;break;case"collapsed":f=r.tail;for(var x=null;f!==null;)f.alternate!==null&&(x=f),f=f.sibling;x===null?a||r.tail===null?r.tail=null:r.tail.sibling=null:x.sibling=null}}function as(r){var a=r.alternate!==null&&r.alternate.child===r.child,f=0,x=0;if(a)for(var k=r.child;k!==null;)f|=k.lanes|k.childLanes,x|=k.subtreeFlags&14680064,x|=k.flags&14680064,k.return=r,k=k.sibling;else for(k=r.child;k!==null;)f|=k.lanes|k.childLanes,x|=k.subtreeFlags,x|=k.flags,k.return=r,k=k.sibling;return r.subtreeFlags|=x,r.childLanes=f,a}function Qd(r,a,f){var x=a.pendingProps;switch(X(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return as(a),null;case 1:return _r(a.type)&&pu(),as(a),null;case 3:return x=a.stateNode,Io(),sn(Pi),sn(Yi),Ll(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(r===null||r.child===null)&&(Ve(a)?a.flags|=4:r===null||r.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,oe!==null&&(Nh(oe),oe=null))),fc(r,a),as(a),null;case 5:tc(a);var k=Ds(vi.current);if(f=a.type,r!==null&&a.stateNode!=null)Yc(r,a,f,x,k),r.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!x){if(a.stateNode===null)throw Error(N(166));return as(a),null}if(r=Ds(fn.current),Ve(a)){x=a.stateNode,f=a.type;var E=a.memoizedProps;switch(x[mr]=a,x[Es]=E,r=(a.mode&1)!==0,f){case"dialog":qi("cancel",x),qi("close",x);break;case"iframe":case"object":case"embed":qi("load",x);break;case"video":case"audio":for(k=0;k<bo.length;k++)qi(bo[k],x);break;case"source":qi("error",x);break;case"img":case"image":case"link":qi("error",x),qi("load",x);break;case"details":qi("toggle",x);break;case"input":Bo(x,E),qi("invalid",x);break;case"select":x._wrapperState={wasMultiple:!!E.multiple},qi("invalid",x);break;case"textarea":_s(x,E),qi("invalid",x)}tr(f,E),k=null;for(var q in E)if(E.hasOwnProperty(q)){var ae=E[q];q==="children"?typeof ae=="string"?x.textContent!==ae&&(E.suppressHydrationWarning!==!0&&Re(x.textContent,ae,r),k=["children",ae]):typeof ae=="number"&&x.textContent!==""+ae&&(E.suppressHydrationWarning!==!0&&Re(x.textContent,ae,r),k=["children",""+ae]):ce.hasOwnProperty(q)&&ae!=null&&q==="onScroll"&&qi("scroll",x)}switch(f){case"input":js(x),uo(x,E,!0);break;case"textarea":js(x),Nr(x);break;case"select":case"option":break;default:typeof E.onClick=="function"&&(x.onclick=$e)}x=k,a.updateQueue=x,x!==null&&(a.flags|=4)}else{q=k.nodeType===9?k:k.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=Oo(f)),r==="http://www.w3.org/1999/xhtml"?f==="script"?(r=q.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof x.is=="string"?r=q.createElement(f,{is:x.is}):(r=q.createElement(f),f==="select"&&(q=r,x.multiple?q.multiple=!0:x.size&&(q.size=x.size))):r=q.createElementNS(r,f),r[mr]=a,r[Es]=x,Jc(r,a,!1,!1),a.stateNode=r;e:{switch(q=$n(f,x),f){case"dialog":qi("cancel",r),qi("close",r),k=x;break;case"iframe":case"object":case"embed":qi("load",r),k=x;break;case"video":case"audio":for(k=0;k<bo.length;k++)qi(bo[k],r);k=x;break;case"source":qi("error",r),k=x;break;case"img":case"image":case"link":qi("error",r),qi("load",r),k=x;break;case"details":qi("toggle",r),k=x;break;case"input":Bo(r,x),k=Vs(r,x),qi("invalid",r);break;case"option":k=x;break;case"select":r._wrapperState={wasMultiple:!!x.multiple},k=He({},x,{value:void 0}),qi("invalid",r);break;case"textarea":_s(r,x),k=ms(r,x),qi("invalid",r);break;default:k=x}tr(f,k),ae=k;for(E in ae)if(ae.hasOwnProperty(E)){var _e=ae[E];E==="style"?ri(r,_e):E==="dangerouslySetInnerHTML"?(_e=_e?_e.__html:void 0,_e!=null&&gs(r,_e)):E==="children"?typeof _e=="string"?(f!=="textarea"||_e!=="")&&Tn(r,_e):typeof _e=="number"&&Tn(r,""+_e):E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&E!=="autoFocus"&&(ce.hasOwnProperty(E)?_e!=null&&E==="onScroll"&&qi("scroll",r):_e!=null&&Mt(r,E,_e,q))}switch(f){case"input":js(r),uo(r,x,!1);break;case"textarea":js(r),Nr(r);break;case"option":x.value!=null&&r.setAttribute("value",""+ni(x.value));break;case"select":r.multiple=!!x.multiple,E=x.value,E!=null?Kr(r,!!x.multiple,E,!1):x.defaultValue!=null&&Kr(r,!!x.multiple,x.defaultValue,!0);break;default:typeof k.onClick=="function"&&(r.onclick=$e)}switch(f){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}}x&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return as(a),null;case 6:if(r&&a.stateNode!=null)Rh(r,a,r.memoizedProps,x);else{if(typeof x!="string"&&a.stateNode===null)throw Error(N(166));if(f=Ds(vi.current),Ds(fn.current),Ve(a)){if(x=a.stateNode,f=a.memoizedProps,x[mr]=a,(E=x.nodeValue!==f)&&(r=Y,r!==null))switch(r.tag){case 3:Re(x.nodeValue,f,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Re(x.nodeValue,f,(r.mode&1)!==0)}E&&(a.flags|=4)}else x=(f.nodeType===9?f:f.ownerDocument).createTextNode(x),x[mr]=a,a.stateNode=x}return as(a),null;case 13:if(sn(yn),x=a.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(ie&&Q!==null&&(a.mode&1)!==0&&(a.flags&128)===0)et(),at(),a.flags|=98560,E=!1;else if(E=Ve(a),x!==null&&x.dehydrated!==null){if(r===null){if(!E)throw Error(N(318));if(E=a.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(N(317));E[mr]=a}else at(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;as(a),E=!1}else oe!==null&&(Nh(oe),oe=null),E=!0;if(!E)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=f,a):(x=x!==null,x!==(r!==null&&r.memoizedState!==null)&&x&&(a.child.flags|=8192,(a.mode&1)!==0&&(r===null||(yn.current&1)!==0?lr===0&&(lr=3):lh())),a.updateQueue!==null&&(a.flags|=4),as(a),null);case 4:return Io(),fc(r,a),r===null&&Ks(a.stateNode.containerInfo),as(a),null;case 10:return zs(a.type._context),as(a),null;case 17:return _r(a.type)&&pu(),as(a),null;case 19:if(sn(yn),E=a.memoizedState,E===null)return as(a),null;if(x=(a.flags&128)!==0,q=E.rendering,q===null)if(x)ju(E,!1);else{if(lr!==0||r!==null&&(r.flags&128)!==0)for(r=a.child;r!==null;){if(q=Eo(r),q!==null){for(a.flags|=128,ju(E,!1),x=q.updateQueue,x!==null&&(a.updateQueue=x,a.flags|=4),a.subtreeFlags=0,x=f,f=a.child;f!==null;)E=f,r=x,E.flags&=14680066,q=E.alternate,q===null?(E.childLanes=0,E.lanes=r,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=q.childLanes,E.lanes=q.lanes,E.child=q.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=q.memoizedProps,E.memoizedState=q.memoizedState,E.updateQueue=q.updateQueue,E.type=q.type,r=q.dependencies,E.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),f=f.sibling;return un(yn,yn.current&1|2),a.child}r=r.sibling}E.tail!==null&&Xt()>vn&&(a.flags|=128,x=!0,ju(E,!1),a.lanes=4194304)}else{if(!x)if(r=Eo(q),r!==null){if(a.flags|=128,x=!0,f=r.updateQueue,f!==null&&(a.updateQueue=f,a.flags|=4),ju(E,!0),E.tail===null&&E.tailMode==="hidden"&&!q.alternate&&!ie)return as(a),null}else 2*Xt()-E.renderingStartTime>vn&&f!==1073741824&&(a.flags|=128,x=!0,ju(E,!1),a.lanes=4194304);E.isBackwards?(q.sibling=a.child,a.child=q):(f=E.last,f!==null?f.sibling=q:a.child=q,E.last=q)}return E.tail!==null?(a=E.tail,E.rendering=a,E.tail=a.sibling,E.renderingStartTime=Xt(),a.sibling=null,f=yn.current,un(yn,x?f&1|2:f&1),a):(as(a),null);case 22:case 23:return bc(),x=a.memoizedState!==null,r!==null&&r.memoizedState!==null!==x&&(a.flags|=8192),x&&(a.mode&1)!==0?(us&1073741824)!==0&&(as(a),a.subtreeFlags&6&&(a.flags|=8192)):as(a),null;case 24:return null;case 25:return null}throw Error(N(156,a.tag))}function ef(r,a){switch(X(a),a.tag){case 1:return _r(a.type)&&pu(),r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 3:return Io(),sn(Pi),sn(Yi),Ll(),r=a.flags,(r&65536)!==0&&(r&128)===0?(a.flags=r&-65537|128,a):null;case 5:return tc(a),null;case 13:if(sn(yn),r=a.memoizedState,r!==null&&r.dehydrated!==null){if(a.alternate===null)throw Error(N(340));at()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 19:return sn(yn),null;case 4:return Io(),null;case 10:return zs(a.type._context),null;case 22:case 23:return bc(),null;case 24:return null;default:return null}}var Qc=!1,ls=!1,Nl=typeof WeakSet=="function"?WeakSet:Set,At=null;function xu(r,a){var f=r.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(x){Sn(r,a,x)}else f.current=null}function jl(r,a,f){try{f()}catch(x){Sn(r,a,x)}}var md=!1;function tf(r,a){if(ft=Vo,r=nl(),Wo(r)){if("selectionStart"in r)var f={start:r.selectionStart,end:r.selectionEnd};else e:{f=(f=r.ownerDocument)&&f.defaultView||window;var x=f.getSelection&&f.getSelection();if(x&&x.rangeCount!==0){f=x.anchorNode;var k=x.anchorOffset,E=x.focusNode;x=x.focusOffset;try{f.nodeType,E.nodeType}catch{f=null;break e}var q=0,ae=-1,_e=-1,Oe=0,Ye=0,it=r,Ke=null;t:for(;;){for(var mt;it!==f||k!==0&&it.nodeType!==3||(ae=q+k),it!==E||x!==0&&it.nodeType!==3||(_e=q+x),it.nodeType===3&&(q+=it.nodeValue.length),(mt=it.firstChild)!==null;)Ke=it,it=mt;for(;;){if(it===r)break t;if(Ke===f&&++Oe===k&&(ae=q),Ke===E&&++Ye===x&&(_e=q),(mt=it.nextSibling)!==null)break;it=Ke,Ke=it.parentNode}it=mt}f=ae===-1||_e===-1?null:{start:ae,end:_e}}else f=null}f=f||{start:0,end:0}}else f=null;for(Ht={focusedElem:r,selectionRange:f},Vo=!1,At=a;At!==null;)if(a=At,r=a.child,(a.subtreeFlags&1028)!==0&&r!==null)r.return=a,At=r;else for(;At!==null;){a=At;try{var kt=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(kt!==null){var Rt=kt.memoizedProps,Vn=kt.memoizedState,Ee=a.stateNode,we=Ee.getSnapshotBeforeUpdate(a.elementType===a.type?Rt:ea(a.type,Rt),Vn);Ee.__reactInternalSnapshotBeforeUpdate=we}break;case 3:var Ae=a.stateNode.containerInfo;Ae.nodeType===1?Ae.textContent="":Ae.nodeType===9&&Ae.documentElement&&Ae.removeChild(Ae.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(N(163))}}catch(ct){Sn(a,a.return,ct)}if(r=a.sibling,r!==null){r.return=a.return,At=r;break}At=a.return}return kt=md,md=!1,kt}function pc(r,a,f){var x=a.updateQueue;if(x=x!==null?x.lastEffect:null,x!==null){var k=x=x.next;do{if((k.tag&r)===r){var E=k.destroy;k.destroy=void 0,E!==void 0&&jl(a,f,E)}k=k.next}while(k!==x)}}function mc(r,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var f=a=a.next;do{if((f.tag&r)===r){var x=f.create;f.destroy=x()}f=f.next}while(f!==a)}}function eh(r){var a=r.ref;if(a!==null){var f=r.stateNode;switch(r.tag){case 5:r=f;break;default:r=f}typeof a=="function"?a(r):a.current=r}}function _d(r){var a=r.alternate;a!==null&&(r.alternate=null,_d(a)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(a=r.stateNode,a!==null&&(delete a[mr],delete a[Es],delete a[di],delete a[du],delete a[Yu])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function gd(r){return r.tag===5||r.tag===3||r.tag===4}function yd(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||gd(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Bh(r,a,f){var x=r.tag;if(x===5||x===6)r=r.stateNode,a?f.nodeType===8?f.parentNode.insertBefore(r,a):f.insertBefore(r,a):(f.nodeType===8?(a=f.parentNode,a.insertBefore(r,f)):(a=f,a.appendChild(r)),f=f._reactRootContainer,f!=null||a.onclick!==null||(a.onclick=$e));else if(x!==4&&(r=r.child,r!==null))for(Bh(r,a,f),r=r.sibling;r!==null;)Bh(r,a,f),r=r.sibling}function _c(r,a,f){var x=r.tag;if(x===5||x===6)r=r.stateNode,a?f.insertBefore(r,a):f.appendChild(r);else if(x!==4&&(r=r.child,r!==null))for(_c(r,a,f),r=r.sibling;r!==null;)_c(r,a,f),r=r.sibling}var Qn=null,Lo=!1;function Vl(r,a,f){for(f=f.child;f!==null;)vd(r,a,f),f=f.sibling}function vd(r,a,f){if(rr&&typeof rr.onCommitFiberUnmount=="function")try{rr.onCommitFiberUnmount(Hn,f)}catch{}switch(f.tag){case 5:ls||xu(f,a);case 6:var x=Qn,k=Lo;Qn=null,Vl(r,a,f),Qn=x,Lo=k,Qn!==null&&(Lo?(r=Qn,f=f.stateNode,r.nodeType===8?r.parentNode.removeChild(f):r.removeChild(f)):Qn.removeChild(f.stateNode));break;case 18:Qn!==null&&(Lo?(r=Qn,f=f.stateNode,r.nodeType===8?gt(r.parentNode,f):r.nodeType===1&&gt(r,f),hr(r)):gt(Qn,f.stateNode));break;case 4:x=Qn,k=Lo,Qn=f.stateNode.containerInfo,Lo=!0,Vl(r,a,f),Qn=x,Lo=k;break;case 0:case 11:case 14:case 15:if(!ls&&(x=f.updateQueue,x!==null&&(x=x.lastEffect,x!==null))){k=x=x.next;do{var E=k,q=E.destroy;E=E.tag,q!==void 0&&((E&2)!==0||(E&4)!==0)&&jl(f,a,q),k=k.next}while(k!==x)}Vl(r,a,f);break;case 1:if(!ls&&(xu(f,a),x=f.stateNode,typeof x.componentWillUnmount=="function"))try{x.props=f.memoizedProps,x.state=f.memoizedState,x.componentWillUnmount()}catch(ae){Sn(f,a,ae)}Vl(r,a,f);break;case 21:Vl(r,a,f);break;case 22:f.mode&1?(ls=(x=ls)||f.memoizedState!==null,Vl(r,a,f),ls=x):Vl(r,a,f);break;default:Vl(r,a,f)}}function Oh(r){var a=r.updateQueue;if(a!==null){r.updateQueue=null;var f=r.stateNode;f===null&&(f=r.stateNode=new Nl),a.forEach(function(x){var k=zd.bind(null,r,x);f.has(x)||(f.add(x),x.then(k,k))})}}function xa(r,a){var f=a.deletions;if(f!==null)for(var x=0;x<f.length;x++){var k=f[x];try{var E=r,q=a,ae=q;e:for(;ae!==null;){switch(ae.tag){case 5:Qn=ae.stateNode,Lo=!1;break e;case 3:Qn=ae.stateNode.containerInfo,Lo=!0;break e;case 4:Qn=ae.stateNode.containerInfo,Lo=!0;break e}ae=ae.return}if(Qn===null)throw Error(N(160));vd(E,q,k),Qn=null,Lo=!1;var _e=k.alternate;_e!==null&&(_e.return=null),k.return=null}catch(Oe){Sn(k,a,Oe)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)xd(a,r),a=a.sibling}function xd(r,a){var f=r.alternate,x=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(xa(a,r),eo(r),x&4){try{pc(3,r,r.return),mc(3,r)}catch(Rt){Sn(r,r.return,Rt)}try{pc(5,r,r.return)}catch(Rt){Sn(r,r.return,Rt)}}break;case 1:xa(a,r),eo(r),x&512&&f!==null&&xu(f,f.return);break;case 5:if(xa(a,r),eo(r),x&512&&f!==null&&xu(f,f.return),r.flags&32){var k=r.stateNode;try{Tn(k,"")}catch(Rt){Sn(r,r.return,Rt)}}if(x&4&&(k=r.stateNode,k!=null)){var E=r.memoizedProps,q=f!==null?f.memoizedProps:E,ae=r.type,_e=r.updateQueue;if(r.updateQueue=null,_e!==null)try{ae==="input"&&E.type==="radio"&&E.name!=null&&Le(k,E),$n(ae,q);var Oe=$n(ae,E);for(q=0;q<_e.length;q+=2){var Ye=_e[q],it=_e[q+1];Ye==="style"?ri(k,it):Ye==="dangerouslySetInnerHTML"?gs(k,it):Ye==="children"?Tn(k,it):Mt(k,Ye,it,Oe)}switch(ae){case"input":ps(k,E);break;case"textarea":ra(k,E);break;case"select":var Ke=k._wrapperState.wasMultiple;k._wrapperState.wasMultiple=!!E.multiple;var mt=E.value;mt!=null?Kr(k,!!E.multiple,mt,!1):Ke!==!!E.multiple&&(E.defaultValue!=null?Kr(k,!!E.multiple,E.defaultValue,!0):Kr(k,!!E.multiple,E.multiple?[]:"",!1))}k[Es]=E}catch(Rt){Sn(r,r.return,Rt)}}break;case 6:if(xa(a,r),eo(r),x&4){if(r.stateNode===null)throw Error(N(162));k=r.stateNode,E=r.memoizedProps;try{k.nodeValue=E}catch(Rt){Sn(r,r.return,Rt)}}break;case 3:if(xa(a,r),eo(r),x&4&&f!==null&&f.memoizedState.isDehydrated)try{hr(a.containerInfo)}catch(Rt){Sn(r,r.return,Rt)}break;case 4:xa(a,r),eo(r);break;case 13:xa(a,r),eo(r),k=r.child,k.flags&8192&&(E=k.memoizedState!==null,k.stateNode.isHidden=E,!E||k.alternate!==null&&k.alternate.memoizedState!==null||(bu=Xt())),x&4&&Oh(r);break;case 22:if(Ye=f!==null&&f.memoizedState!==null,r.mode&1?(ls=(Oe=ls)||Ye,xa(a,r),ls=Oe):xa(a,r),eo(r),x&8192){if(Oe=r.memoizedState!==null,(r.stateNode.isHidden=Oe)&&!Ye&&(r.mode&1)!==0)for(At=r,Ye=r.child;Ye!==null;){for(it=At=Ye;At!==null;){switch(Ke=At,mt=Ke.child,Ke.tag){case 0:case 11:case 14:case 15:pc(4,Ke,Ke.return);break;case 1:xu(Ke,Ke.return);var kt=Ke.stateNode;if(typeof kt.componentWillUnmount=="function"){x=Ke,f=Ke.return;try{a=x,kt.props=a.memoizedProps,kt.state=a.memoizedState,kt.componentWillUnmount()}catch(Rt){Sn(x,f,Rt)}}break;case 5:xu(Ke,Ke.return);break;case 22:if(Ke.memoizedState!==null){Td(it);continue}}mt!==null?(mt.return=Ke,At=mt):Td(it)}Ye=Ye.sibling}e:for(Ye=null,it=r;;){if(it.tag===5){if(Ye===null){Ye=it;try{k=it.stateNode,Oe?(E=k.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none"):(ae=it.stateNode,_e=it.memoizedProps.style,q=_e!=null&&_e.hasOwnProperty("display")?_e.display:null,ae.style.display=ot("display",q))}catch(Rt){Sn(r,r.return,Rt)}}}else if(it.tag===6){if(Ye===null)try{it.stateNode.nodeValue=Oe?"":it.memoizedProps}catch(Rt){Sn(r,r.return,Rt)}}else if((it.tag!==22&&it.tag!==23||it.memoizedState===null||it===r)&&it.child!==null){it.child.return=it,it=it.child;continue}if(it===r)break e;for(;it.sibling===null;){if(it.return===null||it.return===r)break e;Ye===it&&(Ye=null),it=it.return}Ye===it&&(Ye=null),it.sibling.return=it.return,it=it.sibling}}break;case 19:xa(a,r),eo(r),x&4&&Oh(r);break;case 21:break;default:xa(a,r),eo(r)}}function eo(r){var a=r.flags;if(a&2){try{e:{for(var f=r.return;f!==null;){if(gd(f)){var x=f;break e}f=f.return}throw Error(N(160))}switch(x.tag){case 5:var k=x.stateNode;x.flags&32&&(Tn(k,""),x.flags&=-33);var E=yd(r);_c(r,E,k);break;case 3:case 4:var q=x.stateNode.containerInfo,ae=yd(r);Bh(r,ae,q);break;default:throw Error(N(161))}}catch(_e){Sn(r,r.return,_e)}r.flags&=-3}a&4096&&(r.flags&=-4097)}function wd(r,a,f){At=r,bd(r)}function bd(r,a,f){for(var x=(r.mode&1)!==0;At!==null;){var k=At,E=k.child;if(k.tag===22&&x){var q=k.memoizedState!==null||Qc;if(!q){var ae=k.alternate,_e=ae!==null&&ae.memoizedState!==null||ls;ae=Qc;var Oe=ls;if(Qc=q,(ls=_e)&&!Oe)for(At=k;At!==null;)q=At,_e=q.child,q.tag===22&&q.memoizedState!==null?Pd(k):_e!==null?(_e.return=q,At=_e):Pd(k);for(;E!==null;)At=E,bd(E),E=E.sibling;At=k,Qc=ae,ls=Oe}Sd(r)}else(k.subtreeFlags&8772)!==0&&E!==null?(E.return=k,At=E):Sd(r)}}function Sd(r){for(;At!==null;){var a=At;if((a.flags&8772)!==0){var f=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:ls||mc(5,a);break;case 1:var x=a.stateNode;if(a.flags&4&&!ls)if(f===null)x.componentDidMount();else{var k=a.elementType===a.type?f.memoizedProps:ea(a.type,f.memoizedProps);x.componentDidUpdate(k,f.memoizedState,x.__reactInternalSnapshotBeforeUpdate)}var E=a.updateQueue;E!==null&&Qs(a,E,x);break;case 3:var q=a.updateQueue;if(q!==null){if(f=null,a.child!==null)switch(a.child.tag){case 5:f=a.child.stateNode;break;case 1:f=a.child.stateNode}Qs(a,q,f)}break;case 5:var ae=a.stateNode;if(f===null&&a.flags&4){f=ae;var _e=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":_e.autoFocus&&f.focus();break;case"img":_e.src&&(f.src=_e.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var Oe=a.alternate;if(Oe!==null){var Ye=Oe.memoizedState;if(Ye!==null){var it=Ye.dehydrated;it!==null&&hr(it)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(N(163))}ls||a.flags&512&&eh(a)}catch(Ke){Sn(a,a.return,Ke)}}if(a===r){At=null;break}if(f=a.sibling,f!==null){f.return=a.return,At=f;break}At=a.return}}function Td(r){for(;At!==null;){var a=At;if(a===r){At=null;break}var f=a.sibling;if(f!==null){f.return=a.return,At=f;break}At=a.return}}function Pd(r){for(;At!==null;){var a=At;try{switch(a.tag){case 0:case 11:case 15:var f=a.return;try{mc(4,a)}catch(_e){Sn(a,f,_e)}break;case 1:var x=a.stateNode;if(typeof x.componentDidMount=="function"){var k=a.return;try{x.componentDidMount()}catch(_e){Sn(a,k,_e)}}var E=a.return;try{eh(a)}catch(_e){Sn(a,E,_e)}break;case 5:var q=a.return;try{eh(a)}catch(_e){Sn(a,q,_e)}}}catch(_e){Sn(a,a.return,_e)}if(a===r){At=null;break}var ae=a.sibling;if(ae!==null){ae.return=a.return,At=ae;break}At=a.return}}var nf=Math.ceil,th=hi.ReactCurrentDispatcher,ih=hi.ReactCurrentOwner,to=hi.ReactCurrentBatchConfig,ji=0,vr=null,er=null,Wr=0,us=0,Vu=Oa(0),lr=0,gc=null,wu=0,nh=0,rh=0,yc=null,io=null,bu=0,vn=1/0,Ua=null,vc=!1,sh=null,Li=null,Uu=!1,cl=null,xc=0,Do=0,Ul=null,wc=-1,oh=0;function Bs(){return(ji&6)!==0?Xt():wc!==-1?wc:wc=Xt()}function Zl(r){return(r.mode&1)===0?1:(ji&2)!==0&&Wr!==0?Wr&-Wr:lt.transition!==null?(oh===0&&(oh=ho()),oh):(r=zi,r!==0||(r=window.event,r=r===void 0?16:gi(r.type)),r)}function wa(r,a,f,x){if(50<Do)throw Do=0,Ul=null,Error(N(185));jr(r,f,x),((ji&2)===0||r!==vr)&&(r===vr&&((ji&2)===0&&(nh|=f),lr===4&&ba(r,Wr)),no(r,x),f===1&&ji===0&&(a.mode&1)===0&&(vn=Xt()+500,Bt&&m()))}function no(r,a){var f=r.callbackNode;sa(r,a);var x=Ai(r,r===vr?Wr:0);if(x===0)f!==null&&Mn(f),r.callbackNode=null,r.callbackPriority=0;else if(a=x&-x,r.callbackPriority!==a){if(f!=null&&Mn(f),a===1)r.tag===0?Qu(Su.bind(null,r)):mu(Su.bind(null,r)),An(function(){(ji&6)===0&&m()}),f=null;else{switch(fo(x)){case 1:f=Ha;break;case 4:f=Sr;break;case 16:f=nr;break;case 536870912:f=qn;break;default:f=nr}f=Uh(f,kd.bind(null,r))}r.callbackPriority=a,r.callbackNode=f}}function kd(r,a){if(wc=-1,oh=0,(ji&6)!==0)throw Error(N(327));var f=r.callbackNode;if(Ta()&&r.callbackNode!==f)return null;var x=Ai(r,r===vr?Wr:0);if(x===0)return null;if((x&30)!==0||(x&r.expiredLanes)!==0||a)a=Sc(r,x);else{a=x;var k=ji;ji|=2;var E=Id();(vr!==r||Wr!==a)&&(Ua=null,vn=Xt()+500,Tu(r,a));do try{jh();break}catch(ae){Cd(r,ae)}while(!0);or(),th.current=E,ji=k,er!==null?a=0:(vr=null,Wr=0,a=lr)}if(a!==0){if(a===2&&(k=Pn(r),k!==0&&(x=k,a=Fh(r,k))),a===1)throw f=gc,Tu(r,0),ba(r,x),no(r,Xt()),f;if(a===6)ba(r,x);else{if(k=r.current.alternate,(x&30)===0&&!rf(k)&&(a=Sc(r,x),a===2&&(E=Pn(r),E!==0&&(x=E,a=Fh(r,E))),a===1))throw f=gc,Tu(r,0),ba(r,x),no(r,Xt()),f;switch(r.finishedWork=k,r.finishedLanes=x,a){case 0:case 1:throw Error(N(345));case 2:Sa(r,io,Ua);break;case 3:if(ba(r,x),(x&130023424)===x&&(a=bu+500-Xt(),10<a)){if(Ai(r,0)!==0)break;if(k=r.suspendedLanes,(k&x)!==x){Bs(),r.pingedLanes|=r.suspendedLanes&k;break}r.timeoutHandle=jn(Sa.bind(null,r,io,Ua),a);break}Sa(r,io,Ua);break;case 4:if(ba(r,x),(x&4194240)===x)break;for(a=r.eventTimes,k=-1;0<x;){var q=31-Lt(x);E=1<<q,q=a[q],q>k&&(k=q),x&=~E}if(x=k,x=Xt()-x,x=(120>x?120:480>x?480:1080>x?1080:1920>x?1920:3e3>x?3e3:4320>x?4320:1960*nf(x/1960))-x,10<x){r.timeoutHandle=jn(Sa.bind(null,r,io,Ua),x);break}Sa(r,io,Ua);break;case 5:Sa(r,io,Ua);break;default:throw Error(N(329))}}}return no(r,Xt()),r.callbackNode===f?kd.bind(null,r):null}function Fh(r,a){var f=yc;return r.current.memoizedState.isDehydrated&&(Tu(r,a).flags|=256),r=Sc(r,a),r!==2&&(a=io,io=f,a!==null&&Nh(a)),r}function Nh(r){io===null?io=r:io.push.apply(io,r)}function rf(r){for(var a=r;;){if(a.flags&16384){var f=a.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var x=0;x<f.length;x++){var k=f[x],E=k.getSnapshot;k=k.value;try{if(!zr(E(),k))return!1}catch{return!1}}}if(f=a.child,a.subtreeFlags&16384&&f!==null)f.return=a,a=f;else{if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function ba(r,a){for(a&=~rh,a&=~nh,r.suspendedLanes|=a,r.pingedLanes&=~a,r=r.expirationTimes;0<a;){var f=31-Lt(a),x=1<<f;r[f]=-1,a&=~x}}function Su(r){if((ji&6)!==0)throw Error(N(327));Ta();var a=Ai(r,0);if((a&1)===0)return no(r,Xt()),null;var f=Sc(r,a);if(r.tag!==0&&f===2){var x=Pn(r);x!==0&&(a=x,f=Fh(r,x))}if(f===1)throw f=gc,Tu(r,0),ba(r,a),no(r,Xt()),f;if(f===6)throw Error(N(345));return r.finishedWork=r.current.alternate,r.finishedLanes=a,Sa(r,io,Ua),no(r,Xt()),null}function ah(r,a){var f=ji;ji|=1;try{return r(a)}finally{ji=f,ji===0&&(vn=Xt()+500,Bt&&m())}}function hl(r){cl!==null&&cl.tag===0&&(ji&6)===0&&Ta();var a=ji;ji|=1;var f=to.transition,x=zi;try{if(to.transition=null,zi=1,r)return r()}finally{zi=x,to.transition=f,ji=a,(ji&6)===0&&m()}}function bc(){us=Vu.current,sn(Vu)}function Tu(r,a){r.finishedWork=null,r.finishedLanes=0;var f=r.timeoutHandle;if(f!==-1&&(r.timeoutHandle=-1,zn(f)),er!==null)for(f=er.return;f!==null;){var x=f;switch(X(x),x.tag){case 1:x=x.type.childContextTypes,x!=null&&pu();break;case 3:Io(),sn(Pi),sn(Yi),Ll();break;case 5:tc(x);break;case 4:Io();break;case 13:sn(yn);break;case 19:sn(yn);break;case 10:zs(x.type._context);break;case 22:case 23:bc()}f=f.return}if(vr=r,er=r=$l(r.current,null),Wr=us=a,lr=0,gc=null,rh=nh=wu=0,io=yc=null,Cn!==null){for(a=0;a<Cn.length;a++)if(f=Cn[a],x=f.interleaved,x!==null){f.interleaved=null;var k=x.next,E=f.pending;if(E!==null){var q=E.next;E.next=k,x.next=q}f.pending=x}Cn=null}return r}function Cd(r,a){do{var f=er;try{if(or(),Va.current=Uc,ic){for(var x=tn.memoizedState;x!==null;){var k=x.queue;k!==null&&(k.pending=null),x=x.next}ic=!1}if(Qo=0,Jn=bn=tn=null,Du=!1,nc=0,ih.current=null,f===null||f.return===null){lr=1,gc=a,er=null;break}e:{var E=r,q=f.return,ae=f,_e=a;if(a=Wr,ae.flags|=32768,_e!==null&&typeof _e=="object"&&typeof _e.then=="function"){var Oe=_e,Ye=ae,it=Ye.tag;if((Ye.mode&1)===0&&(it===0||it===11||it===15)){var Ke=Ye.alternate;Ke?(Ye.updateQueue=Ke.updateQueue,Ye.memoizedState=Ke.memoizedState,Ye.lanes=Ke.lanes):(Ye.updateQueue=null,Ye.memoizedState=null)}var mt=od(q);if(mt!==null){mt.flags&=-257,ad(mt,q,ae,E,a),mt.mode&1&&sd(E,Oe,a),a=mt,_e=Oe;var kt=a.updateQueue;if(kt===null){var Rt=new Set;Rt.add(_e),a.updateQueue=Rt}else kt.add(_e);break e}else{if((a&1)===0){sd(E,Oe,a),lh();break e}_e=Error(N(426))}}else if(ie&&ae.mode&1){var Vn=od(q);if(Vn!==null){(Vn.flags&65536)===0&&(Vn.flags|=256),ad(Vn,q,ae,E,a),pt(Lr(_e,ae));break e}}E=_e=Lr(_e,ae),lr!==4&&(lr=2),yc===null?yc=[E]:yc.push(E),E=q;do{switch(E.tag){case 3:E.flags|=65536,a&=-a,E.lanes|=a;var Ee=Eh(E,_e,a);Ls(E,Ee);break e;case 1:ae=_e;var we=E.type,Ae=E.stateNode;if((E.flags&128)===0&&(typeof we.getDerivedStateFromError=="function"||Ae!==null&&typeof Ae.componentDidCatch=="function"&&(Li===null||!Li.has(Ae)))){E.flags|=65536,a&=-a,E.lanes|=a;var ct=rd(E,ae,a);Ls(E,ct);break e}}E=E.return}while(E!==null)}dl(f)}catch(jt){a=jt,er===f&&f!==null&&(er=f=f.return);continue}break}while(!0)}function Id(){var r=th.current;return th.current=Uc,r===null?Uc:r}function lh(){(lr===0||lr===3||lr===2)&&(lr=4),vr===null||(wu&268435455)===0&&(nh&268435455)===0||ba(vr,Wr)}function Sc(r,a){var f=ji;ji|=2;var x=Id();(vr!==r||Wr!==a)&&(Ua=null,Tu(r,a));do try{Os();break}catch(k){Cd(r,k)}while(!0);if(or(),ji=f,th.current=x,er!==null)throw Error(N(261));return vr=null,Wr=0,lr}function Os(){for(;er!==null;)Vh(er)}function jh(){for(;er!==null&&!cr();)Vh(er)}function Vh(r){var a=Ad(r.alternate,r,us);r.memoizedProps=r.pendingProps,a===null?dl(r):er=a,ih.current=null}function dl(r){var a=r;do{var f=a.alternate;if(r=a.return,(a.flags&32768)===0){if(f=Qd(f,a,us),f!==null){er=f;return}}else{if(f=ef(f,a),f!==null){f.flags&=32767,er=f;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{lr=6,er=null;return}}if(a=a.sibling,a!==null){er=a;return}er=a=r}while(a!==null);lr===0&&(lr=5)}function Sa(r,a,f){var x=zi,k=to.transition;try{to.transition=null,zi=1,Tc(r,a,f,x)}finally{to.transition=k,zi=x}return null}function Tc(r,a,f,x){do Ta();while(cl!==null);if((ji&6)!==0)throw Error(N(327));f=r.finishedWork;var k=r.finishedLanes;if(f===null)return null;if(r.finishedWork=null,r.finishedLanes=0,f===r.current)throw Error(N(177));r.callbackNode=null,r.callbackPriority=0;var E=f.lanes|f.childLanes;if(mn(r,E),r===vr&&(er=vr=null,Wr=0),(f.subtreeFlags&2064)===0&&(f.flags&2064)===0||Uu||(Uu=!0,Uh(nr,function(){return Ta(),null})),E=(f.flags&15990)!==0,(f.subtreeFlags&15990)!==0||E){E=to.transition,to.transition=null;var q=zi;zi=1;var ae=ji;ji|=4,ih.current=null,tf(r,f),xd(f,r),Ar(Ht),Vo=!!ft,Ht=ft=null,r.current=f,wd(f),co(),ji=ae,zi=q,to.transition=E}else r.current=f;if(Uu&&(Uu=!1,cl=r,xc=k),E=r.pendingLanes,E===0&&(Li=null),ys(f.stateNode),no(r,Xt()),a!==null)for(x=r.onRecoverableError,f=0;f<a.length;f++)k=a[f],x(k.value,{componentStack:k.stack,digest:k.digest});if(vc)throw vc=!1,r=sh,sh=null,r;return(xc&1)!==0&&r.tag!==0&&Ta(),E=r.pendingLanes,(E&1)!==0?r===Ul?Do++:(Do=0,Ul=r):Do=0,m(),null}function Ta(){if(cl!==null){var r=fo(xc),a=to.transition,f=zi;try{if(to.transition=null,zi=16>r?16:r,cl===null)var x=!1;else{if(r=cl,cl=null,xc=0,(ji&6)!==0)throw Error(N(331));var k=ji;for(ji|=4,At=r.current;At!==null;){var E=At,q=E.child;if((At.flags&16)!==0){var ae=E.deletions;if(ae!==null){for(var _e=0;_e<ae.length;_e++){var Oe=ae[_e];for(At=Oe;At!==null;){var Ye=At;switch(Ye.tag){case 0:case 11:case 15:pc(8,Ye,E)}var it=Ye.child;if(it!==null)it.return=Ye,At=it;else for(;At!==null;){Ye=At;var Ke=Ye.sibling,mt=Ye.return;if(_d(Ye),Ye===Oe){At=null;break}if(Ke!==null){Ke.return=mt,At=Ke;break}At=mt}}}var kt=E.alternate;if(kt!==null){var Rt=kt.child;if(Rt!==null){kt.child=null;do{var Vn=Rt.sibling;Rt.sibling=null,Rt=Vn}while(Rt!==null)}}At=E}}if((E.subtreeFlags&2064)!==0&&q!==null)q.return=E,At=q;else e:for(;At!==null;){if(E=At,(E.flags&2048)!==0)switch(E.tag){case 0:case 11:case 15:pc(9,E,E.return)}var Ee=E.sibling;if(Ee!==null){Ee.return=E.return,At=Ee;break e}At=E.return}}var we=r.current;for(At=we;At!==null;){q=At;var Ae=q.child;if((q.subtreeFlags&2064)!==0&&Ae!==null)Ae.return=q,At=Ae;else e:for(q=we;At!==null;){if(ae=At,(ae.flags&2048)!==0)try{switch(ae.tag){case 0:case 11:case 15:mc(9,ae)}}catch(jt){Sn(ae,ae.return,jt)}if(ae===q){At=null;break e}var ct=ae.sibling;if(ct!==null){ct.return=ae.return,At=ct;break e}At=ae.return}}if(ji=k,m(),rr&&typeof rr.onPostCommitFiberRoot=="function")try{rr.onPostCommitFiberRoot(Hn,r)}catch{}x=!0}return x}finally{zi=f,to.transition=a}}return!1}function Pc(r,a,f){a=Lr(f,a),a=Eh(r,a,1),r=Yo(r,a,1),a=Bs(),r!==null&&(jr(r,1,a),no(r,a))}function Sn(r,a,f){if(r.tag===3)Pc(r,r,f);else for(;a!==null;){if(a.tag===3){Pc(a,r,f);break}else if(a.tag===1){var x=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Li===null||!Li.has(x))){r=Lr(f,r),r=rd(a,r,1),a=Yo(a,r,1),r=Bs(),a!==null&&(jr(a,1,r),no(a,r));break}}a=a.return}}function sf(r,a,f){var x=r.pingCache;x!==null&&x.delete(a),a=Bs(),r.pingedLanes|=r.suspendedLanes&f,vr===r&&(Wr&f)===f&&(lr===4||lr===3&&(Wr&130023424)===Wr&&500>Xt()-bu?Tu(r,0):rh|=f),no(r,a)}function Ed(r,a){a===0&&((r.mode&1)===0?a=1:(a=sr,sr<<=1,(sr&130023424)===0&&(sr=4194304)));var f=Bs();r=ss(r,a),r!==null&&(jr(r,a,f),no(r,f))}function Md(r){var a=r.memoizedState,f=0;a!==null&&(f=a.retryLane),Ed(r,f)}function zd(r,a){var f=0;switch(r.tag){case 13:var x=r.stateNode,k=r.memoizedState;k!==null&&(f=k.retryLane);break;case 19:x=r.stateNode;break;default:throw Error(N(314))}x!==null&&x.delete(a),Ed(r,f)}var Ad;Ad=function(r,a,f){if(r!==null)if(r.memoizedProps!==a.pendingProps||Pi.current)Rs=!0;else{if((r.lanes&f)===0&&(a.flags&128)===0)return Rs=!1,Dh(r,a,f);Rs=(r.flags&131072)!==0}else Rs=!1,ie&&(a.flags&1048576)!==0&&B(a,c,a.index);switch(a.lanes=0,a.tag){case 2:var x=a.type;dc(r,a),r=a.pendingProps;var k=ga(a,Yi.current);Kn(a,f),k=ya(null,a,x,r,k,f);var E=Mo();return a.flags|=1,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,_r(x)?(E=!0,Ms(a)):E=!1,a.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,Na(a),k.updater=qc,a.stateNode=k,k._reactInternals=a,yu(a,x,r,f),a=zh(null,a,x,!0,E,f)):(a.tag=0,ie&&E&&$(a),Yn(null,a,k,f),a=a.child),a;case 16:x=a.elementType;e:{switch(dc(r,a),r=a.pendingProps,k=x._init,x=k(x._payload),a.type=x,k=a.tag=of(x),r=ea(x,r),k){case 0:a=Mh(null,a,x,r,f);break e;case 1:a=fd(null,a,x,r,f);break e;case 11:a=Fu(null,a,x,r,f);break e;case 14:a=ud(null,a,x,ea(x.type,r),f);break e}throw Error(N(306,x,""))}return a;case 0:return x=a.type,k=a.pendingProps,k=a.elementType===x?k:ea(x,k),Mh(r,a,x,k,f);case 1:return x=a.type,k=a.pendingProps,k=a.elementType===x?k:ea(x,k),fd(r,a,x,k,f);case 3:e:{if(Xc(a),r===null)throw Error(N(387));x=a.pendingProps,E=a.memoizedState,k=E.element,As(r,a),Co(a,x,null,f);var q=a.memoizedState;if(x=q.element,E.isDehydrated)if(E={element:x,isDehydrated:!1,cache:q.cache,pendingSuspenseBoundaries:q.pendingSuspenseBoundaries,transitions:q.transitions},a.updateQueue.baseState=E,a.memoizedState=E,a.flags&256){k=Lr(Error(N(423)),a),a=pd(r,a,x,f,k);break e}else if(x!==k){k=Lr(Error(N(424)),a),a=pd(r,a,x,f,k);break e}else for(Q=Is(a.stateNode.containerInfo.firstChild),Y=a,ie=!0,oe=null,f=Gt(a,null,x,f),a.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(at(),x===k){a=Ao(r,a,f);break e}Yn(r,a,x,f)}a=a.child}return a;case 5:return ec(a),r===null&&be(a),x=a.type,k=a.pendingProps,E=r!==null?r.memoizedProps:null,q=k.children,yi(x,k)?q=null:E!==null&&yi(x,E)&&(a.flags|=32),dd(r,a),Yn(r,a,q,f),a.child;case 6:return r===null&&be(a),null;case 13:return In(r,a,f);case 4:return ja(a,a.stateNode.containerInfo),x=a.pendingProps,r===null?a.child=ht(a,null,x,f):Yn(r,a,x,f),a.child;case 11:return x=a.type,k=a.pendingProps,k=a.elementType===x?k:ea(x,k),Fu(r,a,x,k,f);case 7:return Yn(r,a,a.pendingProps,f),a.child;case 8:return Yn(r,a,a.pendingProps.children,f),a.child;case 12:return Yn(r,a,a.pendingProps.children,f),a.child;case 10:e:{if(x=a.type._context,k=a.pendingProps,E=a.memoizedProps,q=k.value,un(Wi,x._currentValue),x._currentValue=q,E!==null)if(zr(E.value,q)){if(E.children===k.children&&!Pi.current){a=Ao(r,a,f);break e}}else for(E=a.child,E!==null&&(E.return=a);E!==null;){var ae=E.dependencies;if(ae!==null){q=E.child;for(var _e=ae.firstContext;_e!==null;){if(_e.context===x){if(E.tag===1){_e=Ys(-1,f&-f),_e.tag=2;var Oe=E.updateQueue;if(Oe!==null){Oe=Oe.shared;var Ye=Oe.pending;Ye===null?_e.next=_e:(_e.next=Ye.next,Ye.next=_e),Oe.pending=_e}}E.lanes|=f,_e=E.alternate,_e!==null&&(_e.lanes|=f),en(E.return,f,a),ae.lanes|=f;break}_e=_e.next}}else if(E.tag===10)q=E.type===a.type?null:E.child;else if(E.tag===18){if(q=E.return,q===null)throw Error(N(341));q.lanes|=f,ae=q.alternate,ae!==null&&(ae.lanes|=f),en(q,f,a),q=E.sibling}else q=E.child;if(q!==null)q.return=E;else for(q=E;q!==null;){if(q===a){q=null;break}if(E=q.sibling,E!==null){E.return=q.return,q=E;break}q=q.return}E=q}Yn(r,a,k.children,f),a=a.child}return a;case 9:return k=a.type,x=a.pendingProps.children,Kn(a,f),k=cn(k),x=x(k),a.flags|=1,Yn(r,a,x,f),a.child;case 14:return x=a.type,k=ea(x,a.pendingProps),k=ea(x.type,k),ud(r,a,x,k,f);case 15:return cd(r,a,a.type,a.pendingProps,f);case 17:return x=a.type,k=a.pendingProps,k=a.elementType===x?k:ea(x,k),dc(r,a),a.tag=1,_r(x)?(r=!0,Ms(a)):r=!1,Kn(a,f),Ih(a,x,k),yu(a,x,k,f),zh(null,a,x,!0,r,f);case 19:return Lh(r,a,f);case 22:return hd(r,a,f)}throw Error(N(156,a.tag))};function Uh(r,a){return En(r,a)}function Ld(r,a,f,x){this.tag=r,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ro(r,a,f,x){return new Ld(r,a,f,x)}function kc(r){return r=r.prototype,!(!r||!r.isReactComponent)}function of(r){if(typeof r=="function")return kc(r)?1:0;if(r!=null){if(r=r.$$typeof,r===Hi)return 11;if(r===Bn)return 14}return 2}function $l(r,a){var f=r.alternate;return f===null?(f=ro(r.tag,a,r.key,r.mode),f.elementType=r.elementType,f.type=r.type,f.stateNode=r.stateNode,f.alternate=r,r.alternate=f):(f.pendingProps=a,f.type=r.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=r.flags&14680064,f.childLanes=r.childLanes,f.lanes=r.lanes,f.child=r.child,f.memoizedProps=r.memoizedProps,f.memoizedState=r.memoizedState,f.updateQueue=r.updateQueue,a=r.dependencies,f.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},f.sibling=r.sibling,f.index=r.index,f.ref=r.ref,f}function Cc(r,a,f,x,k,E){var q=2;if(x=r,typeof r=="function")kc(r)&&(q=1);else if(typeof r=="string")q=5;else e:switch(r){case _i:return ql(f.children,k,E,a);case nn:q=8,k|=8;break;case an:return r=ro(12,f,a,k|2),r.elementType=an,r.lanes=E,r;case Di:return r=ro(13,f,a,k),r.elementType=Di,r.lanes=E,r;case xi:return r=ro(19,f,a,k),r.elementType=xi,r.lanes=E,r;case Ei:return Hl(f,k,E,a);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case Zn:q=10;break e;case qt:q=9;break e;case Hi:q=11;break e;case Bn:q=14;break e;case Bi:q=16,x=null;break e}throw Error(N(130,r==null?r:typeof r,""))}return a=ro(q,f,a,k),a.elementType=r,a.type=x,a.lanes=E,a}function ql(r,a,f,x){return r=ro(7,r,x,a),r.lanes=f,r}function Hl(r,a,f,x){return r=ro(22,r,x,a),r.elementType=Ei,r.lanes=f,r.stateNode={isHidden:!1},r}function ta(r,a,f){return r=ro(6,r,null,a),r.lanes=f,r}function Za(r,a,f){return a=ro(4,r.children!==null?r.children:[],r.key,a),a.lanes=f,a.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},a}function Dd(r,a,f,x,k){this.tag=a,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=wi(0),this.expirationTimes=wi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wi(0),this.identifierPrefix=x,this.onRecoverableError=k,this.mutableSourceEagerHydrationData=null}function Ic(r,a,f,x,k,E,q,ae,_e){return r=new Dd(r,a,f,ae,_e),a===1?(a=1,E===!0&&(a|=8)):a=0,E=ro(3,null,null,a),r.current=E,E.stateNode=r,E.memoizedState={element:x,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},Na(E),r}function af(r,a,f){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ii,key:x==null?null:""+x,children:r,containerInfo:a,implementation:f}}function Rd(r){if(!r)return Fa;r=r._reactInternals;e:{if(si(r)!==r||r.tag!==1)throw Error(N(170));var a=r;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(_r(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(N(171))}if(r.tag===1){var f=r.type;if(_r(f))return Ml(r,f,a)}return a}function Ec(r,a,f,x,k,E,q,ae,_e){return r=Ic(f,x,!0,r,k,E,q,ae,_e),r.context=Rd(null),f=r.current,x=Bs(),k=Zl(f),E=Ys(x,k),E.callback=a??null,Yo(f,E,k),r.current.lanes=k,jr(r,k,x),no(r,x),r}function Zu(r,a,f,x){var k=a.current,E=Bs(),q=Zl(k);return f=Rd(f),a.context===null?a.context=f:a.pendingContext=f,a=Ys(E,q),a.payload={element:r},x=x===void 0?null:x,x!==null&&(a.callback=x),r=Yo(k,a,q),r!==null&&(wa(r,k,q,E),Hr(r,k,q)),q}function uh(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function ch(r,a){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var f=r.retryLane;r.retryLane=f!==0&&f<a?f:a}}function Mc(r,a){ch(r,a),(r=r.alternate)&&ch(r,a)}function $u(){return null}var Zh=typeof reportError=="function"?reportError:function(r){console.error(r)};function hh(r){this._internalRoot=r}qu.prototype.render=hh.prototype.render=function(r){var a=this._internalRoot;if(a===null)throw Error(N(409));Zu(r,a,null,null)},qu.prototype.unmount=hh.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var a=r.containerInfo;hl(function(){Zu(null,r,null,null)}),a[Ni]=null}};function qu(r){this._internalRoot=r}qu.prototype.unstable_scheduleHydration=function(r){if(r){var a=Ga();r={blockedOn:null,target:r,priority:a};for(var f=0;f<kn.length&&a!==0&&a<kn[f].priority;f++);kn.splice(f,0,r),f===0&&Xa(r)}};function dh(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function Pu(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function $h(){}function lf(r,a,f,x,k){if(k){if(typeof x=="function"){var E=x;x=function(){var Oe=uh(q);E.call(Oe)}}var q=Ec(a,x,r,0,null,!1,!1,"",$h);return r._reactRootContainer=q,r[Ni]=q.current,Ks(r.nodeType===8?r.parentNode:r),hl(),q}for(;k=r.lastChild;)r.removeChild(k);if(typeof x=="function"){var ae=x;x=function(){var Oe=uh(_e);ae.call(Oe)}}var _e=Ic(r,0,!1,null,null,!1,!1,"",$h);return r._reactRootContainer=_e,r[Ni]=_e.current,Ks(r.nodeType===8?r.parentNode:r),hl(function(){Zu(a,_e,f,x)}),_e}function fh(r,a,f,x,k){var E=f._reactRootContainer;if(E){var q=E;if(typeof k=="function"){var ae=k;k=function(){var _e=uh(q);ae.call(_e)}}Zu(a,q,r,k)}else q=lf(f,a,r,k,x);return uh(q)}jo=function(r){switch(r.tag){case 3:var a=r.stateNode;if(a.current.memoizedState.isDehydrated){var f=oi(a.pendingLanes);f!==0&&(Pr(a,f|1),no(a,Xt()),(ji&6)===0&&(vn=Xt()+500,m()))}break;case 13:hl(function(){var x=ss(r,1);if(x!==null){var k=Bs();wa(x,r,1,k)}}),Mc(r,1)}},Us=function(r){if(r.tag===13){var a=ss(r,134217728);if(a!==null){var f=Bs();wa(a,r,134217728,f)}Mc(r,134217728)}},po=function(r){if(r.tag===13){var a=Zl(r),f=ss(r,a);if(f!==null){var x=Bs();wa(f,r,a,x)}Mc(r,a)}},Ga=function(){return zi},Wa=function(r,a){var f=zi;try{return zi=r,a()}finally{zi=f}},Yr=function(r,a,f){switch(a){case"input":if(ps(r,f),a=f.name,f.type==="radio"&&a!=null){for(f=r;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<f.length;a++){var x=f[a];if(x!==r&&x.form===r.form){var k=ll(x);if(!k)throw Error(N(90));wr(x),ps(x,k)}}}break;case"textarea":ra(r,f);break;case"select":a=f.value,a!=null&&Kr(r,!!f.multiple,a,!1)}},W=ah,te=hl;var Bd={usingClientEntryPoint:!1,Events:[_a,rs,ll,V,j,ah]},zc={findFiberByHostInstance:To,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},uf={bundleType:zc.bundleType,version:zc.version,rendererPackageName:zc.rendererPackageName,rendererConfig:zc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:hi.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=Fi(r),r===null?null:r.stateNode},findFiberByHostInstance:zc.findFiberByHostInstance||$u,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ph=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ph.isDisabled&&ph.supportsFiber)try{Hn=ph.inject(uf),rr=ph}catch{}}return na.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Bd,na.createPortal=function(r,a){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!dh(a))throw Error(N(200));return af(r,a,null,f)},na.createRoot=function(r,a){if(!dh(r))throw Error(N(299));var f=!1,x="",k=Zh;return a!=null&&(a.unstable_strictMode===!0&&(f=!0),a.identifierPrefix!==void 0&&(x=a.identifierPrefix),a.onRecoverableError!==void 0&&(k=a.onRecoverableError)),a=Ic(r,1,!1,null,null,f,!1,x,k),r[Ni]=a.current,Ks(r.nodeType===8?r.parentNode:r),new hh(a)},na.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var a=r._reactInternals;if(a===void 0)throw typeof r.render=="function"?Error(N(188)):(r=Object.keys(r).join(","),Error(N(268,r)));return r=Fi(a),r=r===null?null:r.stateNode,r},na.flushSync=function(r){return hl(r)},na.hydrate=function(r,a,f){if(!Pu(a))throw Error(N(200));return fh(null,r,a,!0,f)},na.hydrateRoot=function(r,a,f){if(!dh(r))throw Error(N(405));var x=f!=null&&f.hydratedSources||null,k=!1,E="",q=Zh;if(f!=null&&(f.unstable_strictMode===!0&&(k=!0),f.identifierPrefix!==void 0&&(E=f.identifierPrefix),f.onRecoverableError!==void 0&&(q=f.onRecoverableError)),a=Ec(a,null,r,1,f??null,k,!1,E,q),r[Ni]=a.current,Ks(r),x)for(r=0;r<x.length;r++)f=x[r],k=f._getVersion,k=k(f._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[f,k]:a.mutableSourceEagerHydrationData.push(f,k);return new qu(a)},na.render=function(r,a,f){if(!Pu(a))throw Error(N(200));return fh(null,r,a,!1,f)},na.unmountComponentAtNode=function(r){if(!Pu(r))throw Error(N(40));return r._reactRootContainer?(hl(function(){fh(null,null,r,!1,function(){r._reactRootContainer=null,r[Ni]=null})}),!0):!1},na.unstable_batchedUpdates=ah,na.unstable_renderSubtreeIntoContainer=function(r,a,f,x){if(!Pu(f))throw Error(N(200));if(r==null||r._reactInternals===void 0)throw Error(N(38));return fh(r,a,f,!1,x)},na.version="18.3.1-next-f1338f8080-20240426",na}var up;function Pp(){if(up)return Tf.exports;up=1;function Z(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Z)}catch(J){console.error(J)}}return Z(),Tf.exports=wm(),Tf.exports}var cp;function bm(){if(cp)return Zd;cp=1;var Z=Pp();return Zd.createRoot=Z.createRoot,Zd.hydrateRoot=Z.hydrateRoot,Zd}var Sm=bm();Pp();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Kh(){return Kh=Object.assign?Object.assign.bind():function(Z){for(var J=1;J<arguments.length;J++){var N=arguments[J];for(var re in N)Object.prototype.hasOwnProperty.call(N,re)&&(Z[re]=N[re])}return Z},Kh.apply(this,arguments)}var Gu;(function(Z){Z.Pop="POP",Z.Push="PUSH",Z.Replace="REPLACE"})(Gu||(Gu={}));const hp="popstate";function Tm(Z){Z===void 0&&(Z={});function J(re,ce){let{pathname:Me,search:O,hash:g}=re.location;return If("",{pathname:Me,search:O,hash:g},ce.state&&ce.state.usr||null,ce.state&&ce.state.key||"default")}function N(re,ce){return typeof ce=="string"?ce:Gd(ce)}return km(J,N,null,Z)}function Or(Z,J){if(Z===!1||Z===null||typeof Z>"u")throw new Error(J)}function kp(Z,J){if(!Z){typeof console<"u"&&console.warn(J);try{throw new Error(J)}catch{}}}function Pm(){return Math.random().toString(36).substr(2,8)}function dp(Z,J){return{usr:Z.state,key:Z.key,idx:J}}function If(Z,J,N,re){return N===void 0&&(N=null),Kh({pathname:typeof Z=="string"?Z:Z.pathname,search:"",hash:""},typeof J=="string"?yh(J):J,{state:N,key:J&&J.key||re||Pm()})}function Gd(Z){let{pathname:J="/",search:N="",hash:re=""}=Z;return N&&N!=="?"&&(J+=N.charAt(0)==="?"?N:"?"+N),re&&re!=="#"&&(J+=re.charAt(0)==="#"?re:"#"+re),J}function yh(Z){let J={};if(Z){let N=Z.indexOf("#");N>=0&&(J.hash=Z.substr(N),Z=Z.substr(0,N));let re=Z.indexOf("?");re>=0&&(J.search=Z.substr(re),Z=Z.substr(0,re)),Z&&(J.pathname=Z)}return J}function km(Z,J,N,re){re===void 0&&(re={});let{window:ce=document.defaultView,v5Compat:Me=!1}=re,O=ce.history,g=Gu.Pop,ze=null,nt=tt();nt==null&&(nt=0,O.replaceState(Kh({},O.state,{idx:nt}),""));function tt(){return(O.state||{idx:null}).idx}function xe(){g=Gu.Pop;let Je=tt(),$t=Je==null?null:Je-nt;nt=Je,ze&&ze({action:g,location:Ue.location,delta:$t})}function me(Je,$t){g=Gu.Push;let Qt=If(Ue.location,Je,$t);nt=tt()+1;let Mt=dp(Qt,nt),hi=Ue.createHref(Qt);try{O.pushState(Mt,"",hi)}catch(li){if(li instanceof DOMException&&li.name==="DataCloneError")throw li;ce.location.assign(hi)}Me&&ze&&ze({action:g,location:Ue.location,delta:1})}function Ot(Je,$t){g=Gu.Replace;let Qt=If(Ue.location,Je,$t);nt=tt();let Mt=dp(Qt,nt),hi=Ue.createHref(Qt);O.replaceState(Mt,"",hi),Me&&ze&&ze({action:g,location:Ue.location,delta:0})}function st(Je){let $t=ce.location.origin!=="null"?ce.location.origin:ce.location.href,Qt=typeof Je=="string"?Je:Gd(Je);return Qt=Qt.replace(/ $/,"%20"),Or($t,"No window.location.(origin|href) available to create URL for href: "+Qt),new URL(Qt,$t)}let Ue={get action(){return g},get location(){return Z(ce,O)},listen(Je){if(ze)throw new Error("A history only accepts one active listener");return ce.addEventListener(hp,xe),ze=Je,()=>{ce.removeEventListener(hp,xe),ze=null}},createHref(Je){return J(ce,Je)},createURL:st,encodeLocation(Je){let $t=st(Je);return{pathname:$t.pathname,search:$t.search,hash:$t.hash}},push:me,replace:Ot,go(Je){return O.go(Je)}};return Ue}var fp;(function(Z){Z.data="data",Z.deferred="deferred",Z.redirect="redirect",Z.error="error"})(fp||(fp={}));function Cm(Z,J,N){return N===void 0&&(N="/"),Im(Z,J,N)}function Im(Z,J,N,re){let ce=typeof J=="string"?yh(J):J,Me=Of(ce.pathname||"/",N);if(Me==null)return null;let O=Cp(Z);Em(O);let g=null;for(let ze=0;g==null&&ze<O.length;++ze){let nt=Vm(Me);g=Fm(O[ze],nt)}return g}function Cp(Z,J,N,re){J===void 0&&(J=[]),N===void 0&&(N=[]),re===void 0&&(re="");let ce=(Me,O,g)=>{let ze={relativePath:g===void 0?Me.path||"":g,caseSensitive:Me.caseSensitive===!0,childrenIndex:O,route:Me};ze.relativePath.startsWith("/")&&(Or(ze.relativePath.startsWith(re),'Absolute route path "'+ze.relativePath+'" nested under path '+('"'+re+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),ze.relativePath=ze.relativePath.slice(re.length));let nt=Wu([re,ze.relativePath]),tt=N.concat(ze);Me.children&&Me.children.length>0&&(Or(Me.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+nt+'".')),Cp(Me.children,J,tt,nt)),!(Me.path==null&&!Me.index)&&J.push({path:nt,score:Bm(nt,Me.index),routesMeta:tt})};return Z.forEach((Me,O)=>{var g;if(Me.path===""||!((g=Me.path)!=null&&g.includes("?")))ce(Me,O);else for(let ze of Ip(Me.path))ce(Me,O,ze)}),J}function Ip(Z){let J=Z.split("/");if(J.length===0)return[];let[N,...re]=J,ce=N.endsWith("?"),Me=N.replace(/\?$/,"");if(re.length===0)return ce?[Me,""]:[Me];let O=Ip(re.join("/")),g=[];return g.push(...O.map(ze=>ze===""?Me:[Me,ze].join("/"))),ce&&g.push(...O),g.map(ze=>Z.startsWith("/")&&ze===""?"/":ze)}function Em(Z){Z.sort((J,N)=>J.score!==N.score?N.score-J.score:Om(J.routesMeta.map(re=>re.childrenIndex),N.routesMeta.map(re=>re.childrenIndex)))}const Mm=/^:[\w-]+$/,zm=3,Am=2,Lm=1,Dm=10,Rm=-2,pp=Z=>Z==="*";function Bm(Z,J){let N=Z.split("/"),re=N.length;return N.some(pp)&&(re+=Rm),J&&(re+=Am),N.filter(ce=>!pp(ce)).reduce((ce,Me)=>ce+(Mm.test(Me)?zm:Me===""?Lm:Dm),re)}function Om(Z,J){return Z.length===J.length&&Z.slice(0,-1).every((re,ce)=>re===J[ce])?Z[Z.length-1]-J[J.length-1]:0}function Fm(Z,J,N){let{routesMeta:re}=Z,ce={},Me="/",O=[];for(let g=0;g<re.length;++g){let ze=re[g],nt=g===re.length-1,tt=Me==="/"?J:J.slice(Me.length)||"/",xe=Nm({path:ze.relativePath,caseSensitive:ze.caseSensitive,end:nt},tt),me=ze.route;if(!xe)return null;Object.assign(ce,xe.params),O.push({params:ce,pathname:Wu([Me,xe.pathname]),pathnameBase:qm(Wu([Me,xe.pathnameBase])),route:me}),xe.pathnameBase!=="/"&&(Me=Wu([Me,xe.pathnameBase]))}return O}function Nm(Z,J){typeof Z=="string"&&(Z={path:Z,caseSensitive:!1,end:!0});let[N,re]=jm(Z.path,Z.caseSensitive,Z.end),ce=J.match(N);if(!ce)return null;let Me=ce[0],O=Me.replace(/(.)\/+$/,"$1"),g=ce.slice(1);return{params:re.reduce((nt,tt,xe)=>{let{paramName:me,isOptional:Ot}=tt;if(me==="*"){let Ue=g[xe]||"";O=Me.slice(0,Me.length-Ue.length).replace(/(.)\/+$/,"$1")}const st=g[xe];return Ot&&!st?nt[me]=void 0:nt[me]=(st||"").replace(/%2F/g,"/"),nt},{}),pathname:Me,pathnameBase:O,pattern:Z}}function jm(Z,J,N){J===void 0&&(J=!1),N===void 0&&(N=!0),kp(Z==="*"||!Z.endsWith("*")||Z.endsWith("/*"),'Route path "'+Z+'" will be treated as if it were '+('"'+Z.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+Z.replace(/\*$/,"/*")+'".'));let re=[],ce="^"+Z.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(O,g,ze)=>(re.push({paramName:g,isOptional:ze!=null}),ze?"/?([^\\/]+)?":"/([^\\/]+)"));return Z.endsWith("*")?(re.push({paramName:"*"}),ce+=Z==="*"||Z==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):N?ce+="\\/*$":Z!==""&&Z!=="/"&&(ce+="(?:(?=\\/|$))"),[new RegExp(ce,J?void 0:"i"),re]}function Vm(Z){try{return Z.split("/").map(J=>decodeURIComponent(J).replace(/\//g,"%2F")).join("/")}catch(J){return kp(!1,'The URL path "'+Z+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+J+").")),Z}}function Of(Z,J){if(J==="/")return Z;if(!Z.toLowerCase().startsWith(J.toLowerCase()))return null;let N=J.endsWith("/")?J.length-1:J.length,re=Z.charAt(N);return re&&re!=="/"?null:Z.slice(N)||"/"}function Um(Z,J){J===void 0&&(J="/");let{pathname:N,search:re="",hash:ce=""}=typeof Z=="string"?yh(Z):Z;return{pathname:N?N.startsWith("/")?N:Zm(N,J):J,search:Hm(re),hash:Gm(ce)}}function Zm(Z,J){let N=J.replace(/\/+$/,"").split("/");return Z.split("/").forEach(ce=>{ce===".."?N.length>1&&N.pop():ce!=="."&&N.push(ce)}),N.length>1?N.join("/"):"/"}function Cf(Z,J,N,re){return"Cannot include a '"+Z+"' character in a manually specified "+("`to."+J+"` field ["+JSON.stringify(re)+"].  Please separate it out to the ")+("`to."+N+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function $m(Z){return Z.filter((J,N)=>N===0||J.route.path&&J.route.path.length>0)}function Ep(Z,J){let N=$m(Z);return J?N.map((re,ce)=>ce===N.length-1?re.pathname:re.pathnameBase):N.map(re=>re.pathnameBase)}function Mp(Z,J,N,re){re===void 0&&(re=!1);let ce;typeof Z=="string"?ce=yh(Z):(ce=Kh({},Z),Or(!ce.pathname||!ce.pathname.includes("?"),Cf("?","pathname","search",ce)),Or(!ce.pathname||!ce.pathname.includes("#"),Cf("#","pathname","hash",ce)),Or(!ce.search||!ce.search.includes("#"),Cf("#","search","hash",ce)));let Me=Z===""||ce.pathname==="",O=Me?"/":ce.pathname,g;if(O==null)g=N;else{let xe=J.length-1;if(!re&&O.startsWith("..")){let me=O.split("/");for(;me[0]==="..";)me.shift(),xe-=1;ce.pathname=me.join("/")}g=xe>=0?J[xe]:"/"}let ze=Um(ce,g),nt=O&&O!=="/"&&O.endsWith("/"),tt=(Me||O===".")&&N.endsWith("/");return!ze.pathname.endsWith("/")&&(nt||tt)&&(ze.pathname+="/"),ze}const Wu=Z=>Z.join("/").replace(/\/\/+/g,"/"),qm=Z=>Z.replace(/\/+$/,"").replace(/^\/*/,"/"),Hm=Z=>!Z||Z==="?"?"":Z.startsWith("?")?Z:"?"+Z,Gm=Z=>!Z||Z==="#"?"":Z.startsWith("#")?Z:"#"+Z;function Wm(Z){return Z!=null&&typeof Z.status=="number"&&typeof Z.statusText=="string"&&typeof Z.internal=="boolean"&&"data"in Z}const zp=["post","put","patch","delete"];new Set(zp);const Xm=["get",...zp];new Set(Xm);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Jh(){return Jh=Object.assign?Object.assign.bind():function(Z){for(var J=1;J<arguments.length;J++){var N=arguments[J];for(var re in N)Object.prototype.hasOwnProperty.call(N,re)&&(Z[re]=N[re])}return Z},Jh.apply(this,arguments)}const Ff=Xe.createContext(null),Km=Xe.createContext(null),Rc=Xe.createContext(null),Wd=Xe.createContext(null),Bc=Xe.createContext({outlet:null,matches:[],isDataRoute:!1}),Ap=Xe.createContext(null);function Jm(Z,J){let{relative:N}=J===void 0?{}:J;Yh()||Or(!1);let{basename:re,navigator:ce}=Xe.useContext(Rc),{hash:Me,pathname:O,search:g}=Dp(Z,{relative:N}),ze=O;return re!=="/"&&(ze=O==="/"?re:Wu([re,O])),ce.createHref({pathname:ze,search:g,hash:Me})}function Yh(){return Xe.useContext(Wd)!=null}function Xd(){return Yh()||Or(!1),Xe.useContext(Wd).location}function Lp(Z){Xe.useContext(Rc).static||Xe.useLayoutEffect(Z)}function Ym(){let{isDataRoute:Z}=Xe.useContext(Bc);return Z?h_():Qm()}function Qm(){Yh()||Or(!1);let Z=Xe.useContext(Ff),{basename:J,future:N,navigator:re}=Xe.useContext(Rc),{matches:ce}=Xe.useContext(Bc),{pathname:Me}=Xd(),O=JSON.stringify(Ep(ce,N.v7_relativeSplatPath)),g=Xe.useRef(!1);return Lp(()=>{g.current=!0}),Xe.useCallback(function(nt,tt){if(tt===void 0&&(tt={}),!g.current)return;if(typeof nt=="number"){re.go(nt);return}let xe=Mp(nt,JSON.parse(O),Me,tt.relative==="path");Z==null&&J!=="/"&&(xe.pathname=xe.pathname==="/"?J:Wu([J,xe.pathname])),(tt.replace?re.replace:re.push)(xe,tt.state,tt)},[J,re,O,Me,Z])}function Dp(Z,J){let{relative:N}=J===void 0?{}:J,{future:re}=Xe.useContext(Rc),{matches:ce}=Xe.useContext(Bc),{pathname:Me}=Xd(),O=JSON.stringify(Ep(ce,re.v7_relativeSplatPath));return Xe.useMemo(()=>Mp(Z,JSON.parse(O),Me,N==="path"),[Z,O,Me,N])}function e_(Z,J){return t_(Z,J)}function t_(Z,J,N,re){Yh()||Or(!1);let{navigator:ce}=Xe.useContext(Rc),{matches:Me}=Xe.useContext(Bc),O=Me[Me.length-1],g=O?O.params:{};O&&O.pathname;let ze=O?O.pathnameBase:"/";O&&O.route;let nt=Xd(),tt;if(J){var xe;let Je=typeof J=="string"?yh(J):J;ze==="/"||(xe=Je.pathname)!=null&&xe.startsWith(ze)||Or(!1),tt=Je}else tt=nt;let me=tt.pathname||"/",Ot=me;if(ze!=="/"){let Je=ze.replace(/^\//,"").split("/");Ot="/"+me.replace(/^\//,"").split("/").slice(Je.length).join("/")}let st=Cm(Z,{pathname:Ot}),Ue=o_(st&&st.map(Je=>Object.assign({},Je,{params:Object.assign({},g,Je.params),pathname:Wu([ze,ce.encodeLocation?ce.encodeLocation(Je.pathname).pathname:Je.pathname]),pathnameBase:Je.pathnameBase==="/"?ze:Wu([ze,ce.encodeLocation?ce.encodeLocation(Je.pathnameBase).pathname:Je.pathnameBase])})),Me,N,re);return J&&Ue?Xe.createElement(Wd.Provider,{value:{location:Jh({pathname:"/",search:"",hash:"",state:null,key:"default"},tt),navigationType:Gu.Pop}},Ue):Ue}function i_(){let Z=c_(),J=Wm(Z)?Z.status+" "+Z.statusText:Z instanceof Error?Z.message:JSON.stringify(Z),N=Z instanceof Error?Z.stack:null,ce={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Xe.createElement(Xe.Fragment,null,Xe.createElement("h2",null,"Unexpected Application Error!"),Xe.createElement("h3",{style:{fontStyle:"italic"}},J),N?Xe.createElement("pre",{style:ce},N):null,null)}const n_=Xe.createElement(i_,null);class r_ extends Xe.Component{constructor(J){super(J),this.state={location:J.location,revalidation:J.revalidation,error:J.error}}static getDerivedStateFromError(J){return{error:J}}static getDerivedStateFromProps(J,N){return N.location!==J.location||N.revalidation!=="idle"&&J.revalidation==="idle"?{error:J.error,location:J.location,revalidation:J.revalidation}:{error:J.error!==void 0?J.error:N.error,location:N.location,revalidation:J.revalidation||N.revalidation}}componentDidCatch(J,N){console.error("React Router caught the following error during render",J,N)}render(){return this.state.error!==void 0?Xe.createElement(Bc.Provider,{value:this.props.routeContext},Xe.createElement(Ap.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function s_(Z){let{routeContext:J,match:N,children:re}=Z,ce=Xe.useContext(Ff);return ce&&ce.static&&ce.staticContext&&(N.route.errorElement||N.route.ErrorBoundary)&&(ce.staticContext._deepestRenderedBoundaryId=N.route.id),Xe.createElement(Bc.Provider,{value:J},re)}function o_(Z,J,N,re){var ce;if(J===void 0&&(J=[]),N===void 0&&(N=null),re===void 0&&(re=null),Z==null){var Me;if(!N)return null;if(N.errors)Z=N.matches;else if((Me=re)!=null&&Me.v7_partialHydration&&J.length===0&&!N.initialized&&N.matches.length>0)Z=N.matches;else return null}let O=Z,g=(ce=N)==null?void 0:ce.errors;if(g!=null){let tt=O.findIndex(xe=>xe.route.id&&g?.[xe.route.id]!==void 0);tt>=0||Or(!1),O=O.slice(0,Math.min(O.length,tt+1))}let ze=!1,nt=-1;if(N&&re&&re.v7_partialHydration)for(let tt=0;tt<O.length;tt++){let xe=O[tt];if((xe.route.HydrateFallback||xe.route.hydrateFallbackElement)&&(nt=tt),xe.route.id){let{loaderData:me,errors:Ot}=N,st=xe.route.loader&&me[xe.route.id]===void 0&&(!Ot||Ot[xe.route.id]===void 0);if(xe.route.lazy||st){ze=!0,nt>=0?O=O.slice(0,nt+1):O=[O[0]];break}}}return O.reduceRight((tt,xe,me)=>{let Ot,st=!1,Ue=null,Je=null;N&&(Ot=g&&xe.route.id?g[xe.route.id]:void 0,Ue=xe.route.errorElement||n_,ze&&(nt<0&&me===0?(d_("route-fallback"),st=!0,Je=null):nt===me&&(st=!0,Je=xe.route.hydrateFallbackElement||null)));let $t=J.concat(O.slice(0,me+1)),Qt=()=>{let Mt;return Ot?Mt=Ue:st?Mt=Je:xe.route.Component?Mt=Xe.createElement(xe.route.Component,null):xe.route.element?Mt=xe.route.element:Mt=tt,Xe.createElement(s_,{match:xe,routeContext:{outlet:tt,matches:$t,isDataRoute:N!=null},children:Mt})};return N&&(xe.route.ErrorBoundary||xe.route.errorElement||me===0)?Xe.createElement(r_,{location:N.location,revalidation:N.revalidation,component:Ue,error:Ot,children:Qt(),routeContext:{outlet:null,matches:$t,isDataRoute:!0}}):Qt()},null)}var Rp=function(Z){return Z.UseBlocker="useBlocker",Z.UseRevalidator="useRevalidator",Z.UseNavigateStable="useNavigate",Z}(Rp||{}),Bp=function(Z){return Z.UseBlocker="useBlocker",Z.UseLoaderData="useLoaderData",Z.UseActionData="useActionData",Z.UseRouteError="useRouteError",Z.UseNavigation="useNavigation",Z.UseRouteLoaderData="useRouteLoaderData",Z.UseMatches="useMatches",Z.UseRevalidator="useRevalidator",Z.UseNavigateStable="useNavigate",Z.UseRouteId="useRouteId",Z}(Bp||{});function a_(Z){let J=Xe.useContext(Ff);return J||Or(!1),J}function l_(Z){let J=Xe.useContext(Km);return J||Or(!1),J}function u_(Z){let J=Xe.useContext(Bc);return J||Or(!1),J}function Op(Z){let J=u_(),N=J.matches[J.matches.length-1];return N.route.id||Or(!1),N.route.id}function c_(){var Z;let J=Xe.useContext(Ap),N=l_(),re=Op();return J!==void 0?J:(Z=N.errors)==null?void 0:Z[re]}function h_(){let{router:Z}=a_(Rp.UseNavigateStable),J=Op(Bp.UseNavigateStable),N=Xe.useRef(!1);return Lp(()=>{N.current=!0}),Xe.useCallback(function(ce,Me){Me===void 0&&(Me={}),N.current&&(typeof ce=="number"?Z.navigate(ce):Z.navigate(ce,Jh({fromRouteId:J},Me)))},[Z,J])}const mp={};function d_(Z,J,N){mp[Z]||(mp[Z]=!0)}function f_(Z,J){Z?.v7_startTransition,Z?.v7_relativeSplatPath}function Ef(Z){Or(!1)}function p_(Z){let{basename:J="/",children:N=null,location:re,navigationType:ce=Gu.Pop,navigator:Me,static:O=!1,future:g}=Z;Yh()&&Or(!1);let ze=J.replace(/^\/*/,"/"),nt=Xe.useMemo(()=>({basename:ze,navigator:Me,static:O,future:Jh({v7_relativeSplatPath:!1},g)}),[ze,g,Me,O]);typeof re=="string"&&(re=yh(re));let{pathname:tt="/",search:xe="",hash:me="",state:Ot=null,key:st="default"}=re,Ue=Xe.useMemo(()=>{let Je=Of(tt,ze);return Je==null?null:{location:{pathname:Je,search:xe,hash:me,state:Ot,key:st},navigationType:ce}},[ze,tt,xe,me,Ot,st,ce]);return Ue==null?null:Xe.createElement(Rc.Provider,{value:nt},Xe.createElement(Wd.Provider,{children:N,value:Ue}))}function m_(Z){let{children:J,location:N}=Z;return e_(Mf(J),N)}new Promise(()=>{});function Mf(Z,J){J===void 0&&(J=[]);let N=[];return Xe.Children.forEach(Z,(re,ce)=>{if(!Xe.isValidElement(re))return;let Me=[...J,ce];if(re.type===Xe.Fragment){N.push.apply(N,Mf(re.props.children,Me));return}re.type!==Ef&&Or(!1),!re.props.index||!re.props.children||Or(!1);let O={id:re.props.id||Me.join("-"),caseSensitive:re.props.caseSensitive,element:re.props.element,Component:re.props.Component,index:re.props.index,path:re.props.path,loader:re.props.loader,action:re.props.action,errorElement:re.props.errorElement,ErrorBoundary:re.props.ErrorBoundary,hasErrorBoundary:re.props.ErrorBoundary!=null||re.props.errorElement!=null,shouldRevalidate:re.props.shouldRevalidate,handle:re.props.handle,lazy:re.props.lazy};re.props.children&&(O.children=Mf(re.props.children,Me)),N.push(O)}),N}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zf(){return zf=Object.assign?Object.assign.bind():function(Z){for(var J=1;J<arguments.length;J++){var N=arguments[J];for(var re in N)Object.prototype.hasOwnProperty.call(N,re)&&(Z[re]=N[re])}return Z},zf.apply(this,arguments)}function __(Z,J){if(Z==null)return{};var N={},re=Object.keys(Z),ce,Me;for(Me=0;Me<re.length;Me++)ce=re[Me],!(J.indexOf(ce)>=0)&&(N[ce]=Z[ce]);return N}function g_(Z){return!!(Z.metaKey||Z.altKey||Z.ctrlKey||Z.shiftKey)}function y_(Z,J){return Z.button===0&&(!J||J==="_self")&&!g_(Z)}const v_=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],x_="6";try{window.__reactRouterVersion=x_}catch{}const w_="startTransition",_p=ym[w_];function Fp(Z){let{basename:J,children:N,future:re,window:ce}=Z,Me=Xe.useRef();Me.current==null&&(Me.current=Tm({window:ce,v5Compat:!0}));let O=Me.current,[g,ze]=Xe.useState({action:O.action,location:O.location}),{v7_startTransition:nt}=re||{},tt=Xe.useCallback(xe=>{nt&&_p?_p(()=>ze(xe)):ze(xe)},[ze,nt]);return Xe.useLayoutEffect(()=>O.listen(tt),[O,tt]),Xe.useEffect(()=>f_(re),[re]),Xe.createElement(p_,{basename:J,children:N,location:g.location,navigationType:g.action,navigator:O,future:re})}const b_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",S_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,T_=Xe.forwardRef(function(J,N){let{onClick:re,relative:ce,reloadDocument:Me,replace:O,state:g,target:ze,to:nt,preventScrollReset:tt,viewTransition:xe}=J,me=__(J,v_),{basename:Ot}=Xe.useContext(Rc),st,Ue=!1;if(typeof nt=="string"&&S_.test(nt)&&(st=nt,b_))try{let Mt=new URL(window.location.href),hi=nt.startsWith("//")?new URL(Mt.protocol+nt):new URL(nt),li=Of(hi.pathname,Ot);hi.origin===Mt.origin&&li!=null?nt=li+hi.search+hi.hash:Ue=!0}catch{}let Je=Jm(nt,{relative:ce}),$t=P_(nt,{replace:O,state:g,target:ze,preventScrollReset:tt,relative:ce,viewTransition:xe});function Qt(Mt){re&&re(Mt),Mt.defaultPrevented||$t(Mt)}return Xe.createElement("a",zf({},me,{href:st||Je,onClick:Ue||Me?re:Qt,ref:N,target:ze}))});var gp;(function(Z){Z.UseScrollRestoration="useScrollRestoration",Z.UseSubmit="useSubmit",Z.UseSubmitFetcher="useSubmitFetcher",Z.UseFetcher="useFetcher",Z.useViewTransitionState="useViewTransitionState"})(gp||(gp={}));var yp;(function(Z){Z.UseFetcher="useFetcher",Z.UseFetchers="useFetchers",Z.UseScrollRestoration="useScrollRestoration"})(yp||(yp={}));function P_(Z,J){let{target:N,replace:re,state:ce,preventScrollReset:Me,relative:O,viewTransition:g}=J===void 0?{}:J,ze=Ym(),nt=Xd(),tt=Dp(Z,{relative:O});return Xe.useCallback(xe=>{if(y_(xe,N)){xe.preventDefault();let me=re!==void 0?re:Gd(nt)===Gd(tt);ze(Z,{replace:me,state:ce,preventScrollReset:Me,relative:O,viewTransition:g})}},[nt,ze,tt,re,ce,N,Z,Me,O,g])}const k_="/uk-traffic-viewer/logo.png";function C_(){return Ge.jsxs("div",{className:"min-h-screen grid place-items-center bg-[#EEE2C9] dark:bg-[#2A2418]",children:[Ge.jsxs("div",{className:"w-[92vw] max-w-xl rounded-2xl border border-black/10 dark:border-white/15 bg-white/70 dark:bg-black/30 backdrop-blur p-10 shadow",children:[Ge.jsx("img",{src:k_,alt:"CDA",className:"mx-auto mb-4 h-24 w-24 rounded-2xl"}),Ge.jsx("h1",{className:"text-2xl font-semibold text-center mb-2",children:"Coach Drivers App"}),Ge.jsx("h1",{className:"text-2xl font-semibold text-center mb-2",children:"Live Traffic Updates"}),Ge.jsx("p",{className:"opacity-70 mb-6",children:"Real-time UK traffic maps, live incidents powered by TomTom, Provided by Coach Drivers App."}),Ge.jsx(T_,{to:"/traffic",className:"inline-flex items-center gap-2 rounded-xl px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-white shadow",children:"Check Out Live Traffic"})]}),Ge.jsxs("footer",{className:"absolute bottom-4 text-xs opacity-60",children:["© ",new Date().getFullYear()," Coach Drivers App, Version 1.0.0, Developed by Stephen Lewis."]})]})}function I_(Z,J){const N=Xe.useRef(J);Xe.useEffect(function(){J!==N.current&&Z.attributionControl!=null&&(N.current!=null&&Z.attributionControl.removeAttribution(N.current),J!=null&&Z.attributionControl.addAttribution(J)),N.current=J},[Z,J])}const E_=1;function M_(Z){return Object.freeze({__version:E_,map:Z})}function z_(Z,J){return Object.freeze({...Z,...J})}const Np=Xe.createContext(null),jp=Np.Provider;function Nf(){const Z=Xe.useContext(Np);if(Z==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return Z}function A_(Z){function J(N,re){const{instance:ce,context:Me}=Z(N).current;return Xe.useImperativeHandle(re,()=>ce),N.children==null?null:Hd.createElement(jp,{value:Me},N.children)}return Xe.forwardRef(J)}function L_(Z){function J(N,re){const{instance:ce}=Z(N).current;return Xe.useImperativeHandle(re,()=>ce),null}return Xe.forwardRef(J)}function Vp(Z,J){const N=Xe.useRef();Xe.useEffect(function(){return J!=null&&Z.instance.on(J),N.current=J,function(){N.current!=null&&Z.instance.off(N.current),N.current=null}},[Z,J])}function jf(Z,J){const N=Z.pane??J.pane;return N?{...Z,pane:N}:Z}var Xh={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var D_=Xh.exports,vp;function R_(){return vp||(vp=1,function(Z,J){(function(N,re){re(J)})(D_,function(N){var re="1.9.4";function ce(s){var d,v,P,A;for(v=1,P=arguments.length;v<P;v++){A=arguments[v];for(d in A)s[d]=A[d]}return s}var Me=Object.create||function(){function s(){}return function(d){return s.prototype=d,new s}}();function O(s,d){var v=Array.prototype.slice;if(s.bind)return s.bind.apply(s,v.call(arguments,1));var P=v.call(arguments,2);return function(){return s.apply(d,P.length?P.concat(v.call(arguments)):arguments)}}var g=0;function ze(s){return"_leaflet_id"in s||(s._leaflet_id=++g),s._leaflet_id}function nt(s,d,v){var P,A,G,ue;return ue=function(){P=!1,A&&(G.apply(v,A),A=!1)},G=function(){P?A=arguments:(s.apply(v,arguments),setTimeout(ue,d),P=!0)},G}function tt(s,d,v){var P=d[1],A=d[0],G=P-A;return s===P&&v?s:((s-A)%G+G)%G+A}function xe(){return!1}function me(s,d){if(d===!1)return s;var v=Math.pow(10,d===void 0?6:d);return Math.round(s*v)/v}function Ot(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function st(s){return Ot(s).split(/\s+/)}function Ue(s,d){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?Me(s.options):{});for(var v in d)s.options[v]=d[v];return s.options}function Je(s,d,v){var P=[];for(var A in s)P.push(encodeURIComponent(v?A.toUpperCase():A)+"="+encodeURIComponent(s[A]));return(!d||d.indexOf("?")===-1?"?":"&")+P.join("&")}var $t=/\{ *([\w_ -]+) *\}/g;function Qt(s,d){return s.replace($t,function(v,P){var A=d[P];if(A===void 0)throw new Error("No value provided for variable "+v);return typeof A=="function"&&(A=A(d)),A})}var Mt=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function hi(s,d){for(var v=0;v<s.length;v++)if(s[v]===d)return v;return-1}var li="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Ii(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var _i=0;function nn(s){var d=+new Date,v=Math.max(0,16-(d-_i));return _i=d+v,window.setTimeout(s,v)}var an=window.requestAnimationFrame||Ii("RequestAnimationFrame")||nn,Zn=window.cancelAnimationFrame||Ii("CancelAnimationFrame")||Ii("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function qt(s,d,v){if(v&&an===nn)s.call(d);else return an.call(window,O(s,d))}function Hi(s){s&&Zn.call(window,s)}var Di={__proto__:null,extend:ce,create:Me,bind:O,get lastId(){return g},stamp:ze,throttle:nt,wrapNum:tt,falseFn:xe,formatNum:me,trim:Ot,splitWords:st,setOptions:Ue,getParamString:Je,template:Qt,isArray:Mt,indexOf:hi,emptyImageUrl:li,requestFn:an,cancelFn:Zn,requestAnimFrame:qt,cancelAnimFrame:Hi};function xi(){}xi.extend=function(s){var d=function(){Ue(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},v=d.__super__=this.prototype,P=Me(v);P.constructor=d,d.prototype=P;for(var A in this)Object.prototype.hasOwnProperty.call(this,A)&&A!=="prototype"&&A!=="__super__"&&(d[A]=this[A]);return s.statics&&ce(d,s.statics),s.includes&&(Bn(s.includes),ce.apply(null,[P].concat(s.includes))),ce(P,s),delete P.statics,delete P.includes,P.options&&(P.options=v.options?Me(v.options):{},ce(P.options,s.options)),P._initHooks=[],P.callInitHooks=function(){if(!this._initHooksCalled){v.callInitHooks&&v.callInitHooks.call(this),this._initHooksCalled=!0;for(var G=0,ue=P._initHooks.length;G<ue;G++)P._initHooks[G].call(this)}},d},xi.include=function(s){var d=this.prototype.options;return ce(this.prototype,s),s.options&&(this.prototype.options=d,this.mergeOptions(s.options)),this},xi.mergeOptions=function(s){return ce(this.prototype.options,s),this},xi.addInitHook=function(s){var d=Array.prototype.slice.call(arguments,1),v=typeof s=="function"?s:function(){this[s].apply(this,d)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(v),this};function Bn(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=Mt(s)?s:[s];for(var d=0;d<s.length;d++)s[d]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Bi={on:function(s,d,v){if(typeof s=="object")for(var P in s)this._on(P,s[P],d);else{s=st(s);for(var A=0,G=s.length;A<G;A++)this._on(s[A],d,v)}return this},off:function(s,d,v){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var P in s)this._off(P,s[P],d);else{s=st(s);for(var A=arguments.length===1,G=0,ue=s.length;G<ue;G++)A?this._off(s[G]):this._off(s[G],d,v)}return this},_on:function(s,d,v,P){if(typeof d!="function"){console.warn("wrong listener type: "+typeof d);return}if(this._listens(s,d,v)===!1){v===this&&(v=void 0);var A={fn:d,ctx:v};P&&(A.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(A)}},_off:function(s,d,v){var P,A,G;if(this._events&&(P=this._events[s],!!P)){if(arguments.length===1){if(this._firingCount)for(A=0,G=P.length;A<G;A++)P[A].fn=xe;delete this._events[s];return}if(typeof d!="function"){console.warn("wrong listener type: "+typeof d);return}var ue=this._listens(s,d,v);if(ue!==!1){var Pe=P[ue];this._firingCount&&(Pe.fn=xe,this._events[s]=P=P.slice()),P.splice(ue,1)}}},fire:function(s,d,v){if(!this.listens(s,v))return this;var P=ce({},d,{type:s,target:this,sourceTarget:d&&d.sourceTarget||this});if(this._events){var A=this._events[s];if(A){this._firingCount=this._firingCount+1||1;for(var G=0,ue=A.length;G<ue;G++){var Pe=A[G],Re=Pe.fn;Pe.once&&this.off(s,Re,Pe.ctx),Re.call(Pe.ctx||this,P)}this._firingCount--}}return v&&this._propagateEvent(P),this},listens:function(s,d,v,P){typeof s!="string"&&console.warn('"string" type argument expected');var A=d;typeof d!="function"&&(P=!!d,A=void 0,v=void 0);var G=this._events&&this._events[s];if(G&&G.length&&this._listens(s,A,v)!==!1)return!0;if(P){for(var ue in this._eventParents)if(this._eventParents[ue].listens(s,d,v,P))return!0}return!1},_listens:function(s,d,v){if(!this._events)return!1;var P=this._events[s]||[];if(!d)return!!P.length;v===this&&(v=void 0);for(var A=0,G=P.length;A<G;A++)if(P[A].fn===d&&P[A].ctx===v)return A;return!1},once:function(s,d,v){if(typeof s=="object")for(var P in s)this._on(P,s[P],d,!0);else{s=st(s);for(var A=0,G=s.length;A<G;A++)this._on(s[A],d,v,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[ze(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[ze(s)],this},_propagateEvent:function(s){for(var d in this._eventParents)this._eventParents[d].fire(s.type,ce({layer:s.target,propagatedFrom:s.target},s),!0)}};Bi.addEventListener=Bi.on,Bi.removeEventListener=Bi.clearAllEventListeners=Bi.off,Bi.addOneTimeEventListener=Bi.once,Bi.fireEvent=Bi.fire,Bi.hasEventListeners=Bi.listens;var Ei=xi.extend(Bi);function qe(s,d,v){this.x=v?Math.round(s):s,this.y=v?Math.round(d):d}var Nt=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};qe.prototype={clone:function(){return new qe(this.x,this.y)},add:function(s){return this.clone()._add(He(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(He(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new qe(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new qe(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Nt(this.x),this.y=Nt(this.y),this},distanceTo:function(s){s=He(s);var d=s.x-this.x,v=s.y-this.y;return Math.sqrt(d*d+v*v)},equals:function(s){return s=He(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=He(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+me(this.x)+", "+me(this.y)+")"}};function He(s,d,v){return s instanceof qe?s:Mt(s)?new qe(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new qe(s.x,s.y):new qe(s,d,v)}function ge(s,d){if(s)for(var v=d?[s,d]:s,P=0,A=v.length;P<A;P++)this.extend(v[P])}ge.prototype={extend:function(s){var d,v;if(!s)return this;if(s instanceof qe||typeof s[0]=="number"||"x"in s)d=v=He(s);else if(s=Ne(s),d=s.min,v=s.max,!d||!v)return this;return!this.min&&!this.max?(this.min=d.clone(),this.max=v.clone()):(this.min.x=Math.min(d.x,this.min.x),this.max.x=Math.max(v.x,this.max.x),this.min.y=Math.min(d.y,this.min.y),this.max.y=Math.max(v.y,this.max.y)),this},getCenter:function(s){return He((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return He(this.min.x,this.max.y)},getTopRight:function(){return He(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var d,v;return typeof s[0]=="number"||s instanceof qe?s=He(s):s=Ne(s),s instanceof ge?(d=s.min,v=s.max):d=v=s,d.x>=this.min.x&&v.x<=this.max.x&&d.y>=this.min.y&&v.y<=this.max.y},intersects:function(s){s=Ne(s);var d=this.min,v=this.max,P=s.min,A=s.max,G=A.x>=d.x&&P.x<=v.x,ue=A.y>=d.y&&P.y<=v.y;return G&&ue},overlaps:function(s){s=Ne(s);var d=this.min,v=this.max,P=s.min,A=s.max,G=A.x>d.x&&P.x<v.x,ue=A.y>d.y&&P.y<v.y;return G&&ue},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var d=this.min,v=this.max,P=Math.abs(d.x-v.x)*s,A=Math.abs(d.y-v.y)*s;return Ne(He(d.x-P,d.y-A),He(v.x+P,v.y+A))},equals:function(s){return s?(s=Ne(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function Ne(s,d){return!s||s instanceof ge?s:new ge(s,d)}function Ft(s,d){if(s)for(var v=d?[s,d]:s,P=0,A=v.length;P<A;P++)this.extend(v[P])}Ft.prototype={extend:function(s){var d=this._southWest,v=this._northEast,P,A;if(s instanceof Tt)P=s,A=s;else if(s instanceof Ft){if(P=s._southWest,A=s._northEast,!P||!A)return this}else return s?this.extend(wt(s)||It(s)):this;return!d&&!v?(this._southWest=new Tt(P.lat,P.lng),this._northEast=new Tt(A.lat,A.lng)):(d.lat=Math.min(P.lat,d.lat),d.lng=Math.min(P.lng,d.lng),v.lat=Math.max(A.lat,v.lat),v.lng=Math.max(A.lng,v.lng)),this},pad:function(s){var d=this._southWest,v=this._northEast,P=Math.abs(d.lat-v.lat)*s,A=Math.abs(d.lng-v.lng)*s;return new Ft(new Tt(d.lat-P,d.lng-A),new Tt(v.lat+P,v.lng+A))},getCenter:function(){return new Tt((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Tt(this.getNorth(),this.getWest())},getSouthEast:function(){return new Tt(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof Tt||"lat"in s?s=wt(s):s=It(s);var d=this._southWest,v=this._northEast,P,A;return s instanceof Ft?(P=s.getSouthWest(),A=s.getNorthEast()):P=A=s,P.lat>=d.lat&&A.lat<=v.lat&&P.lng>=d.lng&&A.lng<=v.lng},intersects:function(s){s=It(s);var d=this._southWest,v=this._northEast,P=s.getSouthWest(),A=s.getNorthEast(),G=A.lat>=d.lat&&P.lat<=v.lat,ue=A.lng>=d.lng&&P.lng<=v.lng;return G&&ue},overlaps:function(s){s=It(s);var d=this._southWest,v=this._northEast,P=s.getSouthWest(),A=s.getNorthEast(),G=A.lat>d.lat&&P.lat<v.lat,ue=A.lng>d.lng&&P.lng<v.lng;return G&&ue},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,d){return s?(s=It(s),this._southWest.equals(s.getSouthWest(),d)&&this._northEast.equals(s.getNorthEast(),d)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function It(s,d){return s instanceof Ft?s:new Ft(s,d)}function Tt(s,d,v){if(isNaN(s)||isNaN(d))throw new Error("Invalid LatLng object: ("+s+", "+d+")");this.lat=+s,this.lng=+d,v!==void 0&&(this.alt=+v)}Tt.prototype={equals:function(s,d){if(!s)return!1;s=wt(s);var v=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return v<=(d===void 0?1e-9:d)},toString:function(s){return"LatLng("+me(this.lat,s)+", "+me(this.lng,s)+")"},distanceTo:function(s){return ni.distance(this,wt(s))},wrap:function(){return ni.wrapLatLng(this)},toBounds:function(s){var d=180*s/40075017,v=d/Math.cos(Math.PI/180*this.lat);return It([this.lat-d,this.lng-v],[this.lat+d,this.lng+v])},clone:function(){return new Tt(this.lat,this.lng,this.alt)}};function wt(s,d,v){return s instanceof Tt?s:Mt(s)&&typeof s[0]!="object"?s.length===3?new Tt(s[0],s[1],s[2]):s.length===2?new Tt(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new Tt(s.lat,"lng"in s?s.lng:s.lon,s.alt):d===void 0?null:new Tt(s,d,v)}var ii={latLngToPoint:function(s,d){var v=this.projection.project(s),P=this.scale(d);return this.transformation._transform(v,P)},pointToLatLng:function(s,d){var v=this.scale(d),P=this.transformation.untransform(s,v);return this.projection.unproject(P)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var d=this.projection.bounds,v=this.scale(s),P=this.transformation.transform(d.min,v),A=this.transformation.transform(d.max,v);return new ge(P,A)},infinite:!1,wrapLatLng:function(s){var d=this.wrapLng?tt(s.lng,this.wrapLng,!0):s.lng,v=this.wrapLat?tt(s.lat,this.wrapLat,!0):s.lat,P=s.alt;return new Tt(v,d,P)},wrapLatLngBounds:function(s){var d=s.getCenter(),v=this.wrapLatLng(d),P=d.lat-v.lat,A=d.lng-v.lng;if(P===0&&A===0)return s;var G=s.getSouthWest(),ue=s.getNorthEast(),Pe=new Tt(G.lat-P,G.lng-A),Re=new Tt(ue.lat-P,ue.lng-A);return new Ft(Pe,Re)}},ni=ce({},ii,{wrapLng:[-180,180],R:6371e3,distance:function(s,d){var v=Math.PI/180,P=s.lat*v,A=d.lat*v,G=Math.sin((d.lat-s.lat)*v/2),ue=Math.sin((d.lng-s.lng)*v/2),Pe=G*G+Math.cos(P)*Math.cos(A)*ue*ue,Re=2*Math.atan2(Math.sqrt(Pe),Math.sqrt(1-Pe));return this.R*Re}}),Oi=6378137,wn={R:Oi,MAX_LATITUDE:85.0511287798,project:function(s){var d=Math.PI/180,v=this.MAX_LATITUDE,P=Math.max(Math.min(v,s.lat),-v),A=Math.sin(P*d);return new qe(this.R*s.lng*d,this.R*Math.log((1+A)/(1-A))/2)},unproject:function(s){var d=180/Math.PI;return new Tt((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*d,s.x*d/this.R)},bounds:function(){var s=Oi*Math.PI;return new ge([-s,-s],[s,s])}()};function js(s,d,v,P){if(Mt(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=d,this._c=v,this._d=P}js.prototype={transform:function(s,d){return this._transform(s.clone(),d)},_transform:function(s,d){return d=d||1,s.x=d*(this._a*s.x+this._b),s.y=d*(this._c*s.y+this._d),s},untransform:function(s,d){return d=d||1,new qe((s.x/d-this._b)/this._a,(s.y/d-this._d)/this._c)}};function wr(s,d,v,P){return new js(s,d,v,P)}var Fr=ce({},ni,{code:"EPSG:3857",projection:wn,transformation:function(){var s=.5/(Math.PI*wn.R);return wr(s,.5,-s,.5)}()}),Vs=ce({},Fr,{code:"EPSG:900913"});function Bo(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function Le(s,d){var v="",P,A,G,ue,Pe,Re;for(P=0,G=s.length;P<G;P++){for(Pe=s[P],A=0,ue=Pe.length;A<ue;A++)Re=Pe[A],v+=(A?"L":"M")+Re.x+" "+Re.y;v+=d?De.svg?"z":"x":""}return v||"M0 0"}var ps=document.documentElement.style,uo="ActiveXObject"in window,Mi=uo&&!document.addEventListener,$i="msLaunchUri"in navigator&&!("documentMode"in document),Kr=Ie("webkit"),ms=Ie("android"),_s=Ie("android 2")||Ie("android 3"),ra=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Nr=ms&&Ie("Google")&&ra<537&&!("AudioNode"in window),Oo=!!window.opera,Fo=!$i&&Ie("chrome"),Qe=Ie("gecko")&&!Kr&&!Oo&&!uo,gs=!Fo&&Ie("safari"),Tn=Ie("phantom"),ur="OTransition"in ps,No=navigator.platform.indexOf("Win")===0,ot=uo&&"transition"in ps,ri="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!_s,Ut="MozPerspective"in ps,tr=!window.L_DISABLE_3D&&(ot||ri||Ut)&&!ur&&!Tn,$n=typeof orientation<"u"||Ie("mobile"),Wt=$n&&Kr,Jr=$n&&ri,Yr=!window.PointerEvent&&window.MSPointerEvent,br=!!(window.PointerEvent||Yr),ir="ontouchstart"in window||!!window.TouchEvent,se=!window.L_NO_TOUCH&&(ir||br),V=$n&&Oo,j=$n&&Qe,W=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,te=function(){var s=!1;try{var d=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",xe,d),window.removeEventListener("testPassiveEventSupport",xe,d)}catch{}return s}(),fe=function(){return!!document.createElement("canvas").getContext}(),ve=!!(document.createElementNS&&Bo("svg").createSVGRect),Se=!!ve&&function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),he=!ve&&function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var d=s.firstChild;return d.style.behavior="url(#default#VML)",d&&typeof d.adj=="object"}catch{return!1}}(),Be=navigator.platform.indexOf("Mac")===0,Ze=navigator.platform.indexOf("Linux")===0;function Ie(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var De={ie:uo,ielt9:Mi,edge:$i,webkit:Kr,android:ms,android23:_s,androidStock:Nr,opera:Oo,chrome:Fo,gecko:Qe,safari:gs,phantom:Tn,opera12:ur,win:No,ie3d:ot,webkit3d:ri,gecko3d:Ut,any3d:tr,mobile:$n,mobileWebkit:Wt,mobileWebkit3d:Jr,msPointer:Yr,pointer:br,touch:se,touchNative:ir,mobileOpera:V,mobileGecko:j,retina:W,passiveEvents:te,canvas:fe,svg:ve,vml:he,inlineSvg:Se,mac:Be,linux:Ze},Pt=De.msPointer?"MSPointerDown":"pointerdown",zt=De.msPointer?"MSPointerMove":"pointermove",ki=De.msPointer?"MSPointerUp":"pointerup",ei=De.msPointer?"MSPointerCancel":"pointercancel",bi={touchstart:Pt,touchmove:zt,touchend:ki,touchcancel:ei},si={touchstart:Xt,touchmove:co,touchend:co,touchcancel:co},Xi={},rn=!1;function fi(s,d,v){return d==="touchstart"&&cr(),si[d]?(v=si[d].bind(this,v),s.addEventListener(bi[d],v,!1),v):(console.warn("wrong event specified:",d),xe)}function Fi(s,d,v){if(!bi[d]){console.warn("wrong event specified:",d);return}s.removeEventListener(bi[d],v,!1)}function Ki(s){Xi[s.pointerId]=s}function En(s){Xi[s.pointerId]&&(Xi[s.pointerId]=s)}function Mn(s){delete Xi[s.pointerId]}function cr(){rn||(document.addEventListener(Pt,Ki,!0),document.addEventListener(zt,En,!0),document.addEventListener(ki,Mn,!0),document.addEventListener(ei,Mn,!0),rn=!0)}function co(s,d){if(d.pointerType!==(d.MSPOINTER_TYPE_MOUSE||"mouse")){d.touches=[];for(var v in Xi)d.touches.push(Xi[v]);d.changedTouches=[d],s(d)}}function Xt(s,d){d.MSPOINTER_TYPE_TOUCH&&d.pointerType===d.MSPOINTER_TYPE_TOUCH&&_n(d),co(s,d)}function Kl(s){var d={},v,P;for(P in s)v=s[P],d[P]=v&&v.bind?v.bind(s):v;return s=d,d.type="dblclick",d.detail=2,d.isTrusted=!1,d._simulated=!0,d}var Ha=200;function Sr(s,d){s.addEventListener("dblclick",d);var v=0,P;function A(G){if(G.detail!==1){P=G.detail;return}if(!(G.pointerType==="mouse"||G.sourceCapabilities&&!G.sourceCapabilities.firesTouchEvents)){var ue=mo(G);if(!(ue.some(function(Re){return Re instanceof HTMLLabelElement&&Re.attributes.for})&&!ue.some(function(Re){return Re instanceof HTMLInputElement||Re instanceof HTMLSelectElement}))){var Pe=Date.now();Pe-v<=Ha?(P++,P===2&&d(Kl(G))):P=1,v=Pe}}}return s.addEventListener("click",A),{dblclick:d,simDblclick:A}}function nr(s,d){s.removeEventListener("dblclick",d.dblclick),s.removeEventListener("click",d.simDblclick)}var Jl=wi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),qn=wi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Hn=qn==="webkitTransition"||qn==="OTransition"?qn+"End":"transitionend";function rr(s){return typeof s=="string"?document.getElementById(s):s}function ys(s,d){var v=s.style[d]||s.currentStyle&&s.currentStyle[d];if((!v||v==="auto")&&document.defaultView){var P=document.defaultView.getComputedStyle(s,null);v=P?P[d]:null}return v==="auto"?null:v}function Lt(s,d,v){var P=document.createElement(s);return P.className=d||"",v&&v.appendChild(P),P}function Gi(s){var d=s.parentNode;d&&d.removeChild(s)}function Tr(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function Ji(s){var d=s.parentNode;d&&d.lastChild!==s&&d.appendChild(s)}function Qr(s){var d=s.parentNode;d&&d.firstChild!==s&&d.insertBefore(s,d.firstChild)}function sr(s,d){if(s.classList!==void 0)return s.classList.contains(d);var v=sa(s);return v.length>0&&new RegExp("(^|\\s)"+d+"(\\s|$)").test(v)}function oi(s,d){if(s.classList!==void 0)for(var v=st(d),P=0,A=v.length;P<A;P++)s.classList.add(v[P]);else if(!sr(s,d)){var G=sa(s);Yl(s,(G?G+" ":"")+d)}}function Ai(s,d){s.classList!==void 0?s.classList.remove(d):Yl(s,Ot((" "+sa(s)+" ").replace(" "+d+" "," ")))}function Yl(s,d){s.className.baseVal===void 0?s.className=d:s.className.baseVal=d}function sa(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function Pn(s,d){"opacity"in s.style?s.style.opacity=d:"filter"in s.style&&ho(s,d)}function ho(s,d){var v=!1,P="DXImageTransform.Microsoft.Alpha";try{v=s.filters.item(P)}catch{if(d===1)return}d=Math.round(d*100),v?(v.Enabled=d!==100,v.Opacity=d):s.style.filter+=" progid:"+P+"(opacity="+d+")"}function wi(s){for(var d=document.documentElement.style,v=0;v<s.length;v++)if(s[v]in d)return s[v];return!1}function jr(s,d,v){var P=d||new qe(0,0);s.style[Jl]=(De.ie3d?"translate("+P.x+"px,"+P.y+"px)":"translate3d("+P.x+"px,"+P.y+"px,0)")+(v?" scale("+v+")":"")}function mn(s,d){s._leaflet_pos=d,De.any3d?jr(s,d):(s.style.left=d.x+"px",s.style.top=d.y+"px")}function Pr(s){return s._leaflet_pos||new qe(0,0)}var zi,fo,jo;if("onselectstart"in document)zi=function(){Jt(window,"selectstart",_n)},fo=function(){Ui(window,"selectstart",_n)};else{var Us=wi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);zi=function(){if(Us){var s=document.documentElement.style;jo=s[Us],s[Us]="none"}},fo=function(){Us&&(document.documentElement.style[Us]=jo,jo=void 0)}}function po(){Jt(window,"dragstart",_n)}function Ga(){Ui(window,"dragstart",_n)}var Wa,Ia;function Ea(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(Gn(),Wa=s,Ia=s.style.outlineStyle,s.style.outlineStyle="none",Jt(window,"keydown",Gn))}function Gn(){Wa&&(Wa.style.outlineStyle=Ia,Wa=void 0,Ia=void 0,Ui(window,"keydown",Gn))}function Vr(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function dn(s){var d=s.getBoundingClientRect();return{x:d.width/s.offsetWidth||1,y:d.height/s.offsetHeight||1,boundingClientRect:d}}var On={__proto__:null,TRANSFORM:Jl,TRANSITION:qn,TRANSITION_END:Hn,get:rr,getStyle:ys,create:Lt,remove:Gi,empty:Tr,toFront:Ji,toBack:Qr,hasClass:sr,addClass:oi,removeClass:Ai,setClass:Yl,getClass:sa,setOpacity:Pn,testProp:wi,setTransform:jr,setPosition:mn,getPosition:Pr,get disableTextSelection(){return zi},get enableTextSelection(){return fo},disableImageDrag:po,enableImageDrag:Ga,preventOutline:Ea,restoreOutline:Gn,getSizedParentNode:Vr,getScale:dn};function Jt(s,d,v,P){if(d&&typeof d=="object")for(var A in d)Ql(s,A,d[A],v);else{d=st(d);for(var G=0,ue=d.length;G<ue;G++)Ql(s,d[G],v,P)}return this}var kn="_leaflet_events";function Ui(s,d,v,P){if(arguments.length===1)_l(s),delete s[kn];else if(d&&typeof d=="object")for(var A in d)Xa(s,A,d[A],v);else if(d=st(d),arguments.length===2)_l(s,function(Pe){return hi(d,Pe)!==-1});else for(var G=0,ue=d.length;G<ue;G++)Xa(s,d[G],v,P);return this}function _l(s,d){for(var v in s[kn]){var P=v.split(/\d/)[0];(!d||d(P))&&Xa(s,P,null,null,v)}}var es={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ql(s,d,v,P){var A=d+ze(v)+(P?"_"+ze(P):"");if(s[kn]&&s[kn][A])return this;var G=function(Pe){return v.call(P||s,Pe||window.event)},ue=G;!De.touchNative&&De.pointer&&d.indexOf("touch")===0?G=fi(s,d,G):De.touch&&d==="dblclick"?G=Sr(s,G):"addEventListener"in s?d==="touchstart"||d==="touchmove"||d==="wheel"||d==="mousewheel"?s.addEventListener(es[d]||d,G,De.passiveEvents?{passive:!1}:!1):d==="mouseenter"||d==="mouseleave"?(G=function(Pe){Pe=Pe||window.event,kr(s,Pe)&&ue(Pe)},s.addEventListener(es[d],G,!1)):s.addEventListener(d,ue,!1):s.attachEvent("on"+d,G),s[kn]=s[kn]||{},s[kn][A]=G}function Xa(s,d,v,P,A){A=A||d+ze(v)+(P?"_"+ze(P):"");var G=s[kn]&&s[kn][A];if(!G)return this;!De.touchNative&&De.pointer&&d.indexOf("touch")===0?Fi(s,d,G):De.touch&&d==="dblclick"?nr(s,G):"removeEventListener"in s?s.removeEventListener(es[d]||d,G,!1):s.detachEvent("on"+d,G),s[kn][A]=null}function vs(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function gl(s){return Ql(s,"wheel",vs),this}function Ka(s){return Jt(s,"mousedown touchstart dblclick contextmenu",vs),s._leaflet_disable_click=!0,this}function _n(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function hr(s){return _n(s),vs(s),this}function mo(s){if(s.composedPath)return s.composedPath();for(var d=[],v=s.target;v;)d.push(v),v=v.parentNode;return d}function Vo(s,d){if(!d)return new qe(s.clientX,s.clientY);var v=dn(d),P=v.boundingClientRect;return new qe((s.clientX-P.left)/v.x-d.clientLeft,(s.clientY-P.top)/v.y-d.clientTop)}var eu=De.linux&&De.chrome?window.devicePixelRatio:De.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function yl(s){return De.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/eu:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function kr(s,d){var v=d.relatedTarget;if(!v)return!0;try{for(;v&&v!==s;)v=v.parentNode}catch{return!1}return v!==s}var vl={__proto__:null,on:Jt,off:Ui,stopPropagation:vs,disableScrollPropagation:gl,disableClickPropagation:Ka,preventDefault:_n,stop:hr,getPropagationPath:mo,getMousePosition:Vo,getWheelDelta:yl,isExternalTarget:kr,addListener:Jt,removeListener:Ui},Ma=Ei.extend({run:function(s,d,v,P){this.stop(),this._el=s,this._inProgress=!0,this._duration=v||.25,this._easeOutPower=1/Math.max(P||.5,.2),this._startPos=Pr(s),this._offset=d.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=qt(this._animate,this),this._step()},_step:function(s){var d=+new Date-this._startTime,v=this._duration*1e3;d<v?this._runFrame(this._easeOut(d/v),s):(this._runFrame(1),this._complete())},_runFrame:function(s,d){var v=this._startPos.add(this._offset.multiplyBy(s));d&&v._round(),mn(this._el,v),this.fire("step")},_complete:function(){Hi(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),gi=Ei.extend({options:{crs:Fr,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,d){d=Ue(this,d),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=O(this._onResize,this),this._initEvents(),d.maxBounds&&this.setMaxBounds(d.maxBounds),d.zoom!==void 0&&(this._zoom=this._limitZoom(d.zoom)),d.center&&d.zoom!==void 0&&this.setView(wt(d.center),d.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=qn&&De.any3d&&!De.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Jt(this._proxy,Hn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,d,v){if(d=d===void 0?this._zoom:this._limitZoom(d),s=this._limitCenter(wt(s),d,this.options.maxBounds),v=v||{},this._stop(),this._loaded&&!v.reset&&v!==!0){v.animate!==void 0&&(v.zoom=ce({animate:v.animate},v.zoom),v.pan=ce({animate:v.animate,duration:v.duration},v.pan));var P=this._zoom!==d?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,d,v.zoom):this._tryAnimatedPan(s,v.pan);if(P)return clearTimeout(this._sizeTimer),this}return this._resetView(s,d,v.pan&&v.pan.noMoveStart),this},setZoom:function(s,d){return this._loaded?this.setView(this.getCenter(),s,{zoom:d}):(this._zoom=s,this)},zoomIn:function(s,d){return s=s||(De.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,d)},zoomOut:function(s,d){return s=s||(De.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,d)},setZoomAround:function(s,d,v){var P=this.getZoomScale(d),A=this.getSize().divideBy(2),G=s instanceof qe?s:this.latLngToContainerPoint(s),ue=G.subtract(A).multiplyBy(1-1/P),Pe=this.containerPointToLatLng(A.add(ue));return this.setView(Pe,d,{zoom:v})},_getBoundsCenterZoom:function(s,d){d=d||{},s=s.getBounds?s.getBounds():It(s);var v=He(d.paddingTopLeft||d.padding||[0,0]),P=He(d.paddingBottomRight||d.padding||[0,0]),A=this.getBoundsZoom(s,!1,v.add(P));if(A=typeof d.maxZoom=="number"?Math.min(d.maxZoom,A):A,A===1/0)return{center:s.getCenter(),zoom:A};var G=P.subtract(v).divideBy(2),ue=this.project(s.getSouthWest(),A),Pe=this.project(s.getNorthEast(),A),Re=this.unproject(ue.add(Pe).divideBy(2).add(G),A);return{center:Re,zoom:A}},fitBounds:function(s,d){if(s=It(s),!s.isValid())throw new Error("Bounds are not valid.");var v=this._getBoundsCenterZoom(s,d);return this.setView(v.center,v.zoom,d)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,d){return this.setView(s,this._zoom,{pan:d})},panBy:function(s,d){if(s=He(s).round(),d=d||{},!s.x&&!s.y)return this.fire("moveend");if(d.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ma,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),d.noMoveStart||this.fire("movestart"),d.animate!==!1){oi(this._mapPane,"leaflet-pan-anim");var v=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,v,d.duration||.25,d.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,d,v){if(v=v||{},v.animate===!1||!De.any3d)return this.setView(s,d,v);this._stop();var P=this.project(this.getCenter()),A=this.project(s),G=this.getSize(),ue=this._zoom;s=wt(s),d=d===void 0?ue:d;var Pe=Math.max(G.x,G.y),Re=Pe*this.getZoomScale(ue,d),$e=A.distanceTo(P)||1,ft=1.42,Ht=ft*ft;function yi(Ni){var di=Ni?-1:1,du=Ni?Re:Pe,Yu=Re*Re-Pe*Pe+di*Ht*Ht*$e*$e,To=2*du*Ht*$e,_a=Yu/To,rs=Math.sqrt(_a*_a+1)-_a,ll=rs<1e-9?-18:Math.log(rs);return ll}function jn(Ni){return(Math.exp(Ni)-Math.exp(-Ni))/2}function zn(Ni){return(Math.exp(Ni)+Math.exp(-Ni))/2}function pr(Ni){return jn(Ni)/zn(Ni)}var An=yi(0);function Xn(Ni){return Pe*(zn(An)/zn(An+ft*Ni))}function gt(Ni){return Pe*(zn(An)*pr(An+ft*Ni)-jn(An))/Ht}function Is(Ni){return 1-Math.pow(1-Ni,1.5)}var Il=Date.now(),Jo=(yi(1)-An)/ft,mr=v.duration?1e3*v.duration:1e3*Jo*.8;function Es(){var Ni=(Date.now()-Il)/mr,di=Is(Ni)*Jo;Ni<=1?(this._flyToFrame=qt(Es,this),this._move(this.unproject(P.add(A.subtract(P).multiplyBy(gt(di)/$e)),ue),this.getScaleZoom(Pe/Xn(di),ue),{flyTo:!0})):this._move(s,d)._moveEnd(!0)}return this._moveStart(!0,v.noMoveStart),Es.call(this),this},flyToBounds:function(s,d){var v=this._getBoundsCenterZoom(s,d);return this.flyTo(v.center,v.zoom,d)},setMaxBounds:function(s){return s=It(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var d=this.options.minZoom;return this.options.minZoom=s,this._loaded&&d!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var d=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&d!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,d){this._enforcingBounds=!0;var v=this.getCenter(),P=this._limitCenter(v,this._zoom,It(s));return v.equals(P)||this.panTo(P,d),this._enforcingBounds=!1,this},panInside:function(s,d){d=d||{};var v=He(d.paddingTopLeft||d.padding||[0,0]),P=He(d.paddingBottomRight||d.padding||[0,0]),A=this.project(this.getCenter()),G=this.project(s),ue=this.getPixelBounds(),Pe=Ne([ue.min.add(v),ue.max.subtract(P)]),Re=Pe.getSize();if(!Pe.contains(G)){this._enforcingBounds=!0;var $e=G.subtract(Pe.getCenter()),ft=Pe.extend(G).getSize().subtract(Re);A.x+=$e.x<0?-ft.x:ft.x,A.y+=$e.y<0?-ft.y:ft.y,this.panTo(this.unproject(A),d),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=ce({animate:!1,pan:!0},s===!0?{animate:!0}:s);var d=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var v=this.getSize(),P=d.divideBy(2).round(),A=v.divideBy(2).round(),G=P.subtract(A);return!G.x&&!G.y?this:(s.animate&&s.pan?this.panBy(G):(s.pan&&this._rawPanBy(G),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(O(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:d,newSize:v}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=ce({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var d=O(this._handleGeolocationResponse,this),v=O(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(d,v,s):navigator.geolocation.getCurrentPosition(d,v,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var d=s.code,v=s.message||(d===1?"permission denied":d===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:d,message:"Geolocation error: "+v+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var d=s.coords.latitude,v=s.coords.longitude,P=new Tt(d,v),A=P.toBounds(s.coords.accuracy*2),G=this._locateOptions;if(G.setView){var ue=this.getBoundsZoom(A);this.setView(P,G.maxZoom?Math.min(ue,G.maxZoom):ue)}var Pe={latlng:P,bounds:A,timestamp:s.timestamp};for(var Re in s.coords)typeof s.coords[Re]=="number"&&(Pe[Re]=s.coords[Re]);this.fire("locationfound",Pe)}},addHandler:function(s,d){if(!d)return this;var v=this[s]=new d(this);return this._handlers.push(v),this.options[s]&&v.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Gi(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Hi(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)Gi(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,d){var v="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),P=Lt("div",v,d||this._mapPane);return s&&(this._panes[s]=P),P},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),d=this.unproject(s.getBottomLeft()),v=this.unproject(s.getTopRight());return new Ft(d,v)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,d,v){s=It(s),v=He(v||[0,0]);var P=this.getZoom()||0,A=this.getMinZoom(),G=this.getMaxZoom(),ue=s.getNorthWest(),Pe=s.getSouthEast(),Re=this.getSize().subtract(v),$e=Ne(this.project(Pe,P),this.project(ue,P)).getSize(),ft=De.any3d?this.options.zoomSnap:1,Ht=Re.x/$e.x,yi=Re.y/$e.y,jn=d?Math.max(Ht,yi):Math.min(Ht,yi);return P=this.getScaleZoom(jn,P),ft&&(P=Math.round(P/(ft/100))*(ft/100),P=d?Math.ceil(P/ft)*ft:Math.floor(P/ft)*ft),Math.max(A,Math.min(G,P))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new qe(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,d){var v=this._getTopLeftPoint(s,d);return new ge(v,v.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,d){var v=this.options.crs;return d=d===void 0?this._zoom:d,v.scale(s)/v.scale(d)},getScaleZoom:function(s,d){var v=this.options.crs;d=d===void 0?this._zoom:d;var P=v.zoom(s*v.scale(d));return isNaN(P)?1/0:P},project:function(s,d){return d=d===void 0?this._zoom:d,this.options.crs.latLngToPoint(wt(s),d)},unproject:function(s,d){return d=d===void 0?this._zoom:d,this.options.crs.pointToLatLng(He(s),d)},layerPointToLatLng:function(s){var d=He(s).add(this.getPixelOrigin());return this.unproject(d)},latLngToLayerPoint:function(s){var d=this.project(wt(s))._round();return d._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(wt(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(It(s))},distance:function(s,d){return this.options.crs.distance(wt(s),wt(d))},containerPointToLayerPoint:function(s){return He(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return He(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var d=this.containerPointToLayerPoint(He(s));return this.layerPointToLatLng(d)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(wt(s)))},mouseEventToContainerPoint:function(s){return Vo(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var d=this._container=rr(s);if(d){if(d._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Jt(d,"scroll",this._onScroll,this),this._containerId=ze(d)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&De.any3d,oi(s,"leaflet-container"+(De.touch?" leaflet-touch":"")+(De.retina?" leaflet-retina":"")+(De.ielt9?" leaflet-oldie":"")+(De.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var d=ys(s,"position");d!=="absolute"&&d!=="relative"&&d!=="fixed"&&d!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),mn(this._mapPane,new qe(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(oi(s.markerPane,"leaflet-zoom-hide"),oi(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,d,v){mn(this._mapPane,new qe(0,0));var P=!this._loaded;this._loaded=!0,d=this._limitZoom(d),this.fire("viewprereset");var A=this._zoom!==d;this._moveStart(A,v)._move(s,d)._moveEnd(A),this.fire("viewreset"),P&&this.fire("load")},_moveStart:function(s,d){return s&&this.fire("zoomstart"),d||this.fire("movestart"),this},_move:function(s,d,v,P){d===void 0&&(d=this._zoom);var A=this._zoom!==d;return this._zoom=d,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),P?v&&v.pinch&&this.fire("zoom",v):((A||v&&v.pinch)&&this.fire("zoom",v),this.fire("move",v)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Hi(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){mn(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[ze(this._container)]=this;var d=s?Ui:Jt;d(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&d(window,"resize",this._onResize,this),De.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Hi(this._resizeRequest),this._resizeRequest=qt(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,d){for(var v=[],P,A=d==="mouseout"||d==="mouseover",G=s.target||s.srcElement,ue=!1;G;){if(P=this._targets[ze(G)],P&&(d==="click"||d==="preclick")&&this._draggableMoved(P)){ue=!0;break}if(P&&P.listens(d,!0)&&(A&&!kr(G,s)||(v.push(P),A))||G===this._container)break;G=G.parentNode}return!v.length&&!ue&&!A&&this.listens(d,!0)&&(v=[this]),v},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var d=s.target||s.srcElement;if(!(!this._loaded||d._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(d))){var v=s.type;v==="mousedown"&&Ea(d),this._fireDOMEvent(s,v)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,d,v){if(s.type==="click"){var P=ce({},s);P.type="preclick",this._fireDOMEvent(P,P.type,v)}var A=this._findEventTargets(s,d);if(v){for(var G=[],ue=0;ue<v.length;ue++)v[ue].listens(d,!0)&&G.push(v[ue]);A=G.concat(A)}if(A.length){d==="contextmenu"&&_n(s);var Pe=A[0],Re={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var $e=Pe.getLatLng&&(!Pe._radius||Pe._radius<=10);Re.containerPoint=$e?this.latLngToContainerPoint(Pe.getLatLng()):this.mouseEventToContainerPoint(s),Re.layerPoint=this.containerPointToLayerPoint(Re.containerPoint),Re.latlng=$e?Pe.getLatLng():this.layerPointToLatLng(Re.layerPoint)}for(ue=0;ue<A.length;ue++)if(A[ue].fire(d,Re,!0),Re.originalEvent._stopped||A[ue].options.bubblingMouseEvents===!1&&hi(this._mouseEvents,d)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,d=this._handlers.length;s<d;s++)this._handlers[s].disable()},whenReady:function(s,d){return this._loaded?s.call(d||this,{target:this}):this.on("load",s,d),this},_getMapPanePos:function(){return Pr(this._mapPane)||new qe(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,d){var v=s&&d!==void 0?this._getNewPixelOrigin(s,d):this.getPixelOrigin();return v.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,d){var v=this.getSize()._divideBy(2);return this.project(s,d)._subtract(v)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,d,v){var P=this._getNewPixelOrigin(v,d);return this.project(s,d)._subtract(P)},_latLngBoundsToNewLayerBounds:function(s,d,v){var P=this._getNewPixelOrigin(v,d);return Ne([this.project(s.getSouthWest(),d)._subtract(P),this.project(s.getNorthWest(),d)._subtract(P),this.project(s.getSouthEast(),d)._subtract(P),this.project(s.getNorthEast(),d)._subtract(P)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,d,v){if(!v)return s;var P=this.project(s,d),A=this.getSize().divideBy(2),G=new ge(P.subtract(A),P.add(A)),ue=this._getBoundsOffset(G,v,d);return Math.abs(ue.x)<=1&&Math.abs(ue.y)<=1?s:this.unproject(P.add(ue),d)},_limitOffset:function(s,d){if(!d)return s;var v=this.getPixelBounds(),P=new ge(v.min.add(s),v.max.add(s));return s.add(this._getBoundsOffset(P,d))},_getBoundsOffset:function(s,d,v){var P=Ne(this.project(d.getNorthEast(),v),this.project(d.getSouthWest(),v)),A=P.min.subtract(s.min),G=P.max.subtract(s.max),ue=this._rebound(A.x,-G.x),Pe=this._rebound(A.y,-G.y);return new qe(ue,Pe)},_rebound:function(s,d){return s+d>0?Math.round(s-d)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(d))},_limitZoom:function(s){var d=this.getMinZoom(),v=this.getMaxZoom(),P=De.any3d?this.options.zoomSnap:1;return P&&(s=Math.round(s/P)*P),Math.max(d,Math.min(v,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Ai(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,d){var v=this._getCenterOffset(s)._trunc();return(d&&d.animate)!==!0&&!this.getSize().contains(v)?!1:(this.panBy(v,d),!0)},_createAnimProxy:function(){var s=this._proxy=Lt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(d){var v=Jl,P=this._proxy.style[v];jr(this._proxy,this.project(d.center,d.zoom),this.getZoomScale(d.zoom,1)),P===this._proxy.style[v]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Gi(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),d=this.getZoom();jr(this._proxy,this.project(s,d),this.getZoomScale(d,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,d,v){if(this._animatingZoom)return!0;if(v=v||{},!this._zoomAnimated||v.animate===!1||this._nothingToAnimate()||Math.abs(d-this._zoom)>this.options.zoomAnimationThreshold)return!1;var P=this.getZoomScale(d),A=this._getCenterOffset(s)._divideBy(1-1/P);return v.animate!==!0&&!this.getSize().contains(A)?!1:(qt(function(){this._moveStart(!0,v.noMoveStart||!1)._animateZoom(s,d,!0)},this),!0)},_animateZoom:function(s,d,v,P){this._mapPane&&(v&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=d,oi(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:d,noUpdate:P}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(O(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Ai(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function dr(s,d){return new gi(s,d)}var ui=xi.extend({options:{position:"topright"},initialize:function(s){Ue(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var d=this._map;return d&&d.removeControl(this),this.options.position=s,d&&d.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var d=this._container=this.onAdd(s),v=this.getPosition(),P=s._controlCorners[v];return oi(d,"leaflet-control"),v.indexOf("bottom")!==-1?P.insertBefore(d,P.firstChild):P.appendChild(d),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Gi(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),xs=function(s){return new ui(s)};gi.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},d="leaflet-",v=this._controlContainer=Lt("div",d+"control-container",this._container);function P(A,G){var ue=d+A+" "+d+G;s[A+G]=Lt("div",ue,v)}P("top","left"),P("top","right"),P("bottom","left"),P("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)Gi(this._controlCorners[s]);Gi(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var tu=ui.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,d,v,P){return v<P?-1:P<v?1:0}},initialize:function(s,d,v){Ue(this,v),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var P in s)this._addLayer(s[P],P);for(P in d)this._addLayer(d[P],P,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var d=0;d<this._layers.length;d++)this._layers[d].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return ui.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,d){return this._addLayer(s,d),this._map?this._update():this},addOverlay:function(s,d){return this._addLayer(s,d,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var d=this._getLayer(ze(s));return d&&this._layers.splice(this._layers.indexOf(d),1),this._map?this._update():this},expand:function(){oi(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(oi(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):Ai(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Ai(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",d=this._container=Lt("div",s),v=this.options.collapsed;d.setAttribute("aria-haspopup",!0),Ka(d),gl(d);var P=this._section=Lt("section",s+"-list");v&&(this._map.on("click",this.collapse,this),Jt(d,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var A=this._layersLink=Lt("a",s+"-toggle",d);A.href="#",A.title="Layers",A.setAttribute("role","button"),Jt(A,{keydown:function(G){G.keyCode===13&&this._expandSafely()},click:function(G){_n(G),this._expandSafely()}},this),v||this.expand(),this._baseLayersList=Lt("div",s+"-base",P),this._separator=Lt("div",s+"-separator",P),this._overlaysList=Lt("div",s+"-overlays",P),d.appendChild(P)},_getLayer:function(s){for(var d=0;d<this._layers.length;d++)if(this._layers[d]&&ze(this._layers[d].layer)===s)return this._layers[d]},_addLayer:function(s,d,v){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:d,overlay:v}),this.options.sortLayers&&this._layers.sort(O(function(P,A){return this.options.sortFunction(P.layer,A.layer,P.name,A.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Tr(this._baseLayersList),Tr(this._overlaysList),this._layerControlInputs=[];var s,d,v,P,A=0;for(v=0;v<this._layers.length;v++)P=this._layers[v],this._addItem(P),d=d||P.overlay,s=s||!P.overlay,A+=P.overlay?0:1;return this.options.hideSingleBase&&(s=s&&A>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=d&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var d=this._getLayer(ze(s.target)),v=d.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;v&&this._map.fire(v,d)},_createRadioElement:function(s,d){var v='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(d?' checked="checked"':"")+"/>",P=document.createElement("div");return P.innerHTML=v,P.firstChild},_addItem:function(s){var d=document.createElement("label"),v=this._map.hasLayer(s.layer),P;s.overlay?(P=document.createElement("input"),P.type="checkbox",P.className="leaflet-control-layers-selector",P.defaultChecked=v):P=this._createRadioElement("leaflet-base-layers_"+ze(this),v),this._layerControlInputs.push(P),P.layerId=ze(s.layer),Jt(P,"click",this._onInputClick,this);var A=document.createElement("span");A.innerHTML=" "+s.name;var G=document.createElement("span");d.appendChild(G),G.appendChild(P),G.appendChild(A);var ue=s.overlay?this._overlaysList:this._baseLayersList;return ue.appendChild(d),this._checkDisabledLayers(),d},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,d,v,P=[],A=[];this._handlingClick=!0;for(var G=s.length-1;G>=0;G--)d=s[G],v=this._getLayer(d.layerId).layer,d.checked?P.push(v):d.checked||A.push(v);for(G=0;G<A.length;G++)this._map.hasLayer(A[G])&&this._map.removeLayer(A[G]);for(G=0;G<P.length;G++)this._map.hasLayer(P[G])||this._map.addLayer(P[G]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,d,v,P=this._map.getZoom(),A=s.length-1;A>=0;A--)d=s[A],v=this._getLayer(d.layerId).layer,d.disabled=v.options.minZoom!==void 0&&P<v.options.minZoom||v.options.maxZoom!==void 0&&P>v.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,Jt(s,"click",_n),this.expand();var d=this;setTimeout(function(){Ui(s,"click",_n),d._preventClick=!1})}}),_o=function(s,d,v){return new tu(s,d,v)},za=ui.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var d="leaflet-control-zoom",v=Lt("div",d+" leaflet-bar"),P=this.options;return this._zoomInButton=this._createButton(P.zoomInText,P.zoomInTitle,d+"-in",v,this._zoomIn),this._zoomOutButton=this._createButton(P.zoomOutText,P.zoomOutTitle,d+"-out",v,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),v},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,d,v,P,A){var G=Lt("a",v,P);return G.innerHTML=s,G.href="#",G.title=d,G.setAttribute("role","button"),G.setAttribute("aria-label",d),Ka(G),Jt(G,"click",hr),Jt(G,"click",A,this),Jt(G,"click",this._refocusOnMap,this),G},_updateDisabled:function(){var s=this._map,d="leaflet-disabled";Ai(this._zoomInButton,d),Ai(this._zoomOutButton,d),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(oi(this._zoomOutButton,d),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(oi(this._zoomInButton,d),this._zoomInButton.setAttribute("aria-disabled","true"))}});gi.mergeOptions({zoomControl:!0}),gi.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new za,this.addControl(this.zoomControl))});var iu=function(s){return new za(s)},Cr=ui.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var d="leaflet-control-scale",v=Lt("div",d),P=this.options;return this._addScales(P,d+"-line",v),s.on(P.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),v},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,d,v){s.metric&&(this._mScale=Lt("div",d,v)),s.imperial&&(this._iScale=Lt("div",d,v))},_update:function(){var s=this._map,d=s.getSize().y/2,v=s.distance(s.containerPointToLatLng([0,d]),s.containerPointToLatLng([this.options.maxWidth,d]));this._updateScales(v)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var d=this._getRoundNum(s),v=d<1e3?d+" m":d/1e3+" km";this._updateScale(this._mScale,v,d/s)},_updateImperial:function(s){var d=s*3.2808399,v,P,A;d>5280?(v=d/5280,P=this._getRoundNum(v),this._updateScale(this._iScale,P+" mi",P/v)):(A=this._getRoundNum(d),this._updateScale(this._iScale,A+" ft",A/d))},_updateScale:function(s,d,v){s.style.width=Math.round(this.options.maxWidth*v)+"px",s.innerHTML=d},_getRoundNum:function(s){var d=Math.pow(10,(Math.floor(s)+"").length-1),v=s/d;return v=v>=10?10:v>=5?5:v>=3?3:v>=2?2:1,d*v}}),oa=function(s){return new Cr(s)},Ja='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Uo=ui.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(De.inlineSvg?Ja+" ":"")+"Leaflet</a>"},initialize:function(s){Ue(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=Lt("div","leaflet-control-attribution"),Ka(this._container);for(var d in s._layers)s._layers[d].getAttribution&&this.addAttribution(s._layers[d].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var d in this._attributions)this._attributions[d]&&s.push(d);var v=[];this.options.prefix&&v.push(this.options.prefix),s.length&&v.push(s.join(", ")),this._container.innerHTML=v.join(' <span aria-hidden="true">|</span> ')}}});gi.mergeOptions({attributionControl:!0}),gi.addInitHook(function(){this.options.attributionControl&&new Uo().addTo(this)});var Eu=function(s){return new Uo(s)};ui.Layers=tu,ui.Zoom=za,ui.Scale=Cr,ui.Attribution=Uo,xs.layers=_o,xs.zoom=iu,xs.scale=oa,xs.attribution=Eu;var Ur=xi.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Ur.addTo=function(s,d){return s.addHandler(d,this),this};var xl={Events:Bi},ts=De.touch?"touchstart mousedown":"mousedown",is=Ei.extend({options:{clickTolerance:3},initialize:function(s,d,v,P){Ue(this,P),this._element=s,this._dragStartTarget=d||s,this._preventOutline=v},enable:function(){this._enabled||(Jt(this._dragStartTarget,ts,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(is._dragging===this&&this.finishDrag(!0),Ui(this._dragStartTarget,ts,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!sr(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){is._dragging===this&&this.finishDrag();return}if(!(is._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(is._dragging=this,this._preventOutline&&Ea(this._element),po(),zi(),!this._moving)){this.fire("down");var d=s.touches?s.touches[0]:s,v=Vr(this._element);this._startPoint=new qe(d.clientX,d.clientY),this._startPos=Pr(this._element),this._parentScale=dn(v);var P=s.type==="mousedown";Jt(document,P?"mousemove":"touchmove",this._onMove,this),Jt(document,P?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var d=s.touches&&s.touches.length===1?s.touches[0]:s,v=new qe(d.clientX,d.clientY)._subtract(this._startPoint);!v.x&&!v.y||Math.abs(v.x)+Math.abs(v.y)<this.options.clickTolerance||(v.x/=this._parentScale.x,v.y/=this._parentScale.y,_n(s),this._moved||(this.fire("dragstart"),this._moved=!0,oi(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),oi(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(v),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),mn(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){Ai(document.body,"leaflet-dragging"),this._lastTarget&&(Ai(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ui(document,"mousemove touchmove",this._onMove,this),Ui(document,"mouseup touchend touchcancel",this._onUp,this),Ga(),fo();var d=this._moved&&this._moving;this._moving=!1,is._dragging=!1,d&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function nu(s,d,v){var P,A=[1,4,2,8],G,ue,Pe,Re,$e,ft,Ht,yi;for(G=0,ft=s.length;G<ft;G++)s[G]._code=fr(s[G],d);for(Pe=0;Pe<4;Pe++){for(Ht=A[Pe],P=[],G=0,ft=s.length,ue=ft-1;G<ft;ue=G++)Re=s[G],$e=s[ue],Re._code&Ht?$e._code&Ht||(yi=ua($e,Re,Ht,d,v),yi._code=fr(yi,d),P.push(yi)):($e._code&Ht&&(yi=ua($e,Re,Ht,d,v),yi._code=fr(yi,d),P.push(yi)),P.push(Re));s=P}return s}function ru(s,d){var v,P,A,G,ue,Pe,Re,$e,ft;if(!s||s.length===0)throw new Error("latlngs not passed");Ir(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var Ht=wt([0,0]),yi=It(s),jn=yi.getNorthWest().distanceTo(yi.getSouthWest())*yi.getNorthEast().distanceTo(yi.getNorthWest());jn<1700&&(Ht=aa(s));var zn=s.length,pr=[];for(v=0;v<zn;v++){var An=wt(s[v]);pr.push(d.project(wt([An.lat-Ht.lat,An.lng-Ht.lng])))}for(Pe=Re=$e=0,v=0,P=zn-1;v<zn;P=v++)A=pr[v],G=pr[P],ue=A.y*G.x-G.y*A.x,Re+=(A.x+G.x)*ue,$e+=(A.y+G.y)*ue,Pe+=ue*3;Pe===0?ft=pr[0]:ft=[Re/Pe,$e/Pe];var Xn=d.unproject(He(ft));return wt([Xn.lat+Ht.lat,Xn.lng+Ht.lng])}function aa(s){for(var d=0,v=0,P=0,A=0;A<s.length;A++){var G=wt(s[A]);d+=G.lat,v+=G.lng,P++}return wt([d/P,v/P])}var Xu={__proto__:null,clipPolygon:nu,polygonCenter:ru,centroid:aa};function la(s,d){if(!d||!s.length)return s.slice();var v=d*d;return s=Au(s,v),s=zu(s,v),s}function Mu(s,d,v){return Math.sqrt(go(s,d,v,!0))}function Ku(s,d,v){return go(s,d,v)}function zu(s,d){var v=s.length,P=typeof Uint8Array<"u"?Uint8Array:Array,A=new P(v);A[0]=A[v-1]=1,wl(s,A,d,0,v-1);var G,ue=[];for(G=0;G<v;G++)A[G]&&ue.push(s[G]);return ue}function wl(s,d,v,P,A){var G=0,ue,Pe,Re;for(Pe=P+1;Pe<=A-1;Pe++)Re=go(s[Pe],s[P],s[A],!0),Re>G&&(ue=Pe,G=Re);G>v&&(d[ue]=1,wl(s,d,v,P,ue),wl(s,d,v,ue,A))}function Au(s,d){for(var v=[s[0]],P=1,A=0,G=s.length;P<G;P++)ou(s[P],s[A])>d&&(v.push(s[P]),A=P);return A<G-1&&v.push(s[G-1]),v}var Ya;function su(s,d,v,P,A){var G=P?Ya:fr(s,v),ue=fr(d,v),Pe,Re,$e;for(Ya=ue;;){if(!(G|ue))return[s,d];if(G&ue)return!1;Pe=G||ue,Re=ua(s,d,Pe,v,A),$e=fr(Re,v),Pe===G?(s=Re,G=$e):(d=Re,ue=$e)}}function ua(s,d,v,P,A){var G=d.x-s.x,ue=d.y-s.y,Pe=P.min,Re=P.max,$e,ft;return v&8?($e=s.x+G*(Re.y-s.y)/ue,ft=Re.y):v&4?($e=s.x+G*(Pe.y-s.y)/ue,ft=Pe.y):v&2?($e=Re.x,ft=s.y+ue*(Re.x-s.x)/G):v&1&&($e=Pe.x,ft=s.y+ue*(Pe.x-s.x)/G),new qe($e,ft,A)}function fr(s,d){var v=0;return s.x<d.min.x?v|=1:s.x>d.max.x&&(v|=2),s.y<d.min.y?v|=4:s.y>d.max.y&&(v|=8),v}function ou(s,d){var v=d.x-s.x,P=d.y-s.y;return v*v+P*P}function go(s,d,v,P){var A=d.x,G=d.y,ue=v.x-A,Pe=v.y-G,Re=ue*ue+Pe*Pe,$e;return Re>0&&($e=((s.x-A)*ue+(s.y-G)*Pe)/Re,$e>1?(A=v.x,G=v.y):$e>0&&(A+=ue*$e,G+=Pe*$e)),ue=s.x-A,Pe=s.y-G,P?ue*ue+Pe*Pe:new qe(A,G)}function Ir(s){return!Mt(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function Qa(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Ir(s)}function bl(s,d){var v,P,A,G,ue,Pe,Re,$e;if(!s||s.length===0)throw new Error("latlngs not passed");Ir(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var ft=wt([0,0]),Ht=It(s),yi=Ht.getNorthWest().distanceTo(Ht.getSouthWest())*Ht.getNorthEast().distanceTo(Ht.getNorthWest());yi<1700&&(ft=aa(s));var jn=s.length,zn=[];for(v=0;v<jn;v++){var pr=wt(s[v]);zn.push(d.project(wt([pr.lat-ft.lat,pr.lng-ft.lng])))}for(v=0,P=0;v<jn-1;v++)P+=zn[v].distanceTo(zn[v+1])/2;if(P===0)$e=zn[0];else for(v=0,G=0;v<jn-1;v++)if(ue=zn[v],Pe=zn[v+1],A=ue.distanceTo(Pe),G+=A,G>P){Re=(G-P)/A,$e=[Pe.x-Re*(Pe.x-ue.x),Pe.y-Re*(Pe.y-ue.y)];break}var An=d.unproject(He($e));return wt([An.lat+ft.lat,An.lng+ft.lng])}var Zo={__proto__:null,simplify:la,pointToSegmentDistance:Mu,closestPointOnSegment:Ku,clipSegment:su,_getEdgeIntersection:ua,_getBitCode:fr,_sqClosestPointOnSegment:go,isFlat:Ir,_flat:Qa,polylineCenter:bl},el={project:function(s){return new qe(s.lng,s.lat)},unproject:function(s){return new Tt(s.y,s.x)},bounds:new ge([-180,-90],[180,90])},au={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ge([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var d=Math.PI/180,v=this.R,P=s.lat*d,A=this.R_MINOR/v,G=Math.sqrt(1-A*A),ue=G*Math.sin(P),Pe=Math.tan(Math.PI/4-P/2)/Math.pow((1-ue)/(1+ue),G/2);return P=-v*Math.log(Math.max(Pe,1e-10)),new qe(s.lng*d*v,P)},unproject:function(s){for(var d=180/Math.PI,v=this.R,P=this.R_MINOR/v,A=Math.sqrt(1-P*P),G=Math.exp(-s.y/v),ue=Math.PI/2-2*Math.atan(G),Pe=0,Re=.1,$e;Pe<15&&Math.abs(Re)>1e-7;Pe++)$e=A*Math.sin(ue),$e=Math.pow((1-$e)/(1+$e),A/2),Re=Math.PI/2-2*Math.atan(G*$e)-ue,ue+=Re;return new Tt(ue*d,s.x*d/v)}},gn={__proto__:null,LonLat:el,Mercator:au,SphericalMercator:wn},Ju=ce({},ni,{code:"EPSG:3395",projection:au,transformation:function(){var s=.5/(Math.PI*au.R);return wr(s,.5,-s,.5)}()}),pi=ce({},ni,{code:"EPSG:4326",projection:el,transformation:wr(1/180,1,-1/180,.5)}),Sl=ce({},ii,{projection:el,transformation:wr(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,d){var v=d.lng-s.lng,P=d.lat-s.lat;return Math.sqrt(v*v+P*P)},infinite:!0});ii.Earth=ni,ii.EPSG3395=Ju,ii.EPSG3857=Fr,ii.EPSG900913=Vs,ii.EPSG4326=pi,ii.Simple=Sl;var Si=Ei.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[ze(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[ze(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var d=s.target;if(d.hasLayer(this)){if(this._map=d,this._zoomAnimated=d._zoomAnimated,this.getEvents){var v=this.getEvents();d.on(v,this),this.once("remove",function(){d.off(v,this)},this)}this.onAdd(d),this.fire("add"),d.fire("layeradd",{layer:this})}}});gi.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var d=ze(s);return this._layers[d]?this:(this._layers[d]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var d=ze(s);return this._layers[d]?(this._loaded&&s.onRemove(this),delete this._layers[d],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return ze(s)in this._layers},eachLayer:function(s,d){for(var v in this._layers)s.call(d,this._layers[v]);return this},_addLayers:function(s){s=s?Mt(s)?s:[s]:[];for(var d=0,v=s.length;d<v;d++)this.addLayer(s[d])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[ze(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var d=ze(s);this._zoomBoundLayers[d]&&(delete this._zoomBoundLayers[d],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,d=-1/0,v=this._getZoomSpan();for(var P in this._zoomBoundLayers){var A=this._zoomBoundLayers[P].options;s=A.minZoom===void 0?s:Math.min(s,A.minZoom),d=A.maxZoom===void 0?d:Math.max(d,A.maxZoom)}this._layersMaxZoom=d===-1/0?void 0:d,this._layersMinZoom=s===1/0?void 0:s,v!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Ci=Si.extend({initialize:function(s,d){Ue(this,d),this._layers={};var v,P;if(s)for(v=0,P=s.length;v<P;v++)this.addLayer(s[v])},addLayer:function(s){var d=this.getLayerId(s);return this._layers[d]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var d=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[d]&&this._map.removeLayer(this._layers[d]),delete this._layers[d],this},hasLayer:function(s){var d=typeof s=="number"?s:this.getLayerId(s);return d in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var d=Array.prototype.slice.call(arguments,1),v,P;for(v in this._layers)P=this._layers[v],P[s]&&P[s].apply(P,d);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,d){for(var v in this._layers)s.call(d,this._layers[v]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return ze(s)}}),ws=function(s,d){return new Ci(s,d)},Zr=Ci.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),Ci.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),Ci.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new Ft;for(var d in this._layers){var v=this._layers[d];s.extend(v.getBounds?v.getBounds():v.getLatLng())}return s}}),Aa=function(s,d){return new Zr(s,d)},yo=xi.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){Ue(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,d){var v=this._getIconUrl(s);if(!v){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var P=this._createImg(v,d&&d.tagName==="IMG"?d:null);return this._setIconStyles(P,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(P.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),P},_setIconStyles:function(s,d){var v=this.options,P=v[d+"Size"];typeof P=="number"&&(P=[P,P]);var A=He(P),G=He(d==="shadow"&&v.shadowAnchor||v.iconAnchor||A&&A.divideBy(2,!0));s.className="leaflet-marker-"+d+" "+(v.className||""),G&&(s.style.marginLeft=-G.x+"px",s.style.marginTop=-G.y+"px"),A&&(s.style.width=A.x+"px",s.style.height=A.y+"px")},_createImg:function(s,d){return d=d||document.createElement("img"),d.src=s,d},_getIconUrl:function(s){return De.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function $o(s){return new yo(s)}var bs=yo.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof bs.imagePath!="string"&&(bs.imagePath=this._detectIconPath()),(this.options.imagePath||bs.imagePath)+yo.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var d=function(v,P,A){var G=P.exec(v);return G&&G[A]};return s=d(s,/^url\((['"])?(.+)\1\)$/,2),s&&d(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=Lt("div","leaflet-default-icon-path",document.body),d=ys(s,"background-image")||ys(s,"backgroundImage");if(document.body.removeChild(s),d=this._stripUrl(d),d)return d;var v=document.querySelector('link[href$="leaflet.css"]');return v?v.href.substring(0,v.href.length-11-1):""}}),Er=Ur.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new is(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),oi(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Ai(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var d=this._marker,v=d._map,P=this._marker.options.autoPanSpeed,A=this._marker.options.autoPanPadding,G=Pr(d._icon),ue=v.getPixelBounds(),Pe=v.getPixelOrigin(),Re=Ne(ue.min._subtract(Pe).add(A),ue.max._subtract(Pe).subtract(A));if(!Re.contains(G)){var $e=He((Math.max(Re.max.x,G.x)-Re.max.x)/(ue.max.x-Re.max.x)-(Math.min(Re.min.x,G.x)-Re.min.x)/(ue.min.x-Re.min.x),(Math.max(Re.max.y,G.y)-Re.max.y)/(ue.max.y-Re.max.y)-(Math.min(Re.min.y,G.y)-Re.min.y)/(ue.min.y-Re.min.y)).multiplyBy(P);v.panBy($e,{animate:!1}),this._draggable._newPos._add($e),this._draggable._startPos._add($e),mn(d._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=qt(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(Hi(this._panRequest),this._panRequest=qt(this._adjustPan.bind(this,s)))},_onDrag:function(s){var d=this._marker,v=d._shadow,P=Pr(d._icon),A=d._map.layerPointToLatLng(P);v&&mn(v,P),d._latlng=A,s.latlng=A,s.oldLatLng=this._oldLatLng,d.fire("move",s).fire("drag",s)},_onDragEnd:function(s){Hi(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),Ss=Si.extend({options:{icon:new bs,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,d){Ue(this,d),this._latlng=wt(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var d=this._latlng;return this._latlng=wt(s),this.update(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,d="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),v=s.icon.createIcon(this._icon),P=!1;v!==this._icon&&(this._icon&&this._removeIcon(),P=!0,s.title&&(v.title=s.title),v.tagName==="IMG"&&(v.alt=s.alt||"")),oi(v,d),s.keyboard&&(v.tabIndex="0",v.setAttribute("role","button")),this._icon=v,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Jt(v,"focus",this._panOnFocus,this);var A=s.icon.createShadow(this._shadow),G=!1;A!==this._shadow&&(this._removeShadow(),G=!0),A&&(oi(A,d),A.alt=""),this._shadow=A,s.opacity<1&&this._updateOpacity(),P&&this.getPane().appendChild(this._icon),this._initInteraction(),A&&G&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ui(this._icon,"focus",this._panOnFocus,this),Gi(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Gi(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&mn(this._icon,s),this._shadow&&mn(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var d=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(d)},_initInteraction:function(){if(this.options.interactive&&(oi(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Er)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Er(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&Pn(this._icon,s),this._shadow&&Pn(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var d=this.options.icon.options,v=d.iconSize?He(d.iconSize):He(0,0),P=d.iconAnchor?He(d.iconAnchor):He(0,0);s.panInside(this._latlng,{paddingTopLeft:P,paddingBottomRight:v.subtract(P)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function lu(s,d){return new Ss(s,d)}var Zs=Si.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return Ue(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),$s=Zs.extend({options:{fill:!0,radius:10},initialize:function(s,d){Ue(this,d),this._latlng=wt(s),this._radius=this.options.radius},setLatLng:function(s){var d=this._latlng;return this._latlng=wt(s),this.redraw(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var d=s&&s.radius||this._radius;return Zs.prototype.setStyle.call(this,s),this.setRadius(d),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,d=this._radiusY||s,v=this._clickTolerance(),P=[s+v,d+v];this._pxBounds=new ge(this._point.subtract(P),this._point.add(P))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function La(s,d){return new $s(s,d)}var qo=$s.extend({initialize:function(s,d,v){if(typeof d=="number"&&(d=ce({},v,{radius:d})),Ue(this,d),this._latlng=wt(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new Ft(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:Zs.prototype.setStyle,_project:function(){var s=this._latlng.lng,d=this._latlng.lat,v=this._map,P=v.options.crs;if(P.distance===ni.distance){var A=Math.PI/180,G=this._mRadius/ni.R/A,ue=v.project([d+G,s]),Pe=v.project([d-G,s]),Re=ue.add(Pe).divideBy(2),$e=v.unproject(Re).lat,ft=Math.acos((Math.cos(G*A)-Math.sin(d*A)*Math.sin($e*A))/(Math.cos(d*A)*Math.cos($e*A)))/A;(isNaN(ft)||ft===0)&&(ft=G/Math.cos(Math.PI/180*d)),this._point=Re.subtract(v.getPixelOrigin()),this._radius=isNaN(ft)?0:Re.x-v.project([$e,s-ft]).x,this._radiusY=Re.y-ue.y}else{var Ht=P.unproject(P.project(this._latlng).subtract([this._mRadius,0]));this._point=v.latLngToLayerPoint(this._latlng),this._radius=this._point.x-v.latLngToLayerPoint(Ht).x}this._updateBounds()}});function qs(s,d,v){return new qo(s,d,v)}var Wn=Zs.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,d){Ue(this,d),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var d=1/0,v=null,P=go,A,G,ue=0,Pe=this._parts.length;ue<Pe;ue++)for(var Re=this._parts[ue],$e=1,ft=Re.length;$e<ft;$e++){A=Re[$e-1],G=Re[$e];var Ht=P(s,A,G,!0);Ht<d&&(d=Ht,v=P(s,A,G))}return v&&(v.distance=Math.sqrt(d)),v},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return bl(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,d){return d=d||this._defaultShape(),s=wt(s),d.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new Ft,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return Ir(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var d=[],v=Ir(s),P=0,A=s.length;P<A;P++)v?(d[P]=wt(s[P]),this._bounds.extend(d[P])):d[P]=this._convertLatLngs(s[P]);return d},_project:function(){var s=new ge;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),d=new qe(s,s);this._rawPxBounds&&(this._pxBounds=new ge([this._rawPxBounds.min.subtract(d),this._rawPxBounds.max.add(d)]))},_projectLatlngs:function(s,d,v){var P=s[0]instanceof Tt,A=s.length,G,ue;if(P){for(ue=[],G=0;G<A;G++)ue[G]=this._map.latLngToLayerPoint(s[G]),v.extend(ue[G]);d.push(ue)}else for(G=0;G<A;G++)this._projectLatlngs(s[G],d,v)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var d=this._parts,v,P,A,G,ue,Pe,Re;for(v=0,A=0,G=this._rings.length;v<G;v++)for(Re=this._rings[v],P=0,ue=Re.length;P<ue-1;P++)Pe=su(Re[P],Re[P+1],s,P,!0),Pe&&(d[A]=d[A]||[],d[A].push(Pe[0]),(Pe[1]!==Re[P+1]||P===ue-2)&&(d[A].push(Pe[1]),A++))}},_simplifyPoints:function(){for(var s=this._parts,d=this.options.smoothFactor,v=0,P=s.length;v<P;v++)s[v]=la(s[v],d)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,d){var v,P,A,G,ue,Pe,Re=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(v=0,G=this._parts.length;v<G;v++)for(Pe=this._parts[v],P=0,ue=Pe.length,A=ue-1;P<ue;A=P++)if(!(!d&&P===0)&&Mu(s,Pe[A],Pe[P])<=Re)return!0;return!1}});function Tl(s,d){return new Wn(s,d)}Wn._flat=Qa;var Mr=Wn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ru(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var d=Wn.prototype._convertLatLngs.call(this,s),v=d.length;return v>=2&&d[0]instanceof Tt&&d[0].equals(d[v-1])&&d.pop(),d},_setLatLngs:function(s){Wn.prototype._setLatLngs.call(this,s),Ir(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Ir(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,d=this.options.weight,v=new qe(d,d);if(s=new ge(s.min.subtract(v),s.max.add(v)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var P=0,A=this._rings.length,G;P<A;P++)G=nu(this._rings[P],s,!0),G.length&&this._parts.push(G)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var d=!1,v,P,A,G,ue,Pe,Re,$e;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(G=0,Re=this._parts.length;G<Re;G++)for(v=this._parts[G],ue=0,$e=v.length,Pe=$e-1;ue<$e;Pe=ue++)P=v[ue],A=v[Pe],P.y>s.y!=A.y>s.y&&s.x<(A.x-P.x)*(s.y-P.y)/(A.y-P.y)+P.x&&(d=!d);return d||Wn.prototype._containsPoint.call(this,s,!0)}});function Da(s,d){return new Mr(s,d)}var Ts=Zr.extend({initialize:function(s,d){Ue(this,d),this._layers={},s&&this.addData(s)},addData:function(s){var d=Mt(s)?s:s.features,v,P,A;if(d){for(v=0,P=d.length;v<P;v++)A=d[v],(A.geometries||A.geometry||A.features||A.coordinates)&&this.addData(A);return this}var G=this.options;if(G.filter&&!G.filter(s))return this;var ue=Ho(s,G);return ue?(ue.feature=da(s),ue.defaultOptions=ue.options,this.resetStyle(ue),G.onEachFeature&&G.onEachFeature(s,ue),this.addLayer(ue)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=ce({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(d){this._setLayerStyle(d,s)},this)},_setLayerStyle:function(s,d){s.setStyle&&(typeof d=="function"&&(d=d(s.feature)),s.setStyle(d))}});function Ho(s,d){var v=s.type==="Feature"?s.geometry:s,P=v?v.coordinates:null,A=[],G=d&&d.pointToLayer,ue=d&&d.coordsToLatLng||ca,Pe,Re,$e,ft;if(!P&&!v)return null;switch(v.type){case"Point":return Pe=ue(P),Ti(G,s,Pe,d);case"MultiPoint":for($e=0,ft=P.length;$e<ft;$e++)Pe=ue(P[$e]),A.push(Ti(G,s,Pe,d));return new Zr(A);case"LineString":case"MultiLineString":return Re=tl(P,v.type==="LineString"?0:1,ue),new Wn(Re,d);case"Polygon":case"MultiPolygon":return Re=tl(P,v.type==="Polygon"?1:2,ue),new Mr(Re,d);case"GeometryCollection":for($e=0,ft=v.geometries.length;$e<ft;$e++){var Ht=Ho({geometry:v.geometries[$e],type:"Feature",properties:s.properties},d);Ht&&A.push(Ht)}return new Zr(A);case"FeatureCollection":for($e=0,ft=v.features.length;$e<ft;$e++){var yi=Ho(v.features[$e],d);yi&&A.push(yi)}return new Zr(A);default:throw new Error("Invalid GeoJSON object.")}}function Ti(s,d,v,P){return s?s(d,v):new Ss(v,P&&P.markersInheritOptions&&P)}function ca(s){return new Tt(s[1],s[0],s[2])}function tl(s,d,v){for(var P=[],A=0,G=s.length,ue;A<G;A++)ue=d?tl(s[A],d-1,v):(v||ca)(s[A]),P.push(ue);return P}function il(s,d){return s=wt(s),s.alt!==void 0?[me(s.lng,d),me(s.lat,d),me(s.alt,d)]:[me(s.lng,d),me(s.lat,d)]}function vo(s,d,v,P){for(var A=[],G=0,ue=s.length;G<ue;G++)A.push(d?vo(s[G],Ir(s[G])?0:d-1,v,P):il(s[G],P));return!d&&v&&A.length>0&&A.push(A[0].slice()),A}function ha(s,d){return s.feature?ce({},s.feature,{geometry:d}):da(d)}function da(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var Pl={toGeoJSON:function(s){return ha(this,{type:"Point",coordinates:il(this.getLatLng(),s)})}};Ss.include(Pl),qo.include(Pl),$s.include(Pl),Wn.include({toGeoJSON:function(s){var d=!Ir(this._latlngs),v=vo(this._latlngs,d?1:0,!1,s);return ha(this,{type:(d?"Multi":"")+"LineString",coordinates:v})}}),Mr.include({toGeoJSON:function(s){var d=!Ir(this._latlngs),v=d&&!Ir(this._latlngs[0]),P=vo(this._latlngs,v?2:d?1:0,!0,s);return d||(P=[P]),ha(this,{type:(v?"Multi":"")+"Polygon",coordinates:P})}}),Ci.include({toMultiPoint:function(s){var d=[];return this.eachLayer(function(v){d.push(v.toGeoJSON(s).geometry.coordinates)}),ha(this,{type:"MultiPoint",coordinates:d})},toGeoJSON:function(s){var d=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(d==="MultiPoint")return this.toMultiPoint(s);var v=d==="GeometryCollection",P=[];return this.eachLayer(function(A){if(A.toGeoJSON){var G=A.toGeoJSON(s);if(v)P.push(G.geometry);else{var ue=da(G);ue.type==="FeatureCollection"?P.push.apply(P,ue.features):P.push(ue)}}}),v?ha(this,{geometries:P,type:"GeometryCollection"}):{type:"FeatureCollection",features:P}}});function uu(s,d){return new Ts(s,d)}var zr=uu,Ps=Si.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,d,v){this._url=s,this._bounds=It(d),Ue(this,v)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(oi(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Gi(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&Ji(this._image),this},bringToBack:function(){return this._map&&Qr(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=It(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",d=this._image=s?this._url:Lt("img");if(oi(d,"leaflet-image-layer"),this._zoomAnimated&&oi(d,"leaflet-zoom-animated"),this.options.className&&oi(d,this.options.className),d.onselectstart=xe,d.onmousemove=xe,d.onload=O(this.fire,this,"load"),d.onerror=O(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=d.src;return}d.src=this._url,d.alt=this.options.alt},_animateZoom:function(s){var d=this._map.getZoomScale(s.zoom),v=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;jr(this._image,v,d)},_reset:function(){var s=this._image,d=new ge(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),v=d.getSize();mn(s,d.min),s.style.width=v.x+"px",s.style.height=v.y+"px"},_updateOpacity:function(){Pn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),fa=function(s,d,v){return new Ps(s,d,v)},Go=Ps.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",d=this._image=s?this._url:Lt("video");if(oi(d,"leaflet-image-layer"),this._zoomAnimated&&oi(d,"leaflet-zoom-animated"),this.options.className&&oi(d,this.options.className),d.onselectstart=xe,d.onmousemove=xe,d.onloadeddata=O(this.fire,this,"load"),s){for(var v=d.getElementsByTagName("source"),P=[],A=0;A<v.length;A++)P.push(v[A].src);this._url=v.length>0?P:[d.src];return}Mt(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(d.style,"objectFit")&&(d.style.objectFit="fill"),d.autoplay=!!this.options.autoplay,d.loop=!!this.options.loop,d.muted=!!this.options.muted,d.playsInline=!!this.options.playsInline;for(var G=0;G<this._url.length;G++){var ue=Lt("source");ue.src=this._url[G],d.appendChild(ue)}}});function pa(s,d,v){return new Go(s,d,v)}var nl=Ps.extend({_initImage:function(){var s=this._image=this._url;oi(s,"leaflet-image-layer"),this._zoomAnimated&&oi(s,"leaflet-zoom-animated"),this.options.className&&oi(s,this.options.className),s.onselectstart=xe,s.onmousemove=xe}});function Wo(s,d,v){return new nl(s,d,v)}var Ar=Si.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,d){s&&(s instanceof Tt||Mt(s))?(this._latlng=wt(s),Ue(this,d)):(Ue(this,s),this._source=d),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&Pn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&Pn(this._container,1),this.bringToFront(),this.options.interactive&&(oi(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(Pn(this._container,0),this._removeTimeout=setTimeout(O(Gi,void 0,this._container),200)):Gi(this._container),this.options.interactive&&(Ai(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=wt(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Ji(this._container),this},bringToBack:function(){return this._map&&Qr(this._container),this},_prepareOpen:function(s){var d=this._source;if(!d._map)return!1;if(d instanceof Zr){d=null;var v=this._source._layers;for(var P in v)if(v[P]._map){d=v[P];break}if(!d)return!1;this._source=d}if(!s)if(d.getCenter)s=d.getCenter();else if(d.getLatLng)s=d.getLatLng();else if(d.getBounds)s=d.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,d=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof d=="string")s.innerHTML=d;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(d)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),d=He(this.options.offset),v=this._getAnchor();this._zoomAnimated?mn(this._container,s.add(v)):d=d.add(s).add(v);var P=this._containerBottom=-d.y,A=this._containerLeft=-Math.round(this._containerWidth/2)+d.x;this._container.style.bottom=P+"px",this._container.style.left=A+"px"}},_getAnchor:function(){return[0,0]}});gi.include({_initOverlay:function(s,d,v,P){var A=d;return A instanceof s||(A=new s(P).setContent(d)),v&&A.setLatLng(v),A}}),Si.include({_initOverlay:function(s,d,v,P){var A=v;return A instanceof s?(Ue(A,P),A._source=this):(A=d&&!P?d:new s(P,this),A.setContent(v)),A}});var ma=Ar.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,Ar.prototype.openOn.call(this,s)},onAdd:function(s){Ar.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Zs||this._source.on("preclick",vs))},onRemove:function(s){Ar.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Zs||this._source.off("preclick",vs))},getEvents:function(){var s=Ar.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",d=this._container=Lt("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),v=this._wrapper=Lt("div",s+"-content-wrapper",d);if(this._contentNode=Lt("div",s+"-content",v),Ka(d),gl(this._contentNode),Jt(d,"contextmenu",vs),this._tipContainer=Lt("div",s+"-tip-container",d),this._tip=Lt("div",s+"-tip",this._tipContainer),this.options.closeButton){var P=this._closeButton=Lt("a",s+"-close-button",d);P.setAttribute("role","button"),P.setAttribute("aria-label","Close popup"),P.href="#close",P.innerHTML='<span aria-hidden="true">&#215;</span>',Jt(P,"click",function(A){_n(A),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,d=s.style;d.width="",d.whiteSpace="nowrap";var v=s.offsetWidth;v=Math.min(v,this.options.maxWidth),v=Math.max(v,this.options.minWidth),d.width=v+1+"px",d.whiteSpace="",d.height="";var P=s.offsetHeight,A=this.options.maxHeight,G="leaflet-popup-scrolled";A&&P>A?(d.height=A+"px",oi(s,G)):Ai(s,G),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var d=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),v=this._getAnchor();mn(this._container,d.add(v))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,d=parseInt(ys(this._container,"marginBottom"),10)||0,v=this._container.offsetHeight+d,P=this._containerWidth,A=new qe(this._containerLeft,-v-this._containerBottom);A._add(Pr(this._container));var G=s.layerPointToContainerPoint(A),ue=He(this.options.autoPanPadding),Pe=He(this.options.autoPanPaddingTopLeft||ue),Re=He(this.options.autoPanPaddingBottomRight||ue),$e=s.getSize(),ft=0,Ht=0;G.x+P+Re.x>$e.x&&(ft=G.x+P-$e.x+Re.x),G.x-ft-Pe.x<0&&(ft=G.x-Pe.x),G.y+v+Re.y>$e.y&&(Ht=G.y+v-$e.y+Re.y),G.y-Ht-Pe.y<0&&(Ht=G.y-Pe.y),(ft||Ht)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([ft,Ht]))}},_getAnchor:function(){return He(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),xo=function(s,d){return new ma(s,d)};gi.mergeOptions({closePopupOnClick:!0}),gi.include({openPopup:function(s,d,v){return this._initOverlay(ma,s,d,v).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),Si.include({bindPopup:function(s,d){return this._popup=this._initOverlay(ma,this._popup,s,d),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof Zr||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){hr(s);var d=s.layer||s.target;if(this._popup._source===d&&!(d instanceof Zs)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=d,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var Xo=Ar.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){Ar.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){Ar.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=Ar.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",d=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Lt("div",d),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+ze(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var d,v,P=this._map,A=this._container,G=P.latLngToContainerPoint(P.getCenter()),ue=P.layerPointToContainerPoint(s),Pe=this.options.direction,Re=A.offsetWidth,$e=A.offsetHeight,ft=He(this.options.offset),Ht=this._getAnchor();Pe==="top"?(d=Re/2,v=$e):Pe==="bottom"?(d=Re/2,v=0):Pe==="center"?(d=Re/2,v=$e/2):Pe==="right"?(d=0,v=$e/2):Pe==="left"?(d=Re,v=$e/2):ue.x<G.x?(Pe="right",d=0,v=$e/2):(Pe="left",d=Re+(ft.x+Ht.x)*2,v=$e/2),s=s.subtract(He(d,v,!0)).add(ft).add(Ht),Ai(A,"leaflet-tooltip-right"),Ai(A,"leaflet-tooltip-left"),Ai(A,"leaflet-tooltip-top"),Ai(A,"leaflet-tooltip-bottom"),oi(A,"leaflet-tooltip-"+Pe),mn(A,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&Pn(this._container,s)},_animateZoom:function(s){var d=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(d)},_getAnchor:function(){return He(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),rl=function(s,d){return new Xo(s,d)};gi.include({openTooltip:function(s,d,v){return this._initOverlay(Xo,s,d,v).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),Si.include({bindTooltip:function(s,d){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Xo,this._tooltip,s,d),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var d=s?"off":"on",v={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?v.add=this._openTooltip:(v.mouseover=this._openTooltip,v.mouseout=this.closeTooltip,v.click=this._openTooltip,this._map?this._addFocusListeners():v.add=this._addFocusListeners),this._tooltip.options.sticky&&(v.mousemove=this._moveTooltip),this[d](v),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof Zr||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var d=typeof s.getElement=="function"&&s.getElement();d&&(Jt(d,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),Jt(d,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var d=typeof s.getElement=="function"&&s.getElement();d&&d.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var d=this;this._map.once("moveend",function(){d._openOnceFlag=!1,d._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var d=s.latlng,v,P;this._tooltip.options.sticky&&s.originalEvent&&(v=this._map.mouseEventToContainerPoint(s.originalEvent),P=this._map.containerPointToLayerPoint(v),d=this._map.layerPointToLatLng(P)),this._tooltip.setLatLng(d)}});var sl=yo.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var d=s&&s.tagName==="DIV"?s:document.createElement("div"),v=this.options;if(v.html instanceof Element?(Tr(d),d.appendChild(v.html)):d.innerHTML=v.html!==!1?v.html:"",v.bgPos){var P=He(v.bgPos);d.style.backgroundPosition=-P.x+"px "+-P.y+"px"}return this._setIconStyles(d,"icon"),d},createShadow:function(){return null}});function ol(s){return new sl(s)}yo.Default=bs;var Hs=Si.extend({options:{tileSize:256,opacity:1,updateWhenIdle:De.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){Ue(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),Gi(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Ji(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Qr(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=nt(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof qe?s:new qe(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var d=this.getPane().children,v=-s(-1/0,1/0),P=0,A=d.length,G;P<A;P++)G=d[P].style.zIndex,d[P]!==this._container&&G&&(v=s(v,+G));isFinite(v)&&(this.options.zIndex=v+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!De.ielt9){Pn(this._container,this.options.opacity);var s=+new Date,d=!1,v=!1;for(var P in this._tiles){var A=this._tiles[P];if(!(!A.current||!A.loaded)){var G=Math.min(1,(s-A.loaded)/200);Pn(A.el,G),G<1?d=!0:(A.active?v=!0:this._onOpaqueTile(A),A.active=!0)}}v&&!this._noPrune&&this._pruneTiles(),d&&(Hi(this._fadeFrame),this._fadeFrame=qt(this._updateOpacity,this))}},_onOpaqueTile:xe,_initContainer:function(){this._container||(this._container=Lt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,d=this.options.maxZoom;if(s!==void 0){for(var v in this._levels)v=Number(v),this._levels[v].el.children.length||v===s?(this._levels[v].el.style.zIndex=d-Math.abs(s-v),this._onUpdateLevel(v)):(Gi(this._levels[v].el),this._removeTilesAtZoom(v),this._onRemoveLevel(v),delete this._levels[v]);var P=this._levels[s],A=this._map;return P||(P=this._levels[s]={},P.el=Lt("div","leaflet-tile-container leaflet-zoom-animated",this._container),P.el.style.zIndex=d,P.origin=A.project(A.unproject(A.getPixelOrigin()),s).round(),P.zoom=s,this._setZoomTransform(P,A.getCenter(),A.getZoom()),xe(P.el.offsetWidth),this._onCreateLevel(P)),this._level=P,P}},_onUpdateLevel:xe,_onRemoveLevel:xe,_onCreateLevel:xe,_pruneTiles:function(){if(this._map){var s,d,v=this._map.getZoom();if(v>this.options.maxZoom||v<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)d=this._tiles[s],d.retain=d.current;for(s in this._tiles)if(d=this._tiles[s],d.current&&!d.active){var P=d.coords;this._retainParent(P.x,P.y,P.z,P.z-5)||this._retainChildren(P.x,P.y,P.z,P.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var d in this._tiles)this._tiles[d].coords.z===s&&this._removeTile(d)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)Gi(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,d,v,P){var A=Math.floor(s/2),G=Math.floor(d/2),ue=v-1,Pe=new qe(+A,+G);Pe.z=+ue;var Re=this._tileCoordsToKey(Pe),$e=this._tiles[Re];return $e&&$e.active?($e.retain=!0,!0):($e&&$e.loaded&&($e.retain=!0),ue>P?this._retainParent(A,G,ue,P):!1)},_retainChildren:function(s,d,v,P){for(var A=2*s;A<2*s+2;A++)for(var G=2*d;G<2*d+2;G++){var ue=new qe(A,G);ue.z=v+1;var Pe=this._tileCoordsToKey(ue),Re=this._tiles[Pe];if(Re&&Re.active){Re.retain=!0;continue}else Re&&Re.loaded&&(Re.retain=!0);v+1<P&&this._retainChildren(A,G,v+1,P)}},_resetView:function(s){var d=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),d,d)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var d=this.options;return d.minNativeZoom!==void 0&&s<d.minNativeZoom?d.minNativeZoom:d.maxNativeZoom!==void 0&&d.maxNativeZoom<s?d.maxNativeZoom:s},_setView:function(s,d,v,P){var A=Math.round(d);this.options.maxZoom!==void 0&&A>this.options.maxZoom||this.options.minZoom!==void 0&&A<this.options.minZoom?A=void 0:A=this._clampZoom(A);var G=this.options.updateWhenZooming&&A!==this._tileZoom;(!P||G)&&(this._tileZoom=A,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),A!==void 0&&this._update(s),v||this._pruneTiles(),this._noPrune=!!v),this._setZoomTransforms(s,d)},_setZoomTransforms:function(s,d){for(var v in this._levels)this._setZoomTransform(this._levels[v],s,d)},_setZoomTransform:function(s,d,v){var P=this._map.getZoomScale(v,s.zoom),A=s.origin.multiplyBy(P).subtract(this._map._getNewPixelOrigin(d,v)).round();De.any3d?jr(s.el,A,P):mn(s.el,A)},_resetGrid:function(){var s=this._map,d=s.options.crs,v=this._tileSize=this.getTileSize(),P=this._tileZoom,A=this._map.getPixelWorldBounds(this._tileZoom);A&&(this._globalTileRange=this._pxBoundsToTileRange(A)),this._wrapX=d.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,d.wrapLng[0]],P).x/v.x),Math.ceil(s.project([0,d.wrapLng[1]],P).x/v.y)],this._wrapY=d.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([d.wrapLat[0],0],P).y/v.x),Math.ceil(s.project([d.wrapLat[1],0],P).y/v.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var d=this._map,v=d._animatingZoom?Math.max(d._animateToZoom,d.getZoom()):d.getZoom(),P=d.getZoomScale(v,this._tileZoom),A=d.project(s,this._tileZoom).floor(),G=d.getSize().divideBy(P*2);return new ge(A.subtract(G),A.add(G))},_update:function(s){var d=this._map;if(d){var v=this._clampZoom(d.getZoom());if(s===void 0&&(s=d.getCenter()),this._tileZoom!==void 0){var P=this._getTiledPixelBounds(s),A=this._pxBoundsToTileRange(P),G=A.getCenter(),ue=[],Pe=this.options.keepBuffer,Re=new ge(A.getBottomLeft().subtract([Pe,-Pe]),A.getTopRight().add([Pe,-Pe]));if(!(isFinite(A.min.x)&&isFinite(A.min.y)&&isFinite(A.max.x)&&isFinite(A.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var $e in this._tiles){var ft=this._tiles[$e].coords;(ft.z!==this._tileZoom||!Re.contains(new qe(ft.x,ft.y)))&&(this._tiles[$e].current=!1)}if(Math.abs(v-this._tileZoom)>1){this._setView(s,v);return}for(var Ht=A.min.y;Ht<=A.max.y;Ht++)for(var yi=A.min.x;yi<=A.max.x;yi++){var jn=new qe(yi,Ht);if(jn.z=this._tileZoom,!!this._isValidTile(jn)){var zn=this._tiles[this._tileCoordsToKey(jn)];zn?zn.current=!0:ue.push(jn)}}if(ue.sort(function(An,Xn){return An.distanceTo(G)-Xn.distanceTo(G)}),ue.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var pr=document.createDocumentFragment();for(yi=0;yi<ue.length;yi++)this._addTile(ue[yi],pr);this._level.el.appendChild(pr)}}}},_isValidTile:function(s){var d=this._map.options.crs;if(!d.infinite){var v=this._globalTileRange;if(!d.wrapLng&&(s.x<v.min.x||s.x>v.max.x)||!d.wrapLat&&(s.y<v.min.y||s.y>v.max.y))return!1}if(!this.options.bounds)return!0;var P=this._tileCoordsToBounds(s);return It(this.options.bounds).overlaps(P)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var d=this._map,v=this.getTileSize(),P=s.scaleBy(v),A=P.add(v),G=d.unproject(P,s.z),ue=d.unproject(A,s.z);return[G,ue]},_tileCoordsToBounds:function(s){var d=this._tileCoordsToNwSe(s),v=new Ft(d[0],d[1]);return this.options.noWrap||(v=this._map.wrapLatLngBounds(v)),v},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var d=s.split(":"),v=new qe(+d[0],+d[1]);return v.z=+d[2],v},_removeTile:function(s){var d=this._tiles[s];d&&(Gi(d.el),delete this._tiles[s],this.fire("tileunload",{tile:d.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){oi(s,"leaflet-tile");var d=this.getTileSize();s.style.width=d.x+"px",s.style.height=d.y+"px",s.onselectstart=xe,s.onmousemove=xe,De.ielt9&&this.options.opacity<1&&Pn(s,this.options.opacity)},_addTile:function(s,d){var v=this._getTilePos(s),P=this._tileCoordsToKey(s),A=this.createTile(this._wrapCoords(s),O(this._tileReady,this,s));this._initTile(A),this.createTile.length<2&&qt(O(this._tileReady,this,s,null,A)),mn(A,v),this._tiles[P]={el:A,coords:s,current:!0},d.appendChild(A),this.fire("tileloadstart",{tile:A,coords:s})},_tileReady:function(s,d,v){d&&this.fire("tileerror",{error:d,tile:v,coords:s});var P=this._tileCoordsToKey(s);v=this._tiles[P],v&&(v.loaded=+new Date,this._map._fadeAnimated?(Pn(v.el,0),Hi(this._fadeFrame),this._fadeFrame=qt(this._updateOpacity,this)):(v.active=!0,this._pruneTiles()),d||(oi(v.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:v.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),De.ielt9||!this._map._fadeAnimated?qt(this._pruneTiles,this):setTimeout(O(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var d=new qe(this._wrapX?tt(s.x,this._wrapX):s.x,this._wrapY?tt(s.y,this._wrapY):s.y);return d.z=s.z,d},_pxBoundsToTileRange:function(s){var d=this.getTileSize();return new ge(s.min.unscaleBy(d).floor(),s.max.unscaleBy(d).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function Gs(s){return new Hs(s)}var ns=Hs.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,d){this._url=s,d=Ue(this,d),d.detectRetina&&De.retina&&d.maxZoom>0?(d.tileSize=Math.floor(d.tileSize/2),d.zoomReverse?(d.zoomOffset--,d.minZoom=Math.min(d.maxZoom,d.minZoom+1)):(d.zoomOffset++,d.maxZoom=Math.max(d.minZoom,d.maxZoom-1)),d.minZoom=Math.max(0,d.minZoom)):d.zoomReverse?d.minZoom=Math.min(d.maxZoom,d.minZoom):d.maxZoom=Math.max(d.minZoom,d.maxZoom),typeof d.subdomains=="string"&&(d.subdomains=d.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,d){return this._url===s&&d===void 0&&(d=!0),this._url=s,d||this.redraw(),this},createTile:function(s,d){var v=document.createElement("img");return Jt(v,"load",O(this._tileOnLoad,this,d,v)),Jt(v,"error",O(this._tileOnError,this,d,v)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(v.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(v.referrerPolicy=this.options.referrerPolicy),v.alt="",v.src=this.getTileUrl(s),v},getTileUrl:function(s){var d={r:De.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var v=this._globalTileRange.max.y-s.y;this.options.tms&&(d.y=v),d["-y"]=v}return Qt(this._url,ce(d,this.options))},_tileOnLoad:function(s,d){De.ielt9?setTimeout(O(s,this,null,d),0):s(null,d)},_tileOnError:function(s,d,v){var P=this.options.errorTileUrl;P&&d.getAttribute("src")!==P&&(d.src=P),s(v,d)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,d=this.options.maxZoom,v=this.options.zoomReverse,P=this.options.zoomOffset;return v&&(s=d-s),s+P},_getSubdomain:function(s){var d=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[d]},_abortLoading:function(){var s,d;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(d=this._tiles[s].el,d.onload=xe,d.onerror=xe,!d.complete)){d.src=li;var v=this._tiles[s].coords;Gi(d),delete this._tiles[s],this.fire("tileabort",{tile:d,coords:v})}},_removeTile:function(s){var d=this._tiles[s];if(d)return d.el.setAttribute("src",li),Hs.prototype._removeTile.call(this,s)},_tileReady:function(s,d,v){if(!(!this._map||v&&v.getAttribute("src")===li))return Hs.prototype._tileReady.call(this,s,d,v)}});function Fn(s,d){return new ns(s,d)}var ks=ns.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,d){this._url=s;var v=ce({},this.defaultWmsParams);for(var P in d)P in this.options||(v[P]=d[P]);d=Ue(this,d);var A=d.detectRetina&&De.retina?2:1,G=this.getTileSize();v.width=G.x*A,v.height=G.y*A,this.wmsParams=v},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var d=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[d]=this._crs.code,ns.prototype.onAdd.call(this,s)},getTileUrl:function(s){var d=this._tileCoordsToNwSe(s),v=this._crs,P=Ne(v.project(d[0]),v.project(d[1])),A=P.min,G=P.max,ue=(this._wmsVersion>=1.3&&this._crs===pi?[A.y,A.x,G.y,G.x]:[A.x,A.y,G.x,G.y]).join(","),Pe=ns.prototype.getTileUrl.call(this,s);return Pe+Je(this.wmsParams,Pe,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+ue},setParams:function(s,d){return ce(this.wmsParams,s),d||this.redraw(),this}});function cu(s,d){return new ks(s,d)}ns.WMS=ks,Fn.wms=cu;var Cs=Si.extend({options:{padding:.1},initialize:function(s){Ue(this,s),ze(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),oi(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,d){var v=this._map.getZoomScale(d,this._zoom),P=this._map.getSize().multiplyBy(.5+this.options.padding),A=this._map.project(this._center,d),G=P.multiplyBy(-v).add(A).subtract(this._map._getNewPixelOrigin(s,d));De.any3d?jr(this._container,G,v):mn(this._container,G)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,d=this._map.getSize(),v=this._map.containerPointToLayerPoint(d.multiplyBy(-s)).round();this._bounds=new ge(v,v.add(d.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),ln=Cs.extend({options:{tolerance:0},getEvents:function(){var s=Cs.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Cs.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");Jt(s,"mousemove",this._onMouseMove,this),Jt(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Jt(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){Hi(this._redrawRequest),delete this._ctx,Gi(this._container),Ui(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var d in this._layers)s=this._layers[d],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Cs.prototype._update.call(this);var s=this._bounds,d=this._container,v=s.getSize(),P=De.retina?2:1;mn(d,s.min),d.width=P*v.x,d.height=P*v.y,d.style.width=v.x+"px",d.style.height=v.y+"px",De.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){Cs.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[ze(s)]=s;var d=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=d),this._drawLast=d,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var d=s._order,v=d.next,P=d.prev;v?v.prev=P:this._drawLast=P,P?P.next=v:this._drawFirst=v,delete s._order,delete this._layers[ze(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var d=s.options.dashArray.split(/[, ]+/),v=[],P,A;for(A=0;A<d.length;A++){if(P=Number(d[A]),isNaN(P))return;v.push(P)}s.options._dashArray=v}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||qt(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var d=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ge,this._redrawBounds.extend(s._pxBounds.min.subtract([d,d])),this._redrawBounds.extend(s._pxBounds.max.add([d,d]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var d=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,d.x,d.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,d=this._redrawBounds;if(this._ctx.save(),d){var v=d.getSize();this._ctx.beginPath(),this._ctx.rect(d.min.x,d.min.y,v.x,v.y),this._ctx.clip()}this._drawing=!0;for(var P=this._drawFirst;P;P=P.next)s=P.layer,(!d||s._pxBounds&&s._pxBounds.intersects(d))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,d){if(this._drawing){var v,P,A,G,ue=s._parts,Pe=ue.length,Re=this._ctx;if(Pe){for(Re.beginPath(),v=0;v<Pe;v++){for(P=0,A=ue[v].length;P<A;P++)G=ue[v][P],Re[P?"lineTo":"moveTo"](G.x,G.y);d&&Re.closePath()}this._fillStroke(Re,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var d=s._point,v=this._ctx,P=Math.max(Math.round(s._radius),1),A=(Math.max(Math.round(s._radiusY),1)||P)/P;A!==1&&(v.save(),v.scale(1,A)),v.beginPath(),v.arc(d.x,d.y/A,P,0,Math.PI*2,!1),A!==1&&v.restore(),this._fillStroke(v,s)}},_fillStroke:function(s,d){var v=d.options;v.fill&&(s.globalAlpha=v.fillOpacity,s.fillStyle=v.fillColor||v.color,s.fill(v.fillRule||"evenodd")),v.stroke&&v.weight!==0&&(s.setLineDash&&s.setLineDash(d.options&&d.options._dashArray||[]),s.globalAlpha=v.opacity,s.lineWidth=v.weight,s.strokeStyle=v.color,s.lineCap=v.lineCap,s.lineJoin=v.lineJoin,s.stroke())},_onClick:function(s){for(var d=this._map.mouseEventToLayerPoint(s),v,P,A=this._drawFirst;A;A=A.next)v=A.layer,v.options.interactive&&v._containsPoint(d)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(v))&&(P=v);this._fireEvent(P?[P]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var d=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,d)}},_handleMouseOut:function(s){var d=this._hoveredLayer;d&&(Ai(this._container,"leaflet-interactive"),this._fireEvent([d],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,d){if(!this._mouseHoverThrottled){for(var v,P,A=this._drawFirst;A;A=A.next)v=A.layer,v.options.interactive&&v._containsPoint(d)&&(P=v);P!==this._hoveredLayer&&(this._handleMouseOut(s),P&&(oi(this._container,"leaflet-interactive"),this._fireEvent([P],s,"mouseover"),this._hoveredLayer=P)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(O(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,d,v){this._map._fireDOMEvent(d,v||d.type,s)},_bringToFront:function(s){var d=s._order;if(d){var v=d.next,P=d.prev;if(v)v.prev=P;else return;P?P.next=v:v&&(this._drawFirst=v),d.prev=this._drawLast,this._drawLast.next=d,d.next=null,this._drawLast=d,this._requestRedraw(s)}},_bringToBack:function(s){var d=s._order;if(d){var v=d.next,P=d.prev;if(P)P.next=v;else return;v?v.prev=P:P&&(this._drawLast=P),d.prev=null,d.next=this._drawFirst,this._drawFirst.prev=d,this._drawFirst=d,this._requestRedraw(s)}}});function $r(s){return De.canvas?new ln(s):null}var Nn=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Ra={_initContainer:function(){this._container=Lt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Cs.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var d=s._container=Nn("shape");oi(d,"leaflet-vml-shape "+(this.options.className||"")),d.coordsize="1 1",s._path=Nn("path"),d.appendChild(s._path),this._updateStyle(s),this._layers[ze(s)]=s},_addPath:function(s){var d=s._container;this._container.appendChild(d),s.options.interactive&&s.addInteractiveTarget(d)},_removePath:function(s){var d=s._container;Gi(d),s.removeInteractiveTarget(d),delete this._layers[ze(s)]},_updateStyle:function(s){var d=s._stroke,v=s._fill,P=s.options,A=s._container;A.stroked=!!P.stroke,A.filled=!!P.fill,P.stroke?(d||(d=s._stroke=Nn("stroke")),A.appendChild(d),d.weight=P.weight+"px",d.color=P.color,d.opacity=P.opacity,P.dashArray?d.dashStyle=Mt(P.dashArray)?P.dashArray.join(" "):P.dashArray.replace(/( *, *)/g," "):d.dashStyle="",d.endcap=P.lineCap.replace("butt","flat"),d.joinstyle=P.lineJoin):d&&(A.removeChild(d),s._stroke=null),P.fill?(v||(v=s._fill=Nn("fill")),A.appendChild(v),v.color=P.fillColor||P.color,v.opacity=P.fillOpacity):v&&(A.removeChild(v),s._fill=null)},_updateCircle:function(s){var d=s._point.round(),v=Math.round(s._radius),P=Math.round(s._radiusY||v);this._setPath(s,s._empty()?"M0 0":"AL "+d.x+","+d.y+" "+v+","+P+" 0,"+65535*360)},_setPath:function(s,d){s._path.v=d},_bringToFront:function(s){Ji(s._container)},_bringToBack:function(s){Qr(s._container)}},qr=De.vml?Nn:Bo,Ws=Cs.extend({_initContainer:function(){this._container=qr("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=qr("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Gi(this._container),Ui(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Cs.prototype._update.call(this);var s=this._bounds,d=s.getSize(),v=this._container;(!this._svgSize||!this._svgSize.equals(d))&&(this._svgSize=d,v.setAttribute("width",d.x),v.setAttribute("height",d.y)),mn(v,s.min),v.setAttribute("viewBox",[s.min.x,s.min.y,d.x,d.y].join(" ")),this.fire("update")}},_initPath:function(s){var d=s._path=qr("path");s.options.className&&oi(d,s.options.className),s.options.interactive&&oi(d,"leaflet-interactive"),this._updateStyle(s),this._layers[ze(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){Gi(s._path),s.removeInteractiveTarget(s._path),delete this._layers[ze(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var d=s._path,v=s.options;d&&(v.stroke?(d.setAttribute("stroke",v.color),d.setAttribute("stroke-opacity",v.opacity),d.setAttribute("stroke-width",v.weight),d.setAttribute("stroke-linecap",v.lineCap),d.setAttribute("stroke-linejoin",v.lineJoin),v.dashArray?d.setAttribute("stroke-dasharray",v.dashArray):d.removeAttribute("stroke-dasharray"),v.dashOffset?d.setAttribute("stroke-dashoffset",v.dashOffset):d.removeAttribute("stroke-dashoffset")):d.setAttribute("stroke","none"),v.fill?(d.setAttribute("fill",v.fillColor||v.color),d.setAttribute("fill-opacity",v.fillOpacity),d.setAttribute("fill-rule",v.fillRule||"evenodd")):d.setAttribute("fill","none"))},_updatePoly:function(s,d){this._setPath(s,Le(s._parts,d))},_updateCircle:function(s){var d=s._point,v=Math.max(Math.round(s._radius),1),P=Math.max(Math.round(s._radiusY),1)||v,A="a"+v+","+P+" 0 1,0 ",G=s._empty()?"M0 0":"M"+(d.x-v)+","+d.y+A+v*2+",0 "+A+-v*2+",0 ";this._setPath(s,G)},_setPath:function(s,d){s._path.setAttribute("d",d)},_bringToFront:function(s){Ji(s._path)},_bringToBack:function(s){Qr(s._path)}});De.vml&&Ws.include(Ra);function wo(s){return De.svg||De.vml?new Ws(s):null}gi.include({getRenderer:function(s){var d=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return d||(d=this._renderer=this._createRenderer()),this.hasLayer(d)||this.addLayer(d),d},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var d=this._paneRenderers[s];return d===void 0&&(d=this._createRenderer({pane:s}),this._paneRenderers[s]=d),d},_createRenderer:function(s){return this.options.preferCanvas&&$r(s)||wo(s)}});var Xs=Mr.extend({initialize:function(s,d){Mr.prototype.initialize.call(this,this._boundsToLatLngs(s),d)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=It(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function hu(s,d){return new Xs(s,d)}Ws.create=qr,Ws.pointsToPath=Le,Ts.geometryToLayer=Ho,Ts.coordsToLatLng=ca,Ts.coordsToLatLngs=tl,Ts.latLngToCoords=il,Ts.latLngsToCoords=vo,Ts.getFeature=ha,Ts.asFeature=da,gi.mergeOptions({boxZoom:!0});var bo=Ur.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){Jt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ui(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Gi(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),zi(),po(),this._startPoint=this._map.mouseEventToContainerPoint(s),Jt(document,{contextmenu:hr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=Lt("div","leaflet-zoom-box",this._container),oi(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var d=new ge(this._point,this._startPoint),v=d.getSize();mn(this._box,d.min),this._box.style.width=v.x+"px",this._box.style.height=v.y+"px"},_finish:function(){this._moved&&(Gi(this._box),Ai(this._container,"leaflet-crosshair")),fo(),Ga(),Ui(document,{contextmenu:hr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(O(this._resetState,this),0);var d=new Ft(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(d).fire("boxzoomend",{boxZoomBounds:d})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});gi.addInitHook("addHandler","boxZoom",bo),gi.mergeOptions({doubleClickZoom:!0});var kl=Ur.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var d=this._map,v=d.getZoom(),P=d.options.zoomDelta,A=s.originalEvent.shiftKey?v-P:v+P;d.options.doubleClickZoom==="center"?d.setZoom(A):d.setZoomAround(s.containerPoint,A)}});gi.addInitHook("addHandler","doubleClickZoom",kl),gi.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Ba=Ur.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new is(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}oi(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Ai(this._map._container,"leaflet-grab"),Ai(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var d=It(this._map.options.maxBounds);this._offsetLimit=Ne(this._map.latLngToContainerPoint(d.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(d.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var d=this._lastTime=+new Date,v=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(v),this._times.push(d),this._prunePositions(d)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),d=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=d.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,d){return s-(s-d)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),d=this._offsetLimit;s.x<d.min.x&&(s.x=this._viscousLimit(s.x,d.min.x)),s.y<d.min.y&&(s.y=this._viscousLimit(s.y,d.min.y)),s.x>d.max.x&&(s.x=this._viscousLimit(s.x,d.max.x)),s.y>d.max.y&&(s.y=this._viscousLimit(s.y,d.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,d=Math.round(s/2),v=this._initialWorldOffset,P=this._draggable._newPos.x,A=(P-d+v)%s+d-v,G=(P+d+v)%s-d-v,ue=Math.abs(A+v)<Math.abs(G+v)?A:G;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=ue},_onDragEnd:function(s){var d=this._map,v=d.options,P=!v.inertia||s.noInertia||this._times.length<2;if(d.fire("dragend",s),P)d.fire("moveend");else{this._prunePositions(+new Date);var A=this._lastPos.subtract(this._positions[0]),G=(this._lastTime-this._times[0])/1e3,ue=v.easeLinearity,Pe=A.multiplyBy(ue/G),Re=Pe.distanceTo([0,0]),$e=Math.min(v.inertiaMaxSpeed,Re),ft=Pe.multiplyBy($e/Re),Ht=$e/(v.inertiaDeceleration*ue),yi=ft.multiplyBy(-Ht/2).round();!yi.x&&!yi.y?d.fire("moveend"):(yi=d._limitOffset(yi,d.options.maxBounds),qt(function(){d.panBy(yi,{duration:Ht,easeLinearity:ue,noMoveStart:!0,animate:!0})}))}}});gi.addInitHook("addHandler","dragging",Ba),gi.mergeOptions({keyboard:!0,keyboardPanDelta:80});var al=Ur.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),Jt(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ui(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,d=document.documentElement,v=s.scrollTop||d.scrollTop,P=s.scrollLeft||d.scrollLeft;this._map._container.focus(),window.scrollTo(P,v)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var d=this._panKeys={},v=this.keyCodes,P,A;for(P=0,A=v.left.length;P<A;P++)d[v.left[P]]=[-1*s,0];for(P=0,A=v.right.length;P<A;P++)d[v.right[P]]=[s,0];for(P=0,A=v.down.length;P<A;P++)d[v.down[P]]=[0,s];for(P=0,A=v.up.length;P<A;P++)d[v.up[P]]=[0,-1*s]},_setZoomDelta:function(s){var d=this._zoomKeys={},v=this.keyCodes,P,A;for(P=0,A=v.zoomIn.length;P<A;P++)d[v.zoomIn[P]]=s;for(P=0,A=v.zoomOut.length;P<A;P++)d[v.zoomOut[P]]=-s},_addHooks:function(){Jt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ui(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var d=s.keyCode,v=this._map,P;if(d in this._panKeys){if(!v._panAnim||!v._panAnim._inProgress)if(P=this._panKeys[d],s.shiftKey&&(P=He(P).multiplyBy(3)),v.options.maxBounds&&(P=v._limitOffset(He(P),v.options.maxBounds)),v.options.worldCopyJump){var A=v.wrapLatLng(v.unproject(v.project(v.getCenter()).add(P)));v.panTo(A)}else v.panBy(P)}else if(d in this._zoomKeys)v.setZoom(v.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[d]);else if(d===27&&v._popup&&v._popup.options.closeOnEscapeKey)v.closePopup();else return;hr(s)}}});gi.addInitHook("addHandler","keyboard",al),gi.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var qi=Ur.extend({addHooks:function(){Jt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ui(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var d=yl(s),v=this._map.options.wheelDebounceTime;this._delta+=d,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var P=Math.max(v-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(O(this._performZoom,this),P),hr(s)},_performZoom:function(){var s=this._map,d=s.getZoom(),v=this._map.options.zoomSnap||0;s._stop();var P=this._delta/(this._map.options.wheelPxPerZoomLevel*4),A=4*Math.log(2/(1+Math.exp(-Math.abs(P))))/Math.LN2,G=v?Math.ceil(A/v)*v:A,ue=s._limitZoom(d+(this._delta>0?G:-G))-d;this._delta=0,this._startTime=null,ue&&(s.options.scrollWheelZoom==="center"?s.setZoom(d+ue):s.setZoomAround(this._lastMousePos,d+ue))}});gi.addInitHook("addHandler","scrollWheelZoom",qi);var So=600;gi.mergeOptions({tapHold:De.touchNative&&De.safari&&De.mobile,tapTolerance:15});var Ko=Ur.extend({addHooks:function(){Jt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ui(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var d=s.touches[0];this._startPos=this._newPos=new qe(d.clientX,d.clientY),this._holdTimeout=setTimeout(O(function(){this._cancel(),this._isTapValid()&&(Jt(document,"touchend",_n),Jt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",d))},this),So),Jt(document,"touchend touchcancel contextmenu",this._cancel,this),Jt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){Ui(document,"touchend",_n),Ui(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),Ui(document,"touchend touchcancel contextmenu",this._cancel,this),Ui(document,"touchmove",this._onMove,this)},_onMove:function(s){var d=s.touches[0];this._newPos=new qe(d.clientX,d.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,d){var v=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:d.screenX,screenY:d.screenY,clientX:d.clientX,clientY:d.clientY});v._simulated=!0,d.target.dispatchEvent(v)}});gi.addInitHook("addHandler","tapHold",Ko),gi.mergeOptions({touchZoom:De.touch,bounceAtZoomLimits:!0});var Ks=Ur.extend({addHooks:function(){oi(this._map._container,"leaflet-touch-zoom"),Jt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Ai(this._map._container,"leaflet-touch-zoom"),Ui(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var d=this._map;if(!(!s.touches||s.touches.length!==2||d._animatingZoom||this._zooming)){var v=d.mouseEventToContainerPoint(s.touches[0]),P=d.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=d.getSize()._divideBy(2),this._startLatLng=d.containerPointToLatLng(this._centerPoint),d.options.touchZoom!=="center"&&(this._pinchStartLatLng=d.containerPointToLatLng(v.add(P)._divideBy(2))),this._startDist=v.distanceTo(P),this._startZoom=d.getZoom(),this._moved=!1,this._zooming=!0,d._stop(),Jt(document,"touchmove",this._onTouchMove,this),Jt(document,"touchend touchcancel",this._onTouchEnd,this),_n(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var d=this._map,v=d.mouseEventToContainerPoint(s.touches[0]),P=d.mouseEventToContainerPoint(s.touches[1]),A=v.distanceTo(P)/this._startDist;if(this._zoom=d.getScaleZoom(A,this._startZoom),!d.options.bounceAtZoomLimits&&(this._zoom<d.getMinZoom()&&A<1||this._zoom>d.getMaxZoom()&&A>1)&&(this._zoom=d._limitZoom(this._zoom)),d.options.touchZoom==="center"){if(this._center=this._startLatLng,A===1)return}else{var G=v._add(P)._divideBy(2)._subtract(this._centerPoint);if(A===1&&G.x===0&&G.y===0)return;this._center=d.unproject(d.project(this._pinchStartLatLng,this._zoom).subtract(G),this._zoom)}this._moved||(d._moveStart(!0,!1),this._moved=!0),Hi(this._animRequest);var ue=O(d._move,d,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=qt(ue,this,!0),_n(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Hi(this._animRequest),Ui(document,"touchmove",this._onTouchMove,this),Ui(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});gi.addInitHook("addHandler","touchZoom",Ks),gi.BoxZoom=bo,gi.DoubleClickZoom=kl,gi.Drag=Ba,gi.Keyboard=al,gi.ScrollWheelZoom=qi,gi.TapHold=Ko,gi.TouchZoom=Ks,N.Bounds=ge,N.Browser=De,N.CRS=ii,N.Canvas=ln,N.Circle=qo,N.CircleMarker=$s,N.Class=xi,N.Control=ui,N.DivIcon=sl,N.DivOverlay=Ar,N.DomEvent=vl,N.DomUtil=On,N.Draggable=is,N.Evented=Ei,N.FeatureGroup=Zr,N.GeoJSON=Ts,N.GridLayer=Hs,N.Handler=Ur,N.Icon=yo,N.ImageOverlay=Ps,N.LatLng=Tt,N.LatLngBounds=Ft,N.Layer=Si,N.LayerGroup=Ci,N.LineUtil=Zo,N.Map=gi,N.Marker=Ss,N.Mixin=xl,N.Path=Zs,N.Point=qe,N.PolyUtil=Xu,N.Polygon=Mr,N.Polyline=Wn,N.Popup=ma,N.PosAnimation=Ma,N.Projection=gn,N.Rectangle=Xs,N.Renderer=Cs,N.SVG=Ws,N.SVGOverlay=nl,N.TileLayer=ns,N.Tooltip=Xo,N.Transformation=js,N.Util=Di,N.VideoOverlay=Go,N.bind=O,N.bounds=Ne,N.canvas=$r,N.circle=qs,N.circleMarker=La,N.control=xs,N.divIcon=ol,N.extend=ce,N.featureGroup=Aa,N.geoJSON=uu,N.geoJson=zr,N.gridLayer=Gs,N.icon=$o,N.imageOverlay=fa,N.latLng=wt,N.latLngBounds=It,N.layerGroup=ws,N.map=dr,N.marker=lu,N.point=He,N.polygon=Da,N.polyline=Tl,N.popup=xo,N.rectangle=hu,N.setOptions=Ue,N.stamp=ze,N.svg=wo,N.svgOverlay=Wo,N.tileLayer=Fn,N.tooltip=rl,N.transformation=wr,N.version=re,N.videoOverlay=pa;var Cl=window.L;N.noConflict=function(){return window.L=Cl,this},window.L=N})}(Xh,Xh.exports)),Xh.exports}var Kd=R_();const xp=Rf(Kd);function Up(Z,J,N){return Object.freeze({instance:Z,context:J,container:N})}function Zp(Z,J){return J==null?function(re,ce){const Me=Xe.useRef();return Me.current||(Me.current=Z(re,ce)),Me}:function(re,ce){const Me=Xe.useRef();Me.current||(Me.current=Z(re,ce));const O=Xe.useRef(re),{instance:g}=Me.current;return Xe.useEffect(function(){O.current!==re&&(J(g,re,O.current),O.current=re)},[g,re,ce]),Me}}function $p(Z,J){Xe.useEffect(function(){return(J.layerContainer??J.map).addLayer(Z.instance),function(){J.layerContainer?.removeLayer(Z.instance),J.map.removeLayer(Z.instance)}},[J,Z])}function B_(Z){return function(N){const re=Nf(),ce=Z(jf(N,re),re);return I_(re.map,N.attribution),Vp(ce.current,N.eventHandlers),$p(ce.current,re),ce}}function O_(Z,J){const N=Xe.useRef();Xe.useEffect(function(){if(J.pathOptions!==N.current){const ce=J.pathOptions??{};Z.instance.setStyle(ce),N.current=ce}},[Z,J])}function F_(Z){return function(N){const re=Nf(),ce=Z(jf(N,re),re);return Vp(ce.current,N.eventHandlers),$p(ce.current,re),O_(ce.current,N),ce}}function N_(Z,J){const N=Zp(Z,J),re=F_(N);return A_(re)}function j_(Z,J){const N=Zp(Z,J),re=B_(N);return L_(re)}function V_(Z,J,N){const{opacity:re,zIndex:ce}=J;re!=null&&re!==N.opacity&&Z.setOpacity(re),ce!=null&&ce!==N.zIndex&&Z.setZIndex(ce)}function U_(){return Nf().map}function qp(Z){const J=U_();return Xe.useEffect(function(){return J.on(Z),function(){J.off(Z)}},[J,Z]),J}const Z_=N_(function({data:J,...N},re){const ce=new Kd.GeoJSON(J,N);return Up(ce,z_(re,{overlayContainer:ce}))},function(J,N,re){N.style!==re.style&&(N.style==null?J.resetStyle():J.setStyle(N.style))});function Af(){return Af=Object.assign||function(Z){for(var J=1;J<arguments.length;J++){var N=arguments[J];for(var re in N)Object.prototype.hasOwnProperty.call(N,re)&&(Z[re]=N[re])}return Z},Af.apply(this,arguments)}function $_({bounds:Z,boundsOptions:J,center:N,children:re,className:ce,id:Me,placeholder:O,style:g,whenReady:ze,zoom:nt,...tt},xe){const[me]=Xe.useState({className:ce,id:Me,style:g}),[Ot,st]=Xe.useState(null);Xe.useImperativeHandle(xe,()=>Ot?.map??null,[Ot]);const Ue=Xe.useCallback($t=>{if($t!==null&&Ot===null){const Qt=new Kd.Map($t,tt);N!=null&&nt!=null?Qt.setView(N,nt):Z!=null&&Qt.fitBounds(Z,J),ze!=null&&Qt.whenReady(ze),st(M_(Qt))}},[]);Xe.useEffect(()=>()=>{Ot?.map.remove()},[Ot]);const Je=Ot?Hd.createElement(jp,{value:Ot},re):O??null;return Hd.createElement("div",Af({},me,{ref:Ue}),Je)}const q_=Xe.forwardRef($_),$d=j_(function({url:J,...N},re){const ce=new Kd.TileLayer(J,jf(N,re));return Up(ce,re)},function(J,N,re){V_(J,N,re);const{url:ce}=N;ce!=null&&ce!==re.url&&J.setUrl(ce)});var qd={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.7.1/LICENSE.txt
 */var H_=qd.exports,wp;function G_(){return wp||(wp=1,function(Z,J){(function(N,re){Z.exports=re()})(H_,function(){var N={},re={};function ce(O,g,ze){if(re[O]=ze,O==="index"){var nt="var sharedModule = {}; ("+re.shared+")(sharedModule); ("+re.worker+")(sharedModule);",tt={};return re.shared(tt),re.index(N,tt),typeof window<"u"&&N.setWorkerUrl(window.URL.createObjectURL(new Blob([nt],{type:"text/javascript"}))),N}}ce("shared",["exports"],function(O){function g(i,t,n,l){return new(n||(n=Promise))(function(h,_){function y(I){try{S(l.next(I))}catch(z){_(z)}}function w(I){try{S(l.throw(I))}catch(z){_(z)}}function S(I){var z;I.done?h(I.value):(z=I.value,z instanceof n?z:new n(function(D){D(z)})).then(y,w)}S((l=l.apply(i,t||[])).next())})}function ze(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}typeof SuppressedError=="function"&&SuppressedError;var nt=tt;function tt(i,t){this.x=i,this.y=t}tt.prototype={clone:function(){return new tt(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,t){return this.clone()._rotateAround(i,t)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var t=i.x-this.x,n=i.y-this.y;return t*t+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,t){return Math.atan2(this.x*t-this.y*i,this.x*i+this.y*t)},_matMult:function(i){var t=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=t,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var t=Math.cos(i),n=Math.sin(i),l=n*this.x+t*this.y;return this.x=t*this.x-n*this.y,this.y=l,this},_rotateAround:function(i,t){var n=Math.cos(i),l=Math.sin(i),h=t.y+l*(this.x-t.x)+n*(this.y-t.y);return this.x=t.x+n*(this.x-t.x)-l*(this.y-t.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},tt.convert=function(i){return i instanceof tt?i:Array.isArray(i)?new tt(i[0],i[1]):i};var xe=ze(nt),me=Ot;function Ot(i,t,n,l){this.cx=3*i,this.bx=3*(n-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=t,this.p2x=n,this.p2y=l}Ot.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,t){if(t===void 0&&(t=1e-6),i<0)return 0;if(i>1)return 1;for(var n=i,l=0;l<8;l++){var h=this.sampleCurveX(n)-i;if(Math.abs(h)<t)return n;var _=this.sampleCurveDerivativeX(n);if(Math.abs(_)<1e-6)break;n-=h/_}var y=0,w=1;for(n=i,l=0;l<20&&(h=this.sampleCurveX(n),!(Math.abs(h-i)<t));l++)i>h?y=n:w=n,n=.5*(w-y)+y;return n},solve:function(i,t){return this.sampleCurveY(this.solveCurveX(i,t))}};var st=ze(me);let Ue,Je;function $t(){return Ue==null&&(Ue=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Ue}function Qt(){if(Je==null&&(Je=!1,$t())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let l=0;l<25;l++){const h=4*l;t.fillStyle=`rgb(${h},${h+1},${h+2})`,t.fillRect(l%5,Math.floor(l/5),1,1)}const n=t.getImageData(0,0,5,5).data;for(let l=0;l<100;l++)if(l%4!=3&&n[l]!==l){Je=!0;break}}}return Je||!1}function Mt(i,t,n,l){const h=new st(i,t,n,l);return _=>h.solve(_)}const hi=Mt(.25,.1,.25,1);function li(i,t,n){return Math.min(n,Math.max(t,i))}function Ii(i,t,n){const l=n-t,h=((i-t)%l+l)%l+t;return h===t?n:h}function _i(i,...t){for(const n of t)for(const l in n)i[l]=n[l];return i}let nn=1;function an(i,t,n){const l={};for(const h in i)l[h]=t.call(this,i[h],h,i);return l}function Zn(i,t,n){const l={};for(const h in i)t.call(this,i[h],h,i)&&(l[h]=i[h]);return l}function qt(i){return Array.isArray(i)?i.map(qt):typeof i=="object"&&i?an(i,qt):i}const Hi={};function Di(i){Hi[i]||(typeof console<"u"&&console.warn(i),Hi[i]=!0)}function xi(i,t,n){return(n.y-i.y)*(t.x-i.x)>(t.y-i.y)*(n.x-i.x)}function Bn(i){return typeof WorkerGlobalScope<"u"&&i!==void 0&&i instanceof WorkerGlobalScope}let Bi=null;function Ei(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}const qe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Nt(i,t,n,l,h){return g(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const _=new VideoFrame(i,{timestamp:0});try{const y=_?.format;if(!y||!y.startsWith("BGR")&&!y.startsWith("RGB"))throw new Error(`Unrecognized format ${y}`);const w=y.startsWith("BGR"),S=new Uint8ClampedArray(l*h*4);if(yield _.copyTo(S,function(I,z,D,F,U){const H=4*Math.max(-z,0),K=(Math.max(0,D)-D)*F*4+H,ne=4*F,le=Math.max(0,z),ke=Math.max(0,D);return{rect:{x:le,y:ke,width:Math.min(I.width,z+F)-le,height:Math.min(I.height,D+U)-ke},layout:[{offset:K,stride:ne}]}}(i,t,n,l,h)),w)for(let I=0;I<S.length;I+=4){const z=S[I];S[I]=S[I+2],S[I+2]=z}return S}finally{_.close()}})}let He,ge;const Ne="AbortError";function Ft(){return new Error(Ne)}const It={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Tt(i){return It.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))]}const wt="global-dispatcher";class ii extends Error{constructor(t,n,l,h){super(`AJAXError: ${n} (${t}): ${l}`),this.status=t,this.statusText=n,this.url=l,this.body=h}}const ni=()=>Bn(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Oi=function(i,t){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){const l=Tt(i.url);if(l)return l(i,t);if(Bn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,targetMapId:wt},t)}if(!(/^file:/.test(n=i.url)||/^file:/.test(ni())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(l,h){return g(this,void 0,void 0,function*(){const _=new Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,cache:l.cache,referrer:ni(),signal:h.signal});l.type!=="json"||_.headers.has("Accept")||_.headers.set("Accept","application/json");const y=yield fetch(_);if(!y.ok){const I=yield y.blob();throw new ii(y.status,y.statusText,l.url,I)}let w;w=l.type==="arrayBuffer"||l.type==="image"?y.arrayBuffer():l.type==="json"?y.json():y.text();const S=yield w;if(h.signal.aborted)throw Ft();return{data:S,cacheControl:y.headers.get("Cache-Control"),expires:y.headers.get("Expires")}})}(i,t);if(Bn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,mustQueue:!0,targetMapId:wt},t)}var n;return function(l,h){return new Promise((_,y)=>{var w;const S=new XMLHttpRequest;S.open(l.method||"GET",l.url,!0),l.type!=="arrayBuffer"&&l.type!=="image"||(S.responseType="arraybuffer");for(const I in l.headers)S.setRequestHeader(I,l.headers[I]);l.type==="json"&&(S.responseType="text",!((w=l.headers)===null||w===void 0)&&w.Accept||S.setRequestHeader("Accept","application/json")),S.withCredentials=l.credentials==="include",S.onerror=()=>{y(new Error(S.statusText))},S.onload=()=>{if(!h.signal.aborted)if((S.status>=200&&S.status<300||S.status===0)&&S.response!==null){let I=S.response;if(l.type==="json")try{I=JSON.parse(S.response)}catch(z){return void y(z)}_({data:I,cacheControl:S.getResponseHeader("Cache-Control"),expires:S.getResponseHeader("Expires")})}else{const I=new Blob([S.response],{type:S.getResponseHeader("Content-Type")});y(new ii(S.status,S.statusText,l.url,I))}},h.signal.addEventListener("abort",()=>{S.abort(),y(Ft())}),S.send(l.body)})}(i,t)};function wn(i){if(!i||i.indexOf("://")<=0||i.indexOf("data:image/")===0||i.indexOf("blob:")===0)return!0;const t=new URL(i),n=window.location;return t.protocol===n.protocol&&t.host===n.host}function js(i,t,n){n[i]&&n[i].indexOf(t)!==-1||(n[i]=n[i]||[],n[i].push(t))}function wr(i,t,n){if(n&&n[i]){const l=n[i].indexOf(t);l!==-1&&n[i].splice(l,1)}}class Fr{constructor(t,n={}){_i(this,n),this.type=t}}class Vs extends Fr{constructor(t,n={}){super("error",_i({error:t},n))}}class Bo{on(t,n){return this._listeners=this._listeners||{},js(t,n,this._listeners),this}off(t,n){return wr(t,n,this._listeners),wr(t,n,this._oneTimeListeners),this}once(t,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},js(t,n,this._oneTimeListeners),this):new Promise(l=>this.once(t,l))}fire(t,n){typeof t=="string"&&(t=new Fr(t,n||{}));const l=t.type;if(this.listens(l)){t.target=this;const h=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const w of h)w.call(this,t);const _=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const w of _)wr(l,w,this._oneTimeListeners),w.call(this,t);const y=this._eventedParent;y&&(_i(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(t))}else t instanceof Vs&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,n){return this._eventedParent=t,this._eventedParentData=n,this}}var Le={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ps=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function uo(i,t){const n={};for(const l in i)l!=="ref"&&(n[l]=i[l]);return ps.forEach(l=>{l in t&&(n[l]=t[l])}),n}function Mi(i,t){if(Array.isArray(i)){if(!Array.isArray(t)||i.length!==t.length)return!1;for(let n=0;n<i.length;n++)if(!Mi(i[n],t[n]))return!1;return!0}if(typeof i=="object"&&i!==null&&t!==null){if(typeof t!="object"||Object.keys(i).length!==Object.keys(t).length)return!1;for(const n in i)if(!Mi(i[n],t[n]))return!1;return!0}return i===t}function $i(i,t){i.push(t)}function Kr(i,t,n){$i(n,{command:"addSource",args:[i,t[i]]})}function ms(i,t,n){$i(t,{command:"removeSource",args:[i]}),n[i]=!0}function _s(i,t,n,l){ms(i,n,l),Kr(i,t,n)}function ra(i,t,n){let l;for(l in i[n])if(Object.prototype.hasOwnProperty.call(i[n],l)&&l!=="data"&&!Mi(i[n][l],t[n][l]))return!1;for(l in t[n])if(Object.prototype.hasOwnProperty.call(t[n],l)&&l!=="data"&&!Mi(i[n][l],t[n][l]))return!1;return!0}function Nr(i,t,n,l,h,_){i=i||{},t=t||{};for(const y in i)Object.prototype.hasOwnProperty.call(i,y)&&(Mi(i[y],t[y])||n.push({command:_,args:[l,y,t[y],h]}));for(const y in t)Object.prototype.hasOwnProperty.call(t,y)&&!Object.prototype.hasOwnProperty.call(i,y)&&(Mi(i[y],t[y])||n.push({command:_,args:[l,y,t[y],h]}))}function Oo(i){return i.id}function Fo(i,t){return i[t.id]=t,i}class Qe{constructor(t,n,l,h){this.message=(t?`${t}: `:"")+l,h&&(this.identifier=h),n!=null&&n.__line__&&(this.line=n.__line__)}}function gs(i,...t){for(const n of t)for(const l in n)i[l]=n[l];return i}class Tn extends Error{constructor(t,n){super(n),this.message=n,this.key=t}}class ur{constructor(t,n=[]){this.parent=t,this.bindings={};for(const[l,h]of n)this.bindings[l]=h}concat(t){return new ur(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const No={kind:"null"},ot={kind:"number"},ri={kind:"string"},Ut={kind:"boolean"},tr={kind:"color"},$n={kind:"object"},Wt={kind:"value"},Jr={kind:"collator"},Yr={kind:"formatted"},br={kind:"padding"},ir={kind:"resolvedImage"},se={kind:"variableAnchorOffsetCollection"};function V(i,t){return{kind:"array",itemType:i,N:t}}function j(i){if(i.kind==="array"){const t=j(i.itemType);return typeof i.N=="number"?`array<${t}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${t}>`}return i.kind}const W=[No,ot,ri,Ut,tr,Yr,$n,V(Wt),br,ir,se];function te(i,t){if(t.kind==="error")return null;if(i.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!te(i.itemType,t.itemType))&&(typeof i.N!="number"||i.N===t.N))return null}else{if(i.kind===t.kind)return null;if(i.kind==="value"){for(const n of W)if(!te(n,t))return null}}return`Expected ${j(i)} but found ${j(t)} instead.`}function fe(i,t){return t.some(n=>n.kind===i.kind)}function ve(i,t){return t.some(n=>n==="null"?i===null:n==="array"?Array.isArray(i):n==="object"?i&&!Array.isArray(i)&&typeof i=="object":n===typeof i)}function Se(i,t){return i.kind==="array"&&t.kind==="array"?i.itemType.kind===t.itemType.kind&&typeof i.N=="number":i.kind===t.kind}const he=.96422,Be=.82521,Ze=4/29,Ie=6/29,De=3*Ie*Ie,Pt=Ie*Ie*Ie,zt=Math.PI/180,ki=180/Math.PI;function ei(i){return(i%=360)<0&&(i+=360),i}function bi([i,t,n,l]){let h,_;const y=Xi((.2225045*(i=si(i))+.7168786*(t=si(t))+.0606169*(n=si(n)))/1);i===t&&t===n?h=_=y:(h=Xi((.4360747*i+.3850649*t+.1430804*n)/he),_=Xi((.0139322*i+.0971045*t+.7141733*n)/Be));const w=116*y-16;return[w<0?0:w,500*(h-y),200*(y-_),l]}function si(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Xi(i){return i>Pt?Math.pow(i,1/3):i/De+Ze}function rn([i,t,n,l]){let h=(i+16)/116,_=isNaN(t)?h:h+t/500,y=isNaN(n)?h:h-n/200;return h=1*Fi(h),_=he*Fi(_),y=Be*Fi(y),[fi(3.1338561*_-1.6168667*h-.4906146*y),fi(-.9787684*_+1.9161415*h+.033454*y),fi(.0719453*_-.2289914*h+1.4052427*y),l]}function fi(i){return(i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055)<0?0:i>1?1:i}function Fi(i){return i>Ie?i*i*i:De*(i-Ze)}function Ki(i){return parseInt(i.padEnd(2,i),16)/255}function En(i,t){return Mn(t?i/100:i,0,1)}function Mn(i,t,n){return Math.min(Math.max(t,i),n)}function cr(i){return!i.some(Number.isNaN)}const co={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Xt{constructor(t,n,l,h=1,_=!0){this.r=t,this.g=n,this.b=l,this.a=h,_||(this.r*=h,this.g*=h,this.b*=h,h||this.overwriteGetter("rgb",[t,n,l,h]))}static parse(t){if(t instanceof Xt)return t;if(typeof t!="string")return;const n=function(l){if((l=l.toLowerCase().trim())==="transparent")return[0,0,0,0];const h=co[l];if(h){const[y,w,S]=h;return[y/255,w/255,S/255,1]}if(l.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(l)){const y=l.length<6?1:2;let w=1;return[Ki(l.slice(w,w+=y)),Ki(l.slice(w,w+=y)),Ki(l.slice(w,w+=y)),Ki(l.slice(w,w+y)||"ff")]}if(l.startsWith("rgb")){const y=l.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[w,S,I,z,D,F,U,H,K,ne,le,ke]=y,pe=[z||" ",U||" ",ne].join("");if(pe==="  "||pe==="  /"||pe===",,"||pe===",,,"){const Te=[I,F,K].join(""),Fe=Te==="%%%"?100:Te===""?255:0;if(Fe){const We=[Mn(+S/Fe,0,1),Mn(+D/Fe,0,1),Mn(+H/Fe,0,1),le?En(+le,ke):1];if(cr(We))return We}}return}}const _=l.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[y,w,S,I,z,D,F,U,H]=_,K=[S||" ",z||" ",F].join("");if(K==="  "||K==="  /"||K===",,"||K===",,,"){const ne=[+w,Mn(+I,0,100),Mn(+D,0,100),U?En(+U,H):1];if(cr(ne))return function([le,ke,pe,Te]){function Fe(We){const yt=(We+le/30)%12,Zt=ke*Math.min(pe,1-pe);return pe-Zt*Math.max(-1,Math.min(yt-3,9-yt,1))}return le=ei(le),ke/=100,pe/=100,[Fe(0),Fe(8),Fe(4),Te]}(ne)}}}(t);return n?new Xt(...n,!1):void 0}get rgb(){const{r:t,g:n,b:l,a:h}=this,_=h||1/0;return this.overwriteGetter("rgb",[t/_,n/_,l/_,h])}get hcl(){return this.overwriteGetter("hcl",function(t){const[n,l,h,_]=bi(t),y=Math.sqrt(l*l+h*h);return[Math.round(1e4*y)?ei(Math.atan2(h,l)*ki):NaN,y,n,_]}(this.rgb))}get lab(){return this.overwriteGetter("lab",bi(this.rgb))}overwriteGetter(t,n){return Object.defineProperty(this,t,{value:n}),n}toString(){const[t,n,l,h]=this.rgb;return`rgba(${[t,n,l].map(_=>Math.round(255*_)).join(",")},${h})`}}Xt.black=new Xt(0,0,0,1),Xt.white=new Xt(1,1,1,1),Xt.transparent=new Xt(0,0,0,0),Xt.red=new Xt(1,0,0,1);class Kl{constructor(t,n,l){this.sensitivity=t?n?"variant":"case":n?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,n){return this.collator.compare(t,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ha{constructor(t,n,l,h,_){this.text=t,this.image=n,this.scale=l,this.fontStack=h,this.textColor=_}}class Sr{constructor(t){this.sections=t}static fromString(t){return new Sr([new Ha(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Sr?t:Sr.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class nr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof nr)return t;if(typeof t=="number")return new nr([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const n of t)if(typeof n!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new nr(t)}}toString(){return JSON.stringify(this.values)}}const Jl=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class qn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof qn)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let n=0;n<t.length;n+=2){const l=t[n],h=t[n+1];if(typeof l!="string"||!Jl.has(l)||!Array.isArray(h)||h.length!==2||typeof h[0]!="number"||typeof h[1]!="number")return}return new qn(t)}}toString(){return JSON.stringify(this.values)}}class Hn{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Hn({name:t,available:!1}):null}}function rr(i,t,n,l){return typeof i=="number"&&i>=0&&i<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof n=="number"&&n>=0&&n<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[i,t,n,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[i,t,n,l]:[i,t,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ys(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof Xt||i instanceof Kl||i instanceof Sr||i instanceof nr||i instanceof qn||i instanceof Hn)return!0;if(Array.isArray(i)){for(const t of i)if(!ys(t))return!1;return!0}if(typeof i=="object"){for(const t in i)if(!ys(i[t]))return!1;return!0}return!1}function Lt(i){if(i===null)return No;if(typeof i=="string")return ri;if(typeof i=="boolean")return Ut;if(typeof i=="number")return ot;if(i instanceof Xt)return tr;if(i instanceof Kl)return Jr;if(i instanceof Sr)return Yr;if(i instanceof nr)return br;if(i instanceof qn)return se;if(i instanceof Hn)return ir;if(Array.isArray(i)){const t=i.length;let n;for(const l of i){const h=Lt(l);if(n){if(n===h)continue;n=Wt;break}n=h}return V(n||Wt,t)}return $n}function Gi(i){const t=typeof i;return i===null?"":t==="string"||t==="number"||t==="boolean"?String(i):i instanceof Xt||i instanceof Sr||i instanceof nr||i instanceof qn||i instanceof Hn?i.toString():JSON.stringify(i)}class Tr{constructor(t,n){this.type=t,this.value=n}static parse(t,n){if(t.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!ys(t[1]))return n.error("invalid value");const l=t[1];let h=Lt(l);const _=n.expectedType;return h.kind!=="array"||h.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(h=_),new Tr(h,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Ji{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const Qr={string:ri,number:ot,boolean:Ut,object:$n};class sr{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let l,h=1;const _=t[0];if(_==="array"){let w,S;if(t.length>2){const I=t[1];if(typeof I!="string"||!(I in Qr)||I==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);w=Qr[I],h++}else w=Wt;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return n.error('The length argument to "array" must be a positive integer literal',2);S=t[2],h++}l=V(w,S)}else{if(!Qr[_])throw new Error(`Types doesn't contain name = ${_}`);l=Qr[_]}const y=[];for(;h<t.length;h++){const w=n.parse(t[h],h,Wt);if(!w)return null;y.push(w)}return new sr(l,y)}evaluate(t){for(let n=0;n<this.args.length;n++){const l=this.args[n].evaluate(t);if(!te(this.type,Lt(l)))return l;if(n===this.args.length-1)throw new Ji(`Expected value to be of type ${j(this.type)}, but found ${j(Lt(l))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const oi={"to-boolean":Ut,"to-color":tr,"to-number":ot,"to-string":ri};class Ai{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const l=t[0];if(!oi[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&t.length!==2)return n.error("Expected one argument.");const h=oi[l],_=[];for(let y=1;y<t.length;y++){const w=n.parse(t[y],y,Wt);if(!w)return null;_.push(w)}return new Ai(h,_)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let n,l;for(const h of this.args){if(n=h.evaluate(t),l=null,n instanceof Xt)return n;if(typeof n=="string"){const _=t.parseColor(n);if(_)return _}else if(Array.isArray(n)&&(l=n.length<3||n.length>4?`Invalid rbga value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:rr(n[0],n[1],n[2],n[3]),!l))return new Xt(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new Ji(l||`Could not parse color from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"padding":{let n;for(const l of this.args){n=l.evaluate(t);const h=nr.parse(n);if(h)return h}throw new Ji(`Could not parse padding from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"variableAnchorOffsetCollection":{let n;for(const l of this.args){n=l.evaluate(t);const h=qn.parse(n);if(h)return h}throw new Ji(`Could not parse variableAnchorOffsetCollection from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"number":{let n=null;for(const l of this.args){if(n=l.evaluate(t),n===null)return 0;const h=Number(n);if(!isNaN(h))return h}throw new Ji(`Could not convert ${JSON.stringify(n)} to number.`)}case"formatted":return Sr.fromString(Gi(this.args[0].evaluate(t)));case"resolvedImage":return Hn.fromString(Gi(this.args[0].evaluate(t)));default:return Gi(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Yl=["Unknown","Point","LineString","Polygon"];class sa{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Yl[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let n=this._parseColorCache[t];return n||(n=this._parseColorCache[t]=Xt.parse(t)),n}}class Pn{constructor(t,n,l=[],h,_=new ur,y=[]){this.registry=t,this.path=l,this.key=l.map(w=>`[${w}]`).join(""),this.scope=_,this.errors=y,this.expectedType=h,this._isConstant=n}parse(t,n,l,h,_={}){return n?this.concat(n,l,h)._parse(t,_):this._parse(t,_)}_parse(t,n){function l(h,_,y){return y==="assert"?new sr(_,[h]):y==="coerce"?new Ai(_,[h]):h}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=t[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[h];if(_){let y=_.parse(t,this);if(!y)return null;if(this.expectedType){const w=this.expectedType,S=y.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||S.kind!=="value")if(w.kind!=="color"&&w.kind!=="formatted"&&w.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string")if(w.kind!=="padding"||S.kind!=="value"&&S.kind!=="number"&&S.kind!=="array")if(w.kind!=="variableAnchorOffsetCollection"||S.kind!=="value"&&S.kind!=="array"){if(this.checkSubtype(w,S))return null}else y=l(y,w,n.typeAnnotation||"coerce");else y=l(y,w,n.typeAnnotation||"coerce");else y=l(y,w,n.typeAnnotation||"coerce");else y=l(y,w,n.typeAnnotation||"assert")}if(!(y instanceof Tr)&&y.type.kind!=="resolvedImage"&&this._isConstant(y)){const w=new sa;try{y=new Tr(y.type,y.evaluate(w))}catch(S){return this.error(S.message),null}}return y}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,n,l){const h=typeof t=="number"?this.path.concat(t):this.path,_=l?this.scope.concat(l):this.scope;return new Pn(this.registry,this._isConstant,h,n||null,_,this.errors)}error(t,...n){const l=`${this.key}${n.map(h=>`[${h}]`).join("")}`;this.errors.push(new Tn(l,t))}checkSubtype(t,n){const l=te(t,n);return l&&this.error(l),l}}class ho{constructor(t,n){this.type=n.type,this.bindings=[].concat(t),this.result=n}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const n of this.bindings)t(n[1]);t(this.result)}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const l=[];for(let _=1;_<t.length-1;_+=2){const y=t[_];if(typeof y!="string")return n.error(`Expected string, but found ${typeof y} instead.`,_);if(/[^a-zA-Z0-9_]/.test(y))return n.error("Variable names must contain only alphanumeric characters or '_'.",_);const w=n.parse(t[_+1],_+1);if(!w)return null;l.push([y,w])}const h=n.parse(t[t.length-1],t.length-1,n.expectedType,l);return h?new ho(l,h):null}outputDefined(){return this.result.outputDefined()}}class wi{constructor(t,n){this.type=n.type,this.name=t,this.boundExpression=n}static parse(t,n){if(t.length!==2||typeof t[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const l=t[1];return n.scope.has(l)?new wi(l,n.scope.get(l)):n.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class jr{constructor(t,n,l){this.type=t,this.index=n,this.input=l}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=n.parse(t[1],1,ot),h=n.parse(t[2],2,V(n.expectedType||Wt));return l&&h?new jr(h.type.itemType,l,h):null}evaluate(t){const n=this.index.evaluate(t),l=this.input.evaluate(t);if(n<0)throw new Ji(`Array index out of bounds: ${n} < 0.`);if(n>=l.length)throw new Ji(`Array index out of bounds: ${n} > ${l.length-1}.`);if(n!==Math.floor(n))throw new Ji(`Array index must be an integer, but found ${n} instead.`);return l[n]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class mn{constructor(t,n){this.type=Ut,this.needle=t,this.haystack=n}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=n.parse(t[1],1,Wt),h=n.parse(t[2],2,Wt);return l&&h?fe(l.type,[Ut,ri,ot,No,Wt])?new mn(l,h):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${j(l.type)} instead`):null}evaluate(t){const n=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!l)return!1;if(!ve(n,["boolean","string","number","null"]))throw new Ji(`Expected first argument to be of type boolean, string, number or null, but found ${j(Lt(n))} instead.`);if(!ve(l,["string","array"]))throw new Ji(`Expected second argument to be of type array or string, but found ${j(Lt(l))} instead.`);return l.indexOf(n)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class Pr{constructor(t,n,l){this.type=ot,this.needle=t,this.haystack=n,this.fromIndex=l}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=n.parse(t[1],1,Wt),h=n.parse(t[2],2,Wt);if(!l||!h)return null;if(!fe(l.type,[Ut,ri,ot,No,Wt]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${j(l.type)} instead`);if(t.length===4){const _=n.parse(t[3],3,ot);return _?new Pr(l,h,_):null}return new Pr(l,h)}evaluate(t){const n=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!ve(n,["boolean","string","number","null"]))throw new Ji(`Expected first argument to be of type boolean, string, number or null, but found ${j(Lt(n))} instead.`);let h;if(this.fromIndex&&(h=this.fromIndex.evaluate(t)),ve(l,["string"])){const _=l.indexOf(n,h);return _===-1?-1:[...l.slice(0,_)].length}if(ve(l,["array"]))return l.indexOf(n,h);throw new Ji(`Expected second argument to be of type array or string, but found ${j(Lt(l))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class zi{constructor(t,n,l,h,_,y){this.inputType=t,this.type=n,this.input=l,this.cases=h,this.outputs=_,this.otherwise=y}static parse(t,n){if(t.length<5)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return n.error("Expected an even number of arguments.");let l,h;n.expectedType&&n.expectedType.kind!=="value"&&(h=n.expectedType);const _={},y=[];for(let I=2;I<t.length-1;I+=2){let z=t[I];const D=t[I+1];Array.isArray(z)||(z=[z]);const F=n.concat(I);if(z.length===0)return F.error("Expected at least one branch label.");for(const H of z){if(typeof H!="number"&&typeof H!="string")return F.error("Branch labels must be numbers or strings.");if(typeof H=="number"&&Math.abs(H)>Number.MAX_SAFE_INTEGER)return F.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof H=="number"&&Math.floor(H)!==H)return F.error("Numeric branch labels must be integer values.");if(l){if(F.checkSubtype(l,Lt(H)))return null}else l=Lt(H);if(_[String(H)]!==void 0)return F.error("Branch labels must be unique.");_[String(H)]=y.length}const U=n.parse(D,I,h);if(!U)return null;h=h||U.type,y.push(U)}const w=n.parse(t[1],1,Wt);if(!w)return null;const S=n.parse(t[t.length-1],t.length-1,h);return S?w.type.kind!=="value"&&n.concat(1).checkSubtype(l,w.type)?null:new zi(l,h,w,_,y,S):null}evaluate(t){const n=this.input.evaluate(t);return(Lt(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class fo{constructor(t,n,l){this.type=t,this.branches=n,this.otherwise=l}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return n.error("Expected an odd number of arguments.");let l;n.expectedType&&n.expectedType.kind!=="value"&&(l=n.expectedType);const h=[];for(let y=1;y<t.length-1;y+=2){const w=n.parse(t[y],y,Ut);if(!w)return null;const S=n.parse(t[y+1],y+1,l);if(!S)return null;h.push([w,S]),l=l||S.type}const _=n.parse(t[t.length-1],t.length-1,l);if(!_)return null;if(!l)throw new Error("Can't infer output type");return new fo(l,h,_)}evaluate(t){for(const[n,l]of this.branches)if(n.evaluate(t))return l.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[n,l]of this.branches)t(n),t(l);t(this.otherwise)}outputDefined(){return this.branches.every(([t,n])=>n.outputDefined())&&this.otherwise.outputDefined()}}class jo{constructor(t,n,l,h){this.type=t,this.input=n,this.beginIndex=l,this.endIndex=h}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=n.parse(t[1],1,Wt),h=n.parse(t[2],2,ot);if(!l||!h)return null;if(!fe(l.type,[V(Wt),ri,Wt]))return n.error(`Expected first argument to be of type array or string, but found ${j(l.type)} instead`);if(t.length===4){const _=n.parse(t[3],3,ot);return _?new jo(l.type,l,h,_):null}return new jo(l.type,l,h)}evaluate(t){const n=this.input.evaluate(t),l=this.beginIndex.evaluate(t);let h;if(this.endIndex&&(h=this.endIndex.evaluate(t)),ve(n,["string"]))return[...n].slice(l,h).join("");if(ve(n,["array"]))return n.slice(l,h);throw new Ji(`Expected first argument to be of type array or string, but found ${j(Lt(n))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Us(i,t){const n=i.length-1;let l,h,_=0,y=n,w=0;for(;_<=y;)if(w=Math.floor((_+y)/2),l=i[w],h=i[w+1],l<=t){if(w===n||t<h)return w;_=w+1}else{if(!(l>t))throw new Ji("Input is not a number.");y=w-1}return 0}class po{constructor(t,n,l){this.type=t,this.input=n,this.labels=[],this.outputs=[];for(const[h,_]of l)this.labels.push(h),this.outputs.push(_)}static parse(t,n){if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");const l=n.parse(t[1],1,ot);if(!l)return null;const h=[];let _=null;n.expectedType&&n.expectedType.kind!=="value"&&(_=n.expectedType);for(let y=1;y<t.length;y+=2){const w=y===1?-1/0:t[y],S=t[y+1],I=y,z=y+1;if(typeof w!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(h.length&&h[h.length-1][0]>=w)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);const D=n.parse(S,z,_);if(!D)return null;_=_||D.type,h.push([w,D])}return new po(_,l,h)}evaluate(t){const n=this.labels,l=this.outputs;if(n.length===1)return l[0].evaluate(t);const h=this.input.evaluate(t);if(h<=n[0])return l[0].evaluate(t);const _=n.length;return h>=n[_-1]?l[_-1].evaluate(t):l[Us(n,h)].evaluate(t)}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Ga(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Wa=Ia;function Ia(i,t,n,l){this.cx=3*i,this.bx=3*(n-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=t,this.p2x=n,this.p2y=l}Ia.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,t){if(t===void 0&&(t=1e-6),i<0)return 0;if(i>1)return 1;for(var n=i,l=0;l<8;l++){var h=this.sampleCurveX(n)-i;if(Math.abs(h)<t)return n;var _=this.sampleCurveDerivativeX(n);if(Math.abs(_)<1e-6)break;n-=h/_}var y=0,w=1;for(n=i,l=0;l<20&&(h=this.sampleCurveX(n),!(Math.abs(h-i)<t));l++)i>h?y=n:w=n,n=.5*(w-y)+y;return n},solve:function(i,t){return this.sampleCurveY(this.solveCurveX(i,t))}};var Ea=Ga(Wa);function Gn(i,t,n){return i+n*(t-i)}function Vr(i,t,n){return i.map((l,h)=>Gn(l,t[h],n))}const dn={number:Gn,color:function(i,t,n,l="rgb"){switch(l){case"rgb":{const[h,_,y,w]=Vr(i.rgb,t.rgb,n);return new Xt(h,_,y,w,!1)}case"hcl":{const[h,_,y,w]=i.hcl,[S,I,z,D]=t.hcl;let F,U;if(isNaN(h)||isNaN(S))isNaN(h)?isNaN(S)?F=NaN:(F=S,y!==1&&y!==0||(U=I)):(F=h,z!==1&&z!==0||(U=_));else{let ke=S-h;S>h&&ke>180?ke-=360:S<h&&h-S>180&&(ke+=360),F=h+n*ke}const[H,K,ne,le]=function([ke,pe,Te,Fe]){return ke=isNaN(ke)?0:ke*zt,rn([Te,Math.cos(ke)*pe,Math.sin(ke)*pe,Fe])}([F,U??Gn(_,I,n),Gn(y,z,n),Gn(w,D,n)]);return new Xt(H,K,ne,le,!1)}case"lab":{const[h,_,y,w]=rn(Vr(i.lab,t.lab,n));return new Xt(h,_,y,w,!1)}}},array:Vr,padding:function(i,t,n){return new nr(Vr(i.values,t.values,n))},variableAnchorOffsetCollection:function(i,t,n){const l=i.values,h=t.values;if(l.length!==h.length)throw new Ji(`Cannot interpolate values of different length. from: ${i.toString()}, to: ${t.toString()}`);const _=[];for(let y=0;y<l.length;y+=2){if(l[y]!==h[y])throw new Ji(`Cannot interpolate values containing mismatched anchors. from[${y}]: ${l[y]}, to[${y}]: ${h[y]}`);_.push(l[y]);const[w,S]=l[y+1],[I,z]=h[y+1];_.push([Gn(w,I,n),Gn(S,z,n)])}return new qn(_)}};class On{constructor(t,n,l,h,_){this.type=t,this.operator=n,this.interpolation=l,this.input=h,this.labels=[],this.outputs=[];for(const[y,w]of _)this.labels.push(y),this.outputs.push(w)}static interpolationFactor(t,n,l,h){let _=0;if(t.name==="exponential")_=Jt(n,t.base,l,h);else if(t.name==="linear")_=Jt(n,1,l,h);else if(t.name==="cubic-bezier"){const y=t.controlPoints;_=new Ea(y[0],y[1],y[2],y[3]).solve(Jt(n,1,l,h))}return _}static parse(t,n){let[l,h,_,...y]=t;if(!Array.isArray(h)||h.length===0)return n.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const I=h[1];if(typeof I!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:I}}else{if(h[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const I=h.slice(1);if(I.length!==4||I.some(z=>typeof z!="number"||z<0||z>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:I}}}if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(_=n.parse(_,2,ot),!_)return null;const w=[];let S=null;l==="interpolate-hcl"||l==="interpolate-lab"?S=tr:n.expectedType&&n.expectedType.kind!=="value"&&(S=n.expectedType);for(let I=0;I<y.length;I+=2){const z=y[I],D=y[I+1],F=I+3,U=I+4;if(typeof z!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(w.length&&w[w.length-1][0]>=z)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',F);const H=n.parse(D,U,S);if(!H)return null;S=S||H.type,w.push([z,H])}return Se(S,ot)||Se(S,tr)||Se(S,br)||Se(S,se)||Se(S,V(ot))?new On(S,l,h,_,w):n.error(`Type ${j(S)} is not interpolatable.`)}evaluate(t){const n=this.labels,l=this.outputs;if(n.length===1)return l[0].evaluate(t);const h=this.input.evaluate(t);if(h<=n[0])return l[0].evaluate(t);const _=n.length;if(h>=n[_-1])return l[_-1].evaluate(t);const y=Us(n,h),w=On.interpolationFactor(this.interpolation,h,n[y],n[y+1]),S=l[y].evaluate(t),I=l[y+1].evaluate(t);switch(this.operator){case"interpolate":return dn[this.type.kind](S,I,w);case"interpolate-hcl":return dn.color(S,I,w,"hcl");case"interpolate-lab":return dn.color(S,I,w,"lab")}}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Jt(i,t,n,l){const h=l-n,_=i-n;return h===0?0:t===1?_/h:(Math.pow(t,_)-1)/(Math.pow(t,h)-1)}class kn{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expectected at least one argument.");let l=null;const h=n.expectedType;h&&h.kind!=="value"&&(l=h);const _=[];for(const w of t.slice(1)){const S=n.parse(w,1+_.length,l,void 0,{typeAnnotation:"omit"});if(!S)return null;l=l||S.type,_.push(S)}if(!l)throw new Error("No output type");const y=h&&_.some(w=>te(h,w.type));return new kn(y?Wt:l,_)}evaluate(t){let n,l=null,h=0;for(const _ of this.args)if(h++,l=_.evaluate(t),l&&l instanceof Hn&&!l.available&&(n||(n=l.name),l=null,h===this.args.length&&(l=n)),l!==null)break;return l}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function Ui(i,t){return i==="=="||i==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function _l(i,t,n,l){return l.compare(t,n)===0}function es(i,t,n){const l=i!=="=="&&i!=="!=";return class Hp{constructor(_,y,w){this.type=Ut,this.lhs=_,this.rhs=y,this.collator=w,this.hasUntypedArgument=_.type.kind==="value"||y.type.kind==="value"}static parse(_,y){if(_.length!==3&&_.length!==4)return y.error("Expected two or three arguments.");const w=_[0];let S=y.parse(_[1],1,Wt);if(!S)return null;if(!Ui(w,S.type))return y.concat(1).error(`"${w}" comparisons are not supported for type '${j(S.type)}'.`);let I=y.parse(_[2],2,Wt);if(!I)return null;if(!Ui(w,I.type))return y.concat(2).error(`"${w}" comparisons are not supported for type '${j(I.type)}'.`);if(S.type.kind!==I.type.kind&&S.type.kind!=="value"&&I.type.kind!=="value")return y.error(`Cannot compare types '${j(S.type)}' and '${j(I.type)}'.`);l&&(S.type.kind==="value"&&I.type.kind!=="value"?S=new sr(I.type,[S]):S.type.kind!=="value"&&I.type.kind==="value"&&(I=new sr(S.type,[I])));let z=null;if(_.length===4){if(S.type.kind!=="string"&&I.type.kind!=="string"&&S.type.kind!=="value"&&I.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(z=y.parse(_[3],3,Jr),!z)return null}return new Hp(S,I,z)}evaluate(_){const y=this.lhs.evaluate(_),w=this.rhs.evaluate(_);if(l&&this.hasUntypedArgument){const S=Lt(y),I=Lt(w);if(S.kind!==I.kind||S.kind!=="string"&&S.kind!=="number")throw new Ji(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${S.kind}, ${I.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const S=Lt(y),I=Lt(w);if(S.kind!=="string"||I.kind!=="string")return t(_,y,w)}return this.collator?n(_,y,w,this.collator.evaluate(_)):t(_,y,w)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}}}const Ql=es("==",function(i,t,n){return t===n},_l),Xa=es("!=",function(i,t,n){return t!==n},function(i,t,n,l){return!_l(0,t,n,l)}),vs=es("<",function(i,t,n){return t<n},function(i,t,n,l){return l.compare(t,n)<0}),gl=es(">",function(i,t,n){return t>n},function(i,t,n,l){return l.compare(t,n)>0}),Ka=es("<=",function(i,t,n){return t<=n},function(i,t,n,l){return l.compare(t,n)<=0}),_n=es(">=",function(i,t,n){return t>=n},function(i,t,n,l){return l.compare(t,n)>=0});class hr{constructor(t,n,l){this.type=Jr,this.locale=l,this.caseSensitive=t,this.diacriticSensitive=n}static parse(t,n){if(t.length!==2)return n.error("Expected one argument.");const l=t[1];if(typeof l!="object"||Array.isArray(l))return n.error("Collator options argument must be an object.");const h=n.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,Ut);if(!h)return null;const _=n.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,Ut);if(!_)return null;let y=null;return l.locale&&(y=n.parse(l.locale,1,ri),!y)?null:new hr(h,_,y)}evaluate(t){return new Kl(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class mo{constructor(t,n,l,h,_){this.type=ri,this.number=t,this.locale=n,this.currency=l,this.minFractionDigits=h,this.maxFractionDigits=_}static parse(t,n){if(t.length!==3)return n.error("Expected two arguments.");const l=n.parse(t[1],1,ot);if(!l)return null;const h=t[2];if(typeof h!="object"||Array.isArray(h))return n.error("NumberFormat options argument must be an object.");let _=null;if(h.locale&&(_=n.parse(h.locale,1,ri),!_))return null;let y=null;if(h.currency&&(y=n.parse(h.currency,1,ri),!y))return null;let w=null;if(h["min-fraction-digits"]&&(w=n.parse(h["min-fraction-digits"],1,ot),!w))return null;let S=null;return h["max-fraction-digits"]&&(S=n.parse(h["max-fraction-digits"],1,ot),!S)?null:new mo(l,_,y,w,S)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Vo{constructor(t){this.type=Yr,this.sections=t}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const l=t[1];if(!Array.isArray(l)&&typeof l=="object")return n.error("First argument must be an image or text section.");const h=[];let _=!1;for(let y=1;y<=t.length-1;++y){const w=t[y];if(_&&typeof w=="object"&&!Array.isArray(w)){_=!1;let S=null;if(w["font-scale"]&&(S=n.parse(w["font-scale"],1,ot),!S))return null;let I=null;if(w["text-font"]&&(I=n.parse(w["text-font"],1,V(ri)),!I))return null;let z=null;if(w["text-color"]&&(z=n.parse(w["text-color"],1,tr),!z))return null;const D=h[h.length-1];D.scale=S,D.font=I,D.textColor=z}else{const S=n.parse(t[y],1,Wt);if(!S)return null;const I=S.type.kind;if(I!=="string"&&I!=="value"&&I!=="null"&&I!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,h.push({content:S,scale:null,font:null,textColor:null})}}return new Vo(h)}evaluate(t){return new Sr(this.sections.map(n=>{const l=n.content.evaluate(t);return Lt(l)===ir?new Ha("",l,null,null,null):new Ha(Gi(l),null,n.scale?n.scale.evaluate(t):null,n.font?n.font.evaluate(t).join(","):null,n.textColor?n.textColor.evaluate(t):null)}))}eachChild(t){for(const n of this.sections)t(n.content),n.scale&&t(n.scale),n.font&&t(n.font),n.textColor&&t(n.textColor)}outputDefined(){return!1}}class eu{constructor(t){this.type=ir,this.input=t}static parse(t,n){if(t.length!==2)return n.error("Expected two arguments.");const l=n.parse(t[1],1,ri);return l?new eu(l):n.error("No image name provided.")}evaluate(t){const n=this.input.evaluate(t),l=Hn.fromString(n);return l&&t.availableImages&&(l.available=t.availableImages.indexOf(n)>-1),l}eachChild(t){t(this.input)}outputDefined(){return!1}}class yl{constructor(t){this.type=ot,this.input=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const l=n.parse(t[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${j(l.type)} instead.`):new yl(l):null}evaluate(t){const n=this.input.evaluate(t);if(typeof n=="string")return[...n].length;if(Array.isArray(n))return n.length;throw new Ji(`Expected value to be of type string or array, but found ${j(Lt(n))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const kr=8192;function vl(i,t){const n=(180+i[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(n*h*kr),Math.round(l*h*kr)]}function Ma(i,t){const n=Math.pow(2,t.z);return[(h=(i[0]/kr+t.x)/n,360*h-180),(l=(i[1]/kr+t.y)/n,360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90)];var l,h}function gi(i,t){i[0]=Math.min(i[0],t[0]),i[1]=Math.min(i[1],t[1]),i[2]=Math.max(i[2],t[0]),i[3]=Math.max(i[3],t[1])}function dr(i,t){return!(i[0]<=t[0]||i[2]>=t[2]||i[1]<=t[1]||i[3]>=t[3])}function ui(i,t,n){const l=i[0]-t[0],h=i[1]-t[1],_=i[0]-n[0],y=i[1]-n[1];return l*y-_*h==0&&l*_<=0&&h*y<=0}function xs(i,t,n,l){return(h=[l[0]-n[0],l[1]-n[1]])[0]*(_=[t[0]-i[0],t[1]-i[1]])[1]-h[1]*_[0]!=0&&!(!oa(i,t,n,l)||!oa(n,l,i,t));var h,_}function tu(i,t,n){for(const l of n)for(let h=0;h<l.length-1;++h)if(xs(i,t,l[h],l[h+1]))return!0;return!1}function _o(i,t,n=!1){let l=!1;for(const w of t)for(let S=0;S<w.length-1;S++){if(ui(i,w[S],w[S+1]))return n;(_=w[S])[1]>(h=i)[1]!=(y=w[S+1])[1]>h[1]&&h[0]<(y[0]-_[0])*(h[1]-_[1])/(y[1]-_[1])+_[0]&&(l=!l)}var h,_,y;return l}function za(i,t){for(const n of t)if(_o(i,n))return!0;return!1}function iu(i,t){for(const n of i)if(!_o(n,t))return!1;for(let n=0;n<i.length-1;++n)if(tu(i[n],i[n+1],t))return!1;return!0}function Cr(i,t){for(const n of t)if(iu(i,n))return!0;return!1}function oa(i,t,n,l){const h=l[0]-n[0],_=l[1]-n[1],y=(i[0]-n[0])*_-h*(i[1]-n[1]),w=(t[0]-n[0])*_-h*(t[1]-n[1]);return y>0&&w<0||y<0&&w>0}function Ja(i,t,n){const l=[];for(let h=0;h<i.length;h++){const _=[];for(let y=0;y<i[h].length;y++){const w=vl(i[h][y],n);gi(t,w),_.push(w)}l.push(_)}return l}function Uo(i,t,n){const l=[];for(let h=0;h<i.length;h++){const _=Ja(i[h],t,n);l.push(_)}return l}function Eu(i,t,n,l){if(i[0]<n[0]||i[0]>n[2]){const h=.5*l;let _=i[0]-n[0]>h?-l:n[0]-i[0]>h?l:0;_===0&&(_=i[0]-n[2]>h?-l:n[2]-i[0]>h?l:0),i[0]+=_}gi(t,i)}function Ur(i,t,n,l){const h=Math.pow(2,l.z)*kr,_=[l.x*kr,l.y*kr],y=[];for(const w of i)for(const S of w){const I=[S.x+_[0],S.y+_[1]];Eu(I,t,n,h),y.push(I)}return y}function xl(i,t,n,l){const h=Math.pow(2,l.z)*kr,_=[l.x*kr,l.y*kr],y=[];for(const S of i){const I=[];for(const z of S){const D=[z.x+_[0],z.y+_[1]];gi(t,D),I.push(D)}y.push(I)}if(t[2]-t[0]<=h/2){(w=t)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const S of y)for(const I of S)Eu(I,t,n,h)}var w;return y}class ts{constructor(t,n){this.type=Ut,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ys(t[1])){const l=t[1];if(l.type==="FeatureCollection"){const h=[];for(const _ of l.features){const{type:y,coordinates:w}=_.geometry;y==="Polygon"&&h.push(w),y==="MultiPolygon"&&h.push(...w)}if(h.length)return new ts(l,{type:"MultiPolygon",coordinates:h})}else if(l.type==="Feature"){const h=l.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new ts(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new ts(l,l)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(n,l){const h=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],y=n.canonicalID();if(l.type==="Polygon"){const w=Ja(l.coordinates,_,y),S=Ur(n.geometry(),h,_,y);if(!dr(h,_))return!1;for(const I of S)if(!_o(I,w))return!1}if(l.type==="MultiPolygon"){const w=Uo(l.coordinates,_,y),S=Ur(n.geometry(),h,_,y);if(!dr(h,_))return!1;for(const I of S)if(!za(I,w))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(n,l){const h=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],y=n.canonicalID();if(l.type==="Polygon"){const w=Ja(l.coordinates,_,y),S=xl(n.geometry(),h,_,y);if(!dr(h,_))return!1;for(const I of S)if(!iu(I,w))return!1}if(l.type==="MultiPolygon"){const w=Uo(l.coordinates,_,y),S=xl(n.geometry(),h,_,y);if(!dr(h,_))return!1;for(const I of S)if(!Cr(I,w))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let is=class{constructor(i=[],t=(n,l)=>n<l?-1:n>l?1:0){if(this.data=i,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:t,compare:n}=this,l=t[i];for(;i>0;){const h=i-1>>1,_=t[h];if(n(l,_)>=0)break;t[i]=_,i=h}t[i]=l}_down(i){const{data:t,compare:n}=this,l=this.length>>1,h=t[i];for(;i<l;){let _=1+(i<<1);const y=_+1;if(y<this.length&&n(t[y],t[_])<0&&(_=y),n(t[_],h)>=0)break;t[i]=t[_],i=_}t[i]=h}};function nu(i,t,n,l,h){ru(i,t,n,l||i.length-1,h||Xu)}function ru(i,t,n,l,h){for(;l>n;){if(l-n>600){var _=l-n+1,y=t-n+1,w=Math.log(_),S=.5*Math.exp(2*w/3),I=.5*Math.sqrt(w*S*(_-S)/_)*(y-_/2<0?-1:1);ru(i,t,Math.max(n,Math.floor(t-y*S/_+I)),Math.min(l,Math.floor(t+(_-y)*S/_+I)),h)}var z=i[t],D=n,F=l;for(aa(i,n,t),h(i[l],z)>0&&aa(i,n,l);D<F;){for(aa(i,D,F),D++,F--;h(i[D],z)<0;)D++;for(;h(i[F],z)>0;)F--}h(i[n],z)===0?aa(i,n,F):aa(i,++F,l),F<=t&&(n=F+1),t<=F&&(l=F-1)}}function aa(i,t,n){var l=i[t];i[t]=i[n],i[n]=l}function Xu(i,t){return i<t?-1:i>t?1:0}function la(i,t){if(i.length<=1)return[i];const n=[];let l,h;for(const _ of i){const y=Ku(_);y!==0&&(_.area=Math.abs(y),h===void 0&&(h=y<0),h===y<0?(l&&n.push(l),l=[_]):l.push(_))}if(l&&n.push(l),t>1)for(let _=0;_<n.length;_++)n[_].length<=t||(nu(n[_],t,1,n[_].length-1,Mu),n[_]=n[_].slice(0,t));return n}function Mu(i,t){return t.area-i.area}function Ku(i){let t=0;for(let n,l,h=0,_=i.length,y=_-1;h<_;y=h++)n=i[h],l=i[y],t+=(l.x-n.x)*(n.y+l.y);return t}const zu=1/298.257223563,wl=zu*(2-zu),Au=Math.PI/180;class Ya{constructor(t){const n=6378.137*Au*1e3,l=Math.cos(t*Au),h=1/(1-wl*(1-l*l)),_=Math.sqrt(h);this.kx=n*_*l,this.ky=n*_*h*(1-wl)}distance(t,n){const l=this.wrap(t[0]-n[0])*this.kx,h=(t[1]-n[1])*this.ky;return Math.sqrt(l*l+h*h)}pointOnLine(t,n){let l,h,_,y,w=1/0;for(let S=0;S<t.length-1;S++){let I=t[S][0],z=t[S][1],D=this.wrap(t[S+1][0]-I)*this.kx,F=(t[S+1][1]-z)*this.ky,U=0;D===0&&F===0||(U=(this.wrap(n[0]-I)*this.kx*D+(n[1]-z)*this.ky*F)/(D*D+F*F),U>1?(I=t[S+1][0],z=t[S+1][1]):U>0&&(I+=D/this.kx*U,z+=F/this.ky*U)),D=this.wrap(n[0]-I)*this.kx,F=(n[1]-z)*this.ky;const H=D*D+F*F;H<w&&(w=H,l=I,h=z,_=S,y=U)}return{point:[l,h],index:_,t:Math.max(0,Math.min(1,y))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function su(i,t){return t[0]-i[0]}function ua(i){return i[1]-i[0]+1}function fr(i,t){return i[1]>=i[0]&&i[1]<t}function ou(i,t){if(i[0]>i[1])return[null,null];const n=ua(i);if(t){if(n===2)return[i,null];const h=Math.floor(n/2);return[[i[0],i[0]+h],[i[0]+h,i[1]]]}if(n===1)return[i,null];const l=Math.floor(n/2)-1;return[[i[0],i[0]+l],[i[0]+l+1,i[1]]]}function go(i,t){if(!fr(t,i.length))return[1/0,1/0,-1/0,-1/0];const n=[1/0,1/0,-1/0,-1/0];for(let l=t[0];l<=t[1];++l)gi(n,i[l]);return n}function Ir(i){const t=[1/0,1/0,-1/0,-1/0];for(const n of i)for(const l of n)gi(t,l);return t}function Qa(i){return i[0]!==-1/0&&i[1]!==-1/0&&i[2]!==1/0&&i[3]!==1/0}function bl(i,t,n){if(!Qa(i)||!Qa(t))return NaN;let l=0,h=0;return i[2]<t[0]&&(l=t[0]-i[2]),i[0]>t[2]&&(l=i[0]-t[2]),i[1]>t[3]&&(h=i[1]-t[3]),i[3]<t[1]&&(h=t[1]-i[3]),n.distance([0,0],[l,h])}function Zo(i,t,n){const l=n.pointOnLine(t,i);return n.distance(i,l.point)}function el(i,t,n,l,h){const _=Math.min(Zo(i,[n,l],h),Zo(t,[n,l],h)),y=Math.min(Zo(n,[i,t],h),Zo(l,[i,t],h));return Math.min(_,y)}function au(i,t,n,l,h){if(!fr(t,i.length)||!fr(l,n.length))return 1/0;let _=1/0;for(let y=t[0];y<t[1];++y){const w=i[y],S=i[y+1];for(let I=l[0];I<l[1];++I){const z=n[I],D=n[I+1];if(xs(w,S,z,D))return 0;_=Math.min(_,el(w,S,z,D,h))}}return _}function gn(i,t,n,l,h){if(!fr(t,i.length)||!fr(l,n.length))return NaN;let _=1/0;for(let y=t[0];y<=t[1];++y)for(let w=l[0];w<=l[1];++w)if(_=Math.min(_,h.distance(i[y],n[w])),_===0)return _;return _}function Ju(i,t,n){if(_o(i,t,!0))return 0;let l=1/0;for(const h of t){const _=h[0],y=h[h.length-1];if(_!==y&&(l=Math.min(l,Zo(i,[y,_],n)),l===0))return l;const w=n.pointOnLine(h,i);if(l=Math.min(l,n.distance(i,w.point)),l===0)return l}return l}function pi(i,t,n,l){if(!fr(t,i.length))return NaN;for(let _=t[0];_<=t[1];++_)if(_o(i[_],n,!0))return 0;let h=1/0;for(let _=t[0];_<t[1];++_){const y=i[_],w=i[_+1];for(const S of n)for(let I=0,z=S.length,D=z-1;I<z;D=I++){const F=S[D],U=S[I];if(xs(y,w,F,U))return 0;h=Math.min(h,el(y,w,F,U,l))}}return h}function Sl(i,t){for(const n of i)for(const l of n)if(_o(l,t,!0))return!0;return!1}function Si(i,t,n,l=1/0){const h=Ir(i),_=Ir(t);if(l!==1/0&&bl(h,_,n)>=l)return l;if(dr(h,_)){if(Sl(i,t))return 0}else if(Sl(t,i))return 0;let y=1/0;for(const w of i)for(let S=0,I=w.length,z=I-1;S<I;z=S++){const D=w[z],F=w[S];for(const U of t)for(let H=0,K=U.length,ne=K-1;H<K;ne=H++){const le=U[ne],ke=U[H];if(xs(D,F,le,ke))return 0;y=Math.min(y,el(D,F,le,ke,n))}}return y}function Ci(i,t,n,l,h,_){if(!_)return;const y=bl(go(l,_),h,n);y<t&&i.push([y,_,[0,0]])}function ws(i,t,n,l,h,_,y){if(!_||!y)return;const w=bl(go(l,_),go(h,y),n);w<t&&i.push([w,_,y])}function Zr(i,t,n,l,h=1/0){let _=Math.min(l.distance(i[0],n[0][0]),h);if(_===0)return _;const y=new is([[0,[0,i.length-1],[0,0]]],su),w=Ir(n);for(;y.length>0;){const S=y.pop();if(S[0]>=_)continue;const I=S[1],z=t?50:100;if(ua(I)<=z){if(!fr(I,i.length))return NaN;if(t){const D=pi(i,I,n,l);if(isNaN(D)||D===0)return D;_=Math.min(_,D)}else for(let D=I[0];D<=I[1];++D){const F=Ju(i[D],n,l);if(_=Math.min(_,F),_===0)return 0}}else{const D=ou(I,t);Ci(y,_,l,i,w,D[0]),Ci(y,_,l,i,w,D[1])}}return _}function Aa(i,t,n,l,h,_=1/0){let y=Math.min(_,h.distance(i[0],n[0]));if(y===0)return y;const w=new is([[0,[0,i.length-1],[0,n.length-1]]],su);for(;w.length>0;){const S=w.pop();if(S[0]>=y)continue;const I=S[1],z=S[2],D=t?50:100,F=l?50:100;if(ua(I)<=D&&ua(z)<=F){if(!fr(I,i.length)&&fr(z,n.length))return NaN;let U;if(t&&l)U=au(i,I,n,z,h),y=Math.min(y,U);else if(t&&!l){const H=i.slice(I[0],I[1]+1);for(let K=z[0];K<=z[1];++K)if(U=Zo(n[K],H,h),y=Math.min(y,U),y===0)return y}else if(!t&&l){const H=n.slice(z[0],z[1]+1);for(let K=I[0];K<=I[1];++K)if(U=Zo(i[K],H,h),y=Math.min(y,U),y===0)return y}else U=gn(i,I,n,z,h),y=Math.min(y,U)}else{const U=ou(I,t),H=ou(z,l);ws(w,y,h,i,n,U[0],H[0]),ws(w,y,h,i,n,U[0],H[1]),ws(w,y,h,i,n,U[1],H[0]),ws(w,y,h,i,n,U[1],H[1])}}return y}function yo(i){return i.type==="MultiPolygon"?i.coordinates.map(t=>({type:"Polygon",coordinates:t})):i.type==="MultiLineString"?i.coordinates.map(t=>({type:"LineString",coordinates:t})):i.type==="MultiPoint"?i.coordinates.map(t=>({type:"Point",coordinates:t})):[i]}class $o{constructor(t,n){this.type=ot,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ys(t[1])){const l=t[1];if(l.type==="FeatureCollection")return new $o(l,l.features.map(h=>yo(h.geometry)).flat());if(l.type==="Feature")return new $o(l,yo(l.geometry));if("type"in l&&"coordinates"in l)return new $o(l,yo(l))}return n.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(n,l){const h=n.geometry(),_=h.flat().map(S=>Ma([S.x,S.y],n.canonical));if(h.length===0)return NaN;const y=new Ya(_[0][1]);let w=1/0;for(const S of l){switch(S.type){case"Point":w=Math.min(w,Aa(_,!1,[S.coordinates],!1,y,w));break;case"LineString":w=Math.min(w,Aa(_,!1,S.coordinates,!0,y,w));break;case"Polygon":w=Math.min(w,Zr(_,!1,S.coordinates,y,w))}if(w===0)return w}return w}(t,this.geometries);if(t.geometryType()==="LineString")return function(n,l){const h=n.geometry(),_=h.flat().map(S=>Ma([S.x,S.y],n.canonical));if(h.length===0)return NaN;const y=new Ya(_[0][1]);let w=1/0;for(const S of l){switch(S.type){case"Point":w=Math.min(w,Aa(_,!0,[S.coordinates],!1,y,w));break;case"LineString":w=Math.min(w,Aa(_,!0,S.coordinates,!0,y,w));break;case"Polygon":w=Math.min(w,Zr(_,!0,S.coordinates,y,w))}if(w===0)return w}return w}(t,this.geometries);if(t.geometryType()==="Polygon")return function(n,l){const h=n.geometry();if(h.length===0||h[0].length===0)return NaN;const _=la(h,0).map(S=>S.map(I=>I.map(z=>Ma([z.x,z.y],n.canonical)))),y=new Ya(_[0][0][0][1]);let w=1/0;for(const S of l)for(const I of _){switch(S.type){case"Point":w=Math.min(w,Zr([S.coordinates],!1,I,y,w));break;case"LineString":w=Math.min(w,Zr(S.coordinates,!0,I,y,w));break;case"Polygon":w=Math.min(w,Si(I,S.coordinates,y,w))}if(w===0)return w}return w}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const bs={"==":Ql,"!=":Xa,">":gl,"<":vs,">=":_n,"<=":Ka,array:sr,at:jr,boolean:sr,case:fo,coalesce:kn,collator:hr,format:Vo,image:eu,in:mn,"index-of":Pr,interpolate:On,"interpolate-hcl":On,"interpolate-lab":On,length:yl,let:ho,literal:Tr,match:zi,number:sr,"number-format":mo,object:sr,slice:jo,step:po,string:sr,"to-boolean":Ai,"to-color":Ai,"to-number":Ai,"to-string":Ai,var:wi,within:ts,distance:$o};class Er{constructor(t,n,l,h){this.name=t,this.type=n,this._evaluate=l,this.args=h}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,n){const l=t[0],h=Er.definitions[l];if(!h)return n.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(h)?h[0]:h.type,y=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,w=y.filter(([I])=>!Array.isArray(I)||I.length===t.length-1);let S=null;for(const[I,z]of w){S=new Pn(n.registry,La,n.path,null,n.scope);const D=[];let F=!1;for(let U=1;U<t.length;U++){const H=t[U],K=Array.isArray(I)?I[U-1]:I.type,ne=S.parse(H,1+D.length,K);if(!ne){F=!0;break}D.push(ne)}if(!F)if(Array.isArray(I)&&I.length!==D.length)S.error(`Expected ${I.length} arguments, but found ${D.length} instead.`);else{for(let U=0;U<D.length;U++){const H=Array.isArray(I)?I[U]:I.type,K=D[U];S.concat(U+1).checkSubtype(H,K.type)}if(S.errors.length===0)return new Er(l,_,z,D)}}if(w.length===1)n.errors.push(...S.errors);else{const I=(w.length?w:y).map(([D])=>{return F=D,Array.isArray(F)?`(${F.map(j).join(", ")})`:`(${j(F.type)}...)`;var F}).join(" | "),z=[];for(let D=1;D<t.length;D++){const F=n.parse(t[D],1+z.length);if(!F)return null;z.push(j(F.type))}n.error(`Expected arguments of type ${I}, but found (${z.join(", ")}) instead.`)}return null}static register(t,n){Er.definitions=n;for(const l in n)t[l]=Er}}function Ss(i,[t,n,l,h]){t=t.evaluate(i),n=n.evaluate(i),l=l.evaluate(i);const _=h?h.evaluate(i):1,y=rr(t,n,l,_);if(y)throw new Ji(y);return new Xt(t/255,n/255,l/255,_,!1)}function lu(i,t){return i in t}function Zs(i,t){const n=t[i];return n===void 0?null:n}function $s(i){return{type:i}}function La(i){if(i instanceof wi)return La(i.boundExpression);if(i instanceof Er&&i.name==="error"||i instanceof hr||i instanceof ts||i instanceof $o)return!1;const t=i instanceof Ai||i instanceof sr;let n=!0;return i.eachChild(l=>{n=t?n&&La(l):n&&l instanceof Tr}),!!n&&qo(i)&&Wn(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function qo(i){if(i instanceof Er&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof ts||i instanceof $o)return!1;let t=!0;return i.eachChild(n=>{t&&!qo(n)&&(t=!1)}),t}function qs(i){if(i instanceof Er&&i.name==="feature-state")return!1;let t=!0;return i.eachChild(n=>{t&&!qs(n)&&(t=!1)}),t}function Wn(i,t){if(i instanceof Er&&t.indexOf(i.name)>=0)return!1;let n=!0;return i.eachChild(l=>{n&&!Wn(l,t)&&(n=!1)}),n}function Tl(i){return{result:"success",value:i}}function Mr(i){return{result:"error",value:i}}function Da(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function Ts(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function Ho(i){return!!i.expression&&i.expression.interpolated}function Ti(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function ca(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function tl(i){return i}function il(i,t){const n=t.type==="color",l=i.stops&&typeof i.stops[0][0]=="object",h=l||!(l||i.property!==void 0),_=i.type||(Ho(t)?"exponential":"interval");if(n||t.type==="padding"){const z=n?Xt.parse:nr.parse;(i=gs({},i)).stops&&(i.stops=i.stops.map(D=>[D[0],z(D[1])])),i.default=z(i.default?i.default:t.default)}if(i.colorSpace&&(y=i.colorSpace)!=="rgb"&&y!=="hcl"&&y!=="lab")throw new Error(`Unknown color space: "${i.colorSpace}"`);var y;let w,S,I;if(_==="exponential")w=Pl;else if(_==="interval")w=da;else if(_==="categorical"){w=ha,S=Object.create(null);for(const z of i.stops)S[z[0]]=z[1];I=typeof i.stops[0][0]}else{if(_!=="identity")throw new Error(`Unknown function type "${_}"`);w=uu}if(l){const z={},D=[];for(let H=0;H<i.stops.length;H++){const K=i.stops[H],ne=K[0].zoom;z[ne]===void 0&&(z[ne]={zoom:ne,type:i.type,property:i.property,default:i.default,stops:[]},D.push(ne)),z[ne].stops.push([K[0].value,K[1]])}const F=[];for(const H of D)F.push([z[H].zoom,il(z[H],t)]);const U={name:"linear"};return{kind:"composite",interpolationType:U,interpolationFactor:On.interpolationFactor.bind(void 0,U),zoomStops:F.map(H=>H[0]),evaluate:({zoom:H},K)=>Pl({stops:F,base:i.base},t,H).evaluate(H,K)}}if(h){const z=_==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:z,interpolationFactor:On.interpolationFactor.bind(void 0,z),zoomStops:i.stops.map(D=>D[0]),evaluate:({zoom:D})=>w(i,t,D,S,I)}}return{kind:"source",evaluate(z,D){const F=D&&D.properties?D.properties[i.property]:void 0;return F===void 0?vo(i.default,t.default):w(i,t,F,S,I)}}}function vo(i,t,n){return i!==void 0?i:t!==void 0?t:n!==void 0?n:void 0}function ha(i,t,n,l,h){return vo(typeof n===h?l[n]:void 0,i.default,t.default)}function da(i,t,n){if(Ti(n)!=="number")return vo(i.default,t.default);const l=i.stops.length;if(l===1||n<=i.stops[0][0])return i.stops[0][1];if(n>=i.stops[l-1][0])return i.stops[l-1][1];const h=Us(i.stops.map(_=>_[0]),n);return i.stops[h][1]}function Pl(i,t,n){const l=i.base!==void 0?i.base:1;if(Ti(n)!=="number")return vo(i.default,t.default);const h=i.stops.length;if(h===1||n<=i.stops[0][0])return i.stops[0][1];if(n>=i.stops[h-1][0])return i.stops[h-1][1];const _=Us(i.stops.map(z=>z[0]),n),y=function(z,D,F,U){const H=U-F,K=z-F;return H===0?0:D===1?K/H:(Math.pow(D,K)-1)/(Math.pow(D,H)-1)}(n,l,i.stops[_][0],i.stops[_+1][0]),w=i.stops[_][1],S=i.stops[_+1][1],I=dn[t.type]||tl;return typeof w.evaluate=="function"?{evaluate(...z){const D=w.evaluate.apply(void 0,z),F=S.evaluate.apply(void 0,z);if(D!==void 0&&F!==void 0)return I(D,F,y,i.colorSpace)}}:I(w,S,y,i.colorSpace)}function uu(i,t,n){switch(t.type){case"color":n=Xt.parse(n);break;case"formatted":n=Sr.fromString(n.toString());break;case"resolvedImage":n=Hn.fromString(n.toString());break;case"padding":n=nr.parse(n);break;default:Ti(n)===t.type||t.type==="enum"&&t.values[n]||(n=void 0)}return vo(n,i.default,t.default)}Er.register(bs,{error:[{kind:"error"},[ri],(i,[t])=>{throw new Ji(t.evaluate(i))}],typeof:[ri,[Wt],(i,[t])=>j(Lt(t.evaluate(i)))],"to-rgba":[V(ot,4),[tr],(i,[t])=>{const[n,l,h,_]=t.evaluate(i).rgb;return[255*n,255*l,255*h,_]}],rgb:[tr,[ot,ot,ot],Ss],rgba:[tr,[ot,ot,ot,ot],Ss],has:{type:Ut,overloads:[[[ri],(i,[t])=>lu(t.evaluate(i),i.properties())],[[ri,$n],(i,[t,n])=>lu(t.evaluate(i),n.evaluate(i))]]},get:{type:Wt,overloads:[[[ri],(i,[t])=>Zs(t.evaluate(i),i.properties())],[[ri,$n],(i,[t,n])=>Zs(t.evaluate(i),n.evaluate(i))]]},"feature-state":[Wt,[ri],(i,[t])=>Zs(t.evaluate(i),i.featureState||{})],properties:[$n,[],i=>i.properties()],"geometry-type":[ri,[],i=>i.geometryType()],id:[Wt,[],i=>i.id()],zoom:[ot,[],i=>i.globals.zoom],"heatmap-density":[ot,[],i=>i.globals.heatmapDensity||0],"line-progress":[ot,[],i=>i.globals.lineProgress||0],accumulated:[Wt,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[ot,$s(ot),(i,t)=>{let n=0;for(const l of t)n+=l.evaluate(i);return n}],"*":[ot,$s(ot),(i,t)=>{let n=1;for(const l of t)n*=l.evaluate(i);return n}],"-":{type:ot,overloads:[[[ot,ot],(i,[t,n])=>t.evaluate(i)-n.evaluate(i)],[[ot],(i,[t])=>-t.evaluate(i)]]},"/":[ot,[ot,ot],(i,[t,n])=>t.evaluate(i)/n.evaluate(i)],"%":[ot,[ot,ot],(i,[t,n])=>t.evaluate(i)%n.evaluate(i)],ln2:[ot,[],()=>Math.LN2],pi:[ot,[],()=>Math.PI],e:[ot,[],()=>Math.E],"^":[ot,[ot,ot],(i,[t,n])=>Math.pow(t.evaluate(i),n.evaluate(i))],sqrt:[ot,[ot],(i,[t])=>Math.sqrt(t.evaluate(i))],log10:[ot,[ot],(i,[t])=>Math.log(t.evaluate(i))/Math.LN10],ln:[ot,[ot],(i,[t])=>Math.log(t.evaluate(i))],log2:[ot,[ot],(i,[t])=>Math.log(t.evaluate(i))/Math.LN2],sin:[ot,[ot],(i,[t])=>Math.sin(t.evaluate(i))],cos:[ot,[ot],(i,[t])=>Math.cos(t.evaluate(i))],tan:[ot,[ot],(i,[t])=>Math.tan(t.evaluate(i))],asin:[ot,[ot],(i,[t])=>Math.asin(t.evaluate(i))],acos:[ot,[ot],(i,[t])=>Math.acos(t.evaluate(i))],atan:[ot,[ot],(i,[t])=>Math.atan(t.evaluate(i))],min:[ot,$s(ot),(i,t)=>Math.min(...t.map(n=>n.evaluate(i)))],max:[ot,$s(ot),(i,t)=>Math.max(...t.map(n=>n.evaluate(i)))],abs:[ot,[ot],(i,[t])=>Math.abs(t.evaluate(i))],round:[ot,[ot],(i,[t])=>{const n=t.evaluate(i);return n<0?-Math.round(-n):Math.round(n)}],floor:[ot,[ot],(i,[t])=>Math.floor(t.evaluate(i))],ceil:[ot,[ot],(i,[t])=>Math.ceil(t.evaluate(i))],"filter-==":[Ut,[ri,Wt],(i,[t,n])=>i.properties()[t.value]===n.value],"filter-id-==":[Ut,[Wt],(i,[t])=>i.id()===t.value],"filter-type-==":[Ut,[ri],(i,[t])=>i.geometryType()===t.value],"filter-<":[Ut,[ri,Wt],(i,[t,n])=>{const l=i.properties()[t.value],h=n.value;return typeof l==typeof h&&l<h}],"filter-id-<":[Ut,[Wt],(i,[t])=>{const n=i.id(),l=t.value;return typeof n==typeof l&&n<l}],"filter->":[Ut,[ri,Wt],(i,[t,n])=>{const l=i.properties()[t.value],h=n.value;return typeof l==typeof h&&l>h}],"filter-id->":[Ut,[Wt],(i,[t])=>{const n=i.id(),l=t.value;return typeof n==typeof l&&n>l}],"filter-<=":[Ut,[ri,Wt],(i,[t,n])=>{const l=i.properties()[t.value],h=n.value;return typeof l==typeof h&&l<=h}],"filter-id-<=":[Ut,[Wt],(i,[t])=>{const n=i.id(),l=t.value;return typeof n==typeof l&&n<=l}],"filter->=":[Ut,[ri,Wt],(i,[t,n])=>{const l=i.properties()[t.value],h=n.value;return typeof l==typeof h&&l>=h}],"filter-id->=":[Ut,[Wt],(i,[t])=>{const n=i.id(),l=t.value;return typeof n==typeof l&&n>=l}],"filter-has":[Ut,[Wt],(i,[t])=>t.value in i.properties()],"filter-has-id":[Ut,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Ut,[V(ri)],(i,[t])=>t.value.indexOf(i.geometryType())>=0],"filter-id-in":[Ut,[V(Wt)],(i,[t])=>t.value.indexOf(i.id())>=0],"filter-in-small":[Ut,[ri,V(Wt)],(i,[t,n])=>n.value.indexOf(i.properties()[t.value])>=0],"filter-in-large":[Ut,[ri,V(Wt)],(i,[t,n])=>function(l,h,_,y){for(;_<=y;){const w=_+y>>1;if(h[w]===l)return!0;h[w]>l?y=w-1:_=w+1}return!1}(i.properties()[t.value],n.value,0,n.value.length-1)],all:{type:Ut,overloads:[[[Ut,Ut],(i,[t,n])=>t.evaluate(i)&&n.evaluate(i)],[$s(Ut),(i,t)=>{for(const n of t)if(!n.evaluate(i))return!1;return!0}]]},any:{type:Ut,overloads:[[[Ut,Ut],(i,[t,n])=>t.evaluate(i)||n.evaluate(i)],[$s(Ut),(i,t)=>{for(const n of t)if(n.evaluate(i))return!0;return!1}]]},"!":[Ut,[Ut],(i,[t])=>!t.evaluate(i)],"is-supported-script":[Ut,[ri],(i,[t])=>{const n=i.globals&&i.globals.isSupportedScript;return!n||n(t.evaluate(i))}],upcase:[ri,[ri],(i,[t])=>t.evaluate(i).toUpperCase()],downcase:[ri,[ri],(i,[t])=>t.evaluate(i).toLowerCase()],concat:[ri,$s(Wt),(i,t)=>t.map(n=>Gi(n.evaluate(i))).join("")],"resolved-locale":[ri,[Jr],(i,[t])=>t.evaluate(i).resolvedLocale()]});class zr{constructor(t,n){var l;this.expression=t,this._warningHistory={},this._evaluator=new sa,this._defaultValue=n?(l=n).type==="color"&&ca(l.default)?new Xt(0,0,0,0):l.type==="color"?Xt.parse(l.default)||null:l.type==="padding"?nr.parse(l.default)||null:l.type==="variableAnchorOffsetCollection"?qn.parse(l.default)||null:l.default===void 0?null:l.default:null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(t,n,l,h,_,y){return this._evaluator.globals=t,this._evaluator.feature=n,this._evaluator.featureState=l,this._evaluator.canonical=h,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=y,this.expression.evaluate(this._evaluator)}evaluate(t,n,l,h,_,y){this._evaluator.globals=t,this._evaluator.feature=n||null,this._evaluator.featureState=l||null,this._evaluator.canonical=h,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=y||null;try{const w=this.expression.evaluate(this._evaluator);if(w==null||typeof w=="number"&&w!=w)return this._defaultValue;if(this._enumValues&&!(w in this._enumValues))throw new Ji(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(w)} instead.`);return w}catch(w){return this._warningHistory[w.message]||(this._warningHistory[w.message]=!0,typeof console<"u"&&console.warn(w.message)),this._defaultValue}}}function Ps(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in bs}function fa(i,t){const n=new Pn(bs,La,[],t?function(h){const _={color:tr,string:ri,number:ot,enum:ri,boolean:Ut,formatted:Yr,padding:br,resolvedImage:ir,variableAnchorOffsetCollection:se};return h.type==="array"?V(_[h.value]||Wt,h.length):_[h.type]}(t):void 0),l=n.parse(i,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?Tl(new zr(l,t)):Mr(n.errors)}class Go{constructor(t,n){this.kind=t,this._styleExpression=n,this.isStateDependent=t!=="constant"&&!qs(n.expression)}evaluateWithoutErrorHandling(t,n,l,h,_,y){return this._styleExpression.evaluateWithoutErrorHandling(t,n,l,h,_,y)}evaluate(t,n,l,h,_,y){return this._styleExpression.evaluate(t,n,l,h,_,y)}}class pa{constructor(t,n,l,h){this.kind=t,this.zoomStops=l,this._styleExpression=n,this.isStateDependent=t!=="camera"&&!qs(n.expression),this.interpolationType=h}evaluateWithoutErrorHandling(t,n,l,h,_,y){return this._styleExpression.evaluateWithoutErrorHandling(t,n,l,h,_,y)}evaluate(t,n,l,h,_,y){return this._styleExpression.evaluate(t,n,l,h,_,y)}interpolationFactor(t,n,l){return this.interpolationType?On.interpolationFactor(this.interpolationType,t,n,l):0}}function nl(i,t){const n=fa(i,t);if(n.result==="error")return n;const l=n.value.expression,h=qo(l);if(!h&&!Da(t))return Mr([new Tn("","data expressions not supported")]);const _=Wn(l,["zoom"]);if(!_&&!Ts(t))return Mr([new Tn("","zoom expressions not supported")]);const y=Ar(l);return y||_?y instanceof Tn?Mr([y]):y instanceof On&&!Ho(t)?Mr([new Tn("",'"interpolate" expressions cannot be used with this property')]):Tl(y?new pa(h?"camera":"composite",n.value,y.labels,y instanceof On?y.interpolation:void 0):new Go(h?"constant":"source",n.value)):Mr([new Tn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Wo{constructor(t,n){this._parameters=t,this._specification=n,gs(this,il(this._parameters,this._specification))}static deserialize(t){return new Wo(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Ar(i){let t=null;if(i instanceof ho)t=Ar(i.result);else if(i instanceof kn){for(const n of i.args)if(t=Ar(n),t)break}else(i instanceof po||i instanceof On)&&i.input instanceof Er&&i.input.name==="zoom"&&(t=i);return t instanceof Tn||i.eachChild(n=>{const l=Ar(n);l instanceof Tn?t=l:!t&&l?t=new Tn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&l&&t!==l&&(t=new Tn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function ma(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const t of i.slice(1))if(!ma(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const xo={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Xo(i){if(i==null)return{filter:()=>!0,needGeometry:!1};ma(i)||(i=ol(i));const t=fa(i,xo);if(t.result==="error")throw new Error(t.value.map(n=>`${n.key}: ${n.message}`).join(", "));return{filter:(n,l,h)=>t.value.evaluate(n,l,{},h),needGeometry:sl(i)}}function rl(i,t){return i<t?-1:i>t?1:0}function sl(i){if(!Array.isArray(i))return!1;if(i[0]==="within"||i[0]==="distance")return!0;for(let t=1;t<i.length;t++)if(sl(i[t]))return!0;return!1}function ol(i){if(!i)return!0;const t=i[0];return i.length<=1?t!=="any":t==="=="?Hs(i[1],i[2],"=="):t==="!="?Fn(Hs(i[1],i[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Hs(i[1],i[2],t):t==="any"?(n=i.slice(1),["any"].concat(n.map(ol))):t==="all"?["all"].concat(i.slice(1).map(ol)):t==="none"?["all"].concat(i.slice(1).map(ol).map(Fn)):t==="in"?Gs(i[1],i.slice(2)):t==="!in"?Fn(Gs(i[1],i.slice(2))):t==="has"?ns(i[1]):t!=="!has"||Fn(ns(i[1]));var n}function Hs(i,t,n){switch(i){case"$type":return[`filter-type-${n}`,t];case"$id":return[`filter-id-${n}`,t];default:return[`filter-${n}`,i,t]}}function Gs(i,t){if(t.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(n=>typeof n!=typeof t[0])?["filter-in-large",i,["literal",t.sort(rl)]]:["filter-in-small",i,["literal",t]]}}function ns(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function Fn(i){return["!",i]}function ks(i){const t=typeof i;if(t==="number"||t==="boolean"||t==="string"||i==null)return JSON.stringify(i);if(Array.isArray(i)){let h="[";for(const _ of i)h+=`${ks(_)},`;return`${h}]`}const n=Object.keys(i).sort();let l="{";for(let h=0;h<n.length;h++)l+=`${JSON.stringify(n[h])}:${ks(i[n[h]])},`;return`${l}}`}function cu(i){let t="";for(const n of ps)t+=`/${ks(i[n])}`;return t}function Cs(i){const t=i.value;return t?[new Qe(i.key,t,"constants have been deprecated as of v8")]:[]}function ln(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function $r(i){if(Array.isArray(i))return i.map($r);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const t={};for(const n in i)t[n]=$r(i[n]);return t}return ln(i)}function Nn(i){const t=i.key,n=i.value,l=i.valueSpec||{},h=i.objectElementValidators||{},_=i.style,y=i.styleSpec,w=i.validateSpec;let S=[];const I=Ti(n);if(I!=="object")return[new Qe(t,n,`object expected, ${I} found`)];for(const z in n){const D=z.split(".")[0],F=l[D]||l["*"];let U;if(h[D])U=h[D];else if(l[D])U=w;else if(h["*"])U=h["*"];else{if(!l["*"]){S.push(new Qe(t,n[z],`unknown property "${z}"`));continue}U=w}S=S.concat(U({key:(t&&`${t}.`)+z,value:n[z],valueSpec:F,style:_,styleSpec:y,object:n,objectKey:z,validateSpec:w},n))}for(const z in l)h[z]||l[z].required&&l[z].default===void 0&&n[z]===void 0&&S.push(new Qe(t,n,`missing required property "${z}"`));return S}function Ra(i){const t=i.value,n=i.valueSpec,l=i.style,h=i.styleSpec,_=i.key,y=i.arrayElementValidator||i.validateSpec;if(Ti(t)!=="array")return[new Qe(_,t,`array expected, ${Ti(t)} found`)];if(n.length&&t.length!==n.length)return[new Qe(_,t,`array length ${n.length} expected, length ${t.length} found`)];if(n["min-length"]&&t.length<n["min-length"])return[new Qe(_,t,`array length at least ${n["min-length"]} expected, length ${t.length} found`)];let w={type:n.value,values:n.values};h.$version<7&&(w.function=n.function),Ti(n.value)==="object"&&(w=n.value);let S=[];for(let I=0;I<t.length;I++)S=S.concat(y({array:t,arrayIndex:I,value:t[I],valueSpec:w,validateSpec:i.validateSpec,style:l,styleSpec:h,key:`${_}[${I}]`}));return S}function qr(i){const t=i.key,n=i.value,l=i.valueSpec;let h=Ti(n);return h==="number"&&n!=n&&(h="NaN"),h!=="number"?[new Qe(t,n,`number expected, ${h} found`)]:"minimum"in l&&n<l.minimum?[new Qe(t,n,`${n} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&n>l.maximum?[new Qe(t,n,`${n} is greater than the maximum value ${l.maximum}`)]:[]}function Ws(i){const t=i.valueSpec,n=ln(i.value.type);let l,h,_,y={};const w=n!=="categorical"&&i.value.property===void 0,S=!w,I=Ti(i.value.stops)==="array"&&Ti(i.value.stops[0])==="array"&&Ti(i.value.stops[0][0])==="object",z=Nn({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(U){if(n==="identity")return[new Qe(U.key,U.value,'identity function may not have a "stops" property')];let H=[];const K=U.value;return H=H.concat(Ra({key:U.key,value:K,valueSpec:U.valueSpec,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec,arrayElementValidator:D})),Ti(K)==="array"&&K.length===0&&H.push(new Qe(U.key,K,"array must have at least one stop")),H},default:function(U){return U.validateSpec({key:U.key,value:U.value,valueSpec:t,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec})}}});return n==="identity"&&w&&z.push(new Qe(i.key,i.value,'missing required property "property"')),n==="identity"||i.value.stops||z.push(new Qe(i.key,i.value,'missing required property "stops"')),n==="exponential"&&i.valueSpec.expression&&!Ho(i.valueSpec)&&z.push(new Qe(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(S&&!Da(i.valueSpec)?z.push(new Qe(i.key,i.value,"property functions not supported")):w&&!Ts(i.valueSpec)&&z.push(new Qe(i.key,i.value,"zoom functions not supported"))),n!=="categorical"&&!I||i.value.property!==void 0||z.push(new Qe(i.key,i.value,'"property" property is required')),z;function D(U){let H=[];const K=U.value,ne=U.key;if(Ti(K)!=="array")return[new Qe(ne,K,`array expected, ${Ti(K)} found`)];if(K.length!==2)return[new Qe(ne,K,`array length 2 expected, length ${K.length} found`)];if(I){if(Ti(K[0])!=="object")return[new Qe(ne,K,`object expected, ${Ti(K[0])} found`)];if(K[0].zoom===void 0)return[new Qe(ne,K,"object stop key must have zoom")];if(K[0].value===void 0)return[new Qe(ne,K,"object stop key must have value")];if(_&&_>ln(K[0].zoom))return[new Qe(ne,K[0].zoom,"stop zoom values must appear in ascending order")];ln(K[0].zoom)!==_&&(_=ln(K[0].zoom),h=void 0,y={}),H=H.concat(Nn({key:`${ne}[0]`,value:K[0],valueSpec:{zoom:{}},validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec,objectElementValidators:{zoom:qr,value:F}}))}else H=H.concat(F({key:`${ne}[0]`,value:K[0],validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec},K));return Ps($r(K[1]))?H.concat([new Qe(`${ne}[1]`,K[1],"expressions are not allowed in function stops.")]):H.concat(U.validateSpec({key:`${ne}[1]`,value:K[1],valueSpec:t,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec}))}function F(U,H){const K=Ti(U.value),ne=ln(U.value),le=U.value!==null?U.value:H;if(l){if(K!==l)return[new Qe(U.key,le,`${K} stop domain type must match previous stop domain type ${l}`)]}else l=K;if(K!=="number"&&K!=="string"&&K!=="boolean")return[new Qe(U.key,le,"stop domain value must be a number, string, or boolean")];if(K!=="number"&&n!=="categorical"){let ke=`number expected, ${K} found`;return Da(t)&&n===void 0&&(ke+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Qe(U.key,le,ke)]}return n!=="categorical"||K!=="number"||isFinite(ne)&&Math.floor(ne)===ne?n!=="categorical"&&K==="number"&&h!==void 0&&ne<h?[new Qe(U.key,le,"stop domain values must appear in ascending order")]:(h=ne,n==="categorical"&&ne in y?[new Qe(U.key,le,"stop domain values must be unique")]:(y[ne]=!0,[])):[new Qe(U.key,le,`integer expected, found ${ne}`)]}}function wo(i){const t=(i.expressionContext==="property"?nl:fa)($r(i.value),i.valueSpec);if(t.result==="error")return t.value.map(l=>new Qe(`${i.key}${l.key}`,i.value,l.message));const n=t.value.expression||t.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!n.outputDefined())return[new Qe(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!qs(n))return[new Qe(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!qs(n))return[new Qe(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Wn(n,["zoom","feature-state"]))return[new Qe(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!qo(n))return[new Qe(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Xs(i){const t=i.key,n=i.value,l=i.valueSpec,h=[];return Array.isArray(l.values)?l.values.indexOf(ln(n))===-1&&h.push(new Qe(t,n,`expected one of [${l.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(l.values).indexOf(ln(n))===-1&&h.push(new Qe(t,n,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(n)} found`)),h}function hu(i){return ma($r(i.value))?wo(gs({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):bo(i)}function bo(i){const t=i.value,n=i.key;if(Ti(t)!=="array")return[new Qe(n,t,`array expected, ${Ti(t)} found`)];const l=i.styleSpec;let h,_=[];if(t.length<1)return[new Qe(n,t,"filter array must have at least 1 element")];switch(_=_.concat(Xs({key:`${n}[0]`,value:t[0],valueSpec:l.filter_operator,style:i.style,styleSpec:i.styleSpec})),ln(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&ln(t[1])==="$type"&&_.push(new Qe(n,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&_.push(new Qe(n,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(h=Ti(t[1]),h!=="string"&&_.push(new Qe(`${n}[1]`,t[1],`string expected, ${h} found`)));for(let y=2;y<t.length;y++)h=Ti(t[y]),ln(t[1])==="$type"?_=_.concat(Xs({key:`${n}[${y}]`,value:t[y],valueSpec:l.geometry_type,style:i.style,styleSpec:i.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&_.push(new Qe(`${n}[${y}]`,t[y],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let y=1;y<t.length;y++)_=_.concat(bo({key:`${n}[${y}]`,value:t[y],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":h=Ti(t[1]),t.length!==2?_.push(new Qe(n,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="string"&&_.push(new Qe(`${n}[1]`,t[1],`string expected, ${h} found`))}return _}function kl(i,t){const n=i.key,l=i.validateSpec,h=i.style,_=i.styleSpec,y=i.value,w=i.objectKey,S=_[`${t}_${i.layerType}`];if(!S)return[];const I=w.match(/^(.*)-transition$/);if(t==="paint"&&I&&S[I[1]]&&S[I[1]].transition)return l({key:n,value:y,valueSpec:_.transition,style:h,styleSpec:_});const z=i.valueSpec||S[w];if(!z)return[new Qe(n,y,`unknown property "${w}"`)];let D;if(Ti(y)==="string"&&Da(z)&&!z.tokens&&(D=/^{([^}]+)}$/.exec(y)))return[new Qe(n,y,`"${w}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(D[1])} }\`.`)];const F=[];return i.layerType==="symbol"&&(w==="text-field"&&h&&!h.glyphs&&F.push(new Qe(n,y,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&ca($r(y))&&ln(y.type)==="identity"&&F.push(new Qe(n,y,'"text-font" does not support identity functions'))),F.concat(l({key:i.key,value:y,valueSpec:z,style:h,styleSpec:_,expressionContext:"property",propertyType:t,propertyKey:w}))}function Ba(i){return kl(i,"paint")}function al(i){return kl(i,"layout")}function qi(i){let t=[];const n=i.value,l=i.key,h=i.style,_=i.styleSpec;n.type||n.ref||t.push(new Qe(l,n,'either "type" or "ref" is required'));let y=ln(n.type);const w=ln(n.ref);if(n.id){const S=ln(n.id);for(let I=0;I<i.arrayIndex;I++){const z=h.layers[I];ln(z.id)===S&&t.push(new Qe(l,n.id,`duplicate layer id "${n.id}", previously used at line ${z.id.__line__}`))}}if("ref"in n){let S;["type","source","source-layer","filter","layout"].forEach(I=>{I in n&&t.push(new Qe(l,n[I],`"${I}" is prohibited for ref layers`))}),h.layers.forEach(I=>{ln(I.id)===w&&(S=I)}),S?S.ref?t.push(new Qe(l,n.ref,"ref cannot reference another ref layer")):y=ln(S.type):t.push(new Qe(l,n.ref,`ref layer "${w}" not found`))}else if(y!=="background")if(n.source){const S=h.sources&&h.sources[n.source],I=S&&ln(S.type);S?I==="vector"&&y==="raster"?t.push(new Qe(l,n.source,`layer "${n.id}" requires a raster source`)):I!=="raster-dem"&&y==="hillshade"?t.push(new Qe(l,n.source,`layer "${n.id}" requires a raster-dem source`)):I==="raster"&&y!=="raster"?t.push(new Qe(l,n.source,`layer "${n.id}" requires a vector source`)):I!=="vector"||n["source-layer"]?I==="raster-dem"&&y!=="hillshade"?t.push(new Qe(l,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!n.paint||!n.paint["line-gradient"]||I==="geojson"&&S.lineMetrics||t.push(new Qe(l,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Qe(l,n,`layer "${n.id}" must specify a "source-layer"`)):t.push(new Qe(l,n.source,`source "${n.source}" not found`))}else t.push(new Qe(l,n,'missing required property "source"'));return t=t.concat(Nn({key:l,value:n,valueSpec:_.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*":()=>[],type:()=>i.validateSpec({key:`${l}.type`,value:n.type,valueSpec:_.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:n,objectKey:"type"}),filter:hu,layout:S=>Nn({layer:n,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":I=>al(gs({layerType:y},I))}}),paint:S=>Nn({layer:n,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":I=>Ba(gs({layerType:y},I))}})}})),t}function So(i){const t=i.value,n=i.key,l=Ti(t);return l!=="string"?[new Qe(n,t,`string expected, ${l} found`)]:[]}const Ko={promoteId:function({key:i,value:t}){if(Ti(t)==="string")return So({key:i,value:t});{const n=[];for(const l in t)n.push(...So({key:`${i}.${l}`,value:t[l]}));return n}}};function Ks(i){const t=i.value,n=i.key,l=i.styleSpec,h=i.style,_=i.validateSpec;if(!t.type)return[new Qe(n,t,'"type" is required')];const y=ln(t.type);let w;switch(y){case"vector":case"raster":return w=Nn({key:n,value:t,valueSpec:l[`source_${y.replace("-","_")}`],style:i.style,styleSpec:l,objectElementValidators:Ko,validateSpec:_}),w;case"raster-dem":return w=function(S){var I;const z=(I=S.sourceName)!==null&&I!==void 0?I:"",D=S.value,F=S.styleSpec,U=F.source_raster_dem,H=S.style;let K=[];const ne=Ti(D);if(D===void 0)return K;if(ne!=="object")return K.push(new Qe("source_raster_dem",D,`object expected, ${ne} found`)),K;const le=ln(D.encoding)==="custom",ke=["redFactor","greenFactor","blueFactor","baseShift"],pe=S.value.encoding?`"${S.value.encoding}"`:"Default";for(const Te in D)!le&&ke.includes(Te)?K.push(new Qe(Te,D[Te],`In "${z}": "${Te}" is only valid when "encoding" is set to "custom". ${pe} encoding found`)):U[Te]?K=K.concat(S.validateSpec({key:Te,value:D[Te],valueSpec:U[Te],validateSpec:S.validateSpec,style:H,styleSpec:F})):K.push(new Qe(Te,D[Te],`unknown property "${Te}"`));return K}({sourceName:n,value:t,style:i.style,styleSpec:l,validateSpec:_}),w;case"geojson":if(w=Nn({key:n,value:t,valueSpec:l.source_geojson,style:h,styleSpec:l,validateSpec:_,objectElementValidators:Ko}),t.cluster)for(const S in t.clusterProperties){const[I,z]=t.clusterProperties[S],D=typeof I=="string"?[I,["accumulated"],["get",S]]:I;w.push(...wo({key:`${n}.${S}.map`,value:z,expressionContext:"cluster-map"})),w.push(...wo({key:`${n}.${S}.reduce`,value:D,expressionContext:"cluster-reduce"}))}return w;case"video":return Nn({key:n,value:t,valueSpec:l.source_video,style:h,validateSpec:_,styleSpec:l});case"image":return Nn({key:n,value:t,valueSpec:l.source_image,style:h,validateSpec:_,styleSpec:l});case"canvas":return[new Qe(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Xs({key:`${n}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Cl(i){const t=i.value,n=i.styleSpec,l=n.light,h=i.style;let _=[];const y=Ti(t);if(t===void 0)return _;if(y!=="object")return _=_.concat([new Qe("light",t,`object expected, ${y} found`)]),_;for(const w in t){const S=w.match(/^(.*)-transition$/);_=_.concat(S&&l[S[1]]&&l[S[1]].transition?i.validateSpec({key:w,value:t[w],valueSpec:n.transition,validateSpec:i.validateSpec,style:h,styleSpec:n}):l[w]?i.validateSpec({key:w,value:t[w],valueSpec:l[w],validateSpec:i.validateSpec,style:h,styleSpec:n}):[new Qe(w,t[w],`unknown property "${w}"`)])}return _}function s(i){const t=i.value,n=i.styleSpec,l=n.sky,h=i.style,_=Ti(t);if(t===void 0)return[];if(_!=="object")return[new Qe("sky",t,`object expected, ${_} found`)];let y=[];for(const w in t)y=y.concat(l[w]?i.validateSpec({key:w,value:t[w],valueSpec:l[w],style:h,styleSpec:n}):[new Qe(w,t[w],`unknown property "${w}"`)]);return y}function d(i){const t=i.value,n=i.styleSpec,l=n.terrain,h=i.style;let _=[];const y=Ti(t);if(t===void 0)return _;if(y!=="object")return _=_.concat([new Qe("terrain",t,`object expected, ${y} found`)]),_;for(const w in t)_=_.concat(l[w]?i.validateSpec({key:w,value:t[w],valueSpec:l[w],validateSpec:i.validateSpec,style:h,styleSpec:n}):[new Qe(w,t[w],`unknown property "${w}"`)]);return _}function v(i){let t=[];const n=i.value,l=i.key;if(Array.isArray(n)){const h=[],_=[];for(const y in n)n[y].id&&h.includes(n[y].id)&&t.push(new Qe(l,n,`all the sprites' ids must be unique, but ${n[y].id} is duplicated`)),h.push(n[y].id),n[y].url&&_.includes(n[y].url)&&t.push(new Qe(l,n,`all the sprites' URLs must be unique, but ${n[y].url} is duplicated`)),_.push(n[y].url),t=t.concat(Nn({key:`${l}[${y}]`,value:n[y],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:i.validateSpec}));return t}return So({key:l,value:n})}const P={"*":()=>[],array:Ra,boolean:function(i){const t=i.value,n=i.key,l=Ti(t);return l!=="boolean"?[new Qe(n,t,`boolean expected, ${l} found`)]:[]},number:qr,color:function(i){const t=i.key,n=i.value,l=Ti(n);return l!=="string"?[new Qe(t,n,`color expected, ${l} found`)]:Xt.parse(String(n))?[]:[new Qe(t,n,`color expected, "${n}" found`)]},constants:Cs,enum:Xs,filter:hu,function:Ws,layer:qi,object:Nn,source:Ks,light:Cl,sky:s,terrain:d,projection:function(i){const t=i.value,n=i.styleSpec,l=n.projection,h=i.style,_=Ti(t);if(t===void 0)return[];if(_!=="object")return[new Qe("projection",t,`object expected, ${_} found`)];let y=[];for(const w in t)y=y.concat(l[w]?i.validateSpec({key:w,value:t[w],valueSpec:l[w],style:h,styleSpec:n}):[new Qe(w,t[w],`unknown property "${w}"`)]);return y},string:So,formatted:function(i){return So(i).length===0?[]:wo(i)},resolvedImage:function(i){return So(i).length===0?[]:wo(i)},padding:function(i){const t=i.key,n=i.value;if(Ti(n)==="array"){if(n.length<1||n.length>4)return[new Qe(t,n,`padding requires 1 to 4 values; ${n.length} values found`)];const l={type:"number"};let h=[];for(let _=0;_<n.length;_++)h=h.concat(i.validateSpec({key:`${t}[${_}]`,value:n[_],validateSpec:i.validateSpec,valueSpec:l}));return h}return qr({key:t,value:n,valueSpec:{}})},variableAnchorOffsetCollection:function(i){const t=i.key,n=i.value,l=Ti(n),h=i.styleSpec;if(l!=="array"||n.length<1||n.length%2!=0)return[new Qe(t,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let _=[];for(let y=0;y<n.length;y+=2)_=_.concat(Xs({key:`${t}[${y}]`,value:n[y],valueSpec:h.layout_symbol["text-anchor"]})),_=_.concat(Ra({key:`${t}[${y+1}]`,value:n[y+1],valueSpec:{length:2,value:"number"},validateSpec:i.validateSpec,style:i.style,styleSpec:h}));return _},sprite:v};function A(i){const t=i.value,n=i.valueSpec,l=i.styleSpec;return i.validateSpec=A,n.expression&&ca(ln(t))?Ws(i):n.expression&&Ps($r(t))?wo(i):n.type&&P[n.type]?P[n.type](i):Nn(gs({},i,{valueSpec:n.type?l[n.type]:n}))}function G(i){const t=i.value,n=i.key,l=So(i);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new Qe(n,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new Qe(n,t,'"glyphs" url must include a "{range}" token'))),l}function ue(i,t=Le){let n=[];return n=n.concat(A({key:"",value:i,valueSpec:t.$root,styleSpec:t,style:i,validateSpec:A,objectElementValidators:{glyphs:G,"*":()=>[]}})),i.constants&&(n=n.concat(Cs({key:"constants",value:i.constants}))),Re(n)}function Pe(i){return function(t){return i({...t,validateSpec:A})}}function Re(i){return[].concat(i).sort((t,n)=>t.line-n.line)}function $e(i){return function(...t){return Re(i.apply(this,t))}}ue.source=$e(Pe(Ks)),ue.sprite=$e(Pe(v)),ue.glyphs=$e(Pe(G)),ue.light=$e(Pe(Cl)),ue.sky=$e(Pe(s)),ue.terrain=$e(Pe(d)),ue.layer=$e(Pe(qi)),ue.filter=$e(Pe(hu)),ue.paintProperty=$e(Pe(Ba)),ue.layoutProperty=$e(Pe(al));const ft=ue,Ht=ft.light,yi=ft.sky,jn=ft.paintProperty,zn=ft.layoutProperty;function pr(i,t){let n=!1;if(t&&t.length)for(const l of t)i.fire(new Vs(new Error(l.message))),n=!0;return n}class An{constructor(t,n,l){const h=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const y=new Int32Array(this.arrayBuffer);t=y[0],this.d=(n=y[1])+2*(l=y[2]);for(let S=0;S<this.d*this.d;S++){const I=y[3+S],z=y[3+S+1];h.push(I===z?null:y.subarray(I,z))}const w=y[3+h.length+1];this.keys=y.subarray(y[3+h.length],w),this.bboxes=y.subarray(w),this.insert=this._insertReadonly}else{this.d=n+2*l;for(let y=0;y<this.d*this.d;y++)h.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=t,this.padding=l,this.scale=n/t,this.uid=0;const _=l/n*t;this.min=-_,this.max=t+_}insert(t,n,l,h,_){this._forEachCell(n,l,h,_,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(n),this.bboxes.push(l),this.bboxes.push(h),this.bboxes.push(_)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,n,l,h,_,y){this.cells[_].push(y)}query(t,n,l,h,_){const y=this.min,w=this.max;if(t<=y&&n<=y&&w<=l&&w<=h&&!_)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(t,n,l,h,this._queryCell,S,{},_),S}}_queryCell(t,n,l,h,_,y,w,S){const I=this.cells[_];if(I!==null){const z=this.keys,D=this.bboxes;for(let F=0;F<I.length;F++){const U=I[F];if(w[U]===void 0){const H=4*U;(S?S(D[H+0],D[H+1],D[H+2],D[H+3]):t<=D[H+2]&&n<=D[H+3]&&l>=D[H+0]&&h>=D[H+1])?(w[U]=!0,y.push(z[U])):w[U]=!1}}}}_forEachCell(t,n,l,h,_,y,w,S){const I=this._convertToCellCoord(t),z=this._convertToCellCoord(n),D=this._convertToCellCoord(l),F=this._convertToCellCoord(h);for(let U=I;U<=D;U++)for(let H=z;H<=F;H++){const K=this.d*H+U;if((!S||S(this._convertFromCellCoord(U),this._convertFromCellCoord(H),this._convertFromCellCoord(U+1),this._convertFromCellCoord(H+1)))&&_.call(this,t,n,l,h,K,y,w,S))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,n=3+this.cells.length+1+1;let l=0;for(let y=0;y<this.cells.length;y++)l+=this.cells[y].length;const h=new Int32Array(n+l+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;let _=n;for(let y=0;y<t.length;y++){const w=t[y];h[3+y]=_,h.set(w,_),_+=w.length}return h[3+t.length]=_,h.set(this.keys,_),_+=this.keys.length,h[3+t.length+1]=_,h.set(this.bboxes,_),_+=this.bboxes.length,h.buffer}static serialize(t,n){const l=t.toArrayBuffer();return n&&n.push(l),{buffer:l}}static deserialize(t){return new An(t.buffer)}}const Xn={};function gt(i,t,n={}){if(Xn[i])throw new Error(`${i} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:i,writeable:!1}),Xn[i]={klass:t,omit:n.omit||[],shallow:n.shallow||[]}}gt("Object",Object),gt("TransferableGridIndex",An),gt("Color",Xt),gt("Error",Error),gt("AJAXError",ii),gt("ResolvedImage",Hn),gt("StylePropertyFunction",Wo),gt("StyleExpression",zr,{omit:["_evaluator"]}),gt("ZoomDependentExpression",pa),gt("ZoomConstantExpression",Go),gt("CompoundExpression",Er,{omit:["_evaluate"]});for(const i in bs)bs[i]._classRegistryKey||gt(`Expression_${i}`,bs[i]);function Is(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function Il(i){return i.$name||i.constructor._classRegistryKey}function Jo(i){return!function(t){if(t===null||typeof t!="object")return!1;const n=Il(t);return!(!n||n==="Object")}(i)&&(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||i instanceof Error||Is(i)||Ei(i)||ArrayBuffer.isView(i)||i instanceof ImageData)}function mr(i,t){if(Jo(i))return(Is(i)||Ei(i))&&t&&t.push(i),ArrayBuffer.isView(i)&&t&&t.push(i.buffer),i instanceof ImageData&&t&&t.push(i.data.buffer),i;if(Array.isArray(i)){const _=[];for(const y of i)_.push(mr(y,t));return _}if(typeof i!="object")throw new Error("can't serialize object of type "+typeof i);const n=Il(i);if(!n)throw new Error(`can't serialize object of unregistered class ${i.constructor.name}`);if(!Xn[n])throw new Error(`${n} is not registered.`);const{klass:l}=Xn[n],h=l.serialize?l.serialize(i,t):{};if(l.serialize){if(t&&h===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const _ in i){if(!i.hasOwnProperty(_)||Xn[n].omit.indexOf(_)>=0)continue;const y=i[_];h[_]=Xn[n].shallow.indexOf(_)>=0?y:mr(y,t)}i instanceof Error&&(h.message=i.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(h.$name=n),h}function Es(i){if(Jo(i))return i;if(Array.isArray(i))return i.map(Es);if(typeof i!="object")throw new Error("can't deserialize object of type "+typeof i);const t=Il(i)||"Object";if(!Xn[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:n}=Xn[t];if(!n)throw new Error(`can't deserialize unregistered class ${t}`);if(n.deserialize)return n.deserialize(i);const l=Object.create(n.prototype);for(const h of Object.keys(i)){if(h==="$name")continue;const _=i[h];l[h]=Xn[t].shallow.indexOf(h)>=0?_:Es(_)}return l}class Ni{constructor(){this.first=!0}update(t,n){const l=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=n),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=l,!0))}}const di={"Latin-1 Supplement":i=>i>=128&&i<=255,"Hangul Jamo":i=>i>=4352&&i<=4607,Khmer:i=>i>=6016&&i<=6143,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Katakana:i=>i>=12448&&i<=12543,Kanbun:i=>i>=12688&&i<=12703,"CJK Strokes":i=>i>=12736&&i<=12783,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"Private Use Area":i=>i>=57344&&i<=63743,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function du(i){for(const t of i)if(fu(t.charCodeAt(0)))return!0;return!1}function Yu(i){for(const t of i)if(!rs(t.charCodeAt(0)))return!1;return!0}function To(i){const t=i.map(n=>{try{return new RegExp(`\\p{sc=${n}}`,"u").source}catch{return null}}).filter(n=>n);return new RegExp(t.join("|"),"u")}const _a=To(["Arab","Dupl","Mong","Ougr","Syrc"]);function rs(i){return!_a.test(String.fromCodePoint(i))}const ll=To(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function fu(i){return!(i!==746&&i!==747&&(i<4352||!(di["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||di["CJK Compatibility"](i)||di["CJK Strokes"](i)||!(!di["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||di["Enclosed CJK Letters and Months"](i)||di["Ideographic Description Characters"](i)||di.Kanbun(i)||di.Katakana(i)&&i!==12540||!(!di["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!di["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||di["Vertical Forms"](i)||di["Yijing Hexagram Symbols"](i)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(i))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(i))||ll.test(String.fromCodePoint(i)))))}function ul(i){return!(fu(i)||function(t){return!!(di["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||di["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||di["Letterlike Symbols"](t)||di["Number Forms"](t)||di["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||di["Control Pictures"](t)&&t!==9251||di["Optical Character Recognition"](t)||di["Enclosed Alphanumerics"](t)||di["Geometric Shapes"](t)||di["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||di["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||di["CJK Symbols and Punctuation"](t)||di.Katakana(t)||di["Private Use Area"](t)||di["CJK Compatibility Forms"](t)||di["Small Form Variants"](t)||di["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(i))}const Oa=To(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function sn(i){return Oa.test(String.fromCodePoint(i))}function un(i,t){return!(!t&&sn(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||di.Khmer(i))}function Fa(i){for(const t of i)if(sn(t.charCodeAt(0)))return!0;return!1}const Yi=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(i){this.pluginStatus=i.pluginStatus,this.pluginURL=i.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(i){this.applyArabicShaping=i.applyArabicShaping,this.processBidirectionalText=i.processBidirectionalText,this.processStyledBidirectionalText=i.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class Pi{constructor(t,n){this.zoom=t,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ni,this.transition={})}isSupportedScript(t){return function(n,l){for(const h of n)if(!un(h.charCodeAt(0),l))return!1;return!0}(t,Yi.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,n=t-Math.floor(t),l=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*n}}}class Js{constructor(t,n){this.property=t,this.value=n,this.expression=function(l,h){if(ca(l))return new Wo(l,h);if(Ps(l)){const _=nl(l,h);if(_.result==="error")throw new Error(_.value.map(y=>`${y.key}: ${y.message}`).join(", "));return _.value}{let _=l;return h.type==="color"&&typeof l=="string"?_=Xt.parse(l):h.type!=="padding"||typeof l!="number"&&!Array.isArray(l)?h.type==="variableAnchorOffsetCollection"&&Array.isArray(l)&&(_=qn.parse(l)):_=nr.parse(l),{kind:"constant",evaluate:()=>_}}}(n===void 0?t.specification.default:n,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,n,l){return this.property.possiblyEvaluate(this,t,n,l)}}class ga{constructor(t){this.property=t,this.value=new Js(t,void 0)}transitioned(t,n){return new pu(this.property,this.value,n,_i({},t.transition,this.transition),t.now)}untransitioned(){return new pu(this.property,this.value,null,{},0)}}class _r{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return qt(this._values[t].value.value)}setValue(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new ga(this._values[t].property)),this._values[t].value=new Js(this._values[t].property,n===null?void 0:qt(n))}getTransition(t){return qt(this._values[t].transition)}setTransition(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new ga(this._values[t].property)),this._values[t].transition=qt(n)||void 0}serialize(){const t={};for(const n of Object.keys(this._values)){const l=this.getValue(n);l!==void 0&&(t[n]=l);const h=this.getTransition(n);h!==void 0&&(t[`${n}-transition`]=h)}return t}transitioned(t,n){const l=new El(this._properties);for(const h of Object.keys(this._values))l._values[h]=this._values[h].transitioned(t,n._values[h]);return l}untransitioned(){const t=new El(this._properties);for(const n of Object.keys(this._values))t._values[n]=this._values[n].untransitioned();return t}}class pu{constructor(t,n,l,h,_){this.property=t,this.value=n,this.begin=_+h.delay||0,this.end=this.begin+h.duration||0,t.specification.transition&&(h.delay||h.duration)&&(this.prior=l)}possiblyEvaluate(t,n,l){const h=t.now||0,_=this.value.possiblyEvaluate(t,n,l),y=this.prior;if(y){if(h>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(h<this.begin)return y.possiblyEvaluate(t,n,l);{const w=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(t,n,l),_,function(S){if(S<=0)return 0;if(S>=1)return 1;const I=S*S,z=I*S;return 4*(S<.5?z:3*(S-I)+z-.75)}(w))}}return _}}class El{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,n,l){const h=new zl(this._properties);for(const _ of Object.keys(this._values))h._values[_]=this._values[_].possiblyEvaluate(t,n,l);return h}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Ml{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return qt(this._values[t].value)}setValue(t,n){this._values[t]=new Js(this._values[t].property,n===null?void 0:qt(n))}serialize(){const t={};for(const n of Object.keys(this._values)){const l=this.getValue(n);l!==void 0&&(t[n]=l)}return t}possiblyEvaluate(t,n,l){const h=new zl(this._properties);for(const _ of Object.keys(this._values))h._values[_]=this._values[_].possiblyEvaluate(t,n,l);return h}}class Ms{constructor(t,n,l){this.property=t,this.value=n,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,n,l,h){return this.property.evaluate(this.value,this.parameters,t,n,l,h)}}class zl{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class vt{constructor(t){this.specification=t}possiblyEvaluate(t,n){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(n)}interpolate(t,n,l){const h=dn[this.specification.type];return h?h(t,n,l):t}}class Bt{constructor(t,n){this.specification=t,this.overrides=n}possiblyEvaluate(t,n,l,h){return new Ms(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(n,null,{},l,h)}:t.expression,n)}interpolate(t,n,l){if(t.value.kind!=="constant"||n.value.kind!=="constant")return t;if(t.value.value===void 0||n.value.value===void 0)return new Ms(this,{kind:"constant",value:void 0},t.parameters);const h=dn[this.specification.type];if(h){const _=h(t.value.value,n.value.value,l);return new Ms(this,{kind:"constant",value:_},t.parameters)}return t}evaluate(t,n,l,h,_,y){return t.kind==="constant"?t.value:t.evaluate(n,l,h,_,y)}}class Al extends Bt{possiblyEvaluate(t,n,l,h){if(t.value===void 0)return new Ms(this,{kind:"constant",value:void 0},n);if(t.expression.kind==="constant"){const _=t.expression.evaluate(n,null,{},l,h),y=t.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,w=this._calculate(y,y,y,n);return new Ms(this,{kind:"constant",value:w},n)}if(t.expression.kind==="camera"){const _=this._calculate(t.expression.evaluate({zoom:n.zoom-1}),t.expression.evaluate({zoom:n.zoom}),t.expression.evaluate({zoom:n.zoom+1}),n);return new Ms(this,{kind:"constant",value:_},n)}return new Ms(this,t.expression,n)}evaluate(t,n,l,h,_,y){if(t.kind==="source"){const w=t.evaluate(n,l,h,_,y);return this._calculate(w,w,w,n)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(n.zoom)-1},l,h),t.evaluate({zoom:Math.floor(n.zoom)},l,h),t.evaluate({zoom:Math.floor(n.zoom)+1},l,h),n):t.value}_calculate(t,n,l,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:l,to:n}}interpolate(t){return t}}class mu{constructor(t){this.specification=t}possiblyEvaluate(t,n,l,h){if(t.value!==void 0){if(t.expression.kind==="constant"){const _=t.expression.evaluate(n,null,{},l,h);return this._calculate(_,_,_,n)}return this._calculate(t.expression.evaluate(new Pi(Math.floor(n.zoom-1),n)),t.expression.evaluate(new Pi(Math.floor(n.zoom),n)),t.expression.evaluate(new Pi(Math.floor(n.zoom+1),n)),n)}}_calculate(t,n,l,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:l,to:n}}interpolate(t){return t}}class Qu{constructor(t){this.specification=t}possiblyEvaluate(t,n,l,h){return!!t.expression.evaluate(n,null,{},l,h)}interpolate(){return!1}}class m{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in t){const l=t[n];l.specification.overridable&&this.overridableProperties.push(n);const h=this.defaultPropertyValues[n]=new Js(l,void 0),_=this.defaultTransitionablePropertyValues[n]=new ga(l);this.defaultTransitioningPropertyValues[n]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=h.possiblyEvaluate({})}}}gt("DataDrivenProperty",Bt),gt("DataConstantProperty",vt),gt("CrossFadedDataDrivenProperty",Al),gt("CrossFadedProperty",mu),gt("ColorRampProperty",Qu);const e="-transition";class o extends Bo{constructor(t,n){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),n.layout&&(this._unevaluatedLayout=new Ml(n.layout)),n.paint)){this._transitionablePaint=new _r(n.paint);for(const l in t.paint)this.setPaintProperty(l,t.paint[l],{validate:!1});for(const l in t.layout)this.setLayoutProperty(l,t.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new zl(n.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,n,l={}){n!=null&&this._validate(zn,`layers.${this.id}.layout.${t}`,t,n,l)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,n):this.visibility=n)}getPaintProperty(t){return t.endsWith(e)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,n,l={}){if(n!=null&&this._validate(jn,`layers.${this.id}.paint.${t}`,t,n,l))return!1;if(t.endsWith(e))return this._transitionablePaint.setTransition(t.slice(0,-11),n||void 0),!1;{const h=this._transitionablePaint._values[t],_=h.property.specification["property-type"]==="cross-faded-data-driven",y=h.value.isDataDriven(),w=h.value;this._transitionablePaint.setValue(t,n),this._handleSpecialPaintPropertyUpdate(t);const S=this._transitionablePaint._values[t].value;return S.isDataDriven()||y||_||this._handleOverridablePaintPropertyUpdate(t,w,S)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,n,l){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,n){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,n)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),Zn(t,(n,l)=>!(n===void 0||l==="layout"&&!Object.keys(n).length||l==="paint"&&!Object.keys(n).length))}_validate(t,n,l,h,_={}){return(!_||_.validate!==!1)&&pr(this,t.call(ft,{key:n,layerType:this.type,objectKey:l,value:h,styleSpec:Le,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const n=this.paint.get(t);if(n instanceof Ms&&Da(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}}const u={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class c{constructor(t,n){this._structArray=t,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class p{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,n){return t._trim(),n&&(t.isTransferred=!0,n.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const n=Object.create(this.prototype);return n.arrayBuffer=t.arrayBuffer,n.length=t.length,n.capacity=t.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function b(i,t=1){let n=0,l=0;return{members:i.map(h=>{const _=u[h.type].BYTES_PER_ELEMENT,y=n=T(n,Math.max(t,_)),w=h.components||1;return l=Math.max(l,_),n+=_*w,{name:h.name,type:h.type,components:w,offset:y}}),size:T(n,Math.max(l,t)),alignment:t}}function T(i,t){return Math.ceil(i/t)*t}class C extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n){const l=this.length;return this.resize(l+1),this.emplace(l,t,n)}emplace(t,n,l){const h=2*t;return this.int16[h+0]=n,this.int16[h+1]=l,t}}C.prototype.bytesPerElement=4,gt("StructArrayLayout2i4",C);class M extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,l)}emplace(t,n,l,h){const _=3*t;return this.int16[_+0]=n,this.int16[_+1]=l,this.int16[_+2]=h,t}}M.prototype.bytesPerElement=6,gt("StructArrayLayout3i6",M);class R extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,h){const _=this.length;return this.resize(_+1),this.emplace(_,t,n,l,h)}emplace(t,n,l,h,_){const y=4*t;return this.int16[y+0]=n,this.int16[y+1]=l,this.int16[y+2]=h,this.int16[y+3]=_,t}}R.prototype.bytesPerElement=8,gt("StructArrayLayout4i8",R);class B extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,_,y){const w=this.length;return this.resize(w+1),this.emplace(w,t,n,l,h,_,y)}emplace(t,n,l,h,_,y,w){const S=6*t;return this.int16[S+0]=n,this.int16[S+1]=l,this.int16[S+2]=h,this.int16[S+3]=_,this.int16[S+4]=y,this.int16[S+5]=w,t}}B.prototype.bytesPerElement=12,gt("StructArrayLayout2i4i12",B);class $ extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,_,y){const w=this.length;return this.resize(w+1),this.emplace(w,t,n,l,h,_,y)}emplace(t,n,l,h,_,y,w){const S=4*t,I=8*t;return this.int16[S+0]=n,this.int16[S+1]=l,this.uint8[I+4]=h,this.uint8[I+5]=_,this.uint8[I+6]=y,this.uint8[I+7]=w,t}}$.prototype.bytesPerElement=8,gt("StructArrayLayout2i4ub8",$);class X extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n){const l=this.length;return this.resize(l+1),this.emplace(l,t,n)}emplace(t,n,l){const h=2*t;return this.float32[h+0]=n,this.float32[h+1]=l,t}}X.prototype.bytesPerElement=8,gt("StructArrayLayout2f8",X);class Y extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,_,y,w,S,I,z){const D=this.length;return this.resize(D+1),this.emplace(D,t,n,l,h,_,y,w,S,I,z)}emplace(t,n,l,h,_,y,w,S,I,z,D){const F=10*t;return this.uint16[F+0]=n,this.uint16[F+1]=l,this.uint16[F+2]=h,this.uint16[F+3]=_,this.uint16[F+4]=y,this.uint16[F+5]=w,this.uint16[F+6]=S,this.uint16[F+7]=I,this.uint16[F+8]=z,this.uint16[F+9]=D,t}}Y.prototype.bytesPerElement=20,gt("StructArrayLayout10ui20",Y);class Q extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,_,y,w,S,I,z,D,F){const U=this.length;return this.resize(U+1),this.emplace(U,t,n,l,h,_,y,w,S,I,z,D,F)}emplace(t,n,l,h,_,y,w,S,I,z,D,F,U){const H=12*t;return this.int16[H+0]=n,this.int16[H+1]=l,this.int16[H+2]=h,this.int16[H+3]=_,this.uint16[H+4]=y,this.uint16[H+5]=w,this.uint16[H+6]=S,this.uint16[H+7]=I,this.int16[H+8]=z,this.int16[H+9]=D,this.int16[H+10]=F,this.int16[H+11]=U,t}}Q.prototype.bytesPerElement=24,gt("StructArrayLayout4i4ui4i24",Q);class ie extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,l)}emplace(t,n,l,h){const _=3*t;return this.float32[_+0]=n,this.float32[_+1]=l,this.float32[_+2]=h,t}}ie.prototype.bytesPerElement=12,gt("StructArrayLayout3f12",ie);class oe extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint32[1*t+0]=n,t}}oe.prototype.bytesPerElement=4,gt("StructArrayLayout1ul4",oe);class de extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,_,y,w,S,I){const z=this.length;return this.resize(z+1),this.emplace(z,t,n,l,h,_,y,w,S,I)}emplace(t,n,l,h,_,y,w,S,I,z){const D=10*t,F=5*t;return this.int16[D+0]=n,this.int16[D+1]=l,this.int16[D+2]=h,this.int16[D+3]=_,this.int16[D+4]=y,this.int16[D+5]=w,this.uint32[F+3]=S,this.uint16[D+8]=I,this.uint16[D+9]=z,t}}de.prototype.bytesPerElement=20,gt("StructArrayLayout6i1ul2ui20",de);class ee extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,_,y){const w=this.length;return this.resize(w+1),this.emplace(w,t,n,l,h,_,y)}emplace(t,n,l,h,_,y,w){const S=6*t;return this.int16[S+0]=n,this.int16[S+1]=l,this.int16[S+2]=h,this.int16[S+3]=_,this.int16[S+4]=y,this.int16[S+5]=w,t}}ee.prototype.bytesPerElement=12,gt("StructArrayLayout2i2i2i12",ee);class ye extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,_){const y=this.length;return this.resize(y+1),this.emplace(y,t,n,l,h,_)}emplace(t,n,l,h,_,y){const w=4*t,S=8*t;return this.float32[w+0]=n,this.float32[w+1]=l,this.float32[w+2]=h,this.int16[S+6]=_,this.int16[S+7]=y,t}}ye.prototype.bytesPerElement=16,gt("StructArrayLayout2f1f2i16",ye);class be extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,_,y){const w=this.length;return this.resize(w+1),this.emplace(w,t,n,l,h,_,y)}emplace(t,n,l,h,_,y,w){const S=16*t,I=4*t,z=8*t;return this.uint8[S+0]=n,this.uint8[S+1]=l,this.float32[I+1]=h,this.float32[I+2]=_,this.int16[z+6]=y,this.int16[z+7]=w,t}}be.prototype.bytesPerElement=16,gt("StructArrayLayout2ub2f2i16",be);class Ce extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,l)}emplace(t,n,l,h){const _=3*t;return this.uint16[_+0]=n,this.uint16[_+1]=l,this.uint16[_+2]=h,t}}Ce.prototype.bytesPerElement=6,gt("StructArrayLayout3ui6",Ce);class Ve extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l,h,_,y,w,S,I,z,D,F,U,H,K,ne,le){const ke=this.length;return this.resize(ke+1),this.emplace(ke,t,n,l,h,_,y,w,S,I,z,D,F,U,H,K,ne,le)}emplace(t,n,l,h,_,y,w,S,I,z,D,F,U,H,K,ne,le,ke){const pe=24*t,Te=12*t,Fe=48*t;return this.int16[pe+0]=n,this.int16[pe+1]=l,this.uint16[pe+2]=h,this.uint16[pe+3]=_,this.uint32[Te+2]=y,this.uint32[Te+3]=w,this.uint32[Te+4]=S,this.uint16[pe+10]=I,this.uint16[pe+11]=z,this.uint16[pe+12]=D,this.float32[Te+7]=F,this.float32[Te+8]=U,this.uint8[Fe+36]=H,this.uint8[Fe+37]=K,this.uint8[Fe+38]=ne,this.uint32[Te+10]=le,this.int16[pe+22]=ke,t}}Ve.prototype.bytesPerElement=48,gt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ve);class et extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l,h,_,y,w,S,I,z,D,F,U,H,K,ne,le,ke,pe,Te,Fe,We,yt,Zt,_t,dt,Et,St){const xt=this.length;return this.resize(xt+1),this.emplace(xt,t,n,l,h,_,y,w,S,I,z,D,F,U,H,K,ne,le,ke,pe,Te,Fe,We,yt,Zt,_t,dt,Et,St)}emplace(t,n,l,h,_,y,w,S,I,z,D,F,U,H,K,ne,le,ke,pe,Te,Fe,We,yt,Zt,_t,dt,Et,St,xt){const je=32*t,Dt=16*t;return this.int16[je+0]=n,this.int16[je+1]=l,this.int16[je+2]=h,this.int16[je+3]=_,this.int16[je+4]=y,this.int16[je+5]=w,this.int16[je+6]=S,this.int16[je+7]=I,this.uint16[je+8]=z,this.uint16[je+9]=D,this.uint16[je+10]=F,this.uint16[je+11]=U,this.uint16[je+12]=H,this.uint16[je+13]=K,this.uint16[je+14]=ne,this.uint16[je+15]=le,this.uint16[je+16]=ke,this.uint16[je+17]=pe,this.uint16[je+18]=Te,this.uint16[je+19]=Fe,this.uint16[je+20]=We,this.uint16[je+21]=yt,this.uint16[je+22]=Zt,this.uint32[Dt+12]=_t,this.float32[Dt+13]=dt,this.float32[Dt+14]=Et,this.uint16[je+30]=St,this.uint16[je+31]=xt,t}}et.prototype.bytesPerElement=64,gt("StructArrayLayout8i15ui1ul2f2ui64",et);class at extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.float32[1*t+0]=n,t}}at.prototype.bytesPerElement=4,gt("StructArrayLayout1f4",at);class pt extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,l)}emplace(t,n,l,h){const _=3*t;return this.uint16[6*t+0]=n,this.float32[_+1]=l,this.float32[_+2]=h,t}}pt.prototype.bytesPerElement=12,gt("StructArrayLayout1ui2f12",pt);class lt extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,l)}emplace(t,n,l,h){const _=4*t;return this.uint32[2*t+0]=n,this.uint16[_+2]=l,this.uint16[_+3]=h,t}}lt.prototype.bytesPerElement=8,gt("StructArrayLayout1ul2ui8",lt);class rt extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n){const l=this.length;return this.resize(l+1),this.emplace(l,t,n)}emplace(t,n,l){const h=2*t;return this.uint16[h+0]=n,this.uint16[h+1]=l,t}}rt.prototype.bytesPerElement=4,gt("StructArrayLayout2ui4",rt);class bt extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint16[1*t+0]=n,t}}bt.prototype.bytesPerElement=2,gt("StructArrayLayout1ui2",bt);class Kt extends p{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l,h){const _=this.length;return this.resize(_+1),this.emplace(_,t,n,l,h)}emplace(t,n,l,h,_){const y=4*t;return this.float32[y+0]=n,this.float32[y+1]=l,this.float32[y+2]=h,this.float32[y+3]=_,t}}Kt.prototype.bytesPerElement=16,gt("StructArrayLayout4f16",Kt);class ut extends c{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new xe(this.anchorPointX,this.anchorPointY)}}ut.prototype.size=20;class ht extends de{get(t){return new ut(this,t)}}gt("CollisionBoxArray",ht);class Gt extends c{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Gt.prototype.size=48;class Wi extends Ve{get(t){return new Gt(this,t)}}gt("PlacedSymbolArray",Wi);class ai extends c{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ai.prototype.size=64;class mi extends et{get(t){return new ai(this,t)}}gt("SymbolInstanceArray",mi);class Qi extends at{getoffsetX(t){return this.float32[1*t+0]}}gt("GlyphOffsetArray",Qi);class or extends M{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}gt("SymbolLineVertexArray",or);class zs extends c{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}zs.prototype.size=12;class en extends pt{get(t){return new zs(this,t)}}gt("TextAnchorOffsetArray",en);class Kn extends c{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Kn.prototype.size=8;class cn extends lt{get(t){return new Kn(this,t)}}gt("FeatureIndexArray",cn);class Cn extends C{}class gr extends C{}class Po extends C{}class ss extends B{}class ko extends ${}class Na extends X{}class As extends Y{}class Ys extends Q{}class Yo extends ie{}class Hr extends oe{}class Ls extends ee{}class Co extends be{}class Qs extends Ce{}class Ln extends rt{}const fn=b([{name:"a_pos",components:2,type:"Int16"}],4),{members:yr}=fn;class vi{constructor(t=[]){this.segments=t}prepareSegment(t,n,l,h){let _=this.segments[this.segments.length-1];return t>vi.MAX_VERTEX_ARRAY_LENGTH&&Di(`Max vertices per segment is ${vi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!_||_.vertexLength+t>vi.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==h)&&(_={vertexOffset:n.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},h!==void 0&&(_.sortKey=h),this.segments.push(_)),_}get(){return this.segments}destroy(){for(const t of this.segments)for(const n in t.vaos)t.vaos[n].destroy()}static simpleSegment(t,n,l,h){return new vi([{vertexOffset:t,primitiveOffset:n,vertexLength:l,primitiveLength:h,vaos:{},sortKey:0}])}}function Ds(i,t){return 256*(i=li(Math.floor(i),0,255))+li(Math.floor(t),0,255)}vi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,gt("SegmentVector",vi);const ja=b([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Io={exports:{}},ec={exports:{}};ec.exports=function(i,t){var n,l,h,_,y,w,S,I;for(l=i.length-(n=3&i.length),h=t,y=3432918353,w=461845907,I=0;I<l;)S=255&i.charCodeAt(I)|(255&i.charCodeAt(++I))<<8|(255&i.charCodeAt(++I))<<16|(255&i.charCodeAt(++I))<<24,++I,h=27492+(65535&(_=5*(65535&(h=(h^=S=(65535&(S=(S=(65535&S)*y+(((S>>>16)*y&65535)<<16)&4294967295)<<15|S>>>17))*w+(((S>>>16)*w&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(S=0,n){case 3:S^=(255&i.charCodeAt(I+2))<<16;case 2:S^=(255&i.charCodeAt(I+1))<<8;case 1:h^=S=(65535&(S=(S=(65535&(S^=255&i.charCodeAt(I)))*y+(((S>>>16)*y&65535)<<16)&4294967295)<<15|S>>>17))*w+(((S>>>16)*w&65535)<<16)&4294967295}return h^=i.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0};var tc=ec.exports,yn={exports:{}};yn.exports=function(i,t){for(var n,l=i.length,h=t^l,_=0;l>=4;)n=1540483477*(65535&(n=255&i.charCodeAt(_)|(255&i.charCodeAt(++_))<<8|(255&i.charCodeAt(++_))<<16|(255&i.charCodeAt(++_))<<24))+((1540483477*(n>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),l-=4,++_;switch(l){case 3:h^=(255&i.charCodeAt(_+2))<<16;case 2:h^=(255&i.charCodeAt(_+1))<<8;case 1:h=1540483477*(65535&(h^=255&i.charCodeAt(_)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0};var Eo=tc,Lu=yn.exports;Io.exports=Eo,Io.exports.murmur3=Eo,Io.exports.murmur2=Lu;var Ll=ze(Io.exports);class Va{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,n,l,h){this.ids.push(Dl(t)),this.positions.push(n,l,h)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const n=Dl(t);let l=0,h=this.ids.length-1;for(;l<h;){const y=l+h>>1;this.ids[y]>=n?h=y:l=y+1}const _=[];for(;this.ids[l]===n;)_.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return _}static serialize(t,n){const l=new Float64Array(t.ids),h=new Uint32Array(t.positions);return Qo(l,h,0,l.length-1),n&&n.push(l.buffer,h.buffer),{ids:l,positions:h}}static deserialize(t){const n=new Va;return n.ids=t.ids,n.positions=t.positions,n.indexed=!0,n}}function Dl(i){const t=+i;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Ll(String(i))}function Qo(i,t,n,l){for(;n<l;){const h=i[n+l>>1];let _=n-1,y=l+1;for(;;){do _++;while(i[_]<h);do y--;while(i[y]>h);if(_>=y)break;tn(i,_,y),tn(t,3*_,3*y),tn(t,3*_+1,3*y+1),tn(t,3*_+2,3*y+2)}y-n<l-y?(Qo(i,t,n,y),n=y+1):(Qo(i,t,y+1,l),l=y)}}function tn(i,t,n){const l=i[t];i[t]=i[n],i[n]=l}gt("FeaturePositionMap",Va);class bn{constructor(t,n){this.gl=t.gl,this.location=n}}class Jn extends bn{constructor(t,n){super(t,n),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class ic extends bn{constructor(t,n){super(t,n),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Du extends bn{constructor(t,n){super(t,n),this.current=Xt.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const nc=new Float32Array(16);function vh(i){return[Ds(255*i.r,255*i.g),Ds(255*i.b,255*i.a)]}class ar{constructor(t,n,l){this.value=t,this.uniformNames=n.map(h=>`u_${h}`),this.type=l}setUniform(t,n,l){t.set(l.constantOr(this.value))}getBinding(t,n,l){return this.type==="color"?new Du(t,n):new Jn(t,n)}}class Rl{constructor(t,n){this.uniformNames=n.map(l=>`u_${l}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=t.tlbr}setUniform(t,n,l,h){const _=h==="u_pattern_to"?this.patternTo:h==="u_pattern_from"?this.patternFrom:h==="u_pixel_ratio_to"?this.pixelRatioTo:h==="u_pixel_ratio_from"?this.pixelRatioFrom:null;_&&t.set(_)}getBinding(t,n,l){return l.substr(0,9)==="u_pattern"?new ic(t,n):new Jn(t,n)}}class ya{constructor(t,n,l,h){this.expression=t,this.type=l,this.maxValue=0,this.paintVertexAttributes=n.map(_=>({name:`a_${_}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(t,n,l,h,_){const y=this.paintVertexArray.length,w=this.expression.evaluate(new Pi(0),n,{},h,[],_);this.paintVertexArray.resize(t),this._setPaintValue(y,t,w)}updatePaintArray(t,n,l,h){const _=this.expression.evaluate({zoom:0},l,h);this._setPaintValue(t,n,_)}_setPaintValue(t,n,l){if(this.type==="color"){const h=vh(l);for(let _=t;_<n;_++)this.paintVertexArray.emplace(_,h[0],h[1])}else{for(let h=t;h<n;h++)this.paintVertexArray.emplace(h,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Mo{constructor(t,n,l,h,_,y){this.expression=t,this.uniformNames=n.map(w=>`u_${w}_t`),this.type=l,this.useIntegerZoom=h,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=n.map(w=>({name:`a_${w}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(t,n,l,h,_){const y=this.expression.evaluate(new Pi(this.zoom),n,{},h,[],_),w=this.expression.evaluate(new Pi(this.zoom+1),n,{},h,[],_),S=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(S,t,y,w)}updatePaintArray(t,n,l,h){const _=this.expression.evaluate({zoom:this.zoom},l,h),y=this.expression.evaluate({zoom:this.zoom+1},l,h);this._setPaintValue(t,n,_,y)}_setPaintValue(t,n,l,h){if(this.type==="color"){const _=vh(l),y=vh(h);for(let w=t;w<n;w++)this.paintVertexArray.emplace(w,_[0],_[1],y[0],y[1])}else{for(let _=t;_<n;_++)this.paintVertexArray.emplace(_,l,h);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,n){const l=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,h=li(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);t.set(h)}getBinding(t,n,l){return new Jn(t,n)}}class Gr{constructor(t,n,l,h,_,y){this.expression=t,this.type=n,this.useIntegerZoom=l,this.zoom=h,this.layerId=y,this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _}populatePaintArray(t,n,l){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(h,t,n.patterns&&n.patterns[this.layerId],l)}updatePaintArray(t,n,l,h,_){this._setPaintValues(t,n,l.patterns&&l.patterns[this.layerId],_)}_setPaintValues(t,n,l,h){if(!h||!l)return;const{min:_,mid:y,max:w}=l,S=h[_],I=h[y],z=h[w];if(S&&I&&z)for(let D=t;D<n;D++)this.zoomInPaintVertexArray.emplace(D,I.tl[0],I.tl[1],I.br[0],I.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],I.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(D,I.tl[0],I.tl[1],I.br[0],I.br[1],z.tl[0],z.tl[1],z.br[0],z.br[1],I.pixelRatio,z.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,ja.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,ja.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class zo{constructor(t,n,l){this.binders={},this._buffers=[];const h=[];for(const _ in t.paint._values){if(!l(_))continue;const y=t.paint.get(_);if(!(y instanceof Ms&&Da(y.property.specification)))continue;const w=xh(_,t.type),S=y.value,I=y.property.specification.type,z=y.property.useIntegerZoom,D=y.property.specification["property-type"],F=D==="cross-faded"||D==="cross-faded-data-driven";if(S.kind==="constant")this.binders[_]=F?new Rl(S.value,w):new ar(S.value,w,I),h.push(`/u_${_}`);else if(S.kind==="source"||F){const U=Oc(_,I,"source");this.binders[_]=F?new Gr(S,I,z,n,U,t.id):new ya(S,w,I,U),h.push(`/a_${_}`)}else{const U=Oc(_,I,"composite");this.binders[_]=new Mo(S,w,I,z,n,U),h.push(`/z_${_}`)}}this.cacheKey=h.sort().join("")}getMaxValue(t){const n=this.binders[t];return n instanceof ya||n instanceof Mo?n.maxValue:0}populatePaintArrays(t,n,l,h,_){for(const y in this.binders){const w=this.binders[y];(w instanceof ya||w instanceof Mo||w instanceof Gr)&&w.populatePaintArray(t,n,l,h,_)}}setConstantPatternPositions(t,n){for(const l in this.binders){const h=this.binders[l];h instanceof Rl&&h.setConstantPatternPositions(t,n)}}updatePaintArrays(t,n,l,h,_){let y=!1;for(const w in t){const S=n.getPositions(w);for(const I of S){const z=l.feature(I.index);for(const D in this.binders){const F=this.binders[D];if((F instanceof ya||F instanceof Mo||F instanceof Gr)&&F.expression.isStateDependent===!0){const U=h.paint.get(D);F.expression=U.value,F.updatePaintArray(I.start,I.end,z,t[w],_),y=!0}}}}return y}defines(){const t=[];for(const n in this.binders){const l=this.binders[n];(l instanceof ar||l instanceof Rl)&&t.push(...l.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return t}getBinderAttributes(){const t=[];for(const n in this.binders){const l=this.binders[n];if(l instanceof ya||l instanceof Mo)for(let h=0;h<l.paintVertexAttributes.length;h++)t.push(l.paintVertexAttributes[h].name);else if(l instanceof Gr)for(let h=0;h<ja.members.length;h++)t.push(ja.members[h].name)}return t}getBinderUniforms(){const t=[];for(const n in this.binders){const l=this.binders[n];if(l instanceof ar||l instanceof Rl||l instanceof Mo)for(const h of l.uniformNames)t.push(h)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,n){const l=[];for(const h in this.binders){const _=this.binders[h];if(_ instanceof ar||_ instanceof Rl||_ instanceof Mo){for(const y of _.uniformNames)if(n[y]){const w=_.getBinding(t,n[y],y);l.push({name:y,property:h,binding:w})}}}return l}setUniforms(t,n,l,h){for(const{name:_,property:y,binding:w}of n)this.binders[y].setUniform(w,h,l.get(y),_)}updatePaintBuffers(t){this._buffers=[];for(const n in this.binders){const l=this.binders[n];if(t&&l instanceof Gr){const h=t.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(l instanceof ya||l instanceof Mo)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(t){for(const n in this.binders){const l=this.binders[n];(l instanceof ya||l instanceof Mo||l instanceof Gr)&&l.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const n=this.binders[t];(n instanceof ya||n instanceof Mo||n instanceof Gr)&&n.destroy()}}}class va{constructor(t,n,l=()=>!0){this.programConfigurations={};for(const h of t)this.programConfigurations[h.id]=new zo(h,n,l);this.needsUpload=!1,this._featureMap=new Va,this._bufferOffset=0}populatePaintArrays(t,n,l,h,_,y){for(const w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(t,n,h,_,y);n.id!==void 0&&this._featureMap.add(n.id,l,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,n,l,h){for(const _ of l)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(t,this._featureMap,n,_,h)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function xh(i,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${t}-`,"").replace(/-/g,"_")]}function Oc(i,t,n){const l={color:{source:X,composite:Kt},number:{source:at,composite:X}},h=function(_){return{"line-pattern":{source:As,composite:As},"fill-pattern":{source:As,composite:As},"fill-extrusion-pattern":{source:As,composite:As}}[_]}(i);return h&&h[n]||l[t][n]}gt("ConstantBinder",ar),gt("CrossFadedConstantBinder",Rl),gt("SourceExpressionBinder",ya),gt("CrossFadedCompositeBinder",Gr),gt("CompositeExpressionBinder",Mo),gt("ProgramConfiguration",zo,{omit:["_buffers"]}),gt("ProgramConfigurationSet",va);const Dn=8192,Fc=Math.pow(2,14)-1,wh=-Fc-1;function Bl(i){const t=Dn/i.extent,n=i.loadGeometry();for(let l=0;l<n.length;l++){const h=n[l];for(let _=0;_<h.length;_++){const y=h[_],w=Math.round(y.x*t),S=Math.round(y.y*t);y.x=li(w,wh,Fc),y.y=li(S,wh,Fc),(w<y.x||w>y.x+1||S<y.y||S>y.y+1)&&Di("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function Ol(i,t){return{type:i.type,id:i.id,properties:i.properties,geometry:t?Bl(i):[]}}function rc(i,t,n,l,h){i.emplaceBack(2*t+(l+1)/2,2*n+(h+1)/2)}class Nc{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new gr,this.indexArray=new Qs,this.segments=new vi,this.programConfigurations=new va(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,l){const h=this.layers[0],_=[];let y=null,w=!1;h.type==="circle"&&(y=h.layout.get("circle-sort-key"),w=!y.isConstant());for(const{feature:S,id:I,index:z,sourceLayerIndex:D}of t){const F=this.layers[0]._featureFilter.needGeometry,U=Ol(S,F);if(!this.layers[0]._featureFilter.filter(new Pi(this.zoom),U,l))continue;const H=w?y.evaluate(U,{},l):void 0,K={id:I,properties:S.properties,type:S.type,sourceLayerIndex:D,index:z,geometry:F?U.geometry:Bl(S),patterns:{},sortKey:H};_.push(K)}w&&_.sort((S,I)=>S.sortKey-I.sortKey);for(const S of _){const{geometry:I,index:z,sourceLayerIndex:D}=S,F=t[z].feature;this.addFeature(S,I,z,l),n.featureIndex.insert(F,I,z,D,this.index)}}update(t,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,yr),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,n,l,h){for(const _ of n)for(const y of _){const w=y.x,S=y.y;if(w<0||w>=Dn||S<0||S>=Dn)continue;const I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),z=I.vertexLength;rc(this.layoutVertexArray,w,S,-1,-1),rc(this.layoutVertexArray,w,S,1,-1),rc(this.layoutVertexArray,w,S,1,1),rc(this.layoutVertexArray,w,S,-1,1),this.indexArray.emplaceBack(z,z+1,z+2),this.indexArray.emplaceBack(z,z+3,z+2),I.vertexLength+=4,I.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{},h)}}function bh(i,t){for(let n=0;n<i.length;n++)if(_u(t,i[n]))return!0;for(let n=0;n<t.length;n++)if(_u(i,t[n]))return!0;return!!Ru(i,t)}function sc(i,t,n){return!!_u(i,t)||!!oc(t,i,n)}function Sh(i,t){if(i.length===1)return Ph(t,i[0]);for(let n=0;n<t.length;n++){const l=t[n];for(let h=0;h<l.length;h++)if(_u(i,l[h]))return!0}for(let n=0;n<i.length;n++)if(Ph(t,i[n]))return!0;for(let n=0;n<t.length;n++)if(Ru(i,t[n]))return!0;return!1}function jc(i,t,n){if(i.length>1){if(Ru(i,t))return!0;for(let l=0;l<t.length;l++)if(oc(t[l],i,n))return!0}for(let l=0;l<i.length;l++)if(oc(i[l],t,n))return!0;return!1}function Ru(i,t){if(i.length===0||t.length===0)return!1;for(let n=0;n<i.length-1;n++){const l=i[n],h=i[n+1];for(let _=0;_<t.length-1;_++)if(Qh(l,h,t[_],t[_+1]))return!0}return!1}function Qh(i,t,n,l){return xi(i,n,l)!==xi(t,n,l)&&xi(i,t,n)!==xi(i,t,l)}function oc(i,t,n){const l=n*n;if(t.length===1)return i.distSqr(t[0])<l;for(let h=1;h<t.length;h++)if(Th(i,t[h-1],t[h])<l)return!0;return!1}function Th(i,t,n){const l=t.distSqr(n);if(l===0)return i.distSqr(t);const h=((i.x-t.x)*(n.x-t.x)+(i.y-t.y)*(n.y-t.y))/l;return i.distSqr(h<0?t:h>1?n:n.sub(t)._mult(h)._add(t))}function Ph(i,t){let n,l,h,_=!1;for(let y=0;y<i.length;y++){n=i[y];for(let w=0,S=n.length-1;w<n.length;S=w++)l=n[w],h=n[S],l.y>t.y!=h.y>t.y&&t.x<(h.x-l.x)*(t.y-l.y)/(h.y-l.y)+l.x&&(_=!_)}return _}function _u(i,t){let n=!1;for(let l=0,h=i.length-1;l<i.length;h=l++){const _=i[l],y=i[h];_.y>t.y!=y.y>t.y&&t.x<(y.x-_.x)*(t.y-_.y)/(y.y-_.y)+_.x&&(n=!n)}return n}function ed(i,t,n){const l=n[0],h=n[2];if(i.x<l.x&&t.x<l.x||i.x>h.x&&t.x>h.x||i.y<l.y&&t.y<l.y||i.y>h.y&&t.y>h.y)return!1;const _=xi(i,t,n[0]);return _!==xi(i,t,n[1])||_!==xi(i,t,n[2])||_!==xi(i,t,n[3])}function gu(i,t,n){const l=t.paint.get(i).value;return l.kind==="constant"?l.value:n.programConfigurations.get(t.id).getMaxValue(i)}function ac(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function lc(i,t,n,l,h){if(!t[0]&&!t[1])return i;const _=xe.convert(t)._mult(h);n==="viewport"&&_._rotate(-l);const y=[];for(let w=0;w<i.length;w++)y.push(i[w].sub(_));return y}let kh,td;gt("CircleBucket",Nc,{omit:["layers"]});var id={get paint(){return td=td||new m({"circle-radius":new Bt(Le.paint_circle["circle-radius"]),"circle-color":new Bt(Le.paint_circle["circle-color"]),"circle-blur":new Bt(Le.paint_circle["circle-blur"]),"circle-opacity":new Bt(Le.paint_circle["circle-opacity"]),"circle-translate":new vt(Le.paint_circle["circle-translate"]),"circle-translate-anchor":new vt(Le.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new vt(Le.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new vt(Le.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Bt(Le.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Bt(Le.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Bt(Le.paint_circle["circle-stroke-opacity"])})},get layout(){return kh=kh||new m({"circle-sort-key":new Bt(Le.layout_circle["circle-sort-key"])})}},os=1e-6,Bu=typeof Float32Array<"u"?Float32Array:Array;function Vc(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Ch(i,t,n){var l=t[0],h=t[1],_=t[2],y=t[3],w=t[4],S=t[5],I=t[6],z=t[7],D=t[8],F=t[9],U=t[10],H=t[11],K=t[12],ne=t[13],le=t[14],ke=t[15],pe=n[0],Te=n[1],Fe=n[2],We=n[3];return i[0]=pe*l+Te*w+Fe*D+We*K,i[1]=pe*h+Te*S+Fe*F+We*ne,i[2]=pe*_+Te*I+Fe*U+We*le,i[3]=pe*y+Te*z+Fe*H+We*ke,i[4]=(pe=n[4])*l+(Te=n[5])*w+(Fe=n[6])*D+(We=n[7])*K,i[5]=pe*h+Te*S+Fe*F+We*ne,i[6]=pe*_+Te*I+Fe*U+We*le,i[7]=pe*y+Te*z+Fe*H+We*ke,i[8]=(pe=n[8])*l+(Te=n[9])*w+(Fe=n[10])*D+(We=n[11])*K,i[9]=pe*h+Te*S+Fe*F+We*ne,i[10]=pe*_+Te*I+Fe*U+We*le,i[11]=pe*y+Te*z+Fe*H+We*ke,i[12]=(pe=n[12])*l+(Te=n[13])*w+(Fe=n[14])*D+(We=n[15])*K,i[13]=pe*h+Te*S+Fe*F+We*ne,i[14]=pe*_+Te*I+Fe*U+We*le,i[15]=pe*y+Te*z+Fe*H+We*ke,i}Math.hypot||(Math.hypot=function(){for(var i=0,t=arguments.length;t--;)i+=arguments[t]*arguments[t];return Math.sqrt(i)});var Ou,Uc=Ch;function Zc(i,t,n){var l=t[0],h=t[1],_=t[2],y=t[3];return i[0]=n[0]*l+n[4]*h+n[8]*_+n[12]*y,i[1]=n[1]*l+n[5]*h+n[9]*_+n[13]*y,i[2]=n[2]*l+n[6]*h+n[10]*_+n[14]*y,i[3]=n[3]*l+n[7]*h+n[11]*_+n[15]*y,i}Ou=new Bu(4),Bu!=Float32Array&&(Ou[0]=0,Ou[1]=0,Ou[2]=0,Ou[3]=0);class Jd extends o{constructor(t){super(t,id)}createBucket(t){return new Nc(t)}queryRadius(t){const n=t;return gu("circle-radius",this,n)+gu("circle-stroke-width",this,n)+ac(this.paint.get("circle-translate"))}queryIntersectsFeature(t,n,l,h,_,y,w,S){const I=lc(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),y.angle,w),z=this.paint.get("circle-radius").evaluate(n,l)+this.paint.get("circle-stroke-width").evaluate(n,l),D=this.paint.get("circle-pitch-alignment")==="map",F=D?I:function(H,K){return H.map(ne=>nd(ne,K))}(I,S),U=D?z*w:z;for(const H of h)for(const K of H){const ne=D?K:nd(K,S);let le=U;const ke=Zc([],[K.x,K.y,0,1],S);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?le*=ke[3]/y.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(le*=y.cameraToCenterDistance/ke[3]),sc(F,ne,le))return!0}return!1}}function nd(i,t){const n=Zc([],[i.x,i.y,0,1],t);return new xe(n[0]/n[3],n[1]/n[3])}class ea extends Nc{}let $c;gt("HeatmapBucket",ea,{omit:["layers"]});var qc={get paint(){return $c=$c||new m({"heatmap-radius":new Bt(Le.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Bt(Le.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new vt(Le.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Qu(Le.paint_heatmap["heatmap-color"]),"heatmap-opacity":new vt(Le.paint_heatmap["heatmap-opacity"])})}};function Hc(i,{width:t,height:n},l,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==t*n*l)throw new RangeError(`mismatched image size. expected: ${h.length} but got: ${t*n*l}`)}else h=new Uint8Array(t*n*l);return i.width=t,i.height=n,i.data=h,i}function Ih(i,{width:t,height:n},l){if(t===i.width&&n===i.height)return;const h=Hc({},{width:t,height:n},l);Gc(i,h,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,t),height:Math.min(i.height,n)},l),i.width=t,i.height=n,i.data=h.data}function Gc(i,t,n,l,h,_){if(h.width===0||h.height===0)return t;if(h.width>i.width||h.height>i.height||n.x>i.width-h.width||n.y>i.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||l.x>t.width-h.width||l.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const y=i.data,w=t.data;if(y===w)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<h.height;S++){const I=((n.y+S)*i.width+n.x)*_,z=((l.y+S)*t.width+l.x)*_;for(let D=0;D<h.width*_;D++)w[z+D]=y[I+D]}return t}class yu{constructor(t,n){Hc(this,t,1,n)}resize(t){Ih(this,t,1)}clone(){return new yu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,l,h,_){Gc(t,n,l,h,_,1)}}class Lr{constructor(t,n){Hc(this,t,4,n)}resize(t){Ih(this,t,4)}replace(t,n){n?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Lr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,l,h,_){Gc(t,n,l,h,_,4)}}function Wc(i){const t={},n=i.resolution||256,l=i.clips?i.clips.length:1,h=i.image||new Lr({width:n,height:l});if(Math.log(n)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${n}`);const _=(y,w,S)=>{t[i.evaluationKey]=S;const I=i.expression.evaluate(t);h.data[y+w+0]=Math.floor(255*I.r/I.a),h.data[y+w+1]=Math.floor(255*I.g/I.a),h.data[y+w+2]=Math.floor(255*I.b/I.a),h.data[y+w+3]=Math.floor(255*I.a)};if(i.clips)for(let y=0,w=0;y<l;++y,w+=4*n)for(let S=0,I=0;S<n;S++,I+=4){const z=S/(n-1),{start:D,end:F}=i.clips[y];_(w,I,D*(1-z)+F*z)}else for(let y=0,w=0;y<n;y++,w+=4)_(0,w,y/(n-1));return h}gt("AlphaImage",yu),gt("RGBAImage",Lr);const uc="big-fb";class Yd extends o{createBucket(t){return new ea(t)}constructor(t){super(t,qc),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Wc({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(uc)&&this.heatmapFbos.delete(uc)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Eh;var rd={get paint(){return Eh=Eh||new m({"hillshade-illumination-direction":new vt(Le.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new vt(Le.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new vt(Le.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new vt(Le.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new vt(Le.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new vt(Le.paint_hillshade["hillshade-accent-color"])})}};class sd extends o{constructor(t){super(t,rd)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const od=b([{name:"a_pos",components:2,type:"Int16"}],4),{members:ad}=od;function ld(i,t,n=2){const l=t&&t.length,h=l?t[0]*n:i.length;let _=Rs(i,0,h,n,!0);const y=[];if(!_||_.next===_.prev)return y;let w,S,I;if(l&&(_=function(z,D,F,U){const H=[];for(let K=0,ne=D.length;K<ne;K++){const le=Rs(z,D[K]*U,K<ne-1?D[K+1]*U:z.length,U,!1);le===le.next&&(le.steiner=!0),H.push(pd(le))}H.sort(Mh);for(let K=0;K<H.length;K++)F=fd(H[K],F);return F}(i,t,_,n)),i.length>80*n){w=1/0,S=1/0;let z=-1/0,D=-1/0;for(let F=n;F<h;F+=n){const U=i[F],H=i[F+1];U<w&&(w=U),H<S&&(S=H),U>z&&(z=U),H>D&&(D=H)}I=Math.max(z-w,D-S),I=I!==0?32767/I:0}return Fu(_,y,n,w,S,I,0),y}function Rs(i,t,n,l,h){let _;if(h===function(y,w,S,I){let z=0;for(let D=w,F=S-I;D<S;D+=I)z+=(y[F]-y[D])*(y[D+1]+y[F+1]),F=D;return z}(i,t,n,l)>0)for(let y=t;y<n;y+=l)_=dc(y/l|0,i[y],i[y+1],_);else for(let y=n-l;y>=t;y-=l)_=dc(y/l|0,i[y],i[y+1],_);return _&&Nu(_,_.next)&&(Ao(_),_=_.next),_}function Yn(i,t){if(!i)return i;t||(t=i);let n,l=i;do if(n=!1,l.steiner||!Nu(l,l.next)&&In(l.prev,l,l.next)!==0)l=l.next;else{if(Ao(l),l=t=l.prev,l===l.next)break;n=!0}while(n||l!==t);return t}function Fu(i,t,n,l,h,_,y){if(!i)return;!y&&_&&function(S,I,z,D){let F=S;do F.z===0&&(F.z=Xc(F.x,F.y,I,z,D)),F.prevZ=F.prev,F.nextZ=F.next,F=F.next;while(F!==S);F.prevZ.nextZ=null,F.prevZ=null,function(U){let H,K=1;do{let ne,le=U;U=null;let ke=null;for(H=0;le;){H++;let pe=le,Te=0;for(let We=0;We<K&&(Te++,pe=pe.nextZ,pe);We++);let Fe=K;for(;Te>0||Fe>0&&pe;)Te!==0&&(Fe===0||!pe||le.z<=pe.z)?(ne=le,le=le.nextZ,Te--):(ne=pe,pe=pe.nextZ,Fe--),ke?ke.nextZ=ne:U=ne,ne.prevZ=ke,ke=ne;le=pe}ke.nextZ=null,K*=2}while(H>1)}(F)}(i,l,h,_);let w=i;for(;i.prev!==i.next;){const S=i.prev,I=i.next;if(_?cd(i,l,h,_):ud(i))t.push(S.i,i.i,I.i),Ao(i),i=I.next,w=I.next;else if((i=I)===w){y?y===1?Fu(i=hd(Yn(i),t),t,n,l,h,_,2):y===2&&dd(i,t,n,l,h,_):Fu(Yn(i),t,n,l,h,_,1);break}}}function ud(i){const t=i.prev,n=i,l=i.next;if(In(t,n,l)>=0)return!1;const h=t.x,_=n.x,y=l.x,w=t.y,S=n.y,I=l.y,z=h<_?h<y?h:y:_<y?_:y,D=w<S?w<I?w:I:S<I?S:I,F=h>_?h>y?h:y:_>y?_:y,U=w>S?w>I?w:I:S>I?S:I;let H=l.next;for(;H!==t;){if(H.x>=z&&H.x<=F&&H.y>=D&&H.y<=U&&Fl(h,w,_,S,y,I,H.x,H.y)&&In(H.prev,H,H.next)>=0)return!1;H=H.next}return!0}function cd(i,t,n,l){const h=i.prev,_=i,y=i.next;if(In(h,_,y)>=0)return!1;const w=h.x,S=_.x,I=y.x,z=h.y,D=_.y,F=y.y,U=w<S?w<I?w:I:S<I?S:I,H=z<D?z<F?z:F:D<F?D:F,K=w>S?w>I?w:I:S>I?S:I,ne=z>D?z>F?z:F:D>F?D:F,le=Xc(U,H,t,n,l),ke=Xc(K,ne,t,n,l);let pe=i.prevZ,Te=i.nextZ;for(;pe&&pe.z>=le&&Te&&Te.z<=ke;){if(pe.x>=U&&pe.x<=K&&pe.y>=H&&pe.y<=ne&&pe!==h&&pe!==y&&Fl(w,z,S,D,I,F,pe.x,pe.y)&&In(pe.prev,pe,pe.next)>=0||(pe=pe.prevZ,Te.x>=U&&Te.x<=K&&Te.y>=H&&Te.y<=ne&&Te!==h&&Te!==y&&Fl(w,z,S,D,I,F,Te.x,Te.y)&&In(Te.prev,Te,Te.next)>=0))return!1;Te=Te.nextZ}for(;pe&&pe.z>=le;){if(pe.x>=U&&pe.x<=K&&pe.y>=H&&pe.y<=ne&&pe!==h&&pe!==y&&Fl(w,z,S,D,I,F,pe.x,pe.y)&&In(pe.prev,pe,pe.next)>=0)return!1;pe=pe.prevZ}for(;Te&&Te.z<=ke;){if(Te.x>=U&&Te.x<=K&&Te.y>=H&&Te.y<=ne&&Te!==h&&Te!==y&&Fl(w,z,S,D,I,F,Te.x,Te.y)&&In(Te.prev,Te,Te.next)>=0)return!1;Te=Te.nextZ}return!0}function hd(i,t){let n=i;do{const l=n.prev,h=n.next.next;!Nu(l,h)&&cc(l,n,n.next,h)&&vu(l,h)&&vu(h,l)&&(t.push(l.i,n.i,h.i),Ao(n),Ao(n.next),n=i=h),n=n.next}while(n!==i);return Yn(n)}function dd(i,t,n,l,h,_){let y=i;do{let w=y.next.next;for(;w!==y.prev;){if(y.i!==w.i&&Ah(y,w)){let S=Lh(y,w);return y=Yn(y,y.next),S=Yn(S,S.next),Fu(y,t,n,l,h,_,0),void Fu(S,t,n,l,h,_,0)}w=w.next}y=y.next}while(y!==i)}function Mh(i,t){return i.x-t.x}function fd(i,t){const n=function(h,_){let y=_;const w=h.x,S=h.y;let I,z=-1/0;do{if(S<=y.y&&S>=y.next.y&&y.next.y!==y.y){const K=y.x+(S-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(K<=w&&K>z&&(z=K,I=y.x<y.next.x?y:y.next,K===w))return I}y=y.next}while(y!==_);if(!I)return null;const D=I,F=I.x,U=I.y;let H=1/0;y=I;do{if(w>=y.x&&y.x>=F&&w!==y.x&&Fl(S<U?w:z,S,F,U,S<U?z:w,S,y.x,y.y)){const K=Math.abs(S-y.y)/(w-y.x);vu(y,h)&&(K<H||K===H&&(y.x>I.x||y.x===I.x&&zh(I,y)))&&(I=y,H=K)}y=y.next}while(y!==D);return I}(i,t);if(!n)return t;const l=Lh(n,i);return Yn(l,l.next),Yn(n,n.next)}function zh(i,t){return In(i.prev,i,t.prev)<0&&In(t.next,i,i.next)<0}function Xc(i,t,n,l,h){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-n)*h|0)|i<<8))|i<<4))|i<<2))|i<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-l)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function pd(i){let t=i,n=i;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==i);return n}function Fl(i,t,n,l,h,_,y,w){return(h-y)*(t-w)>=(i-y)*(_-w)&&(i-y)*(l-w)>=(n-y)*(t-w)&&(n-y)*(_-w)>=(h-y)*(l-w)}function Ah(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!function(n,l){let h=n;do{if(h.i!==n.i&&h.next.i!==n.i&&h.i!==l.i&&h.next.i!==l.i&&cc(h,h.next,n,l))return!0;h=h.next}while(h!==n);return!1}(i,t)&&(vu(i,t)&&vu(t,i)&&function(n,l){let h=n,_=!1;const y=(n.x+l.x)/2,w=(n.y+l.y)/2;do h.y>w!=h.next.y>w&&h.next.y!==h.y&&y<(h.next.x-h.x)*(w-h.y)/(h.next.y-h.y)+h.x&&(_=!_),h=h.next;while(h!==n);return _}(i,t)&&(In(i.prev,i,t.prev)||In(i,t.prev,t))||Nu(i,t)&&In(i.prev,i,i.next)>0&&In(t.prev,t,t.next)>0)}function In(i,t,n){return(t.y-i.y)*(n.x-t.x)-(t.x-i.x)*(n.y-t.y)}function Nu(i,t){return i.x===t.x&&i.y===t.y}function cc(i,t,n,l){const h=hc(In(i,t,n)),_=hc(In(i,t,l)),y=hc(In(n,l,i)),w=hc(In(n,l,t));return h!==_&&y!==w||!(h!==0||!Kc(i,n,t))||!(_!==0||!Kc(i,l,t))||!(y!==0||!Kc(n,i,l))||!(w!==0||!Kc(n,t,l))}function Kc(i,t,n){return t.x<=Math.max(i.x,n.x)&&t.x>=Math.min(i.x,n.x)&&t.y<=Math.max(i.y,n.y)&&t.y>=Math.min(i.y,n.y)}function hc(i){return i>0?1:i<0?-1:0}function vu(i,t){return In(i.prev,i,i.next)<0?In(i,t,i.next)>=0&&In(i,i.prev,t)>=0:In(i,t,i.prev)<0||In(i,i.next,t)<0}function Lh(i,t){const n=Dh(i.i,i.x,i.y),l=Dh(t.i,t.x,t.y),h=i.next,_=t.prev;return i.next=t,t.prev=i,n.next=h,h.prev=n,l.next=n,n.prev=l,_.next=l,l.prev=_,l}function dc(i,t,n,l){const h=Dh(i,t,n);return l?(h.next=l.next,h.prev=l,l.next.prev=h,l.next=h):(h.prev=h,h.next=h),h}function Ao(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Dh(i,t,n){return{i,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Jc(i,t,n){const l=n.patternDependencies;let h=!1;for(const _ of t){const y=_.paint.get(`${i}-pattern`);y.isConstant()||(h=!0);const w=y.constantOr(null);w&&(h=!0,l[w.to]=!0,l[w.from]=!0)}return h}function fc(i,t,n,l,h){const _=h.patternDependencies;for(const y of t){const w=y.paint.get(`${i}-pattern`).value;if(w.kind!=="constant"){let S=w.evaluate({zoom:l-1},n,{},h.availableImages),I=w.evaluate({zoom:l},n,{},h.availableImages),z=w.evaluate({zoom:l+1},n,{},h.availableImages);S=S&&S.name?S.name:S,I=I&&I.name?I.name:I,z=z&&z.name?z.name:z,_[S]=!0,_[I]=!0,_[z]=!0,n.patterns[y.id]={min:S,mid:I,max:z}}}return n}class Yc{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Po,this.indexArray=new Qs,this.indexArray2=new Ln,this.programConfigurations=new va(t.layers,t.zoom),this.segments=new vi,this.segments2=new vi,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,l){this.hasPattern=Jc("fill",this.layers,n);const h=this.layers[0].layout.get("fill-sort-key"),_=!h.isConstant(),y=[];for(const{feature:w,id:S,index:I,sourceLayerIndex:z}of t){const D=this.layers[0]._featureFilter.needGeometry,F=Ol(w,D);if(!this.layers[0]._featureFilter.filter(new Pi(this.zoom),F,l))continue;const U=_?h.evaluate(F,{},l,n.availableImages):void 0,H={id:S,properties:w.properties,type:w.type,sourceLayerIndex:z,index:I,geometry:D?F.geometry:Bl(w),patterns:{},sortKey:U};y.push(H)}_&&y.sort((w,S)=>w.sortKey-S.sortKey);for(const w of y){const{geometry:S,index:I,sourceLayerIndex:z}=w;if(this.hasPattern){const D=fc("fill",this.layers,w,this.zoom,n);this.patternFeatures.push(D)}else this.addFeature(w,S,I,l,{});n.featureIndex.insert(t[I].feature,S,I,z,this.index)}}update(t,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,l)}addFeatures(t,n,l){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,n,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ad),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,n,l,h,_){for(const y of la(n,500)){let w=0;for(const U of y)w+=U.length;const S=this.segments.prepareSegment(w,this.layoutVertexArray,this.indexArray),I=S.vertexLength,z=[],D=[];for(const U of y){if(U.length===0)continue;U!==y[0]&&D.push(z.length/2);const H=this.segments2.prepareSegment(U.length,this.layoutVertexArray,this.indexArray2),K=H.vertexLength;this.layoutVertexArray.emplaceBack(U[0].x,U[0].y),this.indexArray2.emplaceBack(K+U.length-1,K),z.push(U[0].x),z.push(U[0].y);for(let ne=1;ne<U.length;ne++)this.layoutVertexArray.emplaceBack(U[ne].x,U[ne].y),this.indexArray2.emplaceBack(K+ne-1,K+ne),z.push(U[ne].x),z.push(U[ne].y);H.vertexLength+=U.length,H.primitiveLength+=U.length}const F=ld(z,D);for(let U=0;U<F.length;U+=3)this.indexArray.emplaceBack(I+F[U],I+F[U+1],I+F[U+2]);S.vertexLength+=w,S.primitiveLength+=F.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,_,h)}}let Rh,ju;gt("FillBucket",Yc,{omit:["layers","patternFeatures"]});var as={get paint(){return ju=ju||new m({"fill-antialias":new vt(Le.paint_fill["fill-antialias"]),"fill-opacity":new Bt(Le.paint_fill["fill-opacity"]),"fill-color":new Bt(Le.paint_fill["fill-color"]),"fill-outline-color":new Bt(Le.paint_fill["fill-outline-color"]),"fill-translate":new vt(Le.paint_fill["fill-translate"]),"fill-translate-anchor":new vt(Le.paint_fill["fill-translate-anchor"]),"fill-pattern":new Al(Le.paint_fill["fill-pattern"])})},get layout(){return Rh=Rh||new m({"fill-sort-key":new Bt(Le.layout_fill["fill-sort-key"])})}};class Qd extends o{constructor(t){super(t,as)}recalculate(t,n){super.recalculate(t,n);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Yc(t)}queryRadius(){return ac(this.paint.get("fill-translate"))}queryIntersectsFeature(t,n,l,h,_,y,w){return Sh(lc(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),y.angle,w),h)}isTileClipped(){return!0}}const ef=b([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Qc=b([{name:"a_centroid",components:2,type:"Int16"}],4),{members:ls}=ef;var Nl={},At=nt,xu=jl;function jl(i,t,n,l,h){this.properties={},this.extent=n,this.type=0,this._pbf=i,this._geometry=-1,this._keys=l,this._values=h,i.readFields(md,this,t)}function md(i,t,n){i==1?t.id=n.readVarint():i==2?function(l,h){for(var _=l.readVarint()+l.pos;l.pos<_;){var y=h._keys[l.readVarint()],w=h._values[l.readVarint()];h.properties[y]=w}}(n,t):i==3?t.type=n.readVarint():i==4&&(t._geometry=n.pos)}function tf(i){for(var t,n,l=0,h=0,_=i.length,y=_-1;h<_;y=h++)l+=((n=i[y]).x-(t=i[h]).x)*(t.y+n.y);return l}jl.types=["Unknown","Point","LineString","Polygon"],jl.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var t,n=i.readVarint()+i.pos,l=1,h=0,_=0,y=0,w=[];i.pos<n;){if(h<=0){var S=i.readVarint();l=7&S,h=S>>3}if(h--,l===1||l===2)_+=i.readSVarint(),y+=i.readSVarint(),l===1&&(t&&w.push(t),t=[]),t.push(new At(_,y));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&w.push(t),w},jl.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var t=i.readVarint()+i.pos,n=1,l=0,h=0,_=0,y=1/0,w=-1/0,S=1/0,I=-1/0;i.pos<t;){if(l<=0){var z=i.readVarint();n=7&z,l=z>>3}if(l--,n===1||n===2)(h+=i.readSVarint())<y&&(y=h),h>w&&(w=h),(_+=i.readSVarint())<S&&(S=_),_>I&&(I=_);else if(n!==7)throw new Error("unknown command "+n)}return[y,S,w,I]},jl.prototype.toGeoJSON=function(i,t,n){var l,h,_=this.extent*Math.pow(2,n),y=this.extent*i,w=this.extent*t,S=this.loadGeometry(),I=jl.types[this.type];function z(U){for(var H=0;H<U.length;H++){var K=U[H];U[H]=[360*(K.x+y)/_-180,360/Math.PI*Math.atan(Math.exp((180-360*(K.y+w)/_)*Math.PI/180))-90]}}switch(this.type){case 1:var D=[];for(l=0;l<S.length;l++)D[l]=S[l][0];z(S=D);break;case 2:for(l=0;l<S.length;l++)z(S[l]);break;case 3:for(S=function(U){var H=U.length;if(H<=1)return[U];for(var K,ne,le=[],ke=0;ke<H;ke++){var pe=tf(U[ke]);pe!==0&&(ne===void 0&&(ne=pe<0),ne===pe<0?(K&&le.push(K),K=[U[ke]]):K.push(U[ke]))}return K&&le.push(K),le}(S),l=0;l<S.length;l++)for(h=0;h<S[l].length;h++)z(S[l][h])}S.length===1?S=S[0]:I="Multi"+I;var F={type:"Feature",geometry:{type:I,coordinates:S},properties:this.properties};return"id"in this&&(F.id=this.id),F};var pc=xu,mc=eh;function eh(i,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(_d,this,t),this.length=this._features.length}function _d(i,t,n){i===15?t.version=n.readVarint():i===1?t.name=n.readString():i===5?t.extent=n.readVarint():i===2?t._features.push(n.pos):i===3?t._keys.push(n.readString()):i===4&&t._values.push(function(l){for(var h=null,_=l.readVarint()+l.pos;l.pos<_;){var y=l.readVarint()>>3;h=y===1?l.readString():y===2?l.readFloat():y===3?l.readDouble():y===4?l.readVarint64():y===5?l.readVarint():y===6?l.readSVarint():y===7?l.readBoolean():null}return h}(n))}eh.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var t=this._pbf.readVarint()+this._pbf.pos;return new pc(this._pbf,t,this.extent,this._keys,this._values)};var gd=mc;function yd(i,t,n){if(i===3){var l=new gd(n,n.readVarint()+n.pos);l.length&&(t[l.name]=l)}}Nl.VectorTile=function(i,t){this.layers=i.readFields(yd,{},t)},Nl.VectorTileFeature=xu,Nl.VectorTileLayer=mc;const Bh=Nl.VectorTileFeature.types,_c=Math.pow(2,13);function Qn(i,t,n,l,h,_,y,w){i.emplaceBack(t,n,2*Math.floor(l*_c)+y,h*_c*2,_*_c*2,Math.round(w))}class Lo{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ss,this.centroidVertexArray=new Cn,this.indexArray=new Qs,this.programConfigurations=new va(t.layers,t.zoom),this.segments=new vi,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,l){this.features=[],this.hasPattern=Jc("fill-extrusion",this.layers,n);for(const{feature:h,id:_,index:y,sourceLayerIndex:w}of t){const S=this.layers[0]._featureFilter.needGeometry,I=Ol(h,S);if(!this.layers[0]._featureFilter.filter(new Pi(this.zoom),I,l))continue;const z={id:_,sourceLayerIndex:w,index:y,geometry:S?I.geometry:Bl(h),properties:h.properties,type:h.type,patterns:{}};this.hasPattern?this.features.push(fc("fill-extrusion",this.layers,z,this.zoom,n)):this.addFeature(z,z.geometry,y,l,{}),n.featureIndex.insert(h,z.geometry,y,w,this.index,!0)}}addFeatures(t,n,l){for(const h of this.features){const{geometry:_}=h;this.addFeature(h,_,h.index,n,l)}}update(t,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ls),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Qc.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,n,l,h,_){for(const y of la(n,500)){const w={x:0,y:0,vertexCount:0};let S=0;for(const H of y)S+=H.length;let I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const H of y){if(H.length===0||vd(H))continue;let K=0;for(let ne=0;ne<H.length;ne++){const le=H[ne];if(ne>=1){const ke=H[ne-1];if(!Vl(le,ke)){I.vertexLength+4>vi.MAX_VERTEX_ARRAY_LENGTH&&(I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const pe=le.sub(ke)._perp()._unit(),Te=ke.dist(le);K+Te>32768&&(K=0),Qn(this.layoutVertexArray,le.x,le.y,pe.x,pe.y,0,0,K),Qn(this.layoutVertexArray,le.x,le.y,pe.x,pe.y,0,1,K),w.x+=2*le.x,w.y+=2*le.y,w.vertexCount+=2,K+=Te,Qn(this.layoutVertexArray,ke.x,ke.y,pe.x,pe.y,0,0,K),Qn(this.layoutVertexArray,ke.x,ke.y,pe.x,pe.y,0,1,K),w.x+=2*ke.x,w.y+=2*ke.y,w.vertexCount+=2;const Fe=I.vertexLength;this.indexArray.emplaceBack(Fe,Fe+2,Fe+1),this.indexArray.emplaceBack(Fe+1,Fe+2,Fe+3),I.vertexLength+=4,I.primitiveLength+=2}}}}if(I.vertexLength+S>vi.MAX_VERTEX_ARRAY_LENGTH&&(I=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray)),Bh[t.type]!=="Polygon")continue;const z=[],D=[],F=I.vertexLength;for(const H of y)if(H.length!==0){H!==y[0]&&D.push(z.length/2);for(let K=0;K<H.length;K++){const ne=H[K];Qn(this.layoutVertexArray,ne.x,ne.y,0,0,1,1,0),w.x+=ne.x,w.y+=ne.y,w.vertexCount+=1,z.push(ne.x),z.push(ne.y)}}const U=ld(z,D);for(let H=0;H<U.length;H+=3)this.indexArray.emplaceBack(F+U[H],F+U[H+2],F+U[H+1]);I.primitiveLength+=U.length/3,I.vertexLength+=S;for(let H=0;H<w.vertexCount;H++){const K=Math.floor(w.x/w.vertexCount),ne=Math.floor(w.y/w.vertexCount);this.centroidVertexArray.emplaceBack(K,ne)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,_,h)}}function Vl(i,t){return i.x===t.x&&(i.x<0||i.x>Dn)||i.y===t.y&&(i.y<0||i.y>Dn)}function vd(i){return i.every(t=>t.x<0)||i.every(t=>t.x>Dn)||i.every(t=>t.y<0)||i.every(t=>t.y>Dn)}let Oh;gt("FillExtrusionBucket",Lo,{omit:["layers","features"]});var xa={get paint(){return Oh=Oh||new m({"fill-extrusion-opacity":new vt(Le["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Bt(Le["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new vt(Le["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new vt(Le["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Al(Le["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Bt(Le["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Bt(Le["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new vt(Le["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class xd extends o{constructor(t){super(t,xa)}createBucket(t){return new Lo(t)}queryRadius(){return ac(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(t,n,l,h,_,y,w,S){const I=lc(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),y.angle,w),z=this.paint.get("fill-extrusion-height").evaluate(n,l),D=this.paint.get("fill-extrusion-base").evaluate(n,l),F=function(H,K,ne,le){const ke=[];for(const pe of H){const Te=[pe.x,pe.y,0,1];Zc(Te,Te,K),ke.push(new xe(Te[0]/Te[3],Te[1]/Te[3]))}return ke}(I,S),U=function(H,K,ne,le){const ke=[],pe=[],Te=le[8]*K,Fe=le[9]*K,We=le[10]*K,yt=le[11]*K,Zt=le[8]*ne,_t=le[9]*ne,dt=le[10]*ne,Et=le[11]*ne;for(const St of H){const xt=[],je=[];for(const Dt of St){const Ct=Dt.x,ti=Dt.y,hn=le[0]*Ct+le[4]*ti+le[12],on=le[1]*Ct+le[5]*ti+le[13],Dr=le[2]*Ct+le[6]*ti+le[14],$a=le[3]*Ct+le[7]*ti+le[15],hs=Dr+We,Rr=$a+yt,so=hn+Zt,oo=on+_t,ao=Dr+dt,Un=$a+Et,Br=new xe((hn+Te)/Rr,(on+Fe)/Rr);Br.z=hs/Rr,xt.push(Br);const Fs=new xe(so/Un,oo/Un);Fs.z=ao/Un,je.push(Fs)}ke.push(xt),pe.push(je)}return[ke,pe]}(h,D,z,S);return function(H,K,ne){let le=1/0;Sh(ne,K)&&(le=wd(ne,K[0]));for(let ke=0;ke<K.length;ke++){const pe=K[ke],Te=H[ke];for(let Fe=0;Fe<pe.length-1;Fe++){const We=pe[Fe],yt=[We,pe[Fe+1],Te[Fe+1],Te[Fe],We];bh(ne,yt)&&(le=Math.min(le,wd(ne,yt)))}}return le!==1/0&&le}(U[0],U[1],F)}}function eo(i,t){return i.x*t.x+i.y*t.y}function wd(i,t){if(i.length===1){let n=0;const l=t[n++];let h;for(;!h||l.equals(h);)if(h=t[n++],!h)return 1/0;for(;n<t.length;n++){const _=t[n],y=i[0],w=h.sub(l),S=_.sub(l),I=y.sub(l),z=eo(w,w),D=eo(w,S),F=eo(S,S),U=eo(I,w),H=eo(I,S),K=z*F-D*D,ne=(F*U-D*H)/K,le=(z*H-D*U)/K,ke=l.z*(1-ne-le)+h.z*ne+_.z*le;if(isFinite(ke))return ke}return 1/0}{let n=1/0;for(const l of t)n=Math.min(n,l.z);return n}}const bd=b([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Sd}=bd,Td=b([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Pd}=Td,nf=Nl.VectorTileFeature.types,th=Math.cos(Math.PI/180*37.5),ih=Math.pow(2,14)/.5;class to{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new ko,this.layoutVertexArray2=new Na,this.indexArray=new Qs,this.programConfigurations=new va(t.layers,t.zoom),this.segments=new vi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,l){this.hasPattern=Jc("line",this.layers,n);const h=this.layers[0].layout.get("line-sort-key"),_=!h.isConstant(),y=[];for(const{feature:w,id:S,index:I,sourceLayerIndex:z}of t){const D=this.layers[0]._featureFilter.needGeometry,F=Ol(w,D);if(!this.layers[0]._featureFilter.filter(new Pi(this.zoom),F,l))continue;const U=_?h.evaluate(F,{},l):void 0,H={id:S,properties:w.properties,type:w.type,sourceLayerIndex:z,index:I,geometry:D?F.geometry:Bl(w),patterns:{},sortKey:U};y.push(H)}_&&y.sort((w,S)=>w.sortKey-S.sortKey);for(const w of y){const{geometry:S,index:I,sourceLayerIndex:z}=w;if(this.hasPattern){const D=fc("line",this.layers,w,this.zoom,n);this.patternFeatures.push(D)}else this.addFeature(w,S,I,l,{});n.featureIndex.insert(t[I].feature,S,I,z,this.index)}}update(t,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,l)}addFeatures(t,n,l){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,n,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Pd)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Sd),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,n,l,h,_){const y=this.layers[0].layout,w=y.get("line-join").evaluate(t,{}),S=y.get("line-cap"),I=y.get("line-miter-limit"),z=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const D of n)this.addLine(D,t,w,S,I,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,_,h)}addLine(t,n,l,h,_,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let le=0;le<t.length-1;le++)this.totalDistance+=t[le].dist(t[le+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const w=nf[n.type]==="Polygon";let S=t.length;for(;S>=2&&t[S-1].equals(t[S-2]);)S--;let I=0;for(;I<S-1&&t[I].equals(t[I+1]);)I++;if(S<(w?3:2))return;l==="bevel"&&(_=1.05);const z=this.overscaling<=16?15*Dn/(512*this.overscaling):0,D=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let F,U,H,K,ne;this.e1=this.e2=-1,w&&(F=t[S-2],ne=t[I].sub(F)._unit()._perp());for(let le=I;le<S;le++){if(H=le===S-1?w?t[I+1]:void 0:t[le+1],H&&t[le].equals(H))continue;ne&&(K=ne),F&&(U=F),F=t[le],ne=H?H.sub(F)._unit()._perp():K,K=K||ne;let ke=K.add(ne);ke.x===0&&ke.y===0||ke._unit();const pe=K.x*ne.x+K.y*ne.y,Te=ke.x*ne.x+ke.y*ne.y,Fe=Te!==0?1/Te:1/0,We=2*Math.sqrt(2-2*Te),yt=Te<th&&U&&H,Zt=K.x*ne.y-K.y*ne.x>0;if(yt&&le>I){const Et=F.dist(U);if(Et>2*z){const St=F.sub(F.sub(U)._mult(z/Et)._round());this.updateDistance(U,St),this.addCurrentVertex(St,K,0,0,D),U=St}}const _t=U&&H;let dt=_t?l:w?"butt":h;if(_t&&dt==="round"&&(Fe<y?dt="miter":Fe<=2&&(dt="fakeround")),dt==="miter"&&Fe>_&&(dt="bevel"),dt==="bevel"&&(Fe>2&&(dt="flipbevel"),Fe<_&&(dt="miter")),U&&this.updateDistance(U,F),dt==="miter")ke._mult(Fe),this.addCurrentVertex(F,ke,0,0,D);else if(dt==="flipbevel"){if(Fe>100)ke=ne.mult(-1);else{const Et=Fe*K.add(ne).mag()/K.sub(ne).mag();ke._perp()._mult(Et*(Zt?-1:1))}this.addCurrentVertex(F,ke,0,0,D),this.addCurrentVertex(F,ke.mult(-1),0,0,D)}else if(dt==="bevel"||dt==="fakeround"){const Et=-Math.sqrt(Fe*Fe-1),St=Zt?Et:0,xt=Zt?0:Et;if(U&&this.addCurrentVertex(F,K,St,xt,D),dt==="fakeround"){const je=Math.round(180*We/Math.PI/20);for(let Dt=1;Dt<je;Dt++){let Ct=Dt/je;if(Ct!==.5){const hn=Ct-.5;Ct+=Ct*hn*(Ct-1)*((1.0904+pe*(pe*(3.55645-1.43519*pe)-3.2452))*hn*hn+(.848013+pe*(.215638*pe-1.06021)))}const ti=ne.sub(K)._mult(Ct)._add(K)._unit()._mult(Zt?-1:1);this.addHalfVertex(F,ti.x,ti.y,!1,Zt,0,D)}}H&&this.addCurrentVertex(F,ne,-St,-xt,D)}else if(dt==="butt")this.addCurrentVertex(F,ke,0,0,D);else if(dt==="square"){const Et=U?1:-1;this.addCurrentVertex(F,ke,Et,Et,D)}else dt==="round"&&(U&&(this.addCurrentVertex(F,K,0,0,D),this.addCurrentVertex(F,K,1,1,D,!0)),H&&(this.addCurrentVertex(F,ne,-1,-1,D,!0),this.addCurrentVertex(F,ne,0,0,D)));if(yt&&le<S-1){const Et=F.dist(H);if(Et>2*z){const St=F.add(H.sub(F)._mult(z/Et)._round());this.updateDistance(F,St),this.addCurrentVertex(St,ne,0,0,D),F=St}}}}addCurrentVertex(t,n,l,h,_,y=!1){const w=n.y*h-n.x,S=-n.y-n.x*h;this.addHalfVertex(t,n.x+n.y*l,n.y-n.x*l,y,!1,l,_),this.addHalfVertex(t,w,S,y,!0,-h,_),this.distance>ih/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,n,l,h,_,y))}addHalfVertex({x:t,y:n},l,h,_,y,w,S){const I=.5*(this.lineClips?this.scaledDistance*(ih-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(_?1:0),(n<<1)+(y?1:0),Math.round(63*l)+128,Math.round(63*h)+128,1+(w===0?0:w<0?-1:1)|(63&I)<<2,I>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const z=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,z),S.primitiveLength++),y?this.e2=z:this.e1=z}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,n){this.distance+=t.dist(n),this.updateScaledDistance()}}let ji,vr;gt("LineBucket",to,{omit:["layers","patternFeatures"]});var er={get paint(){return vr=vr||new m({"line-opacity":new Bt(Le.paint_line["line-opacity"]),"line-color":new Bt(Le.paint_line["line-color"]),"line-translate":new vt(Le.paint_line["line-translate"]),"line-translate-anchor":new vt(Le.paint_line["line-translate-anchor"]),"line-width":new Bt(Le.paint_line["line-width"]),"line-gap-width":new Bt(Le.paint_line["line-gap-width"]),"line-offset":new Bt(Le.paint_line["line-offset"]),"line-blur":new Bt(Le.paint_line["line-blur"]),"line-dasharray":new mu(Le.paint_line["line-dasharray"]),"line-pattern":new Al(Le.paint_line["line-pattern"]),"line-gradient":new Qu(Le.paint_line["line-gradient"])})},get layout(){return ji=ji||new m({"line-cap":new vt(Le.layout_line["line-cap"]),"line-join":new Bt(Le.layout_line["line-join"]),"line-miter-limit":new vt(Le.layout_line["line-miter-limit"]),"line-round-limit":new vt(Le.layout_line["line-round-limit"]),"line-sort-key":new Bt(Le.layout_line["line-sort-key"])})}};class Wr extends Bt{possiblyEvaluate(t,n){return n=new Pi(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),super.possiblyEvaluate(t,n)}evaluate(t,n,l,h){return n=_i({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(t,n,l,h)}}let us;class Vu extends o{constructor(t){super(t,er),this.gradientVersion=0,us||(us=new Wr(er.paint.properties["line-width"].specification),us.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const n=this.gradientExpression();this.stepInterpolant=!!function(l){return l._styleExpression!==void 0}(n)&&n._styleExpression.expression instanceof po,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,n){super.recalculate(t,n),this.paint._values["line-floorwidth"]=us.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new to(t)}queryRadius(t){const n=t,l=lr(gu("line-width",this,n),gu("line-gap-width",this,n)),h=gu("line-offset",this,n);return l/2+Math.abs(h)+ac(this.paint.get("line-translate"))}queryIntersectsFeature(t,n,l,h,_,y,w){const S=lc(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),y.angle,w),I=w/2*lr(this.paint.get("line-width").evaluate(n,l),this.paint.get("line-gap-width").evaluate(n,l)),z=this.paint.get("line-offset").evaluate(n,l);return z&&(h=function(D,F){const U=[];for(let H=0;H<D.length;H++){const K=D[H],ne=[];for(let le=0;le<K.length;le++){const ke=K[le-1],pe=K[le],Te=K[le+1],Fe=le===0?new xe(0,0):pe.sub(ke)._unit()._perp(),We=le===K.length-1?new xe(0,0):Te.sub(pe)._unit()._perp(),yt=Fe._add(We)._unit(),Zt=yt.x*We.x+yt.y*We.y;Zt!==0&&yt._mult(1/Zt),ne.push(yt._mult(F)._add(pe))}U.push(ne)}return U}(h,z*w)),function(D,F,U){for(let H=0;H<F.length;H++){const K=F[H];if(D.length>=3){for(let ne=0;ne<K.length;ne++)if(_u(D,K[ne]))return!0}if(jc(D,K,U))return!0}return!1}(S,h,I)}isTileClipped(){return!0}}function lr(i,t){return t>0?t+2*i:i}const gc=b([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),wu=b([{name:"a_projected_pos",components:3,type:"Float32"}],4);b([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const nh=b([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);b([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const rh=b([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),yc=b([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function io(i,t,n){return i.sections.forEach(l=>{l.text=function(h,_,y){const w=_.layout.get("text-transform").evaluate(y,{});return w==="uppercase"?h=h.toLocaleUpperCase():w==="lowercase"&&(h=h.toLocaleLowerCase()),Yi.applyArabicShaping&&(h=Yi.applyArabicShaping(h)),h}(l.text,t,n)}),i}b([{name:"triangle",components:3,type:"Uint16"}]),b([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),b([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),b([{type:"Float32",name:"offsetX"}]),b([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),b([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const bu={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var vn=24,Ua=Li,vc=function(i,t,n,l,h){var _,y,w=8*h-l-1,S=(1<<w)-1,I=S>>1,z=-7,D=h-1,F=-1,U=i[t+D];for(D+=F,_=U&(1<<-z)-1,U>>=-z,z+=w;z>0;_=256*_+i[t+D],D+=F,z-=8);for(y=_&(1<<-z)-1,_>>=-z,z+=l;z>0;y=256*y+i[t+D],D+=F,z-=8);if(_===0)_=1-I;else{if(_===S)return y?NaN:1/0*(U?-1:1);y+=Math.pow(2,l),_-=I}return(U?-1:1)*y*Math.pow(2,_-l)},sh=function(i,t,n,l,h,_){var y,w,S,I=8*_-h-1,z=(1<<I)-1,D=z>>1,F=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,U=0,H=1,K=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(w=isNaN(t)?1:0,y=z):(y=Math.floor(Math.log(t)/Math.LN2),t*(S=Math.pow(2,-y))<1&&(y--,S*=2),(t+=y+D>=1?F/S:F*Math.pow(2,1-D))*S>=2&&(y++,S/=2),y+D>=z?(w=0,y=z):y+D>=1?(w=(t*S-1)*Math.pow(2,h),y+=D):(w=t*Math.pow(2,D-1)*Math.pow(2,h),y=0));h>=8;i[n+U]=255&w,U+=H,w/=256,h-=8);for(y=y<<h|w,I+=h;I>0;i[n+U]=255&y,U+=H,y/=256,I-=8);i[n+U-H]|=128*K};function Li(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}Li.Varint=0,Li.Fixed64=1,Li.Bytes=2,Li.Fixed32=5;var Uu=4294967296,cl=1/Uu,xc=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function Do(i){return i.type===Li.Bytes?i.readVarint()+i.pos:i.pos+1}function Ul(i,t,n){return n?4294967296*t+(i>>>0):4294967296*(t>>>0)+(i>>>0)}function wc(i,t,n){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));n.realloc(l);for(var h=n.pos-1;h>=i;h--)n.buf[h+l]=n.buf[h]}function oh(i,t){for(var n=0;n<i.length;n++)t.writeVarint(i[n])}function Bs(i,t){for(var n=0;n<i.length;n++)t.writeSVarint(i[n])}function Zl(i,t){for(var n=0;n<i.length;n++)t.writeFloat(i[n])}function wa(i,t){for(var n=0;n<i.length;n++)t.writeDouble(i[n])}function no(i,t){for(var n=0;n<i.length;n++)t.writeBoolean(i[n])}function kd(i,t){for(var n=0;n<i.length;n++)t.writeFixed32(i[n])}function Fh(i,t){for(var n=0;n<i.length;n++)t.writeSFixed32(i[n])}function Nh(i,t){for(var n=0;n<i.length;n++)t.writeFixed64(i[n])}function rf(i,t){for(var n=0;n<i.length;n++)t.writeSFixed64(i[n])}function ba(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16)+16777216*i[t+3]}function Su(i,t,n){i[n]=t,i[n+1]=t>>>8,i[n+2]=t>>>16,i[n+3]=t>>>24}function ah(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16)+(i[t+3]<<24)}Li.prototype={destroy:function(){this.buf=null},readFields:function(i,t,n){for(n=n||this.length;this.pos<n;){var l=this.readVarint(),h=l>>3,_=this.pos;this.type=7&l,i(h,t,this),this.pos===_&&this.skip(l)}return t},readMessage:function(i,t){return this.readFields(i,t,this.readVarint()+this.pos)},readFixed32:function(){var i=ba(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=ah(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=ba(this.buf,this.pos)+ba(this.buf,this.pos+4)*Uu;return this.pos+=8,i},readSFixed64:function(){var i=ba(this.buf,this.pos)+ah(this.buf,this.pos+4)*Uu;return this.pos+=8,i},readFloat:function(){var i=vc(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=vc(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var t,n,l=this.buf;return t=127&(n=l[this.pos++]),n<128?t:(t|=(127&(n=l[this.pos++]))<<7,n<128?t:(t|=(127&(n=l[this.pos++]))<<14,n<128?t:(t|=(127&(n=l[this.pos++]))<<21,n<128?t:function(h,_,y){var w,S,I=y.buf;if(w=(112&(S=I[y.pos++]))>>4,S<128||(w|=(127&(S=I[y.pos++]))<<3,S<128)||(w|=(127&(S=I[y.pos++]))<<10,S<128)||(w|=(127&(S=I[y.pos++]))<<17,S<128)||(w|=(127&(S=I[y.pos++]))<<24,S<128)||(w|=(1&(S=I[y.pos++]))<<31,S<128))return Ul(h,w,_);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(n=l[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,t=this.pos;return this.pos=i,i-t>=12&&xc?function(n,l,h){return xc.decode(n.subarray(l,h))}(this.buf,t,i):function(n,l,h){for(var _="",y=l;y<h;){var w,S,I,z=n[y],D=null,F=z>239?4:z>223?3:z>191?2:1;if(y+F>h)break;F===1?z<128&&(D=z):F===2?(192&(w=n[y+1]))==128&&(D=(31&z)<<6|63&w)<=127&&(D=null):F===3?(S=n[y+2],(192&(w=n[y+1]))==128&&(192&S)==128&&((D=(15&z)<<12|(63&w)<<6|63&S)<=2047||D>=55296&&D<=57343)&&(D=null)):F===4&&(S=n[y+2],I=n[y+3],(192&(w=n[y+1]))==128&&(192&S)==128&&(192&I)==128&&((D=(15&z)<<18|(63&w)<<12|(63&S)<<6|63&I)<=65535||D>=1114112)&&(D=null)),D===null?(D=65533,F=1):D>65535&&(D-=65536,_+=String.fromCharCode(D>>>10&1023|55296),D=56320|1023&D),_+=String.fromCharCode(D),y+=F}return _}(this.buf,t,i)},readBytes:function(){var i=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,i);return this.pos=i,t},readPackedVarint:function(i,t){if(this.type!==Li.Bytes)return i.push(this.readVarint(t));var n=Do(this);for(i=i||[];this.pos<n;)i.push(this.readVarint(t));return i},readPackedSVarint:function(i){if(this.type!==Li.Bytes)return i.push(this.readSVarint());var t=Do(this);for(i=i||[];this.pos<t;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==Li.Bytes)return i.push(this.readBoolean());var t=Do(this);for(i=i||[];this.pos<t;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==Li.Bytes)return i.push(this.readFloat());var t=Do(this);for(i=i||[];this.pos<t;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==Li.Bytes)return i.push(this.readDouble());var t=Do(this);for(i=i||[];this.pos<t;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==Li.Bytes)return i.push(this.readFixed32());var t=Do(this);for(i=i||[];this.pos<t;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==Li.Bytes)return i.push(this.readSFixed32());var t=Do(this);for(i=i||[];this.pos<t;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==Li.Bytes)return i.push(this.readFixed64());var t=Do(this);for(i=i||[];this.pos<t;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==Li.Bytes)return i.push(this.readSFixed64());var t=Do(this);for(i=i||[];this.pos<t;)i.push(this.readSFixed64());return i},skip:function(i){var t=7&i;if(t===Li.Varint)for(;this.buf[this.pos++]>127;);else if(t===Li.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Li.Fixed32)this.pos+=4;else{if(t!==Li.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(i,t){this.writeVarint(i<<3|t)},realloc:function(i){for(var t=this.length||16;t<this.pos+i;)t*=2;if(t!==this.length){var n=new Uint8Array(t);n.set(this.buf),this.buf=n,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),Su(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),Su(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),Su(this.buf,-1&i,this.pos),Su(this.buf,Math.floor(i*cl),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),Su(this.buf,-1&i,this.pos),Su(this.buf,Math.floor(i*cl),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(t,n){var l,h;if(t>=0?(l=t%4294967296|0,h=t/4294967296|0):(h=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,h=h+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");n.realloc(10),function(_,y,w){w.buf[w.pos++]=127&_|128,_>>>=7,w.buf[w.pos++]=127&_|128,_>>>=7,w.buf[w.pos++]=127&_|128,_>>>=7,w.buf[w.pos++]=127&_|128,w.buf[w.pos]=127&(_>>>=7)}(l,0,n),function(_,y){var w=(7&_)<<4;y.buf[y.pos++]|=w|((_>>>=3)?128:0),_&&(y.buf[y.pos++]=127&_|((_>>>=7)?128:0),_&&(y.buf[y.pos++]=127&_|((_>>>=7)?128:0),_&&(y.buf[y.pos++]=127&_|((_>>>=7)?128:0),_&&(y.buf[y.pos++]=127&_|((_>>>=7)?128:0),_&&(y.buf[y.pos++]=127&_)))))}(h,n)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var t=this.pos;this.pos=function(l,h,_){for(var y,w,S=0;S<h.length;S++){if((y=h.charCodeAt(S))>55295&&y<57344){if(!w){y>56319||S+1===h.length?(l[_++]=239,l[_++]=191,l[_++]=189):w=y;continue}if(y<56320){l[_++]=239,l[_++]=191,l[_++]=189,w=y;continue}y=w-55296<<10|y-56320|65536,w=null}else w&&(l[_++]=239,l[_++]=191,l[_++]=189,w=null);y<128?l[_++]=y:(y<2048?l[_++]=y>>6|192:(y<65536?l[_++]=y>>12|224:(l[_++]=y>>18|240,l[_++]=y>>12&63|128),l[_++]=y>>6&63|128),l[_++]=63&y|128)}return _}(this.buf,i,this.pos);var n=this.pos-t;n>=128&&wc(t,n,this),this.pos=t-1,this.writeVarint(n),this.pos+=n},writeFloat:function(i){this.realloc(4),sh(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),sh(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var t=i.length;this.writeVarint(t),this.realloc(t);for(var n=0;n<t;n++)this.buf[this.pos++]=i[n]},writeRawMessage:function(i,t){this.pos++;var n=this.pos;i(t,this);var l=this.pos-n;l>=128&&wc(n,l,this),this.pos=n-1,this.writeVarint(l),this.pos+=l},writeMessage:function(i,t,n){this.writeTag(i,Li.Bytes),this.writeRawMessage(t,n)},writePackedVarint:function(i,t){t.length&&this.writeMessage(i,oh,t)},writePackedSVarint:function(i,t){t.length&&this.writeMessage(i,Bs,t)},writePackedBoolean:function(i,t){t.length&&this.writeMessage(i,no,t)},writePackedFloat:function(i,t){t.length&&this.writeMessage(i,Zl,t)},writePackedDouble:function(i,t){t.length&&this.writeMessage(i,wa,t)},writePackedFixed32:function(i,t){t.length&&this.writeMessage(i,kd,t)},writePackedSFixed32:function(i,t){t.length&&this.writeMessage(i,Fh,t)},writePackedFixed64:function(i,t){t.length&&this.writeMessage(i,Nh,t)},writePackedSFixed64:function(i,t){t.length&&this.writeMessage(i,rf,t)},writeBytesField:function(i,t){this.writeTag(i,Li.Bytes),this.writeBytes(t)},writeFixed32Field:function(i,t){this.writeTag(i,Li.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(i,t){this.writeTag(i,Li.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(i,t){this.writeTag(i,Li.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(i,t){this.writeTag(i,Li.Fixed64),this.writeSFixed64(t)},writeVarintField:function(i,t){this.writeTag(i,Li.Varint),this.writeVarint(t)},writeSVarintField:function(i,t){this.writeTag(i,Li.Varint),this.writeSVarint(t)},writeStringField:function(i,t){this.writeTag(i,Li.Bytes),this.writeString(t)},writeFloatField:function(i,t){this.writeTag(i,Li.Fixed32),this.writeFloat(t)},writeDoubleField:function(i,t){this.writeTag(i,Li.Fixed64),this.writeDouble(t)},writeBooleanField:function(i,t){this.writeVarintField(i,!!t)}};var hl=ze(Ua);const bc=3;function Tu(i,t,n){i===1&&n.readMessage(Cd,t)}function Cd(i,t,n){if(i===3){const{id:l,bitmap:h,width:_,height:y,left:w,top:S,advance:I}=n.readMessage(Id,{});t.push({id:l,bitmap:new yu({width:_+2*bc,height:y+2*bc},h),metrics:{width:_,height:y,left:w,top:S,advance:I}})}}function Id(i,t,n){i===1?t.id=n.readVarint():i===2?t.bitmap=n.readBytes():i===3?t.width=n.readVarint():i===4?t.height=n.readVarint():i===5?t.left=n.readSVarint():i===6?t.top=n.readSVarint():i===7&&(t.advance=n.readVarint())}const lh=bc;function Sc(i){let t=0,n=0;for(const y of i)t+=y.w*y.h,n=Math.max(n,y.w);i.sort((y,w)=>w.h-y.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),n),h:1/0}];let h=0,_=0;for(const y of i)for(let w=l.length-1;w>=0;w--){const S=l[w];if(!(y.w>S.w||y.h>S.h)){if(y.x=S.x,y.y=S.y,_=Math.max(_,y.y+y.h),h=Math.max(h,y.x+y.w),y.w===S.w&&y.h===S.h){const I=l.pop();w<l.length&&(l[w]=I)}else y.h===S.h?(S.x+=y.w,S.w-=y.w):y.w===S.w?(S.y+=y.h,S.h-=y.h):(l.push({x:S.x+y.w,y:S.y,w:S.w-y.w,h:y.h}),S.y+=y.h,S.h-=y.h);break}}return{w:h,h:_,fill:t/(h*_)||0}}const Os=1;class jh{constructor(t,{pixelRatio:n,version:l,stretchX:h,stretchY:_,content:y,textFitWidth:w,textFitHeight:S}){this.paddedRect=t,this.pixelRatio=n,this.stretchX=h,this.stretchY=_,this.content=y,this.version=l,this.textFitWidth=w,this.textFitHeight=S}get tl(){return[this.paddedRect.x+Os,this.paddedRect.y+Os]}get br(){return[this.paddedRect.x+this.paddedRect.w-Os,this.paddedRect.y+this.paddedRect.h-Os]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Os)/this.pixelRatio,(this.paddedRect.h-2*Os)/this.pixelRatio]}}class Vh{constructor(t,n){const l={},h={};this.haveRenderCallbacks=[];const _=[];this.addImages(t,l,_),this.addImages(n,h,_);const{w:y,h:w}=Sc(_),S=new Lr({width:y||1,height:w||1});for(const I in t){const z=t[I],D=l[I].paddedRect;Lr.copy(z.data,S,{x:0,y:0},{x:D.x+Os,y:D.y+Os},z.data)}for(const I in n){const z=n[I],D=h[I].paddedRect,F=D.x+Os,U=D.y+Os,H=z.data.width,K=z.data.height;Lr.copy(z.data,S,{x:0,y:0},{x:F,y:U},z.data),Lr.copy(z.data,S,{x:0,y:K-1},{x:F,y:U-1},{width:H,height:1}),Lr.copy(z.data,S,{x:0,y:0},{x:F,y:U+K},{width:H,height:1}),Lr.copy(z.data,S,{x:H-1,y:0},{x:F-1,y:U},{width:1,height:K}),Lr.copy(z.data,S,{x:0,y:0},{x:F+H,y:U},{width:1,height:K})}this.image=S,this.iconPositions=l,this.patternPositions=h}addImages(t,n,l){for(const h in t){const _=t[h],y={x:0,y:0,w:_.data.width+2*Os,h:_.data.height+2*Os};l.push(y),n[h]=new jh(y,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(t,n){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in t.updatedImages)this.patchUpdatedImage(this.iconPositions[l],t.getImage(l),n),this.patchUpdatedImage(this.patternPositions[l],t.getImage(l),n)}patchUpdatedImage(t,n,l){if(!t||!n||t.version===n.version)return;t.version=n.version;const[h,_]=t.tl;l.update(n.data,void 0,{x:h,y:_})}}var dl;gt("ImagePosition",jh),gt("ImageAtlas",Vh),O.ah=void 0,(dl=O.ah||(O.ah={}))[dl.none=0]="none",dl[dl.horizontal=1]="horizontal",dl[dl.vertical=2]="vertical",dl[dl.horizontalOnly=3]="horizontalOnly";const Sa=-17;class Tc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,n){const l=new Tc;return l.scale=t||1,l.fontStack=n,l}static forImage(t){const n=new Tc;return n.imageName=t,n}}class Ta{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,n){const l=new Ta;for(let h=0;h<t.sections.length;h++){const _=t.sections[h];_.image?l.addImageSection(_):l.addTextSection(_,n)}return l}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let n="";for(let l=0;l<t.length;l++){const h=t.charCodeAt(l+1)||null,_=t.charCodeAt(l-1)||null;n+=h&&ul(h)&&!bu[t[l+1]]||_&&ul(_)&&!bu[t[l-1]]||!bu[t[l]]?t[l]:bu[t[l]]}return n}(this.text)}trim(){let t=0;for(let l=0;l<this.text.length&&Sn[this.text.charCodeAt(l)];l++)t++;let n=this.text.length;for(let l=this.text.length-1;l>=0&&l>=t&&Sn[this.text.charCodeAt(l)];l--)n--;this.text=this.text.substring(t,n),this.sectionIndex=this.sectionIndex.slice(t,n)}substring(t,n){const l=new Ta;return l.text=this.text.substring(t,n),l.sectionIndex=this.sectionIndex.slice(t,n),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,n)=>Math.max(t,this.sections[n].scale),0)}addTextSection(t,n){this.text+=t.text,this.sections.push(Tc.forText(t.scale,t.fontStack||n));const l=this.sections.length-1;for(let h=0;h<t.text.length;++h)this.sectionIndex.push(l)}addImageSection(t){const n=t.image?t.image.name:"";if(n.length===0)return void Di("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(Tc.forImage(n)),this.sectionIndex.push(this.sections.length-1)):Di("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Pc(i,t,n,l,h,_,y,w,S,I,z,D,F,U,H){const K=Ta.fromFeature(i,h);let ne;D===O.ah.vertical&&K.verticalizePunctuation();const{processBidirectionalText:le,processStyledBidirectionalText:ke}=Yi;if(le&&K.sections.length===1){ne=[];const Fe=le(K.toString(),ro(K,I,_,t,l,U));for(const We of Fe){const yt=new Ta;yt.text=We,yt.sections=K.sections;for(let Zt=0;Zt<We.length;Zt++)yt.sectionIndex.push(0);ne.push(yt)}}else if(ke){ne=[];const Fe=ke(K.text,K.sectionIndex,ro(K,I,_,t,l,U));for(const We of Fe){const yt=new Ta;yt.text=We[0],yt.sectionIndex=We[1],yt.sections=K.sections,ne.push(yt)}}else ne=function(Fe,We){const yt=[],Zt=Fe.text;let _t=0;for(const dt of We)yt.push(Fe.substring(_t,dt)),_t=dt;return _t<Zt.length&&yt.push(Fe.substring(_t,Zt.length)),yt}(K,ro(K,I,_,t,l,U));const pe=[],Te={positionedLines:pe,text:K.toString(),top:z[1],bottom:z[1],left:z[0],right:z[0],writingMode:D,iconsInText:!1,verticalizable:!1};return function(Fe,We,yt,Zt,_t,dt,Et,St,xt,je,Dt,Ct){let ti=0,hn=Sa,on=0,Dr=0;const $a=St==="right"?1:St==="left"?0:.5;let hs=0;for(const Un of _t){Un.trim();const Br=Un.getMaxScale(),Fs=(Br-1)*vn,ds={positionedGlyphs:[],lineOffset:0};Fe.positionedLines[hs]=ds;const lo=ds.positionedGlyphs;let fs=0;if(!Un.length()){hn+=dt,++hs;continue}for(let Ro=0;Ro<Un.length();Ro++){const Vi=Un.getSection(Ro),pn=Un.getSectionIndex(Ro),xn=Un.getCharCode(Ro);let ia=0,Rn=null,gh=null,Gl=null,Wl=vn;const qa=!(xt===O.ah.horizontal||!Dt&&!fu(xn)||Dt&&(Sn[xn]||(Rr=xn,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(Rr)))));if(Vi.imageName){const ka=Zt[Vi.imageName];if(!ka)continue;Gl=Vi.imageName,Fe.iconsInText=Fe.iconsInText||!0,gh=ka.paddedRect;const Xr=ka.displaySize;Vi.scale=Vi.scale*vn/Ct,Rn={width:Xr[0],height:Xr[1],left:Os,top:-lh,advance:qa?Xr[1]:Xr[0]},ia=Fs+(vn-Xr[1]*Vi.scale),Wl=Rn.advance;const ku=qa?Xr[0]*Vi.scale-vn*Br:Xr[1]*Vi.scale-vn*Br;ku>0&&ku>fs&&(fs=ku)}else{const ka=yt[Vi.fontStack],Xr=ka&&ka[xn];if(Xr&&Xr.rect)gh=Xr.rect,Rn=Xr.metrics;else{const ku=We[Vi.fontStack],Gh=ku&&ku[xn];if(!Gh)continue;Rn=Gh.metrics}ia=(Br-Vi.scale)*vn}qa?(Fe.verticalizable=!0,lo.push({glyph:xn,imageName:Gl,x:ti,y:hn+ia,vertical:qa,scale:Vi.scale,fontStack:Vi.fontStack,sectionIndex:pn,metrics:Rn,rect:gh}),ti+=Wl*Vi.scale+je):(lo.push({glyph:xn,imageName:Gl,x:ti,y:hn+ia,vertical:qa,scale:Vi.scale,fontStack:Vi.fontStack,sectionIndex:pn,metrics:Rn,rect:gh}),ti+=Rn.advance*Vi.scale+je)}lo.length!==0&&(on=Math.max(ti-je,on),of(lo,0,lo.length-1,$a,fs)),ti=0;const Pa=dt*Br+fs;ds.lineOffset=Math.max(fs,Fs),hn+=Pa,Dr=Math.max(Pa,Dr),++hs}var Rr;const so=hn-Sa,{horizontalAlign:oo,verticalAlign:ao}=kc(Et);(function(Un,Br,Fs,ds,lo,fs,Pa,Ro,Vi){const pn=(Br-Fs)*lo;let xn=0;xn=fs!==Pa?-Ro*ds-Sa:(-ds*Vi+.5)*Pa;for(const ia of Un)for(const Rn of ia.positionedGlyphs)Rn.x+=pn,Rn.y+=xn})(Fe.positionedLines,$a,oo,ao,on,Dr,dt,so,_t.length),Fe.top+=-ao*so,Fe.bottom=Fe.top+so,Fe.left+=-oo*on,Fe.right=Fe.left+on}(Te,t,n,l,ne,y,w,S,D,I,F,H),!function(Fe){for(const We of Fe)if(We.positionedGlyphs.length!==0)return!1;return!0}(pe)&&Te}const Sn={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},sf={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Ed={40:!0};function Md(i,t,n,l,h,_){if(t.imageName){const y=l[t.imageName];return y?y.displaySize[0]*t.scale*vn/_+h:0}{const y=n[t.fontStack],w=y&&y[i];return w?w.metrics.advance*t.scale+h:0}}function zd(i,t,n,l){const h=Math.pow(i-t,2);return l?i<t?h/2:2*h:h+Math.abs(n)*n}function Ad(i,t,n){let l=0;return i===10&&(l-=1e4),n&&(l+=150),i!==40&&i!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function Uh(i,t,n,l,h,_){let y=null,w=zd(t,n,h,_);for(const S of l){const I=zd(t-S.x,n,h,_)+S.badness;I<=w&&(y=S,w=I)}return{index:i,x:t,priorBreak:y,badness:w}}function Ld(i){return i?Ld(i.priorBreak).concat(i.index):[]}function ro(i,t,n,l,h,_){if(!i)return[];const y=[],w=function(D,F,U,H,K,ne){let le=0;for(let ke=0;ke<D.length();ke++){const pe=D.getSection(ke);le+=Md(D.getCharCode(ke),pe,H,K,F,ne)}return le/Math.max(1,Math.ceil(le/U))}(i,t,n,l,h,_),S=i.text.indexOf("​")>=0;let I=0;for(let D=0;D<i.length();D++){const F=i.getSection(D),U=i.getCharCode(D);if(Sn[U]||(I+=Md(U,F,l,h,t,_)),D<i.length()-1){const H=!((z=U)<11904)&&(!!di["CJK Compatibility Forms"](z)||!!di["CJK Compatibility"](z)||!!di["CJK Strokes"](z)||!!di["CJK Symbols and Punctuation"](z)||!!di["Enclosed CJK Letters and Months"](z)||!!di["Halfwidth and Fullwidth Forms"](z)||!!di["Ideographic Description Characters"](z)||!!di["Vertical Forms"](z)||ll.test(String.fromCodePoint(z)));(sf[U]||H||F.imageName||D!==i.length()-2&&Ed[i.getCharCode(D+1)])&&y.push(Uh(D+1,I,w,y,Ad(U,i.getCharCode(D+1),H&&S),!1))}}var z;return Ld(Uh(i.length(),I,w,y,0,!0))}function kc(i){let t=.5,n=.5;switch(i){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:t,verticalAlign:n}}function of(i,t,n,l,h){if(!l&&!h)return;const _=i[n],y=(i[n].x+_.metrics.advance*_.scale)*l;for(let w=t;w<=n;w++)i[w].x-=y,i[w].y+=h}function $l(i,t,n){const{horizontalAlign:l,verticalAlign:h}=kc(n),_=t[0]-i.displaySize[0]*l,y=t[1]-i.displaySize[1]*h;return{image:i,top:y,bottom:y+i.displaySize[1],left:_,right:_+i.displaySize[0]}}function Cc(i){var t,n;let l=i.left,h=i.top,_=i.right-l,y=i.bottom-h;const w=(t=i.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",S=(n=i.image.textFitHeight)!==null&&n!==void 0?n:"stretchOrShrink",I=(i.image.content[2]-i.image.content[0])/(i.image.content[3]-i.image.content[1]);if(S==="proportional"){if(w==="stretchOnly"&&_/y<I||w==="proportional"){const z=Math.ceil(y*I);l*=z/_,_=z}}else if(w==="proportional"&&S==="stretchOnly"&&I!==0&&_/y>I){const z=Math.ceil(_/I);h*=z/y,y=z}return{x1:l,y1:h,x2:l+_,y2:h+y}}function ql(i,t,n,l,h,_){const y=i.image;let w;if(y.content){const ne=y.content,le=y.pixelRatio||1;w=[ne[0]/le,ne[1]/le,y.displaySize[0]-ne[2]/le,y.displaySize[1]-ne[3]/le]}const S=t.left*_,I=t.right*_;let z,D,F,U;n==="width"||n==="both"?(U=h[0]+S-l[3],D=h[0]+I+l[1]):(U=h[0]+(S+I-y.displaySize[0])/2,D=U+y.displaySize[0]);const H=t.top*_,K=t.bottom*_;return n==="height"||n==="both"?(z=h[1]+H-l[0],F=h[1]+K+l[2]):(z=h[1]+(H+K-y.displaySize[1])/2,F=z+y.displaySize[1]),{image:y,top:z,right:D,bottom:F,left:U,collisionPadding:w}}const Hl=255,ta=128,Za=Hl*ta;function Dd(i,t){const{expression:n}=t;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new Pi(i+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:h}=n;let _=0;for(;_<l.length&&l[_]<=i;)_++;_=Math.max(0,_-1);let y=_;for(;y<l.length&&l[y]<i+1;)y++;y=Math.min(l.length-1,y);const w=l[_],S=l[y];return n.kind==="composite"?{kind:"composite",minZoom:w,maxZoom:S,interpolationType:h}:{kind:"camera",minZoom:w,maxZoom:S,minSize:n.evaluate(new Pi(w)),maxSize:n.evaluate(new Pi(S)),interpolationType:h}}}function Ic(i,t,n){let l="never";const h=i.get(t);return h?l=h:i.get(n)&&(l="always"),l}const af=Nl.VectorTileFeature.types,Rd=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ec(i,t,n,l,h,_,y,w,S,I,z,D,F){const U=w?Math.min(Za,Math.round(w[0])):0,H=w?Math.min(Za,Math.round(w[1])):0;i.emplaceBack(t,n,Math.round(32*l),Math.round(32*h),_,y,(U<<1)+(S?1:0),H,16*I,16*z,256*D,256*F)}function Zu(i,t,n){i.emplaceBack(t.x,t.y,n),i.emplaceBack(t.x,t.y,n),i.emplaceBack(t.x,t.y,n),i.emplaceBack(t.x,t.y,n)}function uh(i){for(const t of i.sections)if(Fa(t.text))return!0;return!1}class ch{constructor(t){this.layoutVertexArray=new Ys,this.indexArray=new Qs,this.programConfigurations=t,this.segments=new vi,this.dynamicLayoutVertexArray=new Yo,this.opacityVertexArray=new Hr,this.hasVisibleVertices=!1,this.placedSymbolArray=new Wi}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,n,l,h){this.isEmpty()||(l&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,gc.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,wu.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Rd,!0),this.opacityVertexBuffer.itemSize=1),(l||h)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}gt("SymbolBuffers",ch);class Mc{constructor(t,n,l){this.layoutVertexArray=new t,this.layoutAttributes=n,this.indexArray=new l,this.segments=new vi,this.collisionVertexArray=new Co}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,nh.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}gt("CollisionBuffers",Mc);class $u{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(y=>y.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Vc([]),this.placementViewportMatrix=Vc([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Dd(this.zoom,n["text-size"]),this.iconSizeData=Dd(this.zoom,n["icon-size"]);const l=this.layers[0].layout,h=l.get("symbol-sort-key"),_=l.get("symbol-z-order");this.canOverlap=Ic(l,"text-overlap","text-allow-overlap")!=="never"||Ic(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&!h.isConstant(),this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(y=>O.ah[y])),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=t.sourceID}createArrays(){this.text=new ch(new va(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new ch(new va(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new Qi,this.lineVertexArray=new or,this.symbolInstances=new mi,this.textAnchorOffsets=new en}calculateGlyphDependencies(t,n,l,h,_){for(let y=0;y<t.length;y++)if(n[t.charCodeAt(y)]=!0,(l||h)&&_){const w=bu[t.charAt(y)];w&&(n[w.charCodeAt(0)]=!0)}}populate(t,n,l){const h=this.layers[0],_=h.layout,y=_.get("text-font"),w=_.get("text-field"),S=_.get("icon-image"),I=(w.value.kind!=="constant"||w.value.value instanceof Sr&&!w.value.value.isEmpty()||w.value.value.toString().length>0)&&(y.value.kind!=="constant"||y.value.value.length>0),z=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,D=_.get("symbol-sort-key");if(this.features=[],!I&&!z)return;const F=n.iconDependencies,U=n.glyphDependencies,H=n.availableImages,K=new Pi(this.zoom);for(const{feature:ne,id:le,index:ke,sourceLayerIndex:pe}of t){const Te=h._featureFilter.needGeometry,Fe=Ol(ne,Te);if(!h._featureFilter.filter(K,Fe,l))continue;let We,yt;if(Te||(Fe.geometry=Bl(ne)),I){const _t=h.getValueAndResolveTokens("text-field",Fe,l,H),dt=Sr.factory(_t),Et=this.hasRTLText=this.hasRTLText||uh(dt);(!Et||Yi.getRTLTextPluginStatus()==="unavailable"||Et&&Yi.isParsed())&&(We=io(dt,h,Fe))}if(z){const _t=h.getValueAndResolveTokens("icon-image",Fe,l,H);yt=_t instanceof Hn?_t:Hn.fromString(_t)}if(!We&&!yt)continue;const Zt=this.sortFeaturesByKey?D.evaluate(Fe,{},l):void 0;if(this.features.push({id:le,text:We,icon:yt,index:ke,sourceLayerIndex:pe,geometry:Fe.geometry,properties:ne.properties,type:af[ne.type],sortKey:Zt}),yt&&(F[yt.name]=!0),We){const _t=y.evaluate(Fe,{},l).join(","),dt=_.get("text-rotation-alignment")!=="viewport"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(O.ah.vertical)>=0;for(const Et of We.sections)if(Et.image)F[Et.image.name]=!0;else{const St=du(We.toString()),xt=Et.fontStack||_t,je=U[xt]=U[xt]||{};this.calculateGlyphDependencies(Et.text,je,dt,this.allowVerticalPlacement,St)}}}_.get("symbol-placement")==="line"&&(this.features=function(ne){const le={},ke={},pe=[];let Te=0;function Fe(_t){pe.push(ne[_t]),Te++}function We(_t,dt,Et){const St=ke[_t];return delete ke[_t],ke[dt]=St,pe[St].geometry[0].pop(),pe[St].geometry[0]=pe[St].geometry[0].concat(Et[0]),St}function yt(_t,dt,Et){const St=le[dt];return delete le[dt],le[_t]=St,pe[St].geometry[0].shift(),pe[St].geometry[0]=Et[0].concat(pe[St].geometry[0]),St}function Zt(_t,dt,Et){const St=Et?dt[0][dt[0].length-1]:dt[0][0];return`${_t}:${St.x}:${St.y}`}for(let _t=0;_t<ne.length;_t++){const dt=ne[_t],Et=dt.geometry,St=dt.text?dt.text.toString():null;if(!St){Fe(_t);continue}const xt=Zt(St,Et),je=Zt(St,Et,!0);if(xt in ke&&je in le&&ke[xt]!==le[je]){const Dt=yt(xt,je,Et),Ct=We(xt,je,pe[Dt].geometry);delete le[xt],delete ke[je],ke[Zt(St,pe[Ct].geometry,!0)]=Ct,pe[Dt].geometry=null}else xt in ke?We(xt,je,Et):je in le?yt(xt,je,Et):(Fe(_t),le[xt]=Te-1,ke[je]=Te-1)}return pe.filter(_t=>_t.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ne,le)=>ne.sortKey-le.sortKey)}update(t,n,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,n,this.layers,l),this.icon.programConfigurations.updatePaintArrays(t,n,this.layers,l))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,n){const l=this.lineVertexArray.length;if(t.segment!==void 0){let h=t.dist(n[t.segment+1]),_=t.dist(n[t.segment]);const y={};for(let w=t.segment+1;w<n.length;w++)y[w]={x:n[w].x,y:n[w].y,tileUnitDistanceFromAnchor:h},w<n.length-1&&(h+=n[w+1].dist(n[w]));for(let w=t.segment||0;w>=0;w--)y[w]={x:n[w].x,y:n[w].y,tileUnitDistanceFromAnchor:_},w>0&&(_+=n[w-1].dist(n[w]));for(let w=0;w<n.length;w++){const S=y[w];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(t,n,l,h,_,y,w,S,I,z,D,F){const U=t.indexArray,H=t.layoutVertexArray,K=t.segments.prepareSegment(4*n.length,H,U,this.canOverlap?y.sortKey:void 0),ne=this.glyphOffsetArray.length,le=K.vertexLength,ke=this.allowVerticalPlacement&&w===O.ah.vertical?Math.PI/2:0,pe=y.text&&y.text.sections;for(let Te=0;Te<n.length;Te++){const{tl:Fe,tr:We,bl:yt,br:Zt,tex:_t,pixelOffsetTL:dt,pixelOffsetBR:Et,minFontScaleX:St,minFontScaleY:xt,glyphOffset:je,isSDF:Dt,sectionIndex:Ct}=n[Te],ti=K.vertexLength,hn=je[1];Ec(H,S.x,S.y,Fe.x,hn+Fe.y,_t.x,_t.y,l,Dt,dt.x,dt.y,St,xt),Ec(H,S.x,S.y,We.x,hn+We.y,_t.x+_t.w,_t.y,l,Dt,Et.x,dt.y,St,xt),Ec(H,S.x,S.y,yt.x,hn+yt.y,_t.x,_t.y+_t.h,l,Dt,dt.x,Et.y,St,xt),Ec(H,S.x,S.y,Zt.x,hn+Zt.y,_t.x+_t.w,_t.y+_t.h,l,Dt,Et.x,Et.y,St,xt),Zu(t.dynamicLayoutVertexArray,S,ke),U.emplaceBack(ti,ti+1,ti+2),U.emplaceBack(ti+1,ti+2,ti+3),K.vertexLength+=4,K.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(je[0]),Te!==n.length-1&&Ct===n[Te+1].sectionIndex||t.programConfigurations.populatePaintArrays(H.length,y,y.index,{},F,pe&&pe[Ct])}t.placedSymbolArray.emplaceBack(S.x,S.y,ne,this.glyphOffsetArray.length-ne,le,I,z,S.segment,l?l[0]:0,l?l[1]:0,h[0],h[1],w,0,!1,0,D)}_addCollisionDebugVertex(t,n,l,h,_,y){return n.emplaceBack(0,0),t.emplaceBack(l.x,l.y,h,_,Math.round(y.x),Math.round(y.y))}addCollisionDebugVertices(t,n,l,h,_,y,w){const S=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),I=S.vertexLength,z=_.layoutVertexArray,D=_.collisionVertexArray,F=w.anchorX,U=w.anchorY;this._addCollisionDebugVertex(z,D,y,F,U,new xe(t,n)),this._addCollisionDebugVertex(z,D,y,F,U,new xe(l,n)),this._addCollisionDebugVertex(z,D,y,F,U,new xe(l,h)),this._addCollisionDebugVertex(z,D,y,F,U,new xe(t,h)),S.vertexLength+=4;const H=_.indexArray;H.emplaceBack(I,I+1),H.emplaceBack(I+1,I+2),H.emplaceBack(I+2,I+3),H.emplaceBack(I+3,I),S.primitiveLength+=4}addDebugCollisionBoxes(t,n,l,h){for(let _=t;_<n;_++){const y=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(y.x1,y.y1,y.x2,y.y2,h?this.textCollisionBox:this.iconCollisionBox,y.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Mc(Ls,rh.members,Ln),this.iconCollisionBox=new Mc(Ls,rh.members,Ln);for(let t=0;t<this.symbolInstances.length;t++){const n=this.symbolInstances.get(t);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}}_deserializeCollisionBoxesForSymbol(t,n,l,h,_,y,w,S,I){const z={};for(let D=n;D<l;D++){const F=t.get(D);z.textBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},z.textFeatureIndex=F.featureIndex;break}for(let D=h;D<_;D++){const F=t.get(D);z.verticalTextBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},z.verticalTextFeatureIndex=F.featureIndex;break}for(let D=y;D<w;D++){const F=t.get(D);z.iconBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},z.iconFeatureIndex=F.featureIndex;break}for(let D=S;D<I;D++){const F=t.get(D);z.verticalIconBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},z.verticalIconFeatureIndex=F.featureIndex;break}return z}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const l=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,n){const l=t.placedSymbolArray.get(n),h=l.vertexStartIndex+4*l.numGlyphs;for(let _=l.vertexStartIndex;_<h;_+=4)t.indexArray.emplaceBack(_,_+1,_+2),t.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(t),l=Math.cos(t),h=[],_=[],y=[];for(let w=0;w<this.symbolInstances.length;++w){y.push(w);const S=this.symbolInstances.get(w);h.push(0|Math.round(n*S.anchorX+l*S.anchorY)),_.push(S.featureIndex)}return y.sort((w,S)=>h[w]-h[S]||_[S]-_[w]),y}addToSortKeyRanges(t,n){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===n?l.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const l=this.symbolInstances.get(n);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach((h,_,y)=>{h>=0&&y.indexOf(h)===_&&this.addIndicesForPlacedSymbol(this.text,h)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Zh,hh;gt("SymbolBucket",$u,{omit:["layers","collisionBoxArray","features","compareText"]}),$u.MAX_GLYPHS=65535,$u.addDynamicAttributes=Zu;var qu={get paint(){return hh=hh||new m({"icon-opacity":new Bt(Le.paint_symbol["icon-opacity"]),"icon-color":new Bt(Le.paint_symbol["icon-color"]),"icon-halo-color":new Bt(Le.paint_symbol["icon-halo-color"]),"icon-halo-width":new Bt(Le.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Bt(Le.paint_symbol["icon-halo-blur"]),"icon-translate":new vt(Le.paint_symbol["icon-translate"]),"icon-translate-anchor":new vt(Le.paint_symbol["icon-translate-anchor"]),"text-opacity":new Bt(Le.paint_symbol["text-opacity"]),"text-color":new Bt(Le.paint_symbol["text-color"],{runtimeType:tr,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new Bt(Le.paint_symbol["text-halo-color"]),"text-halo-width":new Bt(Le.paint_symbol["text-halo-width"]),"text-halo-blur":new Bt(Le.paint_symbol["text-halo-blur"]),"text-translate":new vt(Le.paint_symbol["text-translate"]),"text-translate-anchor":new vt(Le.paint_symbol["text-translate-anchor"])})},get layout(){return Zh=Zh||new m({"symbol-placement":new vt(Le.layout_symbol["symbol-placement"]),"symbol-spacing":new vt(Le.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new vt(Le.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Bt(Le.layout_symbol["symbol-sort-key"]),"symbol-z-order":new vt(Le.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new vt(Le.layout_symbol["icon-allow-overlap"]),"icon-overlap":new vt(Le.layout_symbol["icon-overlap"]),"icon-ignore-placement":new vt(Le.layout_symbol["icon-ignore-placement"]),"icon-optional":new vt(Le.layout_symbol["icon-optional"]),"icon-rotation-alignment":new vt(Le.layout_symbol["icon-rotation-alignment"]),"icon-size":new Bt(Le.layout_symbol["icon-size"]),"icon-text-fit":new vt(Le.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new vt(Le.layout_symbol["icon-text-fit-padding"]),"icon-image":new Bt(Le.layout_symbol["icon-image"]),"icon-rotate":new Bt(Le.layout_symbol["icon-rotate"]),"icon-padding":new Bt(Le.layout_symbol["icon-padding"]),"icon-keep-upright":new vt(Le.layout_symbol["icon-keep-upright"]),"icon-offset":new Bt(Le.layout_symbol["icon-offset"]),"icon-anchor":new Bt(Le.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new vt(Le.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new vt(Le.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new vt(Le.layout_symbol["text-rotation-alignment"]),"text-field":new Bt(Le.layout_symbol["text-field"]),"text-font":new Bt(Le.layout_symbol["text-font"]),"text-size":new Bt(Le.layout_symbol["text-size"]),"text-max-width":new Bt(Le.layout_symbol["text-max-width"]),"text-line-height":new vt(Le.layout_symbol["text-line-height"]),"text-letter-spacing":new Bt(Le.layout_symbol["text-letter-spacing"]),"text-justify":new Bt(Le.layout_symbol["text-justify"]),"text-radial-offset":new Bt(Le.layout_symbol["text-radial-offset"]),"text-variable-anchor":new vt(Le.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Bt(Le.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Bt(Le.layout_symbol["text-anchor"]),"text-max-angle":new vt(Le.layout_symbol["text-max-angle"]),"text-writing-mode":new vt(Le.layout_symbol["text-writing-mode"]),"text-rotate":new Bt(Le.layout_symbol["text-rotate"]),"text-padding":new vt(Le.layout_symbol["text-padding"]),"text-keep-upright":new vt(Le.layout_symbol["text-keep-upright"]),"text-transform":new Bt(Le.layout_symbol["text-transform"]),"text-offset":new Bt(Le.layout_symbol["text-offset"]),"text-allow-overlap":new vt(Le.layout_symbol["text-allow-overlap"]),"text-overlap":new vt(Le.layout_symbol["text-overlap"]),"text-ignore-placement":new vt(Le.layout_symbol["text-ignore-placement"]),"text-optional":new vt(Le.layout_symbol["text-optional"])})}};class dh{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:No,this.defaultValue=t}evaluate(t){if(t.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(t.formattedSection))return n.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}gt("FormatSectionOverride",dh,{omit:["defaultValue"]});class Pu extends o{constructor(t){super(t,qu)}recalculate(t,n){if(super.recalculate(t,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const l=this.layout.get("text-writing-mode");if(l){const h=[];for(const _ of l)h.indexOf(_)<0&&h.push(_);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,n,l,h){const _=this.layout.get(t).evaluate(n,{},l,h),y=this._unevaluatedLayout._values[t];return y.isDataDriven()||Ps(y.value)||!_?_:function(w,S){return S.replace(/{([^{}]+)}/g,(I,z)=>w&&z in w?String(w[z]):"")}(n.properties,_)}createBucket(t){return new $u(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of qu.paint.overridableProperties){if(!Pu.hasPaintOverride(this.layout,t))continue;const n=this.paint.get(t),l=new dh(n),h=new zr(l,n.property.specification);let _=null;_=n.value.kind==="constant"||n.value.kind==="source"?new Go("source",h):new pa("composite",h,n.value.zoomStops),this.paint._values[t]=new Ms(n.property,_,n.parameters)}}_handleOverridablePaintPropertyUpdate(t,n,l){return!(!this.layout||n.isDataDriven()||l.isDataDriven())&&Pu.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,n){const l=t.get("text-field"),h=qu.paint.properties[n];let _=!1;const y=w=>{for(const S of w)if(h.overrides&&h.overrides.hasOverride(S))return void(_=!0)};if(l.value.kind==="constant"&&l.value.value instanceof Sr)y(l.value.value.sections);else if(l.value.kind==="source"){const w=I=>{_||(I instanceof Tr&&Lt(I.value)===Yr?y(I.value.sections):I instanceof Vo?y(I.sections):I.eachChild(w))},S=l.value;S._styleExpression&&w(S._styleExpression.expression)}return _}}let $h;var lf={get paint(){return $h=$h||new m({"background-color":new vt(Le.paint_background["background-color"]),"background-pattern":new mu(Le.paint_background["background-pattern"]),"background-opacity":new vt(Le.paint_background["background-opacity"])})}};class fh extends o{constructor(t){super(t,lf)}}let Bd;var zc={get paint(){return Bd=Bd||new m({"raster-opacity":new vt(Le.paint_raster["raster-opacity"]),"raster-hue-rotate":new vt(Le.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new vt(Le.paint_raster["raster-brightness-min"]),"raster-brightness-max":new vt(Le.paint_raster["raster-brightness-max"]),"raster-saturation":new vt(Le.paint_raster["raster-saturation"]),"raster-contrast":new vt(Le.paint_raster["raster-contrast"]),"raster-resampling":new vt(Le.paint_raster["raster-resampling"]),"raster-fade-duration":new vt(Le.paint_raster["raster-fade-duration"])})}};class uf extends o{constructor(t){super(t,zc)}}class ph extends o{constructor(t){super(t,{}),this.onAdd=n=>{this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)},this.onRemove=n=>{this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class r{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const a=63710088e-1;class f{constructor(t,n){if(isNaN(t)||isNaN(n))throw new Error(`Invalid LngLat object: (${t}, ${n})`);if(this.lng=+t,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new f(Ii(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const n=Math.PI/180,l=this.lat*n,h=t.lat*n,_=Math.sin(l)*Math.sin(h)+Math.cos(l)*Math.cos(h)*Math.cos((t.lng-this.lng)*n);return a*Math.acos(Math.min(_,1))}static convert(t){if(t instanceof f)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new f(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new f(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const x=2*Math.PI*a;function k(i){return x*Math.cos(i*Math.PI/180)}function E(i){return(180+i)/360}function q(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function ae(i,t){return i/k(t)}function _e(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}class Oe{constructor(t,n,l=0){this.x=+t,this.y=+n,this.z=+l}static fromLngLat(t,n=0){const l=f.convert(t);return new Oe(E(l.lng),q(l.lat),ae(n,l.lat))}toLngLat(){return new f(360*this.x-180,_e(this.y))}toAltitude(){return this.z*k(_e(this.y))}meterInMercatorCoordinateUnits(){return 1/x*(t=_e(this.y),1/Math.cos(t*Math.PI/180));var t}}function Ye(i,t,n){var l=2*Math.PI*6378137/256/Math.pow(2,n);return[i*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}class it{constructor(t,n,l){if(!function(h,_,y){return!(h<0||h>25||y<0||y>=Math.pow(2,h)||_<0||_>=Math.pow(2,h))}(t,n,l))throw new Error(`x=${n}, y=${l}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=n,this.y=l,this.key=kt(0,t,t,n,l)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,n,l){const h=(y=this.y,w=this.z,S=Ye(256*(_=this.x),256*(y=Math.pow(2,w)-y-1),w),I=Ye(256*(_+1),256*(y+1),w),S[0]+","+S[1]+","+I[0]+","+I[1]);var _,y,w,S,I;const z=function(D,F,U){let H,K="";for(let ne=D;ne>0;ne--)H=1<<ne-1,K+=(F&H?1:0)+(U&H?2:0);return K}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,n>1?"@2x":"").replace(/{quadkey}/g,z).replace(/{bbox-epsg-3857}/g,h)}isChildOf(t){const n=this.z-t.z;return n>0&&t.x===this.x>>n&&t.y===this.y>>n}getTilePoint(t){const n=Math.pow(2,this.z);return new xe((t.x*n-this.x)*Dn,(t.y*n-this.y)*Dn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ke{constructor(t,n){this.wrap=t,this.canonical=n,this.key=kt(t,n.z,n.z,n.x,n.y)}}class mt{constructor(t,n,l,h,_){if(t<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${l}`);this.overscaledZ=t,this.wrap=n,this.canonical=new it(l,+h,+_),this.key=kt(n,t,l,h,_)}clone(){return new mt(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const n=this.canonical.z-t;return t>this.canonical.z?new mt(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new mt(t,this.wrap,t,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(t,n){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-t;return t>this.canonical.z?kt(this.wrap*+n,t,this.canonical.z,this.canonical.x,this.canonical.y):kt(this.wrap*+n,t,t,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const n=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>n&&t.canonical.y===this.canonical.y>>n}children(t){if(this.overscaledZ>=t)return[new mt(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,l=2*this.canonical.x,h=2*this.canonical.y;return[new mt(n,this.wrap,n,l,h),new mt(n,this.wrap,n,l+1,h),new mt(n,this.wrap,n,l,h+1),new mt(n,this.wrap,n,l+1,h+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new mt(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new mt(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ke(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Oe(t.x-this.wrap,t.y))}}function kt(i,t,n,l,h){(i*=2)<0&&(i=-1*i-1);const _=1<<n;return(_*_*i+_*h+l).toString(36)+n.toString(36)+t.toString(36)}gt("CanonicalTileID",it),gt("OverscaledTileID",mt,{omit:["posMatrix"]});class Rt{constructor(t,n,l,h=1,_=1,y=1,w=0){if(this.uid=t,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(l&&!["mapbox","terrarium","custom"].includes(l))return void Di(`"${l}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=n.height;const S=this.dim=n.height-2;switch(this.data=new Uint32Array(n.data.buffer),l){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=h,this.greenFactor=_,this.blueFactor=y,this.baseShift=w;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let I=0;I<S;I++)this.data[this._idx(-1,I)]=this.data[this._idx(0,I)],this.data[this._idx(S,I)]=this.data[this._idx(S-1,I)],this.data[this._idx(I,-1)]=this.data[this._idx(I,0)],this.data[this._idx(I,S)]=this.data[this._idx(I,S-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(S,-1)]=this.data[this._idx(S-1,0)],this.data[this._idx(-1,S)]=this.data[this._idx(0,S-1)],this.data[this._idx(S,S)]=this.data[this._idx(S-1,S-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let I=0;I<S;I++)for(let z=0;z<S;z++){const D=this.get(I,z);D>this.max&&(this.max=D),D<this.min&&(this.min=D)}}get(t,n){const l=new Uint8Array(this.data.buffer),h=4*this._idx(t,n);return this.unpack(l[h],l[h+1],l[h+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,n){if(t<-1||t>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(t+1)}unpack(t,n,l){return t*this.redFactor+n*this.greenFactor+l*this.blueFactor-this.baseShift}getPixels(){return new Lr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,n,l){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let h=n*this.dim,_=n*this.dim+this.dim,y=l*this.dim,w=l*this.dim+this.dim;switch(n){case-1:h=_-1;break;case 1:_=h+1}switch(l){case-1:y=w-1;break;case 1:w=y+1}const S=-n*this.dim,I=-l*this.dim;for(let z=y;z<w;z++)for(let D=h;D<_;D++)this.data[this._idx(D,z)]=t.data[this._idx(D+S,z+I)]}}gt("DEMData",Rt);class Vn{constructor(t){this._stringToNumber={},this._numberToString=[];for(let n=0;n<t.length;n++){const l=t[n];this._stringToNumber[l]=n,this._numberToString[n]=l}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class Ee{constructor(t,n,l,h,_){this.type="Feature",this._vectorTileFeature=t,t._z=n,t._x=l,t._y=h,this.properties=t.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&(t[n]=this[n]);return t}}class we{constructor(t,n){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new An(Dn,16,0),this.grid3D=new An(Dn,16,0),this.featureIndexArray=new cn,this.promoteId=n}insert(t,n,l,h,_,y){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,h,_);const S=y?this.grid3D:this.grid;for(let I=0;I<n.length;I++){const z=n[I],D=[1/0,1/0,-1/0,-1/0];for(let F=0;F<z.length;F++){const U=z[F];D[0]=Math.min(D[0],U.x),D[1]=Math.min(D[1],U.y),D[2]=Math.max(D[2],U.x),D[3]=Math.max(D[3],U.y)}D[0]<Dn&&D[1]<Dn&&D[2]>=0&&D[3]>=0&&S.insert(w,D[0],D[1],D[2],D[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Nl.VectorTile(new hl(this.rawTileData)).layers,this.sourceLayerCoder=new Vn(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,n,l,h){this.loadVTLayers();const _=t.params||{},y=Dn/t.tileSize/t.scale,w=Xo(_.filter),S=t.queryGeometry,I=t.queryPadding*y,z=ct(S),D=this.grid.query(z.minX-I,z.minY-I,z.maxX+I,z.maxY+I),F=ct(t.cameraQueryGeometry),U=this.grid3D.query(F.minX-I,F.minY-I,F.maxX+I,F.maxY+I,(ne,le,ke,pe)=>function(Te,Fe,We,yt,Zt){for(const dt of Te)if(Fe<=dt.x&&We<=dt.y&&yt>=dt.x&&Zt>=dt.y)return!0;const _t=[new xe(Fe,We),new xe(Fe,Zt),new xe(yt,Zt),new xe(yt,We)];if(Te.length>2){for(const dt of _t)if(_u(Te,dt))return!0}for(let dt=0;dt<Te.length-1;dt++)if(ed(Te[dt],Te[dt+1],_t))return!0;return!1}(t.cameraQueryGeometry,ne-I,le-I,ke+I,pe+I));for(const ne of U)D.push(ne);D.sort(jt);const H={};let K;for(let ne=0;ne<D.length;ne++){const le=D[ne];if(le===K)continue;K=le;const ke=this.featureIndexArray.get(le);let pe=null;this.loadMatchingFeature(H,ke.bucketIndex,ke.sourceLayerIndex,ke.featureIndex,w,_.layers,_.availableImages,n,l,h,(Te,Fe,We)=>(pe||(pe=Bl(Te)),Fe.queryIntersectsFeature(S,Te,We,pe,this.z,t.transform,y,t.pixelPosMatrix)))}return H}loadMatchingFeature(t,n,l,h,_,y,w,S,I,z,D){const F=this.bucketLayerIDs[n];if(y&&!function(ne,le){for(let ke=0;ke<ne.length;ke++)if(le.indexOf(ne[ke])>=0)return!0;return!1}(y,F))return;const U=this.sourceLayerCoder.decode(l),H=this.vtLayers[U].feature(h);if(_.needGeometry){const ne=Ol(H,!0);if(!_.filter(new Pi(this.tileID.overscaledZ),ne,this.tileID.canonical))return}else if(!_.filter(new Pi(this.tileID.overscaledZ),H))return;const K=this.getId(H,U);for(let ne=0;ne<F.length;ne++){const le=F[ne];if(y&&y.indexOf(le)<0)continue;const ke=S[le];if(!ke)continue;let pe={};K&&z&&(pe=z.getState(ke.sourceLayer||"_geojsonTileLayer",K));const Te=_i({},I[le]);Te.paint=Ae(Te.paint,ke.paint,H,pe,w),Te.layout=Ae(Te.layout,ke.layout,H,pe,w);const Fe=!D||D(H,ke,pe);if(!Fe)continue;const We=new Ee(H,this.z,this.x,this.y,K);We.layer=Te;let yt=t[le];yt===void 0&&(yt=t[le]=[]),yt.push({featureIndex:h,feature:We,intersectionZ:Fe})}}lookupSymbolFeatures(t,n,l,h,_,y,w,S){const I={};this.loadVTLayers();const z=Xo(_);for(const D of t)this.loadMatchingFeature(I,l,h,D,z,y,w,S,n);return I}hasLayer(t){for(const n of this.bucketLayerIDs)for(const l of n)if(t===l)return!0;return!1}getId(t,n){let l=t.id;return this.promoteId&&(l=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof l=="boolean"&&(l=Number(l))),l}}function Ae(i,t,n,l,h){return an(i,(_,y)=>{const w=t instanceof zl?t.get(y):null;return w&&w.evaluate?w.evaluate(n,l,h):w})}function ct(i){let t=1/0,n=1/0,l=-1/0,h=-1/0;for(const _ of i)t=Math.min(t,_.x),n=Math.min(n,_.y),l=Math.max(l,_.x),h=Math.max(h,_.y);return{minX:t,minY:n,maxX:l,maxY:h}}function jt(i,t){return t-i}function Yt(i,t,n,l,h){const _=[];for(let y=0;y<i.length;y++){const w=i[y];let S;for(let I=0;I<w.length-1;I++){let z=w[I],D=w[I+1];z.x<t&&D.x<t||(z.x<t?z=new xe(t,z.y+(t-z.x)/(D.x-z.x)*(D.y-z.y))._round():D.x<t&&(D=new xe(t,z.y+(t-z.x)/(D.x-z.x)*(D.y-z.y))._round()),z.y<n&&D.y<n||(z.y<n?z=new xe(z.x+(n-z.y)/(D.y-z.y)*(D.x-z.x),n)._round():D.y<n&&(D=new xe(z.x+(n-z.y)/(D.y-z.y)*(D.x-z.x),n)._round()),z.x>=l&&D.x>=l||(z.x>=l?z=new xe(l,z.y+(l-z.x)/(D.x-z.x)*(D.y-z.y))._round():D.x>=l&&(D=new xe(l,z.y+(l-z.x)/(D.x-z.x)*(D.y-z.y))._round()),z.y>=h&&D.y>=h||(z.y>=h?z=new xe(z.x+(h-z.y)/(D.y-z.y)*(D.x-z.x),h)._round():D.y>=h&&(D=new xe(z.x+(h-z.y)/(D.y-z.y)*(D.x-z.x),h)._round()),S&&z.equals(S[S.length-1])||(S=[z],_.push(S)),S.push(D)))))}}return _}gt("FeatureIndex",we,{omit:["rawTileData","sourceLayerCoder"]});class Vt extends xe{constructor(t,n,l,h){super(t,n),this.angle=l,h!==void 0&&(this.segment=h)}clone(){return new Vt(this.x,this.y,this.angle,this.segment)}}function ci(i,t,n,l,h){if(t.segment===void 0||n===0)return!0;let _=t,y=t.segment+1,w=0;for(;w>-n/2;){if(y--,y<0)return!1;w-=i[y].dist(_),_=i[y]}w+=i[y].dist(i[y+1]),y++;const S=[];let I=0;for(;w<n/2;){const z=i[y],D=i[y+1];if(!D)return!1;let F=i[y-1].angleTo(z)-z.angleTo(D);for(F=Math.abs((F+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:w,angleDelta:F}),I+=F;w-S[0].distance>l;)I-=S.shift().angleDelta;if(I>h)return!1;y++,w+=z.dist(D)}return!0}function xr(i){let t=0;for(let n=0;n<i.length-1;n++)t+=i[n].dist(i[n+1]);return t}function Zi(i,t,n){return i?.6*t*n:0}function fl(i,t){return Math.max(i?i.right-i.left:0,t?t.right-t.left:0)}function cf(i,t,n,l,h,_){const y=Zi(n,h,_),w=fl(n,l)*_;let S=0;const I=xr(i)/2;for(let z=0;z<i.length-1;z++){const D=i[z],F=i[z+1],U=D.dist(F);if(S+U>I){const H=(I-S)/U,K=dn.number(D.x,F.x,H),ne=dn.number(D.y,F.y,H),le=new Vt(K,ne,F.angleTo(D),z);return le._round(),!y||ci(i,le,w,y,t)?le:void 0}S+=U}}function Kp(i,t,n,l,h,_,y,w,S){const I=Zi(l,_,y),z=fl(l,h),D=z*y,F=i[0].x===0||i[0].x===S||i[0].y===0||i[0].y===S;return t-D<t/4&&(t=D+t/4),Vf(i,F?t/2*w%t:(z/2+2*_)*y*w%t,t,I,n,D,F,!1,S)}function Vf(i,t,n,l,h,_,y,w,S){const I=_/2,z=xr(i);let D=0,F=t-n,U=[];for(let H=0;H<i.length-1;H++){const K=i[H],ne=i[H+1],le=K.dist(ne),ke=ne.angleTo(K);for(;F+n<D+le;){F+=n;const pe=(F-D)/le,Te=dn.number(K.x,ne.x,pe),Fe=dn.number(K.y,ne.y,pe);if(Te>=0&&Te<S&&Fe>=0&&Fe<S&&F-I>=0&&F+I<=z){const We=new Vt(Te,Fe,ke,H);We._round(),l&&!ci(i,We,_,l,h)||U.push(We)}}D+=le}return w||U.length||y||(U=Vf(i,D/2,n,l,h,_,y,!0,S)),U}gt("Anchor",Vt);const mh=Os;function Uf(i,t,n,l){const h=[],_=i.image,y=_.pixelRatio,w=_.paddedRect.w-2*mh,S=_.paddedRect.h-2*mh;let I={x1:i.left,y1:i.top,x2:i.right,y2:i.bottom};const z=_.stretchX||[[0,w]],D=_.stretchY||[[0,S]],F=(je,Dt)=>je+Dt[1]-Dt[0],U=z.reduce(F,0),H=D.reduce(F,0),K=w-U,ne=S-H;let le=0,ke=U,pe=0,Te=H,Fe=0,We=K,yt=0,Zt=ne;if(_.content&&l){const je=_.content,Dt=je[2]-je[0],Ct=je[3]-je[1];(_.textFitWidth||_.textFitHeight)&&(I=Cc(i)),le=Od(z,0,je[0]),pe=Od(D,0,je[1]),ke=Od(z,je[0],je[2]),Te=Od(D,je[1],je[3]),Fe=je[0]-le,yt=je[1]-pe,We=Dt-ke,Zt=Ct-Te}const _t=I.x1,dt=I.y1,Et=I.x2-_t,St=I.y2-dt,xt=(je,Dt,Ct,ti)=>{const hn=Fd(je.stretch-le,ke,Et,_t),on=Nd(je.fixed-Fe,We,je.stretch,U),Dr=Fd(Dt.stretch-pe,Te,St,dt),$a=Nd(Dt.fixed-yt,Zt,Dt.stretch,H),hs=Fd(Ct.stretch-le,ke,Et,_t),Rr=Nd(Ct.fixed-Fe,We,Ct.stretch,U),so=Fd(ti.stretch-pe,Te,St,dt),oo=Nd(ti.fixed-yt,Zt,ti.stretch,H),ao=new xe(hn,Dr),Un=new xe(hs,Dr),Br=new xe(hs,so),Fs=new xe(hn,so),ds=new xe(on/y,$a/y),lo=new xe(Rr/y,oo/y),fs=t*Math.PI/180;if(fs){const Vi=Math.sin(fs),pn=Math.cos(fs),xn=[pn,-Vi,Vi,pn];ao._matMult(xn),Un._matMult(xn),Fs._matMult(xn),Br._matMult(xn)}const Pa=je.stretch+je.fixed,Ro=Dt.stretch+Dt.fixed;return{tl:ao,tr:Un,bl:Fs,br:Br,tex:{x:_.paddedRect.x+mh+Pa,y:_.paddedRect.y+mh+Ro,w:Ct.stretch+Ct.fixed-Pa,h:ti.stretch+ti.fixed-Ro},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ds,pixelOffsetBR:lo,minFontScaleX:We/y/Et,minFontScaleY:Zt/y/St,isSDF:n}};if(l&&(_.stretchX||_.stretchY)){const je=Zf(z,K,U),Dt=Zf(D,ne,H);for(let Ct=0;Ct<je.length-1;Ct++){const ti=je[Ct],hn=je[Ct+1];for(let on=0;on<Dt.length-1;on++)h.push(xt(ti,Dt[on],hn,Dt[on+1]))}}else h.push(xt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:S+1}));return h}function Od(i,t,n){let l=0;for(const h of i)l+=Math.max(t,Math.min(n,h[1]))-Math.max(t,Math.min(n,h[0]));return l}function Zf(i,t,n){const l=[{fixed:-mh,stretch:0}];for(const[h,_]of i){const y=l[l.length-1];l.push({fixed:h-y.stretch,stretch:y.stretch}),l.push({fixed:h-y.stretch,stretch:y.stretch+(_-h)})}return l.push({fixed:t+mh,stretch:n}),l}function Fd(i,t,n,l){return i/t*n+l}function Nd(i,t,n,l){return i-t*n/l}class jd{constructor(t,n,l,h,_,y,w,S,I,z){var D;if(this.boxStartIndex=t.length,I){let F=y.top,U=y.bottom;const H=y.collisionPadding;H&&(F-=H[1],U+=H[3]);let K=U-F;K>0&&(K=Math.max(10,K),this.circleDiameter=K)}else{const F=!((D=y.image)===null||D===void 0)&&D.content&&(y.image.textFitWidth||y.image.textFitHeight)?Cc(y):{x1:y.left,y1:y.top,x2:y.right,y2:y.bottom};F.y1=F.y1*w-S[0],F.y2=F.y2*w+S[2],F.x1=F.x1*w-S[3],F.x2=F.x2*w+S[1];const U=y.collisionPadding;if(U&&(F.x1-=U[0]*w,F.y1-=U[1]*w,F.x2+=U[2]*w,F.y2+=U[3]*w),z){const H=new xe(F.x1,F.y1),K=new xe(F.x2,F.y1),ne=new xe(F.x1,F.y2),le=new xe(F.x2,F.y2),ke=z*Math.PI/180;H._rotate(ke),K._rotate(ke),ne._rotate(ke),le._rotate(ke),F.x1=Math.min(H.x,K.x,ne.x,le.x),F.x2=Math.max(H.x,K.x,ne.x,le.x),F.y1=Math.min(H.y,K.y,ne.y,le.y),F.y2=Math.max(H.y,K.y,ne.y,le.y)}t.emplaceBack(n.x,n.y,F.x1,F.y1,F.x2,F.y2,l,h,_)}this.boxEndIndex=t.length}}class Jp{constructor(t=[],n=(l,h)=>l<h?-1:l>h?1:0){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:l}=this,h=n[t];for(;t>0;){const _=t-1>>1,y=n[_];if(l(h,y)>=0)break;n[t]=y,t=_}n[t]=h}_down(t){const{data:n,compare:l}=this,h=this.length>>1,_=n[t];for(;t<h;){let y=1+(t<<1);const w=y+1;if(w<this.length&&l(n[w],n[y])<0&&(y=w),l(n[y],_)>=0)break;n[t]=n[y],t=y}n[t]=_}}function Yp(i,t=1,n=!1){let l=1/0,h=1/0,_=-1/0,y=-1/0;const w=i[0];for(let U=0;U<w.length;U++){const H=w[U];(!U||H.x<l)&&(l=H.x),(!U||H.y<h)&&(h=H.y),(!U||H.x>_)&&(_=H.x),(!U||H.y>y)&&(y=H.y)}const S=Math.min(_-l,y-h);let I=S/2;const z=new Jp([],Qp);if(S===0)return new xe(l,h);for(let U=l;U<_;U+=S)for(let H=h;H<y;H+=S)z.push(new _h(U+I,H+I,I,i));let D=function(U){let H=0,K=0,ne=0;const le=U[0];for(let ke=0,pe=le.length,Te=pe-1;ke<pe;Te=ke++){const Fe=le[ke],We=le[Te],yt=Fe.x*We.y-We.x*Fe.y;K+=(Fe.x+We.x)*yt,ne+=(Fe.y+We.y)*yt,H+=3*yt}return new _h(K/H,ne/H,0,U)}(i),F=z.length;for(;z.length;){const U=z.pop();(U.d>D.d||!D.d)&&(D=U,n&&console.log("found best %d after %d probes",Math.round(1e4*U.d)/1e4,F)),U.max-D.d<=t||(I=U.h/2,z.push(new _h(U.p.x-I,U.p.y-I,I,i)),z.push(new _h(U.p.x+I,U.p.y-I,I,i)),z.push(new _h(U.p.x-I,U.p.y+I,I,i)),z.push(new _h(U.p.x+I,U.p.y+I,I,i)),F+=4)}return n&&(console.log(`num probes: ${F}`),console.log(`best distance: ${D.d}`)),D.p}function Qp(i,t){return t.max-i.max}function _h(i,t,n,l){this.p=new xe(i,t),this.h=n,this.d=function(h,_){let y=!1,w=1/0;for(let S=0;S<_.length;S++){const I=_[S];for(let z=0,D=I.length,F=D-1;z<D;F=z++){const U=I[z],H=I[F];U.y>h.y!=H.y>h.y&&h.x<(H.x-U.x)*(h.y-U.y)/(H.y-U.y)+U.x&&(y=!y),w=Math.min(w,Th(h,U,H))}}return(y?1:-1)*Math.sqrt(w)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}var cs;O.aq=void 0,(cs=O.aq||(O.aq={}))[cs.center=1]="center",cs[cs.left=2]="left",cs[cs.right=3]="right",cs[cs.top=4]="top",cs[cs.bottom=5]="bottom",cs[cs["top-left"]=6]="top-left",cs[cs["top-right"]=7]="top-right",cs[cs["bottom-left"]=8]="bottom-left",cs[cs["bottom-right"]=9]="bottom-right";const Hu=7,hf=Number.POSITIVE_INFINITY;function $f(i,t){return t[1]!==hf?function(n,l,h){let _=0,y=0;switch(l=Math.abs(l),h=Math.abs(h),n){case"top-right":case"top-left":case"top":y=h-Hu;break;case"bottom-right":case"bottom-left":case"bottom":y=-h+Hu}switch(n){case"top-right":case"bottom-right":case"right":_=-l;break;case"top-left":case"bottom-left":case"left":_=l}return[_,y]}(i,t[0],t[1]):function(n,l){let h=0,_=0;l<0&&(l=0);const y=l/Math.SQRT2;switch(n){case"top-right":case"top-left":_=y-Hu;break;case"bottom-right":case"bottom-left":_=-y+Hu;break;case"bottom":_=-l+Hu;break;case"top":_=l-Hu}switch(n){case"top-right":case"bottom-right":h=-y;break;case"top-left":case"bottom-left":h=y;break;case"left":h=l;break;case"right":h=-l}return[h,_]}(i,t[0])}function qf(i,t,n){var l;const h=i.layout,_=(l=h.get("text-variable-anchor-offset"))===null||l===void 0?void 0:l.evaluate(t,{},n);if(_){const w=_.values,S=[];for(let I=0;I<w.length;I+=2){const z=S[I]=w[I],D=w[I+1].map(F=>F*vn);z.startsWith("top")?D[1]-=Hu:z.startsWith("bottom")&&(D[1]+=Hu),S[I+1]=D}return new qn(S)}const y=h.get("text-variable-anchor");if(y){let w;w=i._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[h.get("text-radial-offset").evaluate(t,{},n)*vn,hf]:h.get("text-offset").evaluate(t,{},n).map(I=>I*vn);const S=[];for(const I of y)S.push(I,$f(I,w));return new qn(S)}return null}function df(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function em(i,t,n,l,h,_,y,w,S,I,z){let D=_.textMaxSize.evaluate(t,{});D===void 0&&(D=y);const F=i.layers[0].layout,U=F.get("icon-offset").evaluate(t,{},z),H=Gf(n.horizontal),K=y/24,ne=i.tilePixelRatio*K,le=i.tilePixelRatio*D/24,ke=i.tilePixelRatio*w,pe=i.tilePixelRatio*F.get("symbol-spacing"),Te=F.get("text-padding")*i.tilePixelRatio,Fe=function(je,Dt,Ct,ti=1){const hn=je.get("icon-padding").evaluate(Dt,{},Ct),on=hn&&hn.values;return[on[0]*ti,on[1]*ti,on[2]*ti,on[3]*ti]}(F,t,z,i.tilePixelRatio),We=F.get("text-max-angle")/180*Math.PI,yt=F.get("text-rotation-alignment")!=="viewport"&&F.get("symbol-placement")!=="point",Zt=F.get("icon-rotation-alignment")==="map"&&F.get("symbol-placement")!=="point",_t=F.get("symbol-placement"),dt=pe/2,Et=F.get("icon-text-fit");let St;l&&Et!=="none"&&(i.allowVerticalPlacement&&n.vertical&&(St=ql(l,n.vertical,Et,F.get("icon-text-fit-padding"),U,K)),H&&(l=ql(l,H,Et,F.get("icon-text-fit-padding"),U,K)));const xt=(je,Dt)=>{Dt.x<0||Dt.x>=Dn||Dt.y<0||Dt.y>=Dn||function(Ct,ti,hn,on,Dr,$a,hs,Rr,so,oo,ao,Un,Br,Fs,ds,lo,fs,Pa,Ro,Vi,pn,xn,ia,Rn,gh){const Gl=Ct.addToLineVertexArray(ti,hn);let Wl,qa,ka,Xr,ku=0,Gh=0,Jf=0,Yf=0,xf=-1,wf=-1;const Cu={};let Qf=Ll("");if(Ct.allowVerticalPlacement&&on.vertical){const Ns=Rr.layout.get("text-rotate").evaluate(pn,{},Rn)+90;ka=new jd(so,ti,oo,ao,Un,on.vertical,Br,Fs,ds,Ns),hs&&(Xr=new jd(so,ti,oo,ao,Un,hs,fs,Pa,ds,Ns))}if(Dr){const Ns=Rr.layout.get("icon-rotate").evaluate(pn,{}),Ca=Rr.layout.get("icon-text-fit")!=="none",Ac=Uf(Dr,Ns,ia,Ca),ml=hs?Uf(hs,Ns,ia,Ca):void 0;qa=new jd(so,ti,oo,ao,Un,Dr,fs,Pa,!1,Ns),ku=4*Ac.length;const Lc=Ct.iconSizeData;let Xl=null;Lc.kind==="source"?(Xl=[ta*Rr.layout.get("icon-size").evaluate(pn,{})],Xl[0]>Za&&Di(`${Ct.layerIds[0]}: Value for "icon-size" is >= ${Hl}. Reduce your "icon-size".`)):Lc.kind==="composite"&&(Xl=[ta*xn.compositeIconSizes[0].evaluate(pn,{},Rn),ta*xn.compositeIconSizes[1].evaluate(pn,{},Rn)],(Xl[0]>Za||Xl[1]>Za)&&Di(`${Ct.layerIds[0]}: Value for "icon-size" is >= ${Hl}. Reduce your "icon-size".`)),Ct.addSymbols(Ct.icon,Ac,Xl,Vi,Ro,pn,O.ah.none,ti,Gl.lineStartIndex,Gl.lineLength,-1,Rn),xf=Ct.icon.placedSymbolArray.length-1,ml&&(Gh=4*ml.length,Ct.addSymbols(Ct.icon,ml,Xl,Vi,Ro,pn,O.ah.vertical,ti,Gl.lineStartIndex,Gl.lineLength,-1,Rn),wf=Ct.icon.placedSymbolArray.length-1)}const ep=Object.keys(on.horizontal);for(const Ns of ep){const Ca=on.horizontal[Ns];if(!Wl){Qf=Ll(Ca.text);const ml=Rr.layout.get("text-rotate").evaluate(pn,{},Rn);Wl=new jd(so,ti,oo,ao,Un,Ca,Br,Fs,ds,ml)}const Ac=Ca.positionedLines.length===1;if(Jf+=Hf(Ct,ti,Ca,$a,Rr,ds,pn,lo,Gl,on.vertical?O.ah.horizontal:O.ah.horizontalOnly,Ac?ep:[Ns],Cu,xf,xn,Rn),Ac)break}on.vertical&&(Yf+=Hf(Ct,ti,on.vertical,$a,Rr,ds,pn,lo,Gl,O.ah.vertical,["vertical"],Cu,wf,xn,Rn));const nm=Wl?Wl.boxStartIndex:Ct.collisionBoxArray.length,rm=Wl?Wl.boxEndIndex:Ct.collisionBoxArray.length,sm=ka?ka.boxStartIndex:Ct.collisionBoxArray.length,om=ka?ka.boxEndIndex:Ct.collisionBoxArray.length,am=qa?qa.boxStartIndex:Ct.collisionBoxArray.length,lm=qa?qa.boxEndIndex:Ct.collisionBoxArray.length,um=Xr?Xr.boxStartIndex:Ct.collisionBoxArray.length,cm=Xr?Xr.boxEndIndex:Ct.collisionBoxArray.length;let pl=-1;const Ud=(Ns,Ca)=>Ns&&Ns.circleDiameter?Math.max(Ns.circleDiameter,Ca):Ca;pl=Ud(Wl,pl),pl=Ud(ka,pl),pl=Ud(qa,pl),pl=Ud(Xr,pl);const tp=pl>-1?1:0;tp&&(pl*=gh/vn),Ct.glyphOffsetArray.length>=$u.MAX_GLYPHS&&Di("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),pn.sortKey!==void 0&&Ct.addToSortKeyRanges(Ct.symbolInstances.length,pn.sortKey);const hm=qf(Rr,pn,Rn),[dm,fm]=function(Ns,Ca){const Ac=Ns.length,ml=Ca?.values;if(ml?.length>0)for(let Lc=0;Lc<ml.length;Lc+=2){const Xl=ml[Lc+1];Ns.emplaceBack(O.aq[ml[Lc]],Xl[0],Xl[1])}return[Ac,Ns.length]}(Ct.textAnchorOffsets,hm);Ct.symbolInstances.emplaceBack(ti.x,ti.y,Cu.right>=0?Cu.right:-1,Cu.center>=0?Cu.center:-1,Cu.left>=0?Cu.left:-1,Cu.vertical||-1,xf,wf,Qf,nm,rm,sm,om,am,lm,um,cm,oo,Jf,Yf,ku,Gh,tp,0,Br,pl,dm,fm)}(i,Dt,je,n,l,h,St,i.layers[0],i.collisionBoxArray,t.index,t.sourceLayerIndex,i.index,ne,[Te,Te,Te,Te],yt,S,ke,Fe,Zt,U,t,_,I,z,y)};if(_t==="line")for(const je of Yt(t.geometry,0,0,Dn,Dn)){const Dt=Kp(je,pe,We,n.vertical||H,l,24,le,i.overscaling,Dn);for(const Ct of Dt)H&&tm(i,H.text,dt,Ct)||xt(je,Ct)}else if(_t==="line-center"){for(const je of t.geometry)if(je.length>1){const Dt=cf(je,We,n.vertical||H,l,24,le);Dt&&xt(je,Dt)}}else if(t.type==="Polygon")for(const je of la(t.geometry,0)){const Dt=Yp(je,16);xt(je[0],new Vt(Dt.x,Dt.y,0))}else if(t.type==="LineString")for(const je of t.geometry)xt(je,new Vt(je[0].x,je[0].y,0));else if(t.type==="Point")for(const je of t.geometry)for(const Dt of je)xt([Dt],new Vt(Dt.x,Dt.y,0))}function Hf(i,t,n,l,h,_,y,w,S,I,z,D,F,U,H){const K=function(ke,pe,Te,Fe,We,yt,Zt,_t){const dt=Fe.layout.get("text-rotate").evaluate(yt,{})*Math.PI/180,Et=[];for(const St of pe.positionedLines)for(const xt of St.positionedGlyphs){if(!xt.rect)continue;const je=xt.rect||{};let Dt=lh+1,Ct=!0,ti=1,hn=0;const on=(We||_t)&&xt.vertical,Dr=xt.metrics.advance*xt.scale/2;if(_t&&pe.verticalizable&&(hn=St.lineOffset/2-(xt.imageName?-(vn-xt.metrics.width*xt.scale)/2:(xt.scale-1)*vn)),xt.imageName){const Vi=Zt[xt.imageName];Ct=Vi.sdf,ti=Vi.pixelRatio,Dt=Os/ti}const $a=We?[xt.x+Dr,xt.y]:[0,0];let hs=We?[0,0]:[xt.x+Dr+Te[0],xt.y+Te[1]-hn],Rr=[0,0];on&&(Rr=hs,hs=[0,0]);const so=xt.metrics.isDoubleResolution?2:1,oo=(xt.metrics.left-Dt)*xt.scale-Dr+hs[0],ao=(-xt.metrics.top-Dt)*xt.scale+hs[1],Un=oo+je.w/so*xt.scale/ti,Br=ao+je.h/so*xt.scale/ti,Fs=new xe(oo,ao),ds=new xe(Un,ao),lo=new xe(oo,Br),fs=new xe(Un,Br);if(on){const Vi=new xe(-Dr,Dr-Sa),pn=-Math.PI/2,xn=vn/2-Dr,ia=new xe(5-Sa-xn,-(xt.imageName?xn:0)),Rn=new xe(...Rr);Fs._rotateAround(pn,Vi)._add(ia)._add(Rn),ds._rotateAround(pn,Vi)._add(ia)._add(Rn),lo._rotateAround(pn,Vi)._add(ia)._add(Rn),fs._rotateAround(pn,Vi)._add(ia)._add(Rn)}if(dt){const Vi=Math.sin(dt),pn=Math.cos(dt),xn=[pn,-Vi,Vi,pn];Fs._matMult(xn),ds._matMult(xn),lo._matMult(xn),fs._matMult(xn)}const Pa=new xe(0,0),Ro=new xe(0,0);Et.push({tl:Fs,tr:ds,bl:lo,br:fs,tex:je,writingMode:pe.writingMode,glyphOffset:$a,sectionIndex:xt.sectionIndex,isSDF:Ct,pixelOffsetTL:Pa,pixelOffsetBR:Ro,minFontScaleX:0,minFontScaleY:0})}return Et}(0,n,w,h,_,y,l,i.allowVerticalPlacement),ne=i.textSizeData;let le=null;ne.kind==="source"?(le=[ta*h.layout.get("text-size").evaluate(y,{})],le[0]>Za&&Di(`${i.layerIds[0]}: Value for "text-size" is >= ${Hl}. Reduce your "text-size".`)):ne.kind==="composite"&&(le=[ta*U.compositeTextSizes[0].evaluate(y,{},H),ta*U.compositeTextSizes[1].evaluate(y,{},H)],(le[0]>Za||le[1]>Za)&&Di(`${i.layerIds[0]}: Value for "text-size" is >= ${Hl}. Reduce your "text-size".`)),i.addSymbols(i.text,K,le,w,_,y,I,t,S.lineStartIndex,S.lineLength,F,H);for(const ke of z)D[ke]=i.text.placedSymbolArray.length-1;return 4*K.length}function Gf(i){for(const t in i)return i[t];return null}function tm(i,t,n,l){const h=i.compareText;if(t in h){const _=h[t];for(let y=_.length-1;y>=0;y--)if(l.dist(_[y])<n)return!0}else h[t]=[];return h[t].push(l),!1}const Wf=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class ff{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,l]=new Uint8Array(t,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=l>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const _=Wf[15&l];if(!_)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(t,2,1),[w]=new Uint32Array(t,4,1);return new ff(w,y,_,t)}constructor(t,n=64,l=Float64Array,h){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=l,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const _=Wf.indexOf(this.ArrayType),y=2*t*this.ArrayType.BYTES_PER_ELEMENT,w=t*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-w%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${l}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+w+S,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+y+w+S),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+w+S,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=t)}add(t,n){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=t,this.coords[this._pos++]=n,l}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return pf(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,n,l,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:y,nodeSize:w}=this,S=[0,_.length-1,0],I=[];for(;S.length;){const z=S.pop()||0,D=S.pop()||0,F=S.pop()||0;if(D-F<=w){for(let ne=F;ne<=D;ne++){const le=y[2*ne],ke=y[2*ne+1];le>=t&&le<=l&&ke>=n&&ke<=h&&I.push(_[ne])}continue}const U=F+D>>1,H=y[2*U],K=y[2*U+1];H>=t&&H<=l&&K>=n&&K<=h&&I.push(_[U]),(z===0?t<=H:n<=K)&&(S.push(F),S.push(U-1),S.push(1-z)),(z===0?l>=H:h>=K)&&(S.push(U+1),S.push(D),S.push(1-z))}return I}within(t,n,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:_,nodeSize:y}=this,w=[0,h.length-1,0],S=[],I=l*l;for(;w.length;){const z=w.pop()||0,D=w.pop()||0,F=w.pop()||0;if(D-F<=y){for(let ne=F;ne<=D;ne++)Kf(_[2*ne],_[2*ne+1],t,n)<=I&&S.push(h[ne]);continue}const U=F+D>>1,H=_[2*U],K=_[2*U+1];Kf(H,K,t,n)<=I&&S.push(h[U]),(z===0?t-l<=H:n-l<=K)&&(w.push(F),w.push(U-1),w.push(1-z)),(z===0?t+l>=H:n+l>=K)&&(w.push(U+1),w.push(D),w.push(1-z))}return S}}function pf(i,t,n,l,h,_){if(h-l<=n)return;const y=l+h>>1;Xf(i,t,y,l,h,_),pf(i,t,n,l,y-1,1-_),pf(i,t,n,y+1,h,1-_)}function Xf(i,t,n,l,h,_){for(;h>l;){if(h-l>600){const I=h-l+1,z=n-l+1,D=Math.log(I),F=.5*Math.exp(2*D/3),U=.5*Math.sqrt(D*F*(I-F)/I)*(z-I/2<0?-1:1);Xf(i,t,n,Math.max(l,Math.floor(n-z*F/I+U)),Math.min(h,Math.floor(n+(I-z)*F/I+U)),_)}const y=t[2*n+_];let w=l,S=h;for(qh(i,t,l,n),t[2*h+_]>y&&qh(i,t,l,h);w<S;){for(qh(i,t,w,S),w++,S--;t[2*w+_]<y;)w++;for(;t[2*S+_]>y;)S--}t[2*l+_]===y?qh(i,t,l,S):(S++,qh(i,t,S,h)),S<=n&&(l=S+1),n<=S&&(h=S-1)}}function qh(i,t,n,l){mf(i,n,l),mf(t,2*n,2*l),mf(t,2*n+1,2*l+1)}function mf(i,t,n){const l=i[t];i[t]=i[n],i[n]=l}function Kf(i,t,n,l){const h=i-n,_=t-l;return h*h+_*_}var _f;O.bg=void 0,(_f=O.bg||(O.bg={})).create="create",_f.load="load",_f.fullLoad="fullLoad";let Vd=null,Hh=[];const gf=1e3/60,yf="loadTime",vf="fullLoadTime",im={mark(i){performance.mark(i)},frame(i){const t=i;Vd!=null&&Hh.push(t-Vd),Vd=t},clearMetrics(){Vd=null,Hh=[],performance.clearMeasures(yf),performance.clearMeasures(vf);for(const i in O.bg)performance.clearMarks(O.bg[i])},getPerformanceMetrics(){performance.measure(yf,O.bg.create,O.bg.load),performance.measure(vf,O.bg.create,O.bg.fullLoad);const i=performance.getEntriesByName(yf)[0].duration,t=performance.getEntriesByName(vf)[0].duration,n=Hh.length,l=1/(Hh.reduce((_,y)=>_+y,0)/n/1e3),h=Hh.filter(_=>_>gf).reduce((_,y)=>_+(y-gf)/gf,0);return{loadTime:i,fullLoadTime:t,fps:l,percentDroppedFrames:h/(n+h)*100,totalFrames:n}}};O.$=class extends R{},O.A=Bu,O.B=yi,O.C=function(i){if(Bi==null){const t=i.navigator?i.navigator.userAgent:null;Bi=!!i.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Bi},O.D=vt,O.E=Bo,O.F=class{constructor(i,t){this.target=i,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new r(()=>this.process()),this.subscription=function(n,l,h,_){return n.addEventListener(l,h,!1),{unsubscribe:()=>{n.removeEventListener(l,h,!1)}}}(this.target,"message",n=>this.receive(n)),this.globalScope=Bn(self)?i:window}registerMessageHandler(i,t){this.messageHandlers[i]=t}sendAsync(i,t){return new Promise((n,l)=>{const h=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[h]={resolve:n,reject:l},t&&t.signal.addEventListener("abort",()=>{delete this.resolveRejects[h];const w={id:h,type:"<cancel>",origin:location.origin,targetMapId:i.targetMapId,sourceMapId:this.mapId};this.target.postMessage(w)},{once:!0});const _=[],y=Object.assign(Object.assign({},i),{id:h,sourceMapId:this.mapId,origin:location.origin,data:mr(i.data,_)});this.target.postMessage(y,{transfer:_})})}receive(i){const t=i.data,n=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[n];const l=this.abortControllers[n];return delete this.abortControllers[n],void(l&&l.abort())}if(Bn(self)||t.mustQueue)return this.tasks[n]=t,this.taskQueue.push(n),void this.invoker.trigger();this.processTask(n,t)}}process(){if(this.taskQueue.length===0)return;const i=this.taskQueue.shift(),t=this.tasks[i];delete this.tasks[i],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(i,t)}processTask(i,t){return g(this,void 0,void 0,function*(){if(t.type==="<response>"){const h=this.resolveRejects[i];return delete this.resolveRejects[i],h?void(t.error?h.reject(Es(t.error)):h.resolve(Es(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(i,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const n=Es(t.data),l=new AbortController;this.abortControllers[i]=l;try{const h=yield this.messageHandlers[t.type](t.sourceMapId,n,l);this.completeTask(i,null,h)}catch(h){this.completeTask(i,h)}})}completeTask(i,t,n){const l=[];delete this.abortControllers[i];const h={id:i,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?mr(t):null,data:mr(n,l)};this.target.postMessage(h,{transfer:l})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},O.G=wt,O.H=function(){var i=new Bu(16);return Bu!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},O.I=jh,O.J=function(i,t,n){var l,h,_,y,w,S,I,z,D,F,U,H,K=n[0],ne=n[1],le=n[2];return t===i?(i[12]=t[0]*K+t[4]*ne+t[8]*le+t[12],i[13]=t[1]*K+t[5]*ne+t[9]*le+t[13],i[14]=t[2]*K+t[6]*ne+t[10]*le+t[14],i[15]=t[3]*K+t[7]*ne+t[11]*le+t[15]):(h=t[1],_=t[2],y=t[3],w=t[4],S=t[5],I=t[6],z=t[7],D=t[8],F=t[9],U=t[10],H=t[11],i[0]=l=t[0],i[1]=h,i[2]=_,i[3]=y,i[4]=w,i[5]=S,i[6]=I,i[7]=z,i[8]=D,i[9]=F,i[10]=U,i[11]=H,i[12]=l*K+w*ne+D*le+t[12],i[13]=h*K+S*ne+F*le+t[13],i[14]=_*K+I*ne+U*le+t[14],i[15]=y*K+z*ne+H*le+t[15]),i},O.K=function(i,t,n){var l=n[0],h=n[1],_=n[2];return i[0]=t[0]*l,i[1]=t[1]*l,i[2]=t[2]*l,i[3]=t[3]*l,i[4]=t[4]*h,i[5]=t[5]*h,i[6]=t[6]*h,i[7]=t[7]*h,i[8]=t[8]*_,i[9]=t[9]*_,i[10]=t[10]*_,i[11]=t[11]*_,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},O.L=Ch,O.M=function(i,t){const n={};for(let l=0;l<t.length;l++){const h=t[l];h in i&&(n[h]=i[h])}return n},O.N=f,O.O=E,O.P=xe,O.Q=q,O.R=Lr,O.S=mt,O.T=_r,O.U=$t,O.V=Qt,O.W=Nt,O.X=Dn,O.Y=b,O.Z=Oe,O._=g,O.a=It,O.a$=function(i,t){var n=i[0],l=i[1],h=i[2],_=i[3],y=i[4],w=i[5],S=i[6],I=i[7],z=i[8],D=i[9],F=i[10],U=i[11],H=i[12],K=i[13],ne=i[14],le=i[15],ke=t[0],pe=t[1],Te=t[2],Fe=t[3],We=t[4],yt=t[5],Zt=t[6],_t=t[7],dt=t[8],Et=t[9],St=t[10],xt=t[11],je=t[12],Dt=t[13],Ct=t[14],ti=t[15];return Math.abs(n-ke)<=os*Math.max(1,Math.abs(n),Math.abs(ke))&&Math.abs(l-pe)<=os*Math.max(1,Math.abs(l),Math.abs(pe))&&Math.abs(h-Te)<=os*Math.max(1,Math.abs(h),Math.abs(Te))&&Math.abs(_-Fe)<=os*Math.max(1,Math.abs(_),Math.abs(Fe))&&Math.abs(y-We)<=os*Math.max(1,Math.abs(y),Math.abs(We))&&Math.abs(w-yt)<=os*Math.max(1,Math.abs(w),Math.abs(yt))&&Math.abs(S-Zt)<=os*Math.max(1,Math.abs(S),Math.abs(Zt))&&Math.abs(I-_t)<=os*Math.max(1,Math.abs(I),Math.abs(_t))&&Math.abs(z-dt)<=os*Math.max(1,Math.abs(z),Math.abs(dt))&&Math.abs(D-Et)<=os*Math.max(1,Math.abs(D),Math.abs(Et))&&Math.abs(F-St)<=os*Math.max(1,Math.abs(F),Math.abs(St))&&Math.abs(U-xt)<=os*Math.max(1,Math.abs(U),Math.abs(xt))&&Math.abs(H-je)<=os*Math.max(1,Math.abs(H),Math.abs(je))&&Math.abs(K-Dt)<=os*Math.max(1,Math.abs(K),Math.abs(Dt))&&Math.abs(ne-Ct)<=os*Math.max(1,Math.abs(ne),Math.abs(Ct))&&Math.abs(le-ti)<=os*Math.max(1,Math.abs(le),Math.abs(ti))},O.a0=vi,O.a1=it,O.a2=Qe,O.a3=i=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(n=>{t.onloadstart=()=>{n(t)};for(const l of i){const h=window.document.createElement("source");wn(l)||(t.crossOrigin="Anonymous"),h.src=l,t.appendChild(h)}})},O.a4=function(){return nn++},O.a5=ht,O.a6=$u,O.a7=Xo,O.a8=Ol,O.a9=Ee,O.aA=function(i){if(i.type==="custom")return new ph(i);switch(i.type){case"background":return new fh(i);case"circle":return new Jd(i);case"fill":return new Qd(i);case"fill-extrusion":return new xd(i);case"heatmap":return new Yd(i);case"hillshade":return new sd(i);case"line":return new Vu(i);case"raster":return new uf(i);case"symbol":return new Pu(i)}},O.aB=qt,O.aC=function(i,t){if(!i)return[{command:"setStyle",args:[t]}];let n=[];try{if(!Mi(i.version,t.version))return[{command:"setStyle",args:[t]}];Mi(i.center,t.center)||n.push({command:"setCenter",args:[t.center]}),Mi(i.zoom,t.zoom)||n.push({command:"setZoom",args:[t.zoom]}),Mi(i.bearing,t.bearing)||n.push({command:"setBearing",args:[t.bearing]}),Mi(i.pitch,t.pitch)||n.push({command:"setPitch",args:[t.pitch]}),Mi(i.sprite,t.sprite)||n.push({command:"setSprite",args:[t.sprite]}),Mi(i.glyphs,t.glyphs)||n.push({command:"setGlyphs",args:[t.glyphs]}),Mi(i.transition,t.transition)||n.push({command:"setTransition",args:[t.transition]}),Mi(i.light,t.light)||n.push({command:"setLight",args:[t.light]}),Mi(i.terrain,t.terrain)||n.push({command:"setTerrain",args:[t.terrain]}),Mi(i.sky,t.sky)||n.push({command:"setSky",args:[t.sky]}),Mi(i.projection,t.projection)||n.push({command:"setProjection",args:[t.projection]});const l={},h=[];(function(y,w,S,I){let z;for(z in w=w||{},y=y||{})Object.prototype.hasOwnProperty.call(y,z)&&(Object.prototype.hasOwnProperty.call(w,z)||ms(z,S,I));for(z in w)Object.prototype.hasOwnProperty.call(w,z)&&(Object.prototype.hasOwnProperty.call(y,z)?Mi(y[z],w[z])||(y[z].type==="geojson"&&w[z].type==="geojson"&&ra(y,w,z)?$i(S,{command:"setGeoJSONSourceData",args:[z,w[z].data]}):_s(z,w,S,I)):Kr(z,w,S))})(i.sources,t.sources,h,l);const _=[];i.layers&&i.layers.forEach(y=>{"source"in y&&l[y.source]?n.push({command:"removeLayer",args:[y.id]}):_.push(y)}),n=n.concat(h),function(y,w,S){w=w||[];const I=(y=y||[]).map(Oo),z=w.map(Oo),D=y.reduce(Fo,{}),F=w.reduce(Fo,{}),U=I.slice(),H=Object.create(null);let K,ne,le,ke,pe;for(let Te=0,Fe=0;Te<I.length;Te++)K=I[Te],Object.prototype.hasOwnProperty.call(F,K)?Fe++:($i(S,{command:"removeLayer",args:[K]}),U.splice(U.indexOf(K,Fe),1));for(let Te=0,Fe=0;Te<z.length;Te++)K=z[z.length-1-Te],U[U.length-1-Te]!==K&&(Object.prototype.hasOwnProperty.call(D,K)?($i(S,{command:"removeLayer",args:[K]}),U.splice(U.lastIndexOf(K,U.length-Fe),1)):Fe++,ke=U[U.length-Te],$i(S,{command:"addLayer",args:[F[K],ke]}),U.splice(U.length-Te,0,K),H[K]=!0);for(let Te=0;Te<z.length;Te++)if(K=z[Te],ne=D[K],le=F[K],!H[K]&&!Mi(ne,le))if(Mi(ne.source,le.source)&&Mi(ne["source-layer"],le["source-layer"])&&Mi(ne.type,le.type)){for(pe in Nr(ne.layout,le.layout,S,K,null,"setLayoutProperty"),Nr(ne.paint,le.paint,S,K,null,"setPaintProperty"),Mi(ne.filter,le.filter)||$i(S,{command:"setFilter",args:[K,le.filter]}),Mi(ne.minzoom,le.minzoom)&&Mi(ne.maxzoom,le.maxzoom)||$i(S,{command:"setLayerZoomRange",args:[K,le.minzoom,le.maxzoom]}),ne)Object.prototype.hasOwnProperty.call(ne,pe)&&pe!=="layout"&&pe!=="paint"&&pe!=="filter"&&pe!=="metadata"&&pe!=="minzoom"&&pe!=="maxzoom"&&(pe.indexOf("paint.")===0?Nr(ne[pe],le[pe],S,K,pe.slice(6),"setPaintProperty"):Mi(ne[pe],le[pe])||$i(S,{command:"setLayerProperty",args:[K,pe,le[pe]]}));for(pe in le)Object.prototype.hasOwnProperty.call(le,pe)&&!Object.prototype.hasOwnProperty.call(ne,pe)&&pe!=="layout"&&pe!=="paint"&&pe!=="filter"&&pe!=="metadata"&&pe!=="minzoom"&&pe!=="maxzoom"&&(pe.indexOf("paint.")===0?Nr(ne[pe],le[pe],S,K,pe.slice(6),"setPaintProperty"):Mi(ne[pe],le[pe])||$i(S,{command:"setLayerProperty",args:[K,pe,le[pe]]}))}else $i(S,{command:"removeLayer",args:[K]}),ke=U[U.lastIndexOf(K)+1],$i(S,{command:"addLayer",args:[le,ke]})}(_,t.layers,n)}catch(l){console.warn("Unable to compute style diff:",l),n=[{command:"setStyle",args:[t]}]}return n},O.aD=function(i){const t=[],n=i.id;return n===void 0&&t.push({message:`layers.${n}: missing required property "id"`}),i.render===void 0&&t.push({message:`layers.${n}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&t.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),t},O.aE=function i(t,n){if(Array.isArray(t)){if(!Array.isArray(n)||t.length!==n.length)return!1;for(let l=0;l<t.length;l++)if(!i(t[l],n[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&n!==null){if(typeof n!="object"||Object.keys(t).length!==Object.keys(n).length)return!1;for(const l in t)if(!i(t[l],n[l]))return!1;return!0}return t===n},O.aF=an,O.aG=Zn,O.aH=class extends bn{constructor(i,t){super(i,t),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},O.aI=Jn,O.aJ=class extends bn{constructor(i,t){super(i,t),this.current=nc}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let t=1;t<16;t++)if(i[t]!==this.current[t]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},O.aK=ic,O.aL=Du,O.aM=Xt,O.aN=class extends bn{constructor(i,t){super(i,t),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},O.aO=class extends bn{constructor(i,t){super(i,t),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},O.aP=function(i,t,n,l,h,_,y){var w=1/(t-n),S=1/(l-h),I=1/(_-y);return i[0]=-2*w,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*S,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*I,i[11]=0,i[12]=(t+n)*w,i[13]=(h+l)*S,i[14]=(y+_)*I,i[15]=1,i},O.aQ=Uc,O.aR=class extends ye{},O.aS=yc,O.aT=class extends Ce{},O.aU=uc,O.aV=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},O.aW=Wc,O.aX=Cn,O.aY=Qs,O.aZ=class extends bt{},O.a_=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]&&i[3]===t[3]&&i[4]===t[4]&&i[5]===t[5]&&i[6]===t[6]&&i[7]===t[7]&&i[8]===t[8]&&i[9]===t[9]&&i[10]===t[10]&&i[11]===t[11]&&i[12]===t[12]&&i[13]===t[13]&&i[14]===t[14]&&i[15]===t[15]},O.aa=function(i){const t={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,l,h,_)=>{const y=h||_;return t[l]=!y||y.toLowerCase(),""}),t["max-age"]){const n=parseInt(t["max-age"],10);isNaN(n)?delete t["max-age"]:t["max-age"]=n}return t},O.ab=function(i,t){const n=[];for(const l in i)l in t||n.push(l);return n},O.ac=li,O.ad=function(i,t,n){var l=Math.sin(n),h=Math.cos(n),_=t[0],y=t[1],w=t[2],S=t[3],I=t[4],z=t[5],D=t[6],F=t[7];return t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=_*h+I*l,i[1]=y*h+z*l,i[2]=w*h+D*l,i[3]=S*h+F*l,i[4]=I*h-_*l,i[5]=z*h-y*l,i[6]=D*h-w*l,i[7]=F*h-S*l,i},O.ae=function(i){var t=new Bu(16);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t},O.af=Zc,O.ag=function(i,t){let n=0,l=0;if(i.kind==="constant")l=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:h,minZoom:_,maxZoom:y}=i,w=h?li(On.interpolationFactor(h,t,_,y),0,1):0;i.kind==="camera"?l=dn.number(i.minSize,i.maxSize,w):n=w}return{uSizeT:n,uSize:l}},O.ai=function(i,{uSize:t,uSizeT:n},{lowerSize:l,upperSize:h}){return i.kind==="source"?l/ta:i.kind==="composite"?dn.number(l/ta,h/ta,n):t},O.aj=Zu,O.ak=function(i,t,n,l){const h=t.y-i.y,_=t.x-i.x,y=l.y-n.y,w=l.x-n.x,S=y*_-w*h;if(S===0)return null;const I=(w*(i.y-n.y)-y*(i.x-n.x))/S;return new xe(i.x+I*_,i.y+I*h)},O.al=Yt,O.am=bh,O.an=Vc,O.ao=function(i){let t=1/0,n=1/0,l=-1/0,h=-1/0;for(const _ of i)t=Math.min(t,_.x),n=Math.min(n,_.y),l=Math.max(l,_.x),h=Math.max(h,_.y);return[t,n,l,h]},O.ap=vn,O.ar=Ic,O.as=function(i,t){var n=t[0],l=t[1],h=t[2],_=t[3],y=t[4],w=t[5],S=t[6],I=t[7],z=t[8],D=t[9],F=t[10],U=t[11],H=t[12],K=t[13],ne=t[14],le=t[15],ke=n*w-l*y,pe=n*S-h*y,Te=n*I-_*y,Fe=l*S-h*w,We=l*I-_*w,yt=h*I-_*S,Zt=z*K-D*H,_t=z*ne-F*H,dt=z*le-U*H,Et=D*ne-F*K,St=D*le-U*K,xt=F*le-U*ne,je=ke*xt-pe*St+Te*Et+Fe*dt-We*_t+yt*Zt;return je?(i[0]=(w*xt-S*St+I*Et)*(je=1/je),i[1]=(h*St-l*xt-_*Et)*je,i[2]=(K*yt-ne*We+le*Fe)*je,i[3]=(F*We-D*yt-U*Fe)*je,i[4]=(S*dt-y*xt-I*_t)*je,i[5]=(n*xt-h*dt+_*_t)*je,i[6]=(ne*Te-H*yt-le*pe)*je,i[7]=(z*yt-F*Te+U*pe)*je,i[8]=(y*St-w*dt+I*Zt)*je,i[9]=(l*dt-n*St-_*Zt)*je,i[10]=(H*We-K*Te+le*ke)*je,i[11]=(D*Te-z*We-U*ke)*je,i[12]=(w*_t-y*Et-S*Zt)*je,i[13]=(n*Et-l*_t+h*Zt)*je,i[14]=(K*pe-H*Fe-ne*ke)*je,i[15]=(z*Fe-D*pe+F*ke)*je,i):null},O.at=df,O.au=kc,O.av=ff,O.aw=function(){const i={},t=Le.$version;for(const n in Le.$root){const l=Le.$root[n];if(l.required){let h=null;h=n==="version"?t:l.type==="array"?[]:{},h!=null&&(i[n]=h)}}return i},O.ax=Ni,O.ay=ni,O.az=function(i){i=i.slice();const t=Object.create(null);for(let n=0;n<i.length;n++)t[i[n].id]=i[n];for(let n=0;n<i.length;n++)"ref"in i[n]&&(i[n]=uo(i[n],t[i[n].ref]));return i},O.b=Ei,O.b0=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},O.b1=function(i,t,n){return i[0]=t[0]*n[0],i[1]=t[1]*n[1],i[2]=t[2]*n[2],i[3]=t[3]*n[3],i},O.b2=function(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]+i[3]*t[3]},O.b3=Ii,O.b4=Ke,O.b5=ae,O.b6=function(i,t,n,l,h){var _,y=1/Math.tan(t/2);return i[0]=y/n,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=y,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,h!=null&&h!==1/0?(i[10]=(h+l)*(_=1/(l-h)),i[14]=2*h*l*_):(i[10]=-1,i[14]=-2*l),i},O.b7=function(i,t,n){var l=Math.sin(n),h=Math.cos(n),_=t[4],y=t[5],w=t[6],S=t[7],I=t[8],z=t[9],D=t[10],F=t[11];return t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[4]=_*h+I*l,i[5]=y*h+z*l,i[6]=w*h+D*l,i[7]=S*h+F*l,i[8]=I*h-_*l,i[9]=z*h-y*l,i[10]=D*h-w*l,i[11]=F*h-S*l,i},O.b8=Mt,O.b9=hi,O.bA=Ua,O.bB=function(i){return i.message===Ne},O.bC=fa,O.bD=Yi,O.ba=function(i){return i*Math.PI/180},O.bb=function(i,t){const{x:n,y:l}=Oe.fromLngLat(t);return!(i<0||i>25||l<0||l>=1||n<0||n>=1)},O.bc=function(i,t){return i[0]=t[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=t[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=t[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},O.bd=class extends M{},O.be=a,O.bf=im,O.bh=ii,O.bi=function(i,t){It.REGISTERED_PROTOCOLS[i]=t},O.bj=function(i){delete It.REGISTERED_PROTOCOLS[i]},O.bk=function(i,t){const n={};for(let h=0;h<i.length;h++){const _=t&&t[i[h].id]||cu(i[h]);t&&(t[i[h].id]=_);let y=n[_];y||(y=n[_]=[]),y.push(i[h])}const l=[];for(const h in n)l.push(n[h]);return l},O.bl=gt,O.bm=Vn,O.bn=we,O.bo=Vh,O.bp=function(i){i.bucket.createArrays(),i.bucket.tilePixelRatio=Dn/(512*i.bucket.overscaling),i.bucket.compareText={},i.bucket.iconsNeedLinear=!1;const t=i.bucket.layers[0],n=t.layout,l=t._unevaluatedLayout._values,h={layoutIconSize:l["icon-size"].possiblyEvaluate(new Pi(i.bucket.zoom+1),i.canonical),layoutTextSize:l["text-size"].possiblyEvaluate(new Pi(i.bucket.zoom+1),i.canonical),textMaxSize:l["text-size"].possiblyEvaluate(new Pi(18))};if(i.bucket.textSizeData.kind==="composite"){const{minZoom:I,maxZoom:z}=i.bucket.textSizeData;h.compositeTextSizes=[l["text-size"].possiblyEvaluate(new Pi(I),i.canonical),l["text-size"].possiblyEvaluate(new Pi(z),i.canonical)]}if(i.bucket.iconSizeData.kind==="composite"){const{minZoom:I,maxZoom:z}=i.bucket.iconSizeData;h.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new Pi(I),i.canonical),l["icon-size"].possiblyEvaluate(new Pi(z),i.canonical)]}const _=n.get("text-line-height")*vn,y=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",w=n.get("text-keep-upright"),S=n.get("text-size");for(const I of i.bucket.features){const z=n.get("text-font").evaluate(I,{},i.canonical).join(","),D=S.evaluate(I,{},i.canonical),F=h.layoutTextSize.evaluate(I,{},i.canonical),U=h.layoutIconSize.evaluate(I,{},i.canonical),H={horizontal:{},vertical:void 0},K=I.text;let ne,le=[0,0];if(K){const Te=K.toString(),Fe=n.get("text-letter-spacing").evaluate(I,{},i.canonical)*vn,We=Yu(Te)?Fe:0,yt=n.get("text-anchor").evaluate(I,{},i.canonical),Zt=qf(t,I,i.canonical);if(!Zt){const St=n.get("text-radial-offset").evaluate(I,{},i.canonical);le=St?$f(yt,[St*vn,hf]):n.get("text-offset").evaluate(I,{},i.canonical).map(xt=>xt*vn)}let _t=y?"center":n.get("text-justify").evaluate(I,{},i.canonical);const dt=n.get("symbol-placement")==="point"?n.get("text-max-width").evaluate(I,{},i.canonical)*vn:1/0,Et=()=>{i.bucket.allowVerticalPlacement&&du(Te)&&(H.vertical=Pc(K,i.glyphMap,i.glyphPositions,i.imagePositions,z,dt,_,yt,"left",We,le,O.ah.vertical,!0,F,D))};if(!y&&Zt){const St=new Set;if(_t==="auto")for(let je=0;je<Zt.values.length;je+=2)St.add(df(Zt.values[je]));else St.add(_t);let xt=!1;for(const je of St)if(!H.horizontal[je])if(xt)H.horizontal[je]=H.horizontal[0];else{const Dt=Pc(K,i.glyphMap,i.glyphPositions,i.imagePositions,z,dt,_,"center",je,We,le,O.ah.horizontal,!1,F,D);Dt&&(H.horizontal[je]=Dt,xt=Dt.positionedLines.length===1)}Et()}else{_t==="auto"&&(_t=df(yt));const St=Pc(K,i.glyphMap,i.glyphPositions,i.imagePositions,z,dt,_,yt,_t,We,le,O.ah.horizontal,!1,F,D);St&&(H.horizontal[_t]=St),Et(),du(Te)&&y&&w&&(H.vertical=Pc(K,i.glyphMap,i.glyphPositions,i.imagePositions,z,dt,_,yt,_t,We,le,O.ah.vertical,!1,F,D))}}let ke=!1;if(I.icon&&I.icon.name){const Te=i.imageMap[I.icon.name];Te&&(ne=$l(i.imagePositions[I.icon.name],n.get("icon-offset").evaluate(I,{},i.canonical),n.get("icon-anchor").evaluate(I,{},i.canonical)),ke=!!Te.sdf,i.bucket.sdfIcons===void 0?i.bucket.sdfIcons=ke:i.bucket.sdfIcons!==ke&&Di("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Te.pixelRatio!==i.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(i.bucket.iconsNeedLinear=!0))}const pe=Gf(H.horizontal)||H.vertical;i.bucket.iconsInText=!!pe&&pe.iconsInText,(pe||ne)&&em(i.bucket,I,H,ne,i.imageMap,h,F,U,le,ke,i.canonical)}i.showCollisionBoxes&&i.bucket.generateCollisionDebugBuffers()},O.bq=to,O.br=Yc,O.bs=Lo,O.bt=Nl,O.bu=hl,O.bv=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},O.bw=function(i,t,n,l,h){return g(this,void 0,void 0,function*(){if(Qt())try{return yield Nt(i,t,n,l,h)}catch{}return function(_,y,w,S,I){const z=_.width,D=_.height;He&&ge||(He=new OffscreenCanvas(z,D),ge=He.getContext("2d",{willReadFrequently:!0})),He.width=z,He.height=D,ge.drawImage(_,0,0,z,D);const F=ge.getImageData(y,w,S,I);return ge.clearRect(0,0,z,D),F.data}(i,t,n,l,h)})},O.bx=Rt,O.by=ze,O.bz=nt,O.c=Ft,O.d=i=>g(void 0,void 0,void 0,function*(){if(i.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(i)],{type:"image/png"});try{return createImageBitmap(t)}catch(n){throw new Error(`Could not load image because of ${n.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),O.e=_i,O.f=i=>new Promise((t,n)=>{const l=new Image;l.onload=()=>{t(l),URL.revokeObjectURL(l.src),l.onload=null,window.requestAnimationFrame(()=>{l.src=qe})},l.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const h=new Blob([new Uint8Array(i)],{type:"image/png"});l.src=i.byteLength?URL.createObjectURL(h):qe}),O.g=Tt,O.h=(i,t)=>Oi(_i(i,{type:"json"}),t),O.i=Bn,O.j=Vs,O.k=Fr,O.l=(i,t)=>Oi(_i(i,{type:"arrayBuffer"}),t),O.m=Oi,O.n=function(i){return new hl(i).readFields(Tu,[])},O.o=yu,O.p=Sc,O.q=m,O.r=Ht,O.s=wn,O.t=pr,O.u=ft,O.v=Le,O.w=Di,O.x=function([i,t,n]){return t+=90,t*=Math.PI/180,n*=Math.PI/180,{x:i*Math.cos(t)*Math.sin(n),y:i*Math.sin(t)*Math.sin(n),z:i*Math.cos(n)}},O.y=dn,O.z=Pi}),ce("worker",["./shared"],function(O){class g{constructor(V){this.keyCache={},V&&this.replace(V)}replace(V){this._layerConfigs={},this._layers={},this.update(V,[])}update(V,j){for(const te of V){this._layerConfigs[te.id]=te;const fe=this._layers[te.id]=O.aA(te);fe._featureFilter=O.a7(fe.filter),this.keyCache[te.id]&&delete this.keyCache[te.id]}for(const te of j)delete this.keyCache[te],delete this._layerConfigs[te],delete this._layers[te];this.familiesBySource={};const W=O.bk(Object.values(this._layerConfigs),this.keyCache);for(const te of W){const fe=te.map(Ie=>this._layers[Ie.id]),ve=fe[0];if(ve.visibility==="none")continue;const Se=ve.source||"";let he=this.familiesBySource[Se];he||(he=this.familiesBySource[Se]={});const Be=ve.sourceLayer||"_geojsonTileLayer";let Ze=he[Be];Ze||(Ze=he[Be]=[]),Ze.push(fe)}}}class ze{constructor(V){const j={},W=[];for(const Se in V){const he=V[Se],Be=j[Se]={};for(const Ze in he){const Ie=he[+Ze];if(!Ie||Ie.bitmap.width===0||Ie.bitmap.height===0)continue;const De={x:0,y:0,w:Ie.bitmap.width+2,h:Ie.bitmap.height+2};W.push(De),Be[Ze]={rect:De,metrics:Ie.metrics}}}const{w:te,h:fe}=O.p(W),ve=new O.o({width:te||1,height:fe||1});for(const Se in V){const he=V[Se];for(const Be in he){const Ze=he[+Be];if(!Ze||Ze.bitmap.width===0||Ze.bitmap.height===0)continue;const Ie=j[Se][Be].rect;O.o.copy(Ze.bitmap,ve,{x:0,y:0},{x:Ie.x+1,y:Ie.y+1},Ze.bitmap)}}this.image=ve,this.positions=j}}O.bl("GlyphAtlas",ze);class nt{constructor(V){this.tileID=new O.S(V.tileID.overscaledZ,V.tileID.wrap,V.tileID.canonical.z,V.tileID.canonical.x,V.tileID.canonical.y),this.uid=V.uid,this.zoom=V.zoom,this.pixelRatio=V.pixelRatio,this.tileSize=V.tileSize,this.source=V.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=V.showCollisionBoxes,this.collectResourceTiming=!!V.collectResourceTiming,this.returnDependencies=!!V.returnDependencies,this.promoteId=V.promoteId,this.inFlightDependencies=[]}parse(V,j,W,te){return O._(this,void 0,void 0,function*(){this.status="parsing",this.data=V,this.collisionBoxArray=new O.a5;const fe=new O.bm(Object.keys(V.layers).sort()),ve=new O.bn(this.tileID,this.promoteId);ve.bucketLayerIDs=[];const Se={},he={featureIndex:ve,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:W},Be=j.familiesBySource[this.source];for(const fi in Be){const Fi=V.layers[fi];if(!Fi)continue;Fi.version===1&&O.w(`Vector tile source "${this.source}" layer "${fi}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ki=fe.encode(fi),En=[];for(let Mn=0;Mn<Fi.length;Mn++){const cr=Fi.feature(Mn),co=ve.getId(cr,fi);En.push({feature:cr,id:co,index:Mn,sourceLayerIndex:Ki})}for(const Mn of Be[fi]){const cr=Mn[0];cr.source!==this.source&&O.w(`layer.source = ${cr.source} does not equal this.source = ${this.source}`),cr.minzoom&&this.zoom<Math.floor(cr.minzoom)||cr.maxzoom&&this.zoom>=cr.maxzoom||cr.visibility!=="none"&&(tt(Mn,this.zoom,W),(Se[cr.id]=cr.createBucket({index:ve.bucketLayerIDs.length,layers:Mn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ki,sourceID:this.source})).populate(En,he,this.tileID.canonical),ve.bucketLayerIDs.push(Mn.map(co=>co.id)))}}const Ze=O.aF(he.glyphDependencies,fi=>Object.keys(fi).map(Number));this.inFlightDependencies.forEach(fi=>fi?.abort()),this.inFlightDependencies=[];let Ie=Promise.resolve({});if(Object.keys(Ze).length){const fi=new AbortController;this.inFlightDependencies.push(fi),Ie=te.sendAsync({type:"GG",data:{stacks:Ze,source:this.source,tileID:this.tileID,type:"glyphs"}},fi)}const De=Object.keys(he.iconDependencies);let Pt=Promise.resolve({});if(De.length){const fi=new AbortController;this.inFlightDependencies.push(fi),Pt=te.sendAsync({type:"GI",data:{icons:De,source:this.source,tileID:this.tileID,type:"icons"}},fi)}const zt=Object.keys(he.patternDependencies);let ki=Promise.resolve({});if(zt.length){const fi=new AbortController;this.inFlightDependencies.push(fi),ki=te.sendAsync({type:"GI",data:{icons:zt,source:this.source,tileID:this.tileID,type:"patterns"}},fi)}const[ei,bi,si]=yield Promise.all([Ie,Pt,ki]),Xi=new ze(ei),rn=new O.bo(bi,si);for(const fi in Se){const Fi=Se[fi];Fi instanceof O.a6?(tt(Fi.layers,this.zoom,W),O.bp({bucket:Fi,glyphMap:ei,glyphPositions:Xi.positions,imageMap:bi,imagePositions:rn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Fi.hasPattern&&(Fi instanceof O.bq||Fi instanceof O.br||Fi instanceof O.bs)&&(tt(Fi.layers,this.zoom,W),Fi.addFeatures(he,this.tileID.canonical,rn.patternPositions))}return this.status="done",{buckets:Object.values(Se).filter(fi=>!fi.isEmpty()),featureIndex:ve,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Xi.image,imageAtlas:rn,glyphMap:this.returnDependencies?ei:null,iconMap:this.returnDependencies?bi:null,glyphPositions:this.returnDependencies?Xi.positions:null}})}}function tt(se,V,j){const W=new O.z(V);for(const te of se)te.recalculate(W,j)}class xe{constructor(V,j,W){this.actor=V,this.layerIndex=j,this.availableImages=W,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(V,j){return O._(this,void 0,void 0,function*(){const W=yield O.l(V.request,j);try{return{vectorTile:new O.bt.VectorTile(new O.bu(W.data)),rawData:W.data,cacheControl:W.cacheControl,expires:W.expires}}catch(te){const fe=new Uint8Array(W.data);let ve=`Unable to parse the tile at ${V.request.url}, `;throw ve+=fe[0]===31&&fe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${te.message}`,new Error(ve)}})}loadTile(V){return O._(this,void 0,void 0,function*(){const j=V.uid,W=!!(V&&V.request&&V.request.collectResourceTiming)&&new O.bv(V.request),te=new nt(V);this.loading[j]=te;const fe=new AbortController;te.abort=fe;try{const ve=yield this.loadVectorTile(V,fe);if(delete this.loading[j],!ve)return null;const Se=ve.rawData,he={};ve.expires&&(he.expires=ve.expires),ve.cacheControl&&(he.cacheControl=ve.cacheControl);const Be={};if(W){const Ie=W.finish();Ie&&(Be.resourceTiming=JSON.parse(JSON.stringify(Ie)))}te.vectorTile=ve.vectorTile;const Ze=te.parse(ve.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[j]=te,this.fetching[j]={rawTileData:Se,cacheControl:he,resourceTiming:Be};try{const Ie=yield Ze;return O.e({rawTileData:Se.slice(0)},Ie,he,Be)}finally{delete this.fetching[j]}}catch(ve){throw delete this.loading[j],te.status="done",this.loaded[j]=te,ve}})}reloadTile(V){return O._(this,void 0,void 0,function*(){const j=V.uid;if(!this.loaded||!this.loaded[j])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const W=this.loaded[j];if(W.showCollisionBoxes=V.showCollisionBoxes,W.status==="parsing"){const te=yield W.parse(W.vectorTile,this.layerIndex,this.availableImages,this.actor);let fe;if(this.fetching[j]){const{rawTileData:ve,cacheControl:Se,resourceTiming:he}=this.fetching[j];delete this.fetching[j],fe=O.e({rawTileData:ve.slice(0)},te,Se,he)}else fe=te;return fe}if(W.status==="done"&&W.vectorTile)return W.parse(W.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(V){return O._(this,void 0,void 0,function*(){const j=this.loading,W=V.uid;j&&j[W]&&j[W].abort&&(j[W].abort.abort(),delete j[W])})}removeTile(V){return O._(this,void 0,void 0,function*(){this.loaded&&this.loaded[V.uid]&&delete this.loaded[V.uid]})}}class me{constructor(){this.loaded={}}loadTile(V){return O._(this,void 0,void 0,function*(){const{uid:j,encoding:W,rawImageData:te,redFactor:fe,greenFactor:ve,blueFactor:Se,baseShift:he}=V,Be=te.width+2,Ze=te.height+2,Ie=O.b(te)?new O.R({width:Be,height:Ze},yield O.bw(te,-1,-1,Be,Ze)):te,De=new O.bx(j,Ie,W,fe,ve,Se,he);return this.loaded=this.loaded||{},this.loaded[j]=De,De})}removeTile(V){const j=this.loaded,W=V.uid;j&&j[W]&&delete j[W]}}function Ot(se,V){if(se.length!==0){st(se[0],V);for(var j=1;j<se.length;j++)st(se[j],!V)}}function st(se,V){for(var j=0,W=0,te=0,fe=se.length,ve=fe-1;te<fe;ve=te++){var Se=(se[te][0]-se[ve][0])*(se[ve][1]+se[te][1]),he=j+Se;W+=Math.abs(j)>=Math.abs(Se)?j-he+Se:Se-he+j,j=he}j+W>=0!=!!V&&se.reverse()}var Ue=O.by(function se(V,j){var W,te=V&&V.type;if(te==="FeatureCollection")for(W=0;W<V.features.length;W++)se(V.features[W],j);else if(te==="GeometryCollection")for(W=0;W<V.geometries.length;W++)se(V.geometries[W],j);else if(te==="Feature")se(V.geometry,j);else if(te==="Polygon")Ot(V.coordinates,j);else if(te==="MultiPolygon")for(W=0;W<V.coordinates.length;W++)Ot(V.coordinates[W],j);return V});const Je=O.bt.VectorTileFeature.prototype.toGeoJSON;var $t={exports:{}},Qt=O.bz,Mt=O.bt.VectorTileFeature,hi=li;function li(se,V){this.options=V||{},this.features=se,this.length=se.length}function Ii(se,V){this.id=typeof se.id=="number"?se.id:void 0,this.type=se.type,this.rawGeometry=se.type===1?[se.geometry]:se.geometry,this.properties=se.tags,this.extent=V||4096}li.prototype.feature=function(se){return new Ii(this.features[se],this.options.extent)},Ii.prototype.loadGeometry=function(){var se=this.rawGeometry;this.geometry=[];for(var V=0;V<se.length;V++){for(var j=se[V],W=[],te=0;te<j.length;te++)W.push(new Qt(j[te][0],j[te][1]));this.geometry.push(W)}return this.geometry},Ii.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var se=this.geometry,V=1/0,j=-1/0,W=1/0,te=-1/0,fe=0;fe<se.length;fe++)for(var ve=se[fe],Se=0;Se<ve.length;Se++){var he=ve[Se];V=Math.min(V,he.x),j=Math.max(j,he.x),W=Math.min(W,he.y),te=Math.max(te,he.y)}return[V,W,j,te]},Ii.prototype.toGeoJSON=Mt.prototype.toGeoJSON;var _i=O.bA,nn=hi;function an(se){var V=new _i;return function(j,W){for(var te in j.layers)W.writeMessage(3,Zn,j.layers[te])}(se,V),V.finish()}function Zn(se,V){var j;V.writeVarintField(15,se.version||1),V.writeStringField(1,se.name||""),V.writeVarintField(5,se.extent||4096);var W={keys:[],values:[],keycache:{},valuecache:{}};for(j=0;j<se.length;j++)W.feature=se.feature(j),V.writeMessage(2,qt,W);var te=W.keys;for(j=0;j<te.length;j++)V.writeStringField(3,te[j]);var fe=W.values;for(j=0;j<fe.length;j++)V.writeMessage(4,Bi,fe[j])}function qt(se,V){var j=se.feature;j.id!==void 0&&V.writeVarintField(1,j.id),V.writeMessage(2,Hi,se),V.writeVarintField(3,j.type),V.writeMessage(4,Bn,j)}function Hi(se,V){var j=se.feature,W=se.keys,te=se.values,fe=se.keycache,ve=se.valuecache;for(var Se in j.properties){var he=j.properties[Se],Be=fe[Se];if(he!==null){Be===void 0&&(W.push(Se),fe[Se]=Be=W.length-1),V.writeVarint(Be);var Ze=typeof he;Ze!=="string"&&Ze!=="boolean"&&Ze!=="number"&&(he=JSON.stringify(he));var Ie=Ze+":"+he,De=ve[Ie];De===void 0&&(te.push(he),ve[Ie]=De=te.length-1),V.writeVarint(De)}}}function Di(se,V){return(V<<3)+(7&se)}function xi(se){return se<<1^se>>31}function Bn(se,V){for(var j=se.loadGeometry(),W=se.type,te=0,fe=0,ve=j.length,Se=0;Se<ve;Se++){var he=j[Se],Be=1;W===1&&(Be=he.length),V.writeVarint(Di(1,Be));for(var Ze=W===3?he.length-1:he.length,Ie=0;Ie<Ze;Ie++){Ie===1&&W!==1&&V.writeVarint(Di(2,Ze-1));var De=he[Ie].x-te,Pt=he[Ie].y-fe;V.writeVarint(xi(De)),V.writeVarint(xi(Pt)),te+=De,fe+=Pt}W===3&&V.writeVarint(Di(7,1))}}function Bi(se,V){var j=typeof se;j==="string"?V.writeStringField(1,se):j==="boolean"?V.writeBooleanField(7,se):j==="number"&&(se%1!=0?V.writeDoubleField(3,se):se<0?V.writeSVarintField(6,se):V.writeVarintField(5,se))}$t.exports=an,$t.exports.fromVectorTileJs=an,$t.exports.fromGeojsonVt=function(se,V){V=V||{};var j={};for(var W in se)j[W]=new nn(se[W].features,V),j[W].name=W,j[W].version=V.version,j[W].extent=V.extent;return an({layers:j})},$t.exports.GeoJSONWrapper=nn;var Ei=O.by($t.exports);const qe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:se=>se},Nt=Math.fround||(He=new Float32Array(1),se=>(He[0]=+se,He[0]));var He;const ge=3,Ne=5,Ft=6;class It{constructor(V){this.options=Object.assign(Object.create(qe),V),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(V){const{log:j,minZoom:W,maxZoom:te}=this.options;j&&console.time("total time");const fe=`prepare ${V.length} points`;j&&console.time(fe),this.points=V;const ve=[];for(let he=0;he<V.length;he++){const Be=V[he];if(!Be.geometry)continue;const[Ze,Ie]=Be.geometry.coordinates,De=Nt(ii(Ze)),Pt=Nt(ni(Ie));ve.push(De,Pt,1/0,he,-1,1),this.options.reduce&&ve.push(0)}let Se=this.trees[te+1]=this._createTree(ve);j&&console.timeEnd(fe);for(let he=te;he>=W;he--){const Be=+Date.now();Se=this.trees[he]=this._createTree(this._cluster(Se,he)),j&&console.log("z%d: %d clusters in %dms",he,Se.numItems,+Date.now()-Be)}return j&&console.timeEnd("total time"),this}getClusters(V,j){let W=((V[0]+180)%360+360)%360-180;const te=Math.max(-90,Math.min(90,V[1]));let fe=V[2]===180?180:((V[2]+180)%360+360)%360-180;const ve=Math.max(-90,Math.min(90,V[3]));if(V[2]-V[0]>=360)W=-180,fe=180;else if(W>fe){const Ie=this.getClusters([W,te,180,ve],j),De=this.getClusters([-180,te,fe,ve],j);return Ie.concat(De)}const Se=this.trees[this._limitZoom(j)],he=Se.range(ii(W),ni(ve),ii(fe),ni(te)),Be=Se.data,Ze=[];for(const Ie of he){const De=this.stride*Ie;Ze.push(Be[De+Ne]>1?Tt(Be,De,this.clusterProps):this.points[Be[De+ge]])}return Ze}getChildren(V){const j=this._getOriginId(V),W=this._getOriginZoom(V),te="No cluster with the specified id.",fe=this.trees[W];if(!fe)throw new Error(te);const ve=fe.data;if(j*this.stride>=ve.length)throw new Error(te);const Se=this.options.radius/(this.options.extent*Math.pow(2,W-1)),he=fe.within(ve[j*this.stride],ve[j*this.stride+1],Se),Be=[];for(const Ze of he){const Ie=Ze*this.stride;ve[Ie+4]===V&&Be.push(ve[Ie+Ne]>1?Tt(ve,Ie,this.clusterProps):this.points[ve[Ie+ge]])}if(Be.length===0)throw new Error(te);return Be}getLeaves(V,j,W){const te=[];return this._appendLeaves(te,V,j=j||10,W=W||0,0),te}getTile(V,j,W){const te=this.trees[this._limitZoom(V)],fe=Math.pow(2,V),{extent:ve,radius:Se}=this.options,he=Se/ve,Be=(W-he)/fe,Ze=(W+1+he)/fe,Ie={features:[]};return this._addTileFeatures(te.range((j-he)/fe,Be,(j+1+he)/fe,Ze),te.data,j,W,fe,Ie),j===0&&this._addTileFeatures(te.range(1-he/fe,Be,1,Ze),te.data,fe,W,fe,Ie),j===fe-1&&this._addTileFeatures(te.range(0,Be,he/fe,Ze),te.data,-1,W,fe,Ie),Ie.features.length?Ie:null}getClusterExpansionZoom(V){let j=this._getOriginZoom(V)-1;for(;j<=this.options.maxZoom;){const W=this.getChildren(V);if(j++,W.length!==1)break;V=W[0].properties.cluster_id}return j}_appendLeaves(V,j,W,te,fe){const ve=this.getChildren(j);for(const Se of ve){const he=Se.properties;if(he&&he.cluster?fe+he.point_count<=te?fe+=he.point_count:fe=this._appendLeaves(V,he.cluster_id,W,te,fe):fe<te?fe++:V.push(Se),V.length===W)break}return fe}_createTree(V){const j=new O.av(V.length/this.stride|0,this.options.nodeSize,Float32Array);for(let W=0;W<V.length;W+=this.stride)j.add(V[W],V[W+1]);return j.finish(),j.data=V,j}_addTileFeatures(V,j,W,te,fe,ve){for(const Se of V){const he=Se*this.stride,Be=j[he+Ne]>1;let Ze,Ie,De;if(Be)Ze=wt(j,he,this.clusterProps),Ie=j[he],De=j[he+1];else{const ki=this.points[j[he+ge]];Ze=ki.properties;const[ei,bi]=ki.geometry.coordinates;Ie=ii(ei),De=ni(bi)}const Pt={type:1,geometry:[[Math.round(this.options.extent*(Ie*fe-W)),Math.round(this.options.extent*(De*fe-te))]],tags:Ze};let zt;zt=Be||this.options.generateId?j[he+ge]:this.points[j[he+ge]].id,zt!==void 0&&(Pt.id=zt),ve.features.push(Pt)}}_limitZoom(V){return Math.max(this.options.minZoom,Math.min(Math.floor(+V),this.options.maxZoom+1))}_cluster(V,j){const{radius:W,extent:te,reduce:fe,minPoints:ve}=this.options,Se=W/(te*Math.pow(2,j)),he=V.data,Be=[],Ze=this.stride;for(let Ie=0;Ie<he.length;Ie+=Ze){if(he[Ie+2]<=j)continue;he[Ie+2]=j;const De=he[Ie],Pt=he[Ie+1],zt=V.within(he[Ie],he[Ie+1],Se),ki=he[Ie+Ne];let ei=ki;for(const bi of zt){const si=bi*Ze;he[si+2]>j&&(ei+=he[si+Ne])}if(ei>ki&&ei>=ve){let bi,si=De*ki,Xi=Pt*ki,rn=-1;const fi=((Ie/Ze|0)<<5)+(j+1)+this.points.length;for(const Fi of zt){const Ki=Fi*Ze;if(he[Ki+2]<=j)continue;he[Ki+2]=j;const En=he[Ki+Ne];si+=he[Ki]*En,Xi+=he[Ki+1]*En,he[Ki+4]=fi,fe&&(bi||(bi=this._map(he,Ie,!0),rn=this.clusterProps.length,this.clusterProps.push(bi)),fe(bi,this._map(he,Ki)))}he[Ie+4]=fi,Be.push(si/ei,Xi/ei,1/0,fi,-1,ei),fe&&Be.push(rn)}else{for(let bi=0;bi<Ze;bi++)Be.push(he[Ie+bi]);if(ei>1)for(const bi of zt){const si=bi*Ze;if(!(he[si+2]<=j)){he[si+2]=j;for(let Xi=0;Xi<Ze;Xi++)Be.push(he[si+Xi])}}}}return Be}_getOriginId(V){return V-this.points.length>>5}_getOriginZoom(V){return(V-this.points.length)%32}_map(V,j,W){if(V[j+Ne]>1){const ve=this.clusterProps[V[j+Ft]];return W?Object.assign({},ve):ve}const te=this.points[V[j+ge]].properties,fe=this.options.map(te);return W&&fe===te?Object.assign({},fe):fe}}function Tt(se,V,j){return{type:"Feature",id:se[V+ge],properties:wt(se,V,j),geometry:{type:"Point",coordinates:[(W=se[V],360*(W-.5)),Oi(se[V+1])]}};var W}function wt(se,V,j){const W=se[V+Ne],te=W>=1e4?`${Math.round(W/1e3)}k`:W>=1e3?Math.round(W/100)/10+"k":W,fe=se[V+Ft],ve=fe===-1?{}:Object.assign({},j[fe]);return Object.assign(ve,{cluster:!0,cluster_id:se[V+ge],point_count:W,point_count_abbreviated:te})}function ii(se){return se/360+.5}function ni(se){const V=Math.sin(se*Math.PI/180),j=.5-.25*Math.log((1+V)/(1-V))/Math.PI;return j<0?0:j>1?1:j}function Oi(se){const V=(180-360*se)*Math.PI/180;return 360*Math.atan(Math.exp(V))/Math.PI-90}function wn(se,V,j,W){let te=W;const fe=V+(j-V>>1);let ve,Se=j-V;const he=se[V],Be=se[V+1],Ze=se[j],Ie=se[j+1];for(let De=V+3;De<j;De+=3){const Pt=js(se[De],se[De+1],he,Be,Ze,Ie);if(Pt>te)ve=De,te=Pt;else if(Pt===te){const zt=Math.abs(De-fe);zt<Se&&(ve=De,Se=zt)}}te>W&&(ve-V>3&&wn(se,V,ve,W),se[ve+2]=te,j-ve>3&&wn(se,ve,j,W))}function js(se,V,j,W,te,fe){let ve=te-j,Se=fe-W;if(ve!==0||Se!==0){const he=((se-j)*ve+(V-W)*Se)/(ve*ve+Se*Se);he>1?(j=te,W=fe):he>0&&(j+=ve*he,W+=Se*he)}return ve=se-j,Se=V-W,ve*ve+Se*Se}function wr(se,V,j,W){const te={id:se??null,type:V,geometry:j,tags:W,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(V==="Point"||V==="MultiPoint"||V==="LineString")Fr(te,j);else if(V==="Polygon")Fr(te,j[0]);else if(V==="MultiLineString")for(const fe of j)Fr(te,fe);else if(V==="MultiPolygon")for(const fe of j)Fr(te,fe[0]);return te}function Fr(se,V){for(let j=0;j<V.length;j+=3)se.minX=Math.min(se.minX,V[j]),se.minY=Math.min(se.minY,V[j+1]),se.maxX=Math.max(se.maxX,V[j]),se.maxY=Math.max(se.maxY,V[j+1])}function Vs(se,V,j,W){if(!V.geometry)return;const te=V.geometry.coordinates;if(te&&te.length===0)return;const fe=V.geometry.type,ve=Math.pow(j.tolerance/((1<<j.maxZoom)*j.extent),2);let Se=[],he=V.id;if(j.promoteId?he=V.properties[j.promoteId]:j.generateId&&(he=W||0),fe==="Point")Bo(te,Se);else if(fe==="MultiPoint")for(const Be of te)Bo(Be,Se);else if(fe==="LineString")Le(te,Se,ve,!1);else if(fe==="MultiLineString"){if(j.lineMetrics){for(const Be of te)Se=[],Le(Be,Se,ve,!1),se.push(wr(he,"LineString",Se,V.properties));return}ps(te,Se,ve,!1)}else if(fe==="Polygon")ps(te,Se,ve,!0);else{if(fe!=="MultiPolygon"){if(fe==="GeometryCollection"){for(const Be of V.geometry.geometries)Vs(se,{id:he,geometry:Be,properties:V.properties},j,W);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Be of te){const Ze=[];ps(Be,Ze,ve,!0),Se.push(Ze)}}se.push(wr(he,fe,Se,V.properties))}function Bo(se,V){V.push(uo(se[0]),Mi(se[1]),0)}function Le(se,V,j,W){let te,fe,ve=0;for(let he=0;he<se.length;he++){const Be=uo(se[he][0]),Ze=Mi(se[he][1]);V.push(Be,Ze,0),he>0&&(ve+=W?(te*Ze-Be*fe)/2:Math.sqrt(Math.pow(Be-te,2)+Math.pow(Ze-fe,2))),te=Be,fe=Ze}const Se=V.length-3;V[2]=1,wn(V,0,Se,j),V[Se+2]=1,V.size=Math.abs(ve),V.start=0,V.end=V.size}function ps(se,V,j,W){for(let te=0;te<se.length;te++){const fe=[];Le(se[te],fe,j,W),V.push(fe)}}function uo(se){return se/360+.5}function Mi(se){const V=Math.sin(se*Math.PI/180),j=.5-.25*Math.log((1+V)/(1-V))/Math.PI;return j<0?0:j>1?1:j}function $i(se,V,j,W,te,fe,ve,Se){if(W/=V,fe>=(j/=V)&&ve<W)return se;if(ve<j||fe>=W)return null;const he=[];for(const Be of se){const Ze=Be.geometry;let Ie=Be.type;const De=te===0?Be.minX:Be.minY,Pt=te===0?Be.maxX:Be.maxY;if(De>=j&&Pt<W){he.push(Be);continue}if(Pt<j||De>=W)continue;let zt=[];if(Ie==="Point"||Ie==="MultiPoint")Kr(Ze,zt,j,W,te);else if(Ie==="LineString")ms(Ze,zt,j,W,te,!1,Se.lineMetrics);else if(Ie==="MultiLineString")ra(Ze,zt,j,W,te,!1);else if(Ie==="Polygon")ra(Ze,zt,j,W,te,!0);else if(Ie==="MultiPolygon")for(const ki of Ze){const ei=[];ra(ki,ei,j,W,te,!0),ei.length&&zt.push(ei)}if(zt.length){if(Se.lineMetrics&&Ie==="LineString"){for(const ki of zt)he.push(wr(Be.id,Ie,ki,Be.tags));continue}Ie!=="LineString"&&Ie!=="MultiLineString"||(zt.length===1?(Ie="LineString",zt=zt[0]):Ie="MultiLineString"),Ie!=="Point"&&Ie!=="MultiPoint"||(Ie=zt.length===3?"Point":"MultiPoint"),he.push(wr(Be.id,Ie,zt,Be.tags))}}return he.length?he:null}function Kr(se,V,j,W,te){for(let fe=0;fe<se.length;fe+=3){const ve=se[fe+te];ve>=j&&ve<=W&&Nr(V,se[fe],se[fe+1],se[fe+2])}}function ms(se,V,j,W,te,fe,ve){let Se=_s(se);const he=te===0?Oo:Fo;let Be,Ze,Ie=se.start;for(let ei=0;ei<se.length-3;ei+=3){const bi=se[ei],si=se[ei+1],Xi=se[ei+2],rn=se[ei+3],fi=se[ei+4],Fi=te===0?bi:si,Ki=te===0?rn:fi;let En=!1;ve&&(Be=Math.sqrt(Math.pow(bi-rn,2)+Math.pow(si-fi,2))),Fi<j?Ki>j&&(Ze=he(Se,bi,si,rn,fi,j),ve&&(Se.start=Ie+Be*Ze)):Fi>W?Ki<W&&(Ze=he(Se,bi,si,rn,fi,W),ve&&(Se.start=Ie+Be*Ze)):Nr(Se,bi,si,Xi),Ki<j&&Fi>=j&&(Ze=he(Se,bi,si,rn,fi,j),En=!0),Ki>W&&Fi<=W&&(Ze=he(Se,bi,si,rn,fi,W),En=!0),!fe&&En&&(ve&&(Se.end=Ie+Be*Ze),V.push(Se),Se=_s(se)),ve&&(Ie+=Be)}let De=se.length-3;const Pt=se[De],zt=se[De+1],ki=te===0?Pt:zt;ki>=j&&ki<=W&&Nr(Se,Pt,zt,se[De+2]),De=Se.length-3,fe&&De>=3&&(Se[De]!==Se[0]||Se[De+1]!==Se[1])&&Nr(Se,Se[0],Se[1],Se[2]),Se.length&&V.push(Se)}function _s(se){const V=[];return V.size=se.size,V.start=se.start,V.end=se.end,V}function ra(se,V,j,W,te,fe){for(const ve of se)ms(ve,V,j,W,te,fe,!1)}function Nr(se,V,j,W){se.push(V,j,W)}function Oo(se,V,j,W,te,fe){const ve=(fe-V)/(W-V);return Nr(se,fe,j+(te-j)*ve,1),ve}function Fo(se,V,j,W,te,fe){const ve=(fe-j)/(te-j);return Nr(se,V+(W-V)*ve,fe,1),ve}function Qe(se,V){const j=[];for(let W=0;W<se.length;W++){const te=se[W],fe=te.type;let ve;if(fe==="Point"||fe==="MultiPoint"||fe==="LineString")ve=gs(te.geometry,V);else if(fe==="MultiLineString"||fe==="Polygon"){ve=[];for(const Se of te.geometry)ve.push(gs(Se,V))}else if(fe==="MultiPolygon"){ve=[];for(const Se of te.geometry){const he=[];for(const Be of Se)he.push(gs(Be,V));ve.push(he)}}j.push(wr(te.id,fe,ve,te.tags))}return j}function gs(se,V){const j=[];j.size=se.size,se.start!==void 0&&(j.start=se.start,j.end=se.end);for(let W=0;W<se.length;W+=3)j.push(se[W]+V,se[W+1],se[W+2]);return j}function Tn(se,V){if(se.transformed)return se;const j=1<<se.z,W=se.x,te=se.y;for(const fe of se.features){const ve=fe.geometry,Se=fe.type;if(fe.geometry=[],Se===1)for(let he=0;he<ve.length;he+=2)fe.geometry.push(ur(ve[he],ve[he+1],V,j,W,te));else for(let he=0;he<ve.length;he++){const Be=[];for(let Ze=0;Ze<ve[he].length;Ze+=2)Be.push(ur(ve[he][Ze],ve[he][Ze+1],V,j,W,te));fe.geometry.push(Be)}}return se.transformed=!0,se}function ur(se,V,j,W,te,fe){return[Math.round(j*(se*W-te)),Math.round(j*(V*W-fe))]}function No(se,V,j,W,te){const fe=V===te.maxZoom?0:te.tolerance/((1<<V)*te.extent),ve={features:[],numPoints:0,numSimplified:0,numFeatures:se.length,source:null,x:j,y:W,z:V,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Se of se)ot(ve,Se,fe,te);return ve}function ot(se,V,j,W){const te=V.geometry,fe=V.type,ve=[];if(se.minX=Math.min(se.minX,V.minX),se.minY=Math.min(se.minY,V.minY),se.maxX=Math.max(se.maxX,V.maxX),se.maxY=Math.max(se.maxY,V.maxY),fe==="Point"||fe==="MultiPoint")for(let Se=0;Se<te.length;Se+=3)ve.push(te[Se],te[Se+1]),se.numPoints++,se.numSimplified++;else if(fe==="LineString")ri(ve,te,se,j,!1,!1);else if(fe==="MultiLineString"||fe==="Polygon")for(let Se=0;Se<te.length;Se++)ri(ve,te[Se],se,j,fe==="Polygon",Se===0);else if(fe==="MultiPolygon")for(let Se=0;Se<te.length;Se++){const he=te[Se];for(let Be=0;Be<he.length;Be++)ri(ve,he[Be],se,j,!0,Be===0)}if(ve.length){let Se=V.tags||null;if(fe==="LineString"&&W.lineMetrics){Se={};for(const Be in V.tags)Se[Be]=V.tags[Be];Se.mapbox_clip_start=te.start/te.size,Se.mapbox_clip_end=te.end/te.size}const he={geometry:ve,type:fe==="Polygon"||fe==="MultiPolygon"?3:fe==="LineString"||fe==="MultiLineString"?2:1,tags:Se};V.id!==null&&(he.id=V.id),se.features.push(he)}}function ri(se,V,j,W,te,fe){const ve=W*W;if(W>0&&V.size<(te?ve:W))return void(j.numPoints+=V.length/3);const Se=[];for(let he=0;he<V.length;he+=3)(W===0||V[he+2]>ve)&&(j.numSimplified++,Se.push(V[he],V[he+1])),j.numPoints++;te&&function(he,Be){let Ze=0;for(let Ie=0,De=he.length,Pt=De-2;Ie<De;Pt=Ie,Ie+=2)Ze+=(he[Ie]-he[Pt])*(he[Ie+1]+he[Pt+1]);if(Ze>0===Be)for(let Ie=0,De=he.length;Ie<De/2;Ie+=2){const Pt=he[Ie],zt=he[Ie+1];he[Ie]=he[De-2-Ie],he[Ie+1]=he[De-1-Ie],he[De-2-Ie]=Pt,he[De-1-Ie]=zt}}(Se,fe),se.push(Se)}const Ut={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class tr{constructor(V,j){const W=(j=this.options=function(fe,ve){for(const Se in ve)fe[Se]=ve[Se];return fe}(Object.create(Ut),j)).debug;if(W&&console.time("preprocess data"),j.maxZoom<0||j.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(j.promoteId&&j.generateId)throw new Error("promoteId and generateId cannot be used together.");let te=function(fe,ve){const Se=[];if(fe.type==="FeatureCollection")for(let he=0;he<fe.features.length;he++)Vs(Se,fe.features[he],ve,he);else Vs(Se,fe.type==="Feature"?fe:{geometry:fe},ve);return Se}(V,j);this.tiles={},this.tileCoords=[],W&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",j.indexMaxZoom,j.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),te=function(fe,ve){const Se=ve.buffer/ve.extent;let he=fe;const Be=$i(fe,1,-1-Se,Se,0,-1,2,ve),Ze=$i(fe,1,1-Se,2+Se,0,-1,2,ve);return(Be||Ze)&&(he=$i(fe,1,-Se,1+Se,0,-1,2,ve)||[],Be&&(he=Qe(Be,1).concat(he)),Ze&&(he=he.concat(Qe(Ze,-1)))),he}(te,j),te.length&&this.splitTile(te,0,0,0),W&&(te.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(V,j,W,te,fe,ve,Se){const he=[V,j,W,te],Be=this.options,Ze=Be.debug;for(;he.length;){te=he.pop(),W=he.pop(),j=he.pop(),V=he.pop();const Ie=1<<j,De=$n(j,W,te);let Pt=this.tiles[De];if(!Pt&&(Ze>1&&console.time("creation"),Pt=this.tiles[De]=No(V,j,W,te,Be),this.tileCoords.push({z:j,x:W,y:te}),Ze)){Ze>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",j,W,te,Pt.numFeatures,Pt.numPoints,Pt.numSimplified),console.timeEnd("creation"));const En=`z${j}`;this.stats[En]=(this.stats[En]||0)+1,this.total++}if(Pt.source=V,fe==null){if(j===Be.indexMaxZoom||Pt.numPoints<=Be.indexMaxPoints)continue}else{if(j===Be.maxZoom||j===fe)continue;if(fe!=null){const En=fe-j;if(W!==ve>>En||te!==Se>>En)continue}}if(Pt.source=null,V.length===0)continue;Ze>1&&console.time("clipping");const zt=.5*Be.buffer/Be.extent,ki=.5-zt,ei=.5+zt,bi=1+zt;let si=null,Xi=null,rn=null,fi=null,Fi=$i(V,Ie,W-zt,W+ei,0,Pt.minX,Pt.maxX,Be),Ki=$i(V,Ie,W+ki,W+bi,0,Pt.minX,Pt.maxX,Be);V=null,Fi&&(si=$i(Fi,Ie,te-zt,te+ei,1,Pt.minY,Pt.maxY,Be),Xi=$i(Fi,Ie,te+ki,te+bi,1,Pt.minY,Pt.maxY,Be),Fi=null),Ki&&(rn=$i(Ki,Ie,te-zt,te+ei,1,Pt.minY,Pt.maxY,Be),fi=$i(Ki,Ie,te+ki,te+bi,1,Pt.minY,Pt.maxY,Be),Ki=null),Ze>1&&console.timeEnd("clipping"),he.push(si||[],j+1,2*W,2*te),he.push(Xi||[],j+1,2*W,2*te+1),he.push(rn||[],j+1,2*W+1,2*te),he.push(fi||[],j+1,2*W+1,2*te+1)}}getTile(V,j,W){V=+V,j=+j,W=+W;const te=this.options,{extent:fe,debug:ve}=te;if(V<0||V>24)return null;const Se=1<<V,he=$n(V,j=j+Se&Se-1,W);if(this.tiles[he])return Tn(this.tiles[he],fe);ve>1&&console.log("drilling down to z%d-%d-%d",V,j,W);let Be,Ze=V,Ie=j,De=W;for(;!Be&&Ze>0;)Ze--,Ie>>=1,De>>=1,Be=this.tiles[$n(Ze,Ie,De)];return Be&&Be.source?(ve>1&&(console.log("found parent tile z%d-%d-%d",Ze,Ie,De),console.time("drilling down")),this.splitTile(Be.source,Ze,Ie,De,V,j,W),ve>1&&console.timeEnd("drilling down"),this.tiles[he]?Tn(this.tiles[he],fe):null):null}}function $n(se,V,j){return 32*((1<<se)*j+V)+se}function Wt(se,V){return V?se.properties[V]:se.id}function Jr(se,V){if(se==null)return!0;if(se.type==="Feature")return Wt(se,V)!=null;if(se.type==="FeatureCollection"){const j=new Set;for(const W of se.features){const te=Wt(W,V);if(te==null||j.has(te))return!1;j.add(te)}return!0}return!1}function Yr(se,V){const j=new Map;if(se!=null)if(se.type==="Feature")j.set(Wt(se,V),se);else for(const W of se.features)j.set(Wt(W,V),W);return j}class br extends xe{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(V,j){return O._(this,void 0,void 0,function*(){const W=V.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const te=this._geoJSONIndex.getTile(W.z,W.x,W.y);if(!te)return null;const fe=new class{constructor(Se){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=O.X,this.length=Se.length,this._features=Se}feature(Se){return new class{constructor(he){this._feature=he,this.extent=O.X,this.type=he.type,this.properties=he.tags,"id"in he&&!isNaN(he.id)&&(this.id=parseInt(he.id,10))}loadGeometry(){if(this._feature.type===1){const he=[];for(const Be of this._feature.geometry)he.push([new O.P(Be[0],Be[1])]);return he}{const he=[];for(const Be of this._feature.geometry){const Ze=[];for(const Ie of Be)Ze.push(new O.P(Ie[0],Ie[1]));he.push(Ze)}return he}}toGeoJSON(he,Be,Ze){return Je.call(this,he,Be,Ze)}}(this._features[Se])}}(te.features);let ve=Ei(fe);return ve.byteOffset===0&&ve.byteLength===ve.buffer.byteLength||(ve=new Uint8Array(ve)),{vectorTile:fe,rawData:ve.buffer}})}loadData(V){return O._(this,void 0,void 0,function*(){var j;(j=this._pendingRequest)===null||j===void 0||j.abort();const W=!!(V&&V.request&&V.request.collectResourceTiming)&&new O.bv(V.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(V,this._pendingRequest),this._geoJSONIndex=V.cluster?new It(function({superclusterOptions:ve,clusterProperties:Se}){if(!Se||!ve)return ve;const he={},Be={},Ze={accumulated:null,zoom:0},Ie={properties:null},De=Object.keys(Se);for(const Pt of De){const[zt,ki]=Se[Pt],ei=O.bC(ki),bi=O.bC(typeof zt=="string"?[zt,["accumulated"],["get",Pt]]:zt);he[Pt]=ei.value,Be[Pt]=bi.value}return ve.map=Pt=>{Ie.properties=Pt;const zt={};for(const ki of De)zt[ki]=he[ki].evaluate(Ze,Ie);return zt},ve.reduce=(Pt,zt)=>{Ie.properties=zt;for(const ki of De)Ze.accumulated=Pt[ki],Pt[ki]=Be[ki].evaluate(Ze,Ie)},ve}(V)).load((yield this._pendingData).features):(te=yield this._pendingData,new tr(te,V.geojsonVtOptions)),this.loaded={};const fe={};if(W){const ve=W.finish();ve&&(fe.resourceTiming={},fe.resourceTiming[V.source]=JSON.parse(JSON.stringify(ve)))}return fe}catch(fe){if(delete this._pendingRequest,O.bB(fe))return{abandoned:!0};throw fe}var te})}getData(){return O._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(V){const j=this.loaded;return j&&j[V.uid]?super.reloadTile(V):this.loadTile(V)}loadAndProcessGeoJSON(V,j){return O._(this,void 0,void 0,function*(){let W=yield this.loadGeoJSON(V,j);if(delete this._pendingRequest,typeof W!="object")throw new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`);if(Ue(W,!0),V.filter){const te=O.bC(V.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(te.result==="error")throw new Error(te.value.map(ve=>`${ve.key}: ${ve.message}`).join(", "));W={type:"FeatureCollection",features:W.features.filter(ve=>te.value.evaluate({zoom:0},ve))}}return W})}loadGeoJSON(V,j){return O._(this,void 0,void 0,function*(){const{promoteId:W}=V;if(V.request){const te=yield O.h(V.request,j);return this._dataUpdateable=Jr(te.data,W)?Yr(te.data,W):void 0,te.data}if(typeof V.data=="string")try{const te=JSON.parse(V.data);return this._dataUpdateable=Jr(te,W)?Yr(te,W):void 0,te}catch{throw new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`)}if(!V.dataDiff)throw new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${V.source}`);return function(te,fe,ve){var Se,he,Be,Ze;if(fe.removeAll&&te.clear(),fe.remove)for(const Ie of fe.remove)te.delete(Ie);if(fe.add)for(const Ie of fe.add){const De=Wt(Ie,ve);De!=null&&te.set(De,Ie)}if(fe.update)for(const Ie of fe.update){let De=te.get(Ie.id);if(De==null)continue;const Pt=!Ie.removeAllProperties&&(((Se=Ie.removeProperties)===null||Se===void 0?void 0:Se.length)>0||((he=Ie.addOrUpdateProperties)===null||he===void 0?void 0:he.length)>0);if((Ie.newGeometry||Ie.removeAllProperties||Pt)&&(De=Object.assign({},De),te.set(Ie.id,De),Pt&&(De.properties=Object.assign({},De.properties))),Ie.newGeometry&&(De.geometry=Ie.newGeometry),Ie.removeAllProperties)De.properties={};else if(((Be=Ie.removeProperties)===null||Be===void 0?void 0:Be.length)>0)for(const zt of Ie.removeProperties)Object.prototype.hasOwnProperty.call(De.properties,zt)&&delete De.properties[zt];if(((Ze=Ie.addOrUpdateProperties)===null||Ze===void 0?void 0:Ze.length)>0)for(const{key:zt,value:ki}of Ie.addOrUpdateProperties)De.properties[zt]=ki}}(this._dataUpdateable,V.dataDiff,W),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(V){return O._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(V){return this._geoJSONIndex.getClusterExpansionZoom(V.clusterId)}getClusterChildren(V){return this._geoJSONIndex.getChildren(V.clusterId)}getClusterLeaves(V){return this._geoJSONIndex.getLeaves(V.clusterId,V.limit,V.offset)}}class ir{constructor(V){this.self=V,this.actor=new O.F(V),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(j,W)=>{if(this.externalWorkerSourceTypes[j])throw new Error(`Worker source with name "${j}" already registered.`);this.externalWorkerSourceTypes[j]=W},this.self.addProtocol=O.bi,this.self.removeProtocol=O.bj,this.self.registerRTLTextPlugin=j=>{if(O.bD.isParsed())throw new Error("RTL text plugin already registered.");O.bD.setMethods(j)},this.actor.registerMessageHandler("LDT",(j,W)=>this._getDEMWorkerSource(j,W.source).loadTile(W)),this.actor.registerMessageHandler("RDT",(j,W)=>O._(this,void 0,void 0,function*(){this._getDEMWorkerSource(j,W.source).removeTile(W)})),this.actor.registerMessageHandler("GCEZ",(j,W)=>O._(this,void 0,void 0,function*(){return this._getWorkerSource(j,W.type,W.source).getClusterExpansionZoom(W)})),this.actor.registerMessageHandler("GCC",(j,W)=>O._(this,void 0,void 0,function*(){return this._getWorkerSource(j,W.type,W.source).getClusterChildren(W)})),this.actor.registerMessageHandler("GCL",(j,W)=>O._(this,void 0,void 0,function*(){return this._getWorkerSource(j,W.type,W.source).getClusterLeaves(W)})),this.actor.registerMessageHandler("LD",(j,W)=>this._getWorkerSource(j,W.type,W.source).loadData(W)),this.actor.registerMessageHandler("GD",(j,W)=>this._getWorkerSource(j,W.type,W.source).getData()),this.actor.registerMessageHandler("LT",(j,W)=>this._getWorkerSource(j,W.type,W.source).loadTile(W)),this.actor.registerMessageHandler("RT",(j,W)=>this._getWorkerSource(j,W.type,W.source).reloadTile(W)),this.actor.registerMessageHandler("AT",(j,W)=>this._getWorkerSource(j,W.type,W.source).abortTile(W)),this.actor.registerMessageHandler("RMT",(j,W)=>this._getWorkerSource(j,W.type,W.source).removeTile(W)),this.actor.registerMessageHandler("RS",(j,W)=>O._(this,void 0,void 0,function*(){if(!this.workerSources[j]||!this.workerSources[j][W.type]||!this.workerSources[j][W.type][W.source])return;const te=this.workerSources[j][W.type][W.source];delete this.workerSources[j][W.type][W.source],te.removeSource!==void 0&&te.removeSource(W)})),this.actor.registerMessageHandler("RM",j=>O._(this,void 0,void 0,function*(){delete this.layerIndexes[j],delete this.availableImages[j],delete this.workerSources[j],delete this.demWorkerSources[j]})),this.actor.registerMessageHandler("SR",(j,W)=>O._(this,void 0,void 0,function*(){this.referrer=W})),this.actor.registerMessageHandler("SRPS",(j,W)=>this._syncRTLPluginState(j,W)),this.actor.registerMessageHandler("IS",(j,W)=>O._(this,void 0,void 0,function*(){this.self.importScripts(W)})),this.actor.registerMessageHandler("SI",(j,W)=>this._setImages(j,W)),this.actor.registerMessageHandler("UL",(j,W)=>O._(this,void 0,void 0,function*(){this._getLayerIndex(j).update(W.layers,W.removedIds)})),this.actor.registerMessageHandler("SL",(j,W)=>O._(this,void 0,void 0,function*(){this._getLayerIndex(j).replace(W)}))}_setImages(V,j){return O._(this,void 0,void 0,function*(){this.availableImages[V]=j;for(const W in this.workerSources[V]){const te=this.workerSources[V][W];for(const fe in te)te[fe].availableImages=j}})}_syncRTLPluginState(V,j){return O._(this,void 0,void 0,function*(){if(O.bD.isParsed())return O.bD.getState();if(j.pluginStatus!=="loading")return O.bD.setState(j),j;const W=j.pluginURL;if(this.self.importScripts(W),O.bD.isParsed()){const te={pluginStatus:"loaded",pluginURL:W};return O.bD.setState(te),te}throw O.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${W}`)})}_getAvailableImages(V){let j=this.availableImages[V];return j||(j=[]),j}_getLayerIndex(V){let j=this.layerIndexes[V];return j||(j=this.layerIndexes[V]=new g),j}_getWorkerSource(V,j,W){if(this.workerSources[V]||(this.workerSources[V]={}),this.workerSources[V][j]||(this.workerSources[V][j]={}),!this.workerSources[V][j][W]){const te={sendAsync:(fe,ve)=>(fe.targetMapId=V,this.actor.sendAsync(fe,ve))};switch(j){case"vector":this.workerSources[V][j][W]=new xe(te,this._getLayerIndex(V),this._getAvailableImages(V));break;case"geojson":this.workerSources[V][j][W]=new br(te,this._getLayerIndex(V),this._getAvailableImages(V));break;default:this.workerSources[V][j][W]=new this.externalWorkerSourceTypes[j](te,this._getLayerIndex(V),this._getAvailableImages(V))}}return this.workerSources[V][j][W]}_getDEMWorkerSource(V,j){return this.demWorkerSources[V]||(this.demWorkerSources[V]={}),this.demWorkerSources[V][j]||(this.demWorkerSources[V][j]=new me),this.demWorkerSources[V][j]}}return O.i(self)&&(self.worker=new ir(self)),ir}),ce("index",["exports","./shared"],function(O,g){var ze="4.7.1";let nt,tt;const xe={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:m=>new Promise((e,o)=>{const u=requestAnimationFrame(e);m.signal.addEventListener("abort",()=>{cancelAnimationFrame(u),o(g.c())})}),getImageData(m,e=0){return this.getImageCanvasContext(m).getImageData(-e,-e,m.width+2*e,m.height+2*e)},getImageCanvasContext(m){const e=window.document.createElement("canvas"),o=e.getContext("2d",{willReadFrequently:!0});if(!o)throw new Error("failed to create canvas 2d context");return e.width=m.width,e.height=m.height,o.drawImage(m,0,0,m.width,m.height),o},resolveURL:m=>(nt||(nt=document.createElement("a")),nt.href=m,nt.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(tt==null&&(tt=matchMedia("(prefers-reduced-motion: reduce)")),tt.matches)}};class me{static testProp(e){if(!me.docStyle)return e[0];for(let o=0;o<e.length;o++)if(e[o]in me.docStyle)return e[o];return e[0]}static create(e,o,u){const c=window.document.createElement(e);return o!==void 0&&(c.className=o),u&&u.appendChild(c),c}static createNS(e,o){return window.document.createElementNS(e,o)}static disableDrag(){me.docStyle&&me.selectProp&&(me.userSelect=me.docStyle[me.selectProp],me.docStyle[me.selectProp]="none")}static enableDrag(){me.docStyle&&me.selectProp&&(me.docStyle[me.selectProp]=me.userSelect)}static setTransform(e,o){e.style[me.transformProp]=o}static addEventListener(e,o,u,c={}){e.addEventListener(o,u,"passive"in c?c:c.capture)}static removeEventListener(e,o,u,c={}){e.removeEventListener(o,u,"passive"in c?c:c.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",me.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",me.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",me.suppressClickInternal,!0)},0)}static getScale(e){const o=e.getBoundingClientRect();return{x:o.width/e.offsetWidth||1,y:o.height/e.offsetHeight||1,boundingClientRect:o}}static getPoint(e,o,u){const c=o.boundingClientRect;return new g.P((u.clientX-c.left)/o.x-e.clientLeft,(u.clientY-c.top)/o.y-e.clientTop)}static mousePos(e,o){const u=me.getScale(e);return me.getPoint(e,u,o)}static touchPos(e,o){const u=[],c=me.getScale(e);for(let p=0;p<o.length;p++)u.push(me.getPoint(e,c,o[p]));return u}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}}me.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,me.selectProp=me.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),me.transformProp=me.testProp(["transform","WebkitTransform"]);const Ot={supported:!1,testSupport:function(m){!Je&&Ue&&($t?Qt(m):st=m)}};let st,Ue,Je=!1,$t=!1;function Qt(m){const e=m.createTexture();m.bindTexture(m.TEXTURE_2D,e);try{if(m.texImage2D(m.TEXTURE_2D,0,m.RGBA,m.RGBA,m.UNSIGNED_BYTE,Ue),m.isContextLost())return;Ot.supported=!0}catch{}m.deleteTexture(e),Je=!0}var Mt;typeof document<"u"&&(Ue=document.createElement("img"),Ue.onload=()=>{st&&Qt(st),st=null,$t=!0},Ue.onerror=()=>{Je=!0,st=null},Ue.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(m){let e,o,u,c;m.resetRequestQueue=()=>{e=[],o=0,u=0,c={}},m.addThrottleControl=C=>{const M=u++;return c[M]=C,M},m.removeThrottleControl=C=>{delete c[C],b()},m.getImage=(C,M,R=!0)=>new Promise((B,$)=>{Ot.supported&&(C.headers||(C.headers={}),C.headers.accept="image/webp,*/*"),g.e(C,{type:"image"}),e.push({abortController:M,requestParameters:C,supportImageRefresh:R,state:"queued",onError:X=>{$(X)},onSuccess:X=>{B(X)}}),b()});const p=C=>g._(this,void 0,void 0,function*(){C.state="running";const{requestParameters:M,supportImageRefresh:R,onError:B,onSuccess:$,abortController:X}=C,Y=R===!1&&!g.i(self)&&!g.g(M.url)&&(!M.headers||Object.keys(M.headers).reduce((oe,de)=>oe&&de==="accept",!0));o++;const Q=Y?T(M,X):g.m(M,X);try{const oe=yield Q;delete C.abortController,C.state="completed",oe.data instanceof HTMLImageElement||g.b(oe.data)?$(oe):oe.data&&$({data:yield(ie=oe.data,typeof createImageBitmap=="function"?g.d(ie):g.f(ie)),cacheControl:oe.cacheControl,expires:oe.expires})}catch(oe){delete C.abortController,B(oe)}finally{o--,b()}var ie}),b=()=>{const C=(()=>{for(const M of Object.keys(c))if(c[M]())return!0;return!1})()?g.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:g.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let M=o;M<C&&e.length>0;M++){const R=e.shift();R.abortController.signal.aborted?M--:p(R)}},T=(C,M)=>new Promise((R,B)=>{const $=new Image,X=C.url,Y=C.credentials;Y&&Y==="include"?$.crossOrigin="use-credentials":(Y&&Y==="same-origin"||!g.s(X))&&($.crossOrigin="anonymous"),M.signal.addEventListener("abort",()=>{$.src="",B(g.c())}),$.fetchPriority="high",$.onload=()=>{$.onerror=$.onload=null,R({data:$})},$.onerror=()=>{$.onerror=$.onload=null,M.signal.aborted||B(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},$.src=X})}(Mt||(Mt={})),Mt.resetRequestQueue();class hi{constructor(e){this._transformRequestFn=e}transformRequest(e,o){return this._transformRequestFn&&this._transformRequestFn(e,o)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function li(m){var e=new g.A(3);return e[0]=m[0],e[1]=m[1],e[2]=m[2],e}var Ii,_i=function(m,e,o){return m[0]=e[0]-o[0],m[1]=e[1]-o[1],m[2]=e[2]-o[2],m};Ii=new g.A(3),g.A!=Float32Array&&(Ii[0]=0,Ii[1]=0,Ii[2]=0);var nn=function(m){var e=m[0],o=m[1];return e*e+o*o};function an(m){const e=[];if(typeof m=="string")e.push({id:"default",url:m});else if(m&&m.length>0){const o=[];for(const{id:u,url:c}of m){const p=`${u}${c}`;o.indexOf(p)===-1&&(o.push(p),e.push({id:u,url:c}))}}return e}function Zn(m,e,o){const u=m.split("?");return u[0]+=`${e}${o}`,u.join("?")}(function(){var m=new g.A(2);g.A!=Float32Array&&(m[0]=0,m[1]=0)})();class qt{constructor(e,o,u,c){this.context=e,this.format=u,this.texture=e.gl.createTexture(),this.update(o,c)}update(e,o,u){const{width:c,height:p}=e,b=!(this.size&&this.size[0]===c&&this.size[1]===p||u),{context:T}=this,{gl:C}=T;if(this.useMipmap=!!(o&&o.useMipmap),C.bindTexture(C.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===C.RGBA&&(!o||o.premultiply!==!1)),b)this.size=[c,p],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||g.b(e)?C.texImage2D(C.TEXTURE_2D,0,this.format,this.format,C.UNSIGNED_BYTE,e):C.texImage2D(C.TEXTURE_2D,0,this.format,c,p,0,this.format,C.UNSIGNED_BYTE,e.data);else{const{x:M,y:R}=u||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||g.b(e)?C.texSubImage2D(C.TEXTURE_2D,0,M,R,C.RGBA,C.UNSIGNED_BYTE,e):C.texSubImage2D(C.TEXTURE_2D,0,M,R,c,p,C.RGBA,C.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&C.generateMipmap(C.TEXTURE_2D)}bind(e,o,u){const{context:c}=this,{gl:p}=c;p.bindTexture(p.TEXTURE_2D,this.texture),u!==p.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=p.LINEAR),e!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,e),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,u||e),this.filter=e),o!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,o),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function Hi(m){const{userImage:e}=m;return!!(e&&e.render&&e.render())&&(m.data.replace(new Uint8Array(e.data.buffer)),!0)}class Di extends g.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new g.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:o,promiseResolve:u}of this.requestors)u(this._getImagesForIds(o));this.requestors=[]}}getImage(e){const o=this.images[e];if(o&&!o.data&&o.spriteData){const u=o.spriteData;o.data=new g.R({width:u.width,height:u.height},u.context.getImageData(u.x,u.y,u.width,u.height).data),o.spriteData=null}return o}addImage(e,o){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,o)&&(this.images[e]=o)}_validate(e,o){let u=!0;const c=o.data||o.spriteData;return this._validateStretch(o.stretchX,c&&c.width)||(this.fire(new g.j(new Error(`Image "${e}" has invalid "stretchX" value`))),u=!1),this._validateStretch(o.stretchY,c&&c.height)||(this.fire(new g.j(new Error(`Image "${e}" has invalid "stretchY" value`))),u=!1),this._validateContent(o.content,o)||(this.fire(new g.j(new Error(`Image "${e}" has invalid "content" value`))),u=!1),u}_validateStretch(e,o){if(!e)return!0;let u=0;for(const c of e){if(c[0]<u||c[1]<c[0]||o<c[1])return!1;u=c[1]}return!0}_validateContent(e,o){if(!e)return!0;if(e.length!==4)return!1;const u=o.spriteData,c=u&&u.width||o.data.width,p=u&&u.height||o.data.height;return!(e[0]<0||c<e[0]||e[1]<0||p<e[1]||e[2]<0||c<e[2]||e[3]<0||p<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,o,u=!0){const c=this.getImage(e);if(u&&(c.data.width!==o.data.width||c.data.height!==o.data.height))throw new Error(`size mismatch between old image (${c.data.width}x${c.data.height}) and new image (${o.data.width}x${o.data.height}).`);o.version=c.version+1,this.images[e]=o,this.updatedImages[e]=!0}removeImage(e){const o=this.images[e];delete this.images[e],delete this.patterns[e],o.userImage&&o.userImage.onRemove&&o.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((o,u)=>{let c=!0;if(!this.isLoaded())for(const p of e)this.images[p]||(c=!1);this.isLoaded()||c?o(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:o})})}_getImagesForIds(e){const o={};for(const u of e){let c=this.getImage(u);c||(this.fire(new g.k("styleimagemissing",{id:u})),c=this.getImage(u)),c?o[u]={data:c.data.clone(),pixelRatio:c.pixelRatio,sdf:c.sdf,version:c.version,stretchX:c.stretchX,stretchY:c.stretchY,content:c.content,textFitWidth:c.textFitWidth,textFitHeight:c.textFitHeight,hasRenderCallback:!!(c.userImage&&c.userImage.render)}:g.w(`Image "${u}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return o}getPixelSize(){const{width:e,height:o}=this.atlasImage;return{width:e,height:o}}getPattern(e){const o=this.patterns[e],u=this.getImage(e);if(!u)return null;if(o&&o.position.version===u.version)return o.position;if(o)o.position.version=u.version;else{const c={w:u.data.width+2,h:u.data.height+2,x:0,y:0},p=new g.I(c,u);this.patterns[e]={bin:c,position:p}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const o=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new qt(e,this.atlasImage,o.RGBA),this.atlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const p in this.patterns)e.push(this.patterns[p].bin);const{w:o,h:u}=g.p(e),c=this.atlasImage;c.resize({width:o||1,height:u||1});for(const p in this.patterns){const{bin:b}=this.patterns[p],T=b.x+1,C=b.y+1,M=this.getImage(p).data,R=M.width,B=M.height;g.R.copy(M,c,{x:0,y:0},{x:T,y:C},{width:R,height:B}),g.R.copy(M,c,{x:0,y:B-1},{x:T,y:C-1},{width:R,height:1}),g.R.copy(M,c,{x:0,y:0},{x:T,y:C+B},{width:R,height:1}),g.R.copy(M,c,{x:R-1,y:0},{x:T-1,y:C},{width:1,height:B}),g.R.copy(M,c,{x:0,y:0},{x:T+R,y:C},{width:1,height:B})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const o of e){if(this.callbackDispatchedThisFrame[o])continue;this.callbackDispatchedThisFrame[o]=!0;const u=this.getImage(o);u||g.w(`Image with ID: "${o}" was not found`),Hi(u)&&this.updateImage(o,u)}}}const xi=1e20;function Bn(m,e,o,u,c,p,b,T,C){for(let M=e;M<e+u;M++)Bi(m,o*p+M,p,c,b,T,C);for(let M=o;M<o+c;M++)Bi(m,M*p+e,1,u,b,T,C)}function Bi(m,e,o,u,c,p,b){p[0]=0,b[0]=-xi,b[1]=xi,c[0]=m[e];for(let T=1,C=0,M=0;T<u;T++){c[T]=m[e+T*o];const R=T*T;do{const B=p[C];M=(c[T]-c[B]+R-B*B)/(T-B)/2}while(M<=b[C]&&--C>-1);C++,p[C]=T,b[C]=M,b[C+1]=xi}for(let T=0,C=0;T<u;T++){for(;b[C+1]<T;)C++;const M=p[C],R=T-M;m[e+T*o]=c[M]+R*R}}class Ei{constructor(e,o){this.requestManager=e,this.localIdeographFontFamily=o,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return g._(this,void 0,void 0,function*(){const o=[];for(const p in e)for(const b of e[p])o.push(this._getAndCacheGlyphsPromise(p,b));const u=yield Promise.all(o),c={};for(const{stack:p,id:b,glyph:T}of u)c[p]||(c[p]={}),c[p][b]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics};return c})}_getAndCacheGlyphsPromise(e,o){return g._(this,void 0,void 0,function*(){let u=this.entries[e];u||(u=this.entries[e]={glyphs:{},requests:{},ranges:{}});let c=u.glyphs[o];if(c!==void 0)return{stack:e,id:o,glyph:c};if(c=this._tinySDF(u,e,o),c)return u.glyphs[o]=c,{stack:e,id:o,glyph:c};const p=Math.floor(o/256);if(256*p>65535)throw new Error("glyphs > 65535 not supported");if(u.ranges[p])return{stack:e,id:o,glyph:c};if(!this.url)throw new Error("glyphsUrl is not set");if(!u.requests[p]){const T=Ei.loadGlyphRange(e,p,this.url,this.requestManager);u.requests[p]=T}const b=yield u.requests[p];for(const T in b)this._doesCharSupportLocalGlyph(+T)||(u.glyphs[+T]=b[+T]);return u.ranges[p]=!0,{stack:e,id:o,glyph:b[o]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))}_tinySDF(e,o,u){const c=this.localIdeographFontFamily;if(!c||!this._doesCharSupportLocalGlyph(u))return;let p=e.tinySDF;if(!p){let T="400";/bold/i.test(o)?T="900":/medium/i.test(o)?T="500":/light/i.test(o)&&(T="200"),p=e.tinySDF=new Ei.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:c,fontWeight:T})}const b=p.draw(String.fromCharCode(u));return{id:u,bitmap:new g.o({width:b.width||60,height:b.height||60},b.data),metrics:{width:b.glyphWidth/2||24,height:b.glyphHeight/2||24,left:b.glyphLeft/2+.5||0,top:b.glyphTop/2-27.5||-8,advance:b.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ei.loadGlyphRange=function(m,e,o,u){return g._(this,void 0,void 0,function*(){const c=256*e,p=c+255,b=u.transformRequest(o.replace("{fontstack}",m).replace("{range}",`${c}-${p}`),"Glyphs"),T=yield g.l(b,new AbortController);if(!T||!T.data)throw new Error(`Could not load glyph range. range: ${e}, ${c}-${p}`);const C={};for(const M of g.n(T.data))C[M.id]=M;return C})},Ei.TinySDF=class{constructor({fontSize:m=24,buffer:e=3,radius:o=8,cutoff:u=.25,fontFamily:c="sans-serif",fontWeight:p="normal",fontStyle:b="normal"}={}){this.buffer=e,this.cutoff=u,this.radius=o;const T=this.size=m+4*e,C=this._createCanvas(T),M=this.ctx=C.getContext("2d",{willReadFrequently:!0});M.font=`${b} ${p} ${m}px ${c}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(m){const e=document.createElement("canvas");return e.width=e.height=m,e}draw(m){const{width:e,actualBoundingBoxAscent:o,actualBoundingBoxDescent:u,actualBoundingBoxLeft:c,actualBoundingBoxRight:p}=this.ctx.measureText(m),b=Math.ceil(o),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(p-c))),C=Math.min(this.size-this.buffer,b+Math.ceil(u)),M=T+2*this.buffer,R=C+2*this.buffer,B=Math.max(M*R,0),$=new Uint8ClampedArray(B),X={data:$,width:M,height:R,glyphWidth:T,glyphHeight:C,glyphTop:b,glyphLeft:0,glyphAdvance:e};if(T===0||C===0)return X;const{ctx:Y,buffer:Q,gridInner:ie,gridOuter:oe}=this;Y.clearRect(Q,Q,T,C),Y.fillText(m,Q,Q+b);const de=Y.getImageData(Q,Q,T,C);oe.fill(xi,0,B),ie.fill(0,0,B);for(let ee=0;ee<C;ee++)for(let ye=0;ye<T;ye++){const be=de.data[4*(ee*T+ye)+3]/255;if(be===0)continue;const Ce=(ee+Q)*M+ye+Q;if(be===1)oe[Ce]=0,ie[Ce]=xi;else{const Ve=.5-be;oe[Ce]=Ve>0?Ve*Ve:0,ie[Ce]=Ve<0?Ve*Ve:0}}Bn(oe,0,0,M,R,M,this.f,this.v,this.z),Bn(ie,Q,Q,T,C,M,this.f,this.v,this.z);for(let ee=0;ee<B;ee++){const ye=Math.sqrt(oe[ee])-Math.sqrt(ie[ee]);$[ee]=Math.round(255-255*(ye/this.radius+this.cutoff))}return X}};class qe{constructor(){this.specification=g.v.light.position}possiblyEvaluate(e,o){return g.x(e.expression.evaluate(o))}interpolate(e,o,u){return{x:g.y.number(e.x,o.x,u),y:g.y.number(e.y,o.y,u),z:g.y.number(e.z,o.z,u)}}}let Nt;class He extends g.E{constructor(e){super(),Nt=Nt||new g.q({anchor:new g.D(g.v.light.anchor),position:new qe,color:new g.D(g.v.light.color),intensity:new g.D(g.v.light.intensity)}),this._transitionable=new g.T(Nt),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,o={}){if(!this._validate(g.r,e,o))for(const u in e){const c=e[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),c):this._transitionable.setValue(u,c)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,o,u){return(!u||u.validate!==!1)&&g.t(this,e.call(g.u,{value:o,style:{glyphs:!0,sprite:!0},styleSpec:g.v}))}}const ge=new g.q({"sky-color":new g.D(g.v.sky["sky-color"]),"horizon-color":new g.D(g.v.sky["horizon-color"]),"fog-color":new g.D(g.v.sky["fog-color"]),"fog-ground-blend":new g.D(g.v.sky["fog-ground-blend"]),"horizon-fog-blend":new g.D(g.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new g.D(g.v.sky["sky-horizon-blend"]),"atmosphere-blend":new g.D(g.v.sky["atmosphere-blend"])});class Ne extends g.E{constructor(e){super(),this._transitionable=new g.T(ge),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new g.z(0))}setSky(e,o={}){if(!this._validate(g.B,e,o)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const u in e){const c=e[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),c):this._transitionable.setValue(u,c)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,o,u={}){return u?.validate!==!1&&g.t(this,e.call(g.u,g.e({value:o,style:{glyphs:!0,sprite:!0},styleSpec:g.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class Ft{constructor(e,o){this.width=e,this.height=o,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,o){const u=e.join(",")+String(o);return this.dashEntry[u]||(this.dashEntry[u]=this.addDash(e,o)),this.dashEntry[u]}getDashRanges(e,o,u){const c=[];let p=e.length%2==1?-e[e.length-1]*u:0,b=e[0]*u,T=!0;c.push({left:p,right:b,isDash:T,zeroLength:e[0]===0});let C=e[0];for(let M=1;M<e.length;M++){T=!T;const R=e[M];p=C*u,C+=R,b=C*u,c.push({left:p,right:b,isDash:T,zeroLength:R===0})}return c}addRoundDash(e,o,u){const c=o/2;for(let p=-u;p<=u;p++){const b=this.width*(this.nextRow+u+p);let T=0,C=e[T];for(let M=0;M<this.width;M++){M/C.right>1&&(C=e[++T]);const R=Math.abs(M-C.left),B=Math.abs(M-C.right),$=Math.min(R,B);let X;const Y=p/u*(c+1);if(C.isDash){const Q=c-Math.abs(Y);X=Math.sqrt($*$+Q*Q)}else X=c-Math.sqrt($*$+Y*Y);this.data[b+M]=Math.max(0,Math.min(255,X+128))}}}addRegularDash(e){for(let T=e.length-1;T>=0;--T){const C=e[T],M=e[T+1];C.zeroLength?e.splice(T,1):M&&M.isDash===C.isDash&&(M.left=C.left,e.splice(T,1))}const o=e[0],u=e[e.length-1];o.isDash===u.isDash&&(o.left=u.left-this.width,u.right=o.right+this.width);const c=this.width*this.nextRow;let p=0,b=e[p];for(let T=0;T<this.width;T++){T/b.right>1&&(b=e[++p]);const C=Math.abs(T-b.left),M=Math.abs(T-b.right),R=Math.min(C,M);this.data[c+T]=Math.max(0,Math.min(255,(b.isDash?R:-R)+128))}}addDash(e,o){const u=o?7:0,c=2*u+1;if(this.nextRow+c>this.height)return g.w("LineAtlas out of space"),null;let p=0;for(let T=0;T<e.length;T++)p+=e[T];if(p!==0){const T=this.width/p,C=this.getDashRanges(e,this.width,T);o?this.addRoundDash(C,T,u):this.addRegularDash(C)}const b={y:(this.nextRow+u+.5)/this.height,height:2*u/this.height,width:p};return this.nextRow+=c,this.dirty=!0,b}bind(e){const o=e.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))}}const It="maplibre_preloaded_worker_pool";class Tt{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Tt.workerCount;)this.workers.push(new Worker(g.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[It]}numActive(){return Object.keys(this.active).length}}const wt=Math.floor(xe.hardwareConcurrency/2);let ii,ni;function Oi(){return ii||(ii=new Tt),ii}Tt.workerCount=g.C(globalThis)?Math.max(Math.min(wt,3),1):1;class wn{constructor(e,o){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=o;const u=this.workerPool.acquire(o);for(let c=0;c<u.length;c++){const p=new g.F(u[c],o);p.name=`Worker ${c}`,this.actors.push(p)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,o){const u=[];for(const c of this.actors)u.push(c.sendAsync({type:e,data:o}));return Promise.all(u)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(o=>{o.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,o){for(const u of this.actors)u.registerMessageHandler(e,o)}}function js(){return ni||(ni=new wn(Oi(),g.G),ni.registerMessageHandler("GR",(m,e,o)=>g.m(e,o))),ni}function wr(m,e){const o=g.H();return g.J(o,o,[1,1,0]),g.K(o,o,[.5*m.width,.5*m.height,1]),g.L(o,o,m.calculatePosMatrix(e.toUnwrapped()))}function Fr(m,e,o,u,c,p){const b=function(B,$,X){if(B)for(const Y of B){const Q=$[Y];if(Q&&Q.source===X&&Q.type==="fill-extrusion")return!0}else for(const Y in $){const Q=$[Y];if(Q.source===X&&Q.type==="fill-extrusion")return!0}return!1}(c&&c.layers,e,m.id),T=p.maxPitchScaleFactor(),C=m.tilesIn(u,T,b);C.sort(Vs);const M=[];for(const B of C)M.push({wrappedTileID:B.tileID.wrapped().key,queryResults:B.tile.queryRenderedFeatures(e,o,m._state,B.queryGeometry,B.cameraQueryGeometry,B.scale,c,p,T,wr(m.transform,B.tileID))});const R=function(B){const $={},X={};for(const Y of B){const Q=Y.queryResults,ie=Y.wrappedTileID,oe=X[ie]=X[ie]||{};for(const de in Q){const ee=Q[de],ye=oe[de]=oe[de]||{},be=$[de]=$[de]||[];for(const Ce of ee)ye[Ce.featureIndex]||(ye[Ce.featureIndex]=!0,be.push(Ce))}}return $}(M);for(const B in R)R[B].forEach($=>{const X=$.feature,Y=m.getFeatureState(X.layer["source-layer"],X.id);X.source=X.layer.source,X.layer["source-layer"]&&(X.sourceLayer=X.layer["source-layer"]),X.state=Y});return R}function Vs(m,e){const o=m.tileID,u=e.tileID;return o.overscaledZ-u.overscaledZ||o.canonical.y-u.canonical.y||o.wrap-u.wrap||o.canonical.x-u.canonical.x}function Bo(m,e,o){return g._(this,void 0,void 0,function*(){let u=m;if(m.url?u=(yield g.h(e.transformRequest(m.url,"Source"),o)).data:yield xe.frameAsync(o),!u)return null;const c=g.M(g.e(u,m),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in u&&u.vector_layers&&(c.vectorLayerIds=u.vector_layers.map(p=>p.id)),c})}class Le{constructor(e,o){e&&(o?this.setSouthWest(e).setNorthEast(o):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof g.N?new g.N(e.lng,e.lat):g.N.convert(e),this}setSouthWest(e){return this._sw=e instanceof g.N?new g.N(e.lng,e.lat):g.N.convert(e),this}extend(e){const o=this._sw,u=this._ne;let c,p;if(e instanceof g.N)c=e,p=e;else{if(!(e instanceof Le))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Le.convert(e)):this.extend(g.N.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(g.N.convert(e)):this;if(c=e._sw,p=e._ne,!c||!p)return this}return o||u?(o.lng=Math.min(c.lng,o.lng),o.lat=Math.min(c.lat,o.lat),u.lng=Math.max(p.lng,u.lng),u.lat=Math.max(p.lat,u.lat)):(this._sw=new g.N(c.lng,c.lat),this._ne=new g.N(p.lng,p.lat)),this}getCenter(){return new g.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new g.N(this.getWest(),this.getNorth())}getSouthEast(){return new g.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:o,lat:u}=g.N.convert(e);let c=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(c=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&c}static convert(e){return e instanceof Le?e:e&&new Le(e)}static fromLngLat(e,o=0){const u=360*o/40075017,c=u/Math.cos(Math.PI/180*e.lat);return new Le(new g.N(e.lng-c,e.lat-u),new g.N(e.lng+c,e.lat+u))}adjustAntiMeridian(){const e=new g.N(this._sw.lng,this._sw.lat),o=new g.N(this._ne.lng,this._ne.lat);return new Le(e,e.lng>o.lng?new g.N(o.lng+360,o.lat):o)}}class ps{constructor(e,o,u){this.bounds=Le.convert(this.validateBounds(e)),this.minzoom=o||0,this.maxzoom=u||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const o=Math.pow(2,e.z),u=Math.floor(g.O(this.bounds.getWest())*o),c=Math.floor(g.Q(this.bounds.getNorth())*o),p=Math.ceil(g.O(this.bounds.getEast())*o),b=Math.ceil(g.Q(this.bounds.getSouth())*o);return e.x>=u&&e.x<p&&e.y>=c&&e.y<b}}class uo extends g.E{constructor(e,o,u,c){if(super(),this.id=e,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,g.e(this,g.M(o,["url","scheme","tileSize","promoteId"])),this._options=g.e({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(c)}load(){return g._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new g.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield Bo(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(g.e(this,e),e.bounds&&(this.tileBounds=new ps(e.bounds,this.minzoom,this.maxzoom)),this.fire(new g.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new g.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new g.j(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return g.e({},this._options)}loadTile(e){return g._(this,void 0,void 0,function*(){const o=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u={request:this.map._requestManager.transformRequest(o,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};u.request.collectResourceTiming=this._collectResourceTiming;let c="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((p,b)=>{e.reloadPromise={resolve:p,reject:b}})}else e.actor=this.dispatcher.getActor(),c="LT";e.abortController=new AbortController;try{const p=yield e.actor.sendAsync({type:c,data:u},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,p)}catch(p){if(delete e.abortController,e.aborted)return;if(p&&p.status!==404)throw p;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,o){if(o&&o.resourceTiming&&(e.resourceTiming=o.resourceTiming),o&&this.map._refreshExpiredTiles&&e.setExpiryData(o),e.loadVectorData(o,this.map.painter),e.reloadPromise){const u=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(u.resolve).catch(u.reject)}}abortTile(e){return g._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return g._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Mi extends g.E{constructor(e,o,u,c){super(),this.id=e,this.dispatcher=u,this.setEventedParent(c),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=g.e({type:"raster"},o),g.e(this,g.M(o,["url","scheme","tileSize"]))}load(){return g._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new g.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield Bo(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,e&&(g.e(this,e),e.bounds&&(this.tileBounds=new ps(e.bounds,this.minzoom,this.maxzoom)),this.fire(new g.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new g.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new g.j(e))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return g.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return g._(this,void 0,void 0,function*(){const o=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const u=yield Mt.getImage(this.map._requestManager.transformRequest(o,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(u&&u.data){this.map._refreshExpiredTiles&&u.cacheControl&&u.expires&&e.setExpiryData({cacheControl:u.cacheControl,expires:u.expires});const c=this.map.painter.context,p=c.gl,b=u.data;e.texture=this.map.painter.getTileTexture(b.width),e.texture?e.texture.update(b,{useMipmap:!0}):(e.texture=new qt(c,b,p.RGBA,{useMipmap:!0}),e.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE,p.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(u){if(delete e.abortController,e.aborted)e.state="unloaded";else if(u)throw e.state="errored",u}})}abortTile(e){return g._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return g._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class $i extends Mi{constructor(e,o,u,c){super(e,o,u,c),this.type="raster-dem",this.maxzoom=22,this._options=g.e({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox",this.redFactor=o.redFactor,this.greenFactor=o.greenFactor,this.blueFactor=o.blueFactor,this.baseShift=o.baseShift}loadTile(e){return g._(this,void 0,void 0,function*(){const o=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u=this.map._requestManager.transformRequest(o,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const c=yield Mt.getImage(u,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(c&&c.data){const p=c.data;this.map._refreshExpiredTiles&&c.cacheControl&&c.expires&&e.setExpiryData({cacheControl:c.cacheControl,expires:c.expires});const b=g.b(p)&&g.U()?p:yield this.readImageNow(p),T={type:this.type,uid:e.uid,source:this.id,rawImageData:b,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const C=yield e.actor.sendAsync({type:"LDT",data:T});e.dem=C,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(c){if(delete e.abortController,e.aborted)e.state="unloaded";else if(c)throw e.state="errored",c}})}readImageNow(e){return g._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&g.V()){const o=e.width+2,u=e.height+2;try{return new g.R({width:o,height:u},yield g.W(e,-1,-1,o,u))}catch{}}return xe.getImageData(e,1)})}_getNeighboringTiles(e){const o=e.canonical,u=Math.pow(2,o.z),c=(o.x-1+u)%u,p=o.x===0?e.wrap-1:e.wrap,b=(o.x+1+u)%u,T=o.x+1===u?e.wrap+1:e.wrap,C={};return C[new g.S(e.overscaledZ,p,o.z,c,o.y).key]={backfilled:!1},C[new g.S(e.overscaledZ,T,o.z,b,o.y).key]={backfilled:!1},o.y>0&&(C[new g.S(e.overscaledZ,p,o.z,c,o.y-1).key]={backfilled:!1},C[new g.S(e.overscaledZ,e.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},C[new g.S(e.overscaledZ,T,o.z,b,o.y-1).key]={backfilled:!1}),o.y+1<u&&(C[new g.S(e.overscaledZ,p,o.z,c,o.y+1).key]={backfilled:!1},C[new g.S(e.overscaledZ,e.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},C[new g.S(e.overscaledZ,T,o.z,b,o.y+1).key]={backfilled:!1}),C}unloadTile(e){return g._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class Kr extends g.E{constructor(e,o,u,c){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=u.getActor(),this.setEventedParent(c),this._data=o.data,this._options=g.e({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const p=g.X/this.tileSize;o.clusterMaxZoom!==void 0&&this.maxzoom<=o.clusterMaxZoom&&g.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${o.clusterMaxZoom}".`),this.workerOptions=g.e({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*p,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*p,extent:g.X,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:g.X,radius:(o.clusterRadius||50)*p,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return g._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return g._(this,void 0,void 0,function*(){const e=g.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=e.clusterRadius),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,o,u){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:o,offset:u}})}_updateWorkerData(e){return g._(this,void 0,void 0,function*(){const o=g.e({type:this.type},this.workerOptions);e?o.dataDiff=e:typeof this._data=="string"?(o.request=this.map._requestManager.transformRequest(xe.resolveURL(this._data),"Source"),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new g.k("dataloading",{dataType:"source"}));try{const u=yield this.actor.sendAsync({type:"LD",data:o});if(this._pendingLoads--,this._removed||u.abandoned)return void this.fire(new g.k("dataabort",{dataType:"source"}));let c=null;u.resourceTiming&&u.resourceTiming[this.id]&&(c=u.resourceTiming[this.id].slice(0));const p={dataType:"source"};this._collectResourceTiming&&c&&c.length>0&&g.e(p,{resourceTiming:c}),this.fire(new g.k("data",Object.assign(Object.assign({},p),{sourceDataType:"metadata"}))),this.fire(new g.k("data",Object.assign(Object.assign({},p),{sourceDataType:"content"})))}catch(u){if(this._pendingLoads--,this._removed)return void this.fire(new g.k("dataabort",{dataType:"source"}));this.fire(new g.j(u))}})}loaded(){return this._pendingLoads===0}loadTile(e){return g._(this,void 0,void 0,function*(){const o=e.actor?"RT":"LT";e.actor=this.actor;const u={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};e.abortController=new AbortController;const c=yield this.actor.sendAsync({type:o,data:u},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(c,this.map.painter,o==="RT")})}abortTile(e){return g._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return g._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return g.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var ms=g.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class _s extends g.E{constructor(e,o,u,c){super(),this.id=e,this.dispatcher=u,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(c),this.options=o}load(e){return g._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new g.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const o=yield Mt.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,o&&o.data&&(this.image=o.data,e&&(this.coordinates=e),this._finishLoading())}catch(o){this._request=null,this._loaded=!0,this.fire(new g.j(o))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new g.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const o=e.map(g.Z.fromLngLat);this.tileID=function(c){let p=1/0,b=1/0,T=-1/0,C=-1/0;for(const $ of c)p=Math.min(p,$.x),b=Math.min(b,$.y),T=Math.max(T,$.x),C=Math.max(C,$.y);const M=Math.max(T-p,C-b),R=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),B=Math.pow(2,R);return new g.a1(R,Math.floor((p+T)/2*B),Math.floor((b+C)/2*B))}(o),this.minzoom=this.maxzoom=this.tileID.z;const u=o.map(c=>this.tileID.getTilePoint(c)._round());return this._boundsArray=new g.$,this._boundsArray.emplaceBack(u[0].x,u[0].y,0,0),this._boundsArray.emplaceBack(u[1].x,u[1].y,g.X,0),this._boundsArray.emplaceBack(u[3].x,u[3].y,0,g.X),this._boundsArray.emplaceBack(u[2].x,u[2].y,g.X,g.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new g.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,o=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,ms.members)),this.boundsSegments||(this.boundsSegments=g.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new qt(e,this.image,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let u=!1;for(const c in this.tiles){const p=this.tiles[c];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture,u=!0)}u&&this.fire(new g.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return g._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class ra extends _s{constructor(e,o,u,c){super(e,o,u,c),this.roundZoom=!0,this.type="video",this.options=o}load(){return g._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const o of e.urls)this.urls.push(this.map._requestManager.transformRequest(o,"Source").url);try{const o=yield g.a3(this.urls);if(this._loaded=!0,!o)return;this.video=o,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(o){this.fire(new g.j(o))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const o=this.video.seekable;e<o.start(0)||e>o.end(0)?this.fire(new g.j(new g.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,o=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,ms.members)),this.boundsSegments||(this.boundsSegments=g.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new qt(e,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let u=!1;for(const c in this.tiles){const p=this.tiles[c];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture,u=!0)}u&&this.fire(new g.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Nr extends _s{constructor(e,o,u,c){super(e,o,u,c),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(p=>!Array.isArray(p)||p.length!==2||p.some(b=>typeof b!="number"))||this.fire(new g.j(new g.a2(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new g.j(new g.a2(`sources.${e}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new g.j(new g.a2(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new g.j(new g.a2(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new g.j(new g.a2(`sources.${e}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){return g._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new g.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context,u=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,ms.members)),this.boundsSegments||(this.boundsSegments=g.a0.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new qt(o,this.canvas,u.RGBA,{premultiply:!0});let c=!1;for(const p in this.tiles){const b=this.tiles[p];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture,c=!0)}c&&this.fire(new g.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const Oo={},Fo=m=>{switch(m){case"geojson":return Kr;case"image":return _s;case"raster":return Mi;case"raster-dem":return $i;case"vector":return uo;case"video":return ra;case"canvas":return Nr}return Oo[m]},Qe="RTLPluginLoaded";class gs extends g.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=js()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(o=>{throw this.status="error",o})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return g._(this,arguments,void 0,function*(o,u=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=xe.resolveURL(o),!this.url)throw new Error(`requested url ${o} is invalid`);if(this.status==="unavailable"){if(!u)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return g._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new g.k(Qe))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Tn=null;function ur(){return Tn||(Tn=new gs),Tn}class No{constructor(e,o){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=g.a4(),this.uses=0,this.tileSize=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const o=e+this.timeAdded;o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,o,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(c,p){const b={};if(!p)return b;for(const T of c){const C=T.layerIds.map(M=>p.getLayer(M)).filter(Boolean);if(C.length!==0){T.layers=C,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map(M=>C.filter(R=>R.id===M)[0]));for(const M of C)b[M.id]=T}}return b}(e.buckets,o.style),this.hasSymbolBuckets=!1;for(const c in this.buckets){const p=this.buckets[c];if(p instanceof g.a6){if(this.hasSymbolBuckets=!0,!u)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const c in this.buckets){const p=this.buckets[c];if(p instanceof g.a6&&p.hasRTLText){this.hasRTLText=!0,ur().lazyLoad();break}}this.queryPadding=0;for(const c in this.buckets){const p=this.buckets[c];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(c).queryRadius(p))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new g.a5}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const u in this.buckets){const c=this.buckets[u];c.uploadPending()&&c.upload(e)}const o=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new qt(e,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new qt(e,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,o,u,c,p,b,T,C,M,R){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:c,cameraQueryGeometry:p,scale:b,tileSize:this.tileSize,pixelPosMatrix:R,transform:C,params:T,queryPadding:this.queryPadding*M},e,o,u):{}}querySourceFeatures(e,o){const u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;const c=u.loadVTLayers(),p=o&&o.sourceLayer?o.sourceLayer:"",b=c._geojsonTileLayer||c[p];if(!b)return;const T=g.a7(o&&o.filter),{z:C,x:M,y:R}=this.tileID.canonical,B={z:C,x:M,y:R};for(let $=0;$<b.length;$++){const X=b.feature($);if(T.needGeometry){const ie=g.a8(X,!0);if(!T.filter(new g.z(this.tileID.overscaledZ),ie,this.tileID.canonical))continue}else if(!T.filter(new g.z(this.tileID.overscaledZ),X))continue;const Y=u.getId(X,p),Q=new g.a9(X,C,M,R,Y);Q.tile=B,e.push(Q)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const o=this.expirationTime;if(e.cacheControl){const u=g.aa(e.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const u=Date.now();let c=!1;if(this.expirationTime>u)c=!1;else if(o)if(this.expirationTime<o)c=!0;else{const p=this.expirationTime-o;p?this.expirationTime=u+Math.max(p,3e4):c=!0}else c=!0;c?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const u=this.latestFeatureIndex.loadVTLayers();for(const c in this.buckets){if(!o.style.hasLayer(c))continue;const p=this.buckets[c],b=p.layers[0].sourceLayer||"_geojsonTileLayer",T=u[b],C=e[b];if(!T||!C||Object.keys(C).length===0)continue;p.update(C,T,this.imageAtlas&&this.imageAtlas.patternPositions||{});const M=o&&o.style&&o.style.getLayer(c);M&&(this.queryPadding=Math.max(this.queryPadding,M.queryRadius(p)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<xe.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=xe.now()+e}setDependencies(e,o){const u={};for(const c of o)u[c]=!0;this.dependencies[e]=u}hasDependency(e,o){for(const u of e){const c=this.dependencies[u];if(c){for(const p of o)if(c[p])return!0}}return!1}}class ot{constructor(e,o){this.max=e,this.onRemove=o,this.reset()}reset(){for(const e in this.data)for(const o of this.data[e])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(e,o,u){const c=e.wrapped().key;this.data[c]===void 0&&(this.data[c]=[]);const p={value:o,timeout:void 0};if(u!==void 0&&(p.timeout=setTimeout(()=>{this.remove(e,p)},u)),this.data[c].push(p),this.order.push(c),this.order.length>this.max){const b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const o=this.data[e].shift();return o.timeout&&clearTimeout(o.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),o.value}getByKey(e){const o=this.data[e];return o?o[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,o){if(!this.has(e))return this;const u=e.wrapped().key,c=o===void 0?0:this.data[u].indexOf(o),p=this.data[u][c];return this.data[u].splice(c,1),p.timeout&&clearTimeout(p.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(p.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(e){const o=[];for(const u in this.data)for(const c of this.data[u])e(c.value)||o.push(c);for(const u of o)this.remove(u.value.tileID,u)}}class ri{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,o,u){const c=String(o);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][c]=this.stateChanges[e][c]||{},g.e(this.stateChanges[e][c],u),this.deletedStates[e]===null){this.deletedStates[e]={};for(const p in this.state[e])p!==c&&(this.deletedStates[e][p]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][c]===null){this.deletedStates[e][c]={};for(const p in this.state[e][c])u[p]||(this.deletedStates[e][c][p]=null)}else for(const p in u)this.deletedStates[e]&&this.deletedStates[e][c]&&this.deletedStates[e][c][p]===null&&delete this.deletedStates[e][c][p]}removeFeatureState(e,o,u){if(this.deletedStates[e]===null)return;const c=String(o);if(this.deletedStates[e]=this.deletedStates[e]||{},u&&o!==void 0)this.deletedStates[e][c]!==null&&(this.deletedStates[e][c]=this.deletedStates[e][c]||{},this.deletedStates[e][c][u]=null);else if(o!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][c])for(u in this.deletedStates[e][c]={},this.stateChanges[e][c])this.deletedStates[e][c][u]=null;else this.deletedStates[e][c]=null;else this.deletedStates[e]=null}getState(e,o){const u=String(o),c=g.e({},(this.state[e]||{})[u],(this.stateChanges[e]||{})[u]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const p=this.deletedStates[e][o];if(p===null)return{};for(const b in p)delete c[b]}return c}initializeTileState(e,o){e.setFeatureState(this.state,o)}coalesceChanges(e,o){const u={};for(const c in this.stateChanges){this.state[c]=this.state[c]||{};const p={};for(const b in this.stateChanges[c])this.state[c][b]||(this.state[c][b]={}),g.e(this.state[c][b],this.stateChanges[c][b]),p[b]=this.state[c][b];u[c]=p}for(const c in this.deletedStates){this.state[c]=this.state[c]||{};const p={};if(this.deletedStates[c]===null)for(const b in this.state[c])p[b]={},this.state[c][b]={};else for(const b in this.deletedStates[c]){if(this.deletedStates[c][b]===null)this.state[c][b]={};else for(const T of Object.keys(this.deletedStates[c][b]))delete this.state[c][b][T];p[b]=this.state[c][b]}u[c]=u[c]||{},g.e(u[c],p)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(const c in e)e[c].setFeatureState(u,o)}}class Ut extends g.E{constructor(e,o,u){super(),this.id=e,this.dispatcher=u,this.on("data",c=>this._dataHandler(c)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((c,p,b,T)=>{const C=new(Fo(p.type))(c,p,b,T);if(C.id!==c)throw new Error(`Expected Source id to be ${c} instead of ${C.id}`);return C})(e,o,u,this),this._tiles={},this._cache=new ot(0,c=>this._unloadTile(c)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ri,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const o=this._tiles[e];if(o.state!=="loaded"&&o.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,o,u){return g._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,o,u)}catch(c){e.state="errored",c.status!==404?this._source.fire(new g.j(c,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new g.k("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const o in this._tiles){const u=this._tiles[o];u.upload(e),u.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(tr).map(e=>e.key)}getRenderableIds(e){const o=[];for(const u in this._tiles)this._isIdRenderable(u,e)&&o.push(this._tiles[u]);return e?o.sort((u,c)=>{const p=u.tileID,b=c.tileID,T=new g.P(p.canonical.x,p.canonical.y)._rotate(this.transform.angle),C=new g.P(b.canonical.x,b.canonical.y)._rotate(this.transform.angle);return p.overscaledZ-b.overscaledZ||C.y-T.y||C.x-T.x}).map(u=>u.tileID.key):o.map(u=>u.tileID).sort(tr).map(u=>u.key)}hasRenderableParent(e){const o=this.findLoadedParent(e,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(e,o){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(o||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(e,"reloading")}}_reloadTile(e,o){return g._(this,void 0,void 0,function*(){const u=this._tiles[e];u&&(u.state!=="loading"&&(u.state=o),yield this._loadTile(u,e,o))})}_tileLoaded(e,o,u){e.timeAdded=xe.now(),u==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(o,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new g.k("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const o=this.getRenderableIds();for(let c=0;c<o.length;c++){const p=o[c];if(e.neighboringTiles&&e.neighboringTiles[p]){const b=this.getTileByID(p);u(e,b),u(b,e)}}function u(c,p){c.needsHillshadePrepare=!0,c.needsTerrainPrepare=!0;let b=p.tileID.canonical.x-c.tileID.canonical.x;const T=p.tileID.canonical.y-c.tileID.canonical.y,C=Math.pow(2,c.tileID.canonical.z),M=p.tileID.key;b===0&&T===0||Math.abs(T)>1||(Math.abs(b)>1&&(Math.abs(b+C)===1?b+=C:Math.abs(b-C)===1&&(b-=C)),p.dem&&c.dem&&(c.dem.backfillBorder(p.dem,b,T),c.neighboringTiles&&c.neighboringTiles[M]&&(c.neighboringTiles[M].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,o,u,c){for(const p in this._tiles){let b=this._tiles[p];if(c[p]||!b.hasData()||b.tileID.overscaledZ<=o||b.tileID.overscaledZ>u)continue;let T=b.tileID;for(;b&&b.tileID.overscaledZ>o+1;){const M=b.tileID.scaledTo(b.tileID.overscaledZ-1);b=this._tiles[M.key],b&&b.hasData()&&(T=M)}let C=T;for(;C.overscaledZ>o;)if(C=C.scaledTo(C.overscaledZ-1),e[C.key]){c[T.key]=T;break}}}findLoadedParent(e,o){if(e.key in this._loadedParentTiles){const u=this._loadedParentTiles[e.key];return u&&u.tileID.overscaledZ>=o?u:null}for(let u=e.overscaledZ-1;u>=o;u--){const c=e.scaledTo(u),p=this._getLoadedTile(c);if(p)return p}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const o=this._tiles[e.key];return o&&o.hasData()?o:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const o=Math.ceil(e.width/this._source.tileSize)+1,u=Math.ceil(e.height/this._source.tileSize)+1,c=Math.floor(o*u*(this._maxTileCacheZoomLevels===null?g.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),p=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,c):c;this._cache.setMaxSize(p)}handleWrapJump(e){const o=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,o){const u={};for(const c in this._tiles){const p=this._tiles[c];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+o),u[p.tileID.key]=p}this._tiles=u;for(const c in this._timers)clearTimeout(this._timers[c]),delete this._timers[c];for(const c in this._tiles)this._setTileReloadTimer(c,this._tiles[c])}}_updateCoveredAndRetainedTiles(e,o,u,c,p,b){const T={},C={},M=Object.keys(e),R=xe.now();for(const B of M){const $=e[B],X=this._tiles[B];if(!X||X.fadeEndTime!==0&&X.fadeEndTime<=R)continue;const Y=this.findLoadedParent($,o),Q=this.findLoadedSibling($),ie=Y||Q||null;ie&&(this._addTile(ie.tileID),T[ie.tileID.key]=ie.tileID),C[B]=$}this._retainLoadedChildren(C,c,u,e);for(const B in T)e[B]||(this._coveredTiles[B]=!0,e[B]=T[B]);if(b){const B={},$={};for(const X of p)this._tiles[X.key].hasData()?B[X.key]=X:$[X.key]=X;for(const X in $){const Y=$[X].children(this._source.maxzoom);this._tiles[Y[0].key]&&this._tiles[Y[1].key]&&this._tiles[Y[2].key]&&this._tiles[Y[3].key]&&(B[Y[0].key]=e[Y[0].key]=Y[0],B[Y[1].key]=e[Y[1].key]=Y[1],B[Y[2].key]=e[Y[2].key]=Y[2],B[Y[3].key]=e[Y[3].key]=Y[3],delete $[X])}for(const X in $){const Y=$[X],Q=this.findLoadedParent(Y,this._source.minzoom),ie=this.findLoadedSibling(Y),oe=Q||ie||null;if(oe){B[oe.tileID.key]=e[oe.tileID.key]=oe.tileID;for(const de in B)B[de].isChildOf(oe.tileID)&&delete B[de]}}for(const X in this._tiles)B[X]||(this._coveredTiles[X]=!0)}}update(e,o){if(!this._sourceLoaded||this._paused)return;let u;this.transform=e,this.terrain=o,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(R=>new g.S(R.canonical.z,R.wrap,R.canonical.z,R.canonical.x,R.canonical.y)):(u=e.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:o}),this._source.hasTile&&(u=u.filter(R=>this._source.hasTile(R)))):u=[];const c=e.coveringZoomLevel(this._source),p=Math.max(c-Ut.maxOverzooming,this._source.minzoom),b=Math.max(c+Ut.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const R={};for(const B of u)if(B.canonical.z>this._source.minzoom){const $=B.scaledTo(B.canonical.z-1);R[$.key]=$;const X=B.scaledTo(Math.max(this._source.minzoom,Math.min(B.canonical.z,5)));R[X.key]=X}u=u.concat(Object.values(R))}const T=u.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,T&&this.fire(new g.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const C=this._updateRetainedTiles(u,c);$n(this._source.type)&&this._updateCoveredAndRetainedTiles(C,p,b,c,u,o);for(const R in C)this._tiles[R].clearFadeHold();const M=g.ab(this._tiles,C);for(const R of M){const B=this._tiles[R];B.hasSymbolBuckets&&!B.holdingForFade()?B.setHoldDuration(this.map._fadeDuration):B.hasSymbolBuckets&&!B.symbolFadeFinished()||this._removeTile(R)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,o){var u;const c={},p={},b=Math.max(o-Ut.maxOverzooming,this._source.minzoom),T=Math.max(o+Ut.maxUnderzooming,this._source.minzoom),C={};for(const M of e){const R=this._addTile(M);c[M.key]=M,R.hasData()||o<this._source.maxzoom&&(C[M.key]=M)}this._retainLoadedChildren(C,o,T,c);for(const M of e){let R=this._tiles[M.key];if(R.hasData())continue;if(o+1>this._source.maxzoom){const $=M.children(this._source.maxzoom)[0],X=this.getTile($);if(X&&X.hasData()){c[$.key]=$;continue}}else{const $=M.children(this._source.maxzoom);if(c[$[0].key]&&c[$[1].key]&&c[$[2].key]&&c[$[3].key])continue}let B=R.wasRequested();for(let $=M.overscaledZ-1;$>=b;--$){const X=M.scaledTo($);if(p[X.key])break;if(p[X.key]=!0,R=this.getTile(X),!R&&B&&(R=this._addTile(X)),R){const Y=R.hasData();if((Y||!(!((u=this.map)===null||u===void 0)&&u.cancelPendingTileRequestsWhileZooming)||B)&&(c[X.key]=X),B=R.wasRequested(),Y)break}}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const o=[];let u,c=this._tiles[e].tileID;for(;c.overscaledZ>0;){if(c.key in this._loadedParentTiles){u=this._loadedParentTiles[c.key];break}o.push(c.key);const p=c.scaledTo(c.overscaledZ-1);if(u=this._getLoadedTile(p),u)break;c=p}for(const p of o)this._loadedParentTiles[p]=u}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const o=this._tiles[e].tileID,u=this._getLoadedTile(o);this._loadedSiblingTiles[o.key]=u}}_addTile(e){let o=this._tiles[e.key];if(o)return o;o=this._cache.getAndRemove(e),o&&(this._setTileReloadTimer(e.key,o),o.tileID=e,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,o)));const u=o;return o||(o=new No(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(o,e.key,o.state)),o.uses++,this._tiles[e.key]=o,u||this._source.fire(new g.k("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o}_setTileReloadTimer(e,o){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const u=o.getExpiryTimeout();u&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},u))}_removeTile(e){const o=this._tiles[e];o&&(o.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}_dataHandler(e){const o=e.sourceDataType;e.dataType==="source"&&o==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&o==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,o,u){const c=[],p=this.transform;if(!p)return c;const b=u?p.getCameraQueryGeometry(e):e,T=e.map(Y=>p.pointCoordinate(Y,this.terrain)),C=b.map(Y=>p.pointCoordinate(Y,this.terrain)),M=this.getIds();let R=1/0,B=1/0,$=-1/0,X=-1/0;for(const Y of C)R=Math.min(R,Y.x),B=Math.min(B,Y.y),$=Math.max($,Y.x),X=Math.max(X,Y.y);for(let Y=0;Y<M.length;Y++){const Q=this._tiles[M[Y]];if(Q.holdingForFade())continue;const ie=Q.tileID,oe=Math.pow(2,p.zoom-Q.tileID.overscaledZ),de=o*Q.queryPadding*g.X/Q.tileSize/oe,ee=[ie.getTilePoint(new g.Z(R,B)),ie.getTilePoint(new g.Z($,X))];if(ee[0].x-de<g.X&&ee[0].y-de<g.X&&ee[1].x+de>=0&&ee[1].y+de>=0){const ye=T.map(Ce=>ie.getTilePoint(Ce)),be=C.map(Ce=>ie.getTilePoint(Ce));c.push({tile:Q,tileID:ie,queryGeometry:ye,cameraQueryGeometry:be,scale:oe})}}return c}getVisibleCoordinates(e){const o=this.getRenderableIds(e).map(u=>this._tiles[u].tileID);for(const u of o)u.posMatrix=this.transform.calculatePosMatrix(u.toUnwrapped());return o}hasTransition(){if(this._source.hasTransition())return!0;if($n(this._source.type)){const e=xe.now();for(const o in this._tiles)if(this._tiles[o].fadeEndTime>=e)return!0}return!1}setFeatureState(e,o,u){this._state.updateState(e=e||"_geojsonTileLayer",o,u)}removeFeatureState(e,o,u){this._state.removeFeatureState(e=e||"_geojsonTileLayer",o,u)}getFeatureState(e,o){return this._state.getState(e=e||"_geojsonTileLayer",o)}setDependencies(e,o,u){const c=this._tiles[e];c&&c.setDependencies(o,u)}reloadTilesForDependencies(e,o){for(const u in this._tiles)this._tiles[u].hasDependency(e,o)&&this._reloadTile(u,"reloading");this._cache.filter(u=>!u.hasDependency(e,o))}}function tr(m,e){const o=Math.abs(2*m.wrap)-+(m.wrap<0),u=Math.abs(2*e.wrap)-+(e.wrap<0);return m.overscaledZ-e.overscaledZ||u-o||e.canonical.y-m.canonical.y||e.canonical.x-m.canonical.x}function $n(m){return m==="raster"||m==="image"||m==="video"}Ut.maxOverzooming=10,Ut.maxUnderzooming=3;class Wt{constructor(e,o){this.reset(e,o)}reset(e,o){this.points=e||[],this._distances=[0];for(let u=1;u<this.points.length;u++)this._distances[u]=this._distances[u-1]+this.points[u].dist(this.points[u-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=g.ac(e,0,1);let o=1,u=this._distances[o];const c=e*this.paddedLength+this.padding;for(;u<c&&o<this._distances.length;)u=this._distances[++o];const p=o-1,b=this._distances[p],T=u-b,C=T>0?(c-b)/T:0;return this.points[p].mult(1-C).add(this.points[o].mult(C))}}function Jr(m,e){let o=!0;return m==="always"||m!=="never"&&e!=="never"||(o=!1),o}class Yr{constructor(e,o,u){const c=this.boxCells=[],p=this.circleCells=[];this.xCellCount=Math.ceil(e/u),this.yCellCount=Math.ceil(o/u);for(let b=0;b<this.xCellCount*this.yCellCount;b++)c.push([]),p.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=o,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,o,u,c,p){this._forEachCell(o,u,c,p,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(c),this.bboxes.push(p)}insertCircle(e,o,u,c){this._forEachCell(o-c,u-c,o+c,u+c,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(o),this.circles.push(u),this.circles.push(c)}_insertBoxCell(e,o,u,c,p,b){this.boxCells[p].push(b)}_insertCircleCell(e,o,u,c,p,b){this.circleCells[p].push(b)}_query(e,o,u,c,p,b,T){if(u<0||e>this.width||c<0||o>this.height)return[];const C=[];if(e<=0&&o<=0&&this.width<=u&&this.height<=c){if(p)return[{key:null,x1:e,y1:o,x2:u,y2:c}];for(let M=0;M<this.boxKeys.length;M++)C.push({key:this.boxKeys[M],x1:this.bboxes[4*M],y1:this.bboxes[4*M+1],x2:this.bboxes[4*M+2],y2:this.bboxes[4*M+3]});for(let M=0;M<this.circleKeys.length;M++){const R=this.circles[3*M],B=this.circles[3*M+1],$=this.circles[3*M+2];C.push({key:this.circleKeys[M],x1:R-$,y1:B-$,x2:R+$,y2:B+$})}}else this._forEachCell(e,o,u,c,this._queryCell,C,{hitTest:p,overlapMode:b,seenUids:{box:{},circle:{}}},T);return C}query(e,o,u,c){return this._query(e,o,u,c,!1,null)}hitTest(e,o,u,c,p,b){return this._query(e,o,u,c,!0,p,b).length>0}hitTestCircle(e,o,u,c,p){const b=e-u,T=e+u,C=o-u,M=o+u;if(T<0||b>this.width||M<0||C>this.height)return!1;const R=[];return this._forEachCell(b,C,T,M,this._queryCellCircle,R,{hitTest:!0,overlapMode:c,circle:{x:e,y:o,radius:u},seenUids:{box:{},circle:{}}},p),R.length>0}_queryCell(e,o,u,c,p,b,T,C){const{seenUids:M,hitTest:R,overlapMode:B}=T,$=this.boxCells[p];if($!==null){const Y=this.bboxes;for(const Q of $)if(!M.box[Q]){M.box[Q]=!0;const ie=4*Q,oe=this.boxKeys[Q];if(e<=Y[ie+2]&&o<=Y[ie+3]&&u>=Y[ie+0]&&c>=Y[ie+1]&&(!C||C(oe))&&(!R||!Jr(B,oe.overlapMode))&&(b.push({key:oe,x1:Y[ie],y1:Y[ie+1],x2:Y[ie+2],y2:Y[ie+3]}),R))return!0}}const X=this.circleCells[p];if(X!==null){const Y=this.circles;for(const Q of X)if(!M.circle[Q]){M.circle[Q]=!0;const ie=3*Q,oe=this.circleKeys[Q];if(this._circleAndRectCollide(Y[ie],Y[ie+1],Y[ie+2],e,o,u,c)&&(!C||C(oe))&&(!R||!Jr(B,oe.overlapMode))){const de=Y[ie],ee=Y[ie+1],ye=Y[ie+2];if(b.push({key:oe,x1:de-ye,y1:ee-ye,x2:de+ye,y2:ee+ye}),R)return!0}}}return!1}_queryCellCircle(e,o,u,c,p,b,T,C){const{circle:M,seenUids:R,overlapMode:B}=T,$=this.boxCells[p];if($!==null){const Y=this.bboxes;for(const Q of $)if(!R.box[Q]){R.box[Q]=!0;const ie=4*Q,oe=this.boxKeys[Q];if(this._circleAndRectCollide(M.x,M.y,M.radius,Y[ie+0],Y[ie+1],Y[ie+2],Y[ie+3])&&(!C||C(oe))&&!Jr(B,oe.overlapMode))return b.push(!0),!0}}const X=this.circleCells[p];if(X!==null){const Y=this.circles;for(const Q of X)if(!R.circle[Q]){R.circle[Q]=!0;const ie=3*Q,oe=this.circleKeys[Q];if(this._circlesCollide(Y[ie],Y[ie+1],Y[ie+2],M.x,M.y,M.radius)&&(!C||C(oe))&&!Jr(B,oe.overlapMode))return b.push(!0),!0}}}_forEachCell(e,o,u,c,p,b,T,C){const M=this._convertToXCellCoord(e),R=this._convertToYCellCoord(o),B=this._convertToXCellCoord(u),$=this._convertToYCellCoord(c);for(let X=M;X<=B;X++)for(let Y=R;Y<=$;Y++)if(p.call(this,e,o,u,c,this.xCellCount*Y+X,b,T,C))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,o,u,c,p,b){const T=c-e,C=p-o,M=u+b;return M*M>T*T+C*C}_circleAndRectCollide(e,o,u,c,p,b,T){const C=(b-c)/2,M=Math.abs(e-(c+C));if(M>C+u)return!1;const R=(T-p)/2,B=Math.abs(o-(p+R));if(B>R+u)return!1;if(M<=C||B<=R)return!0;const $=M-C,X=B-R;return $*$+X*X<=u*u}}function br(m,e,o,u,c){const p=g.H();return e?(g.K(p,p,[1/c,1/c,1]),o||g.ad(p,p,u.angle)):g.L(p,u.labelPlaneMatrix,m),p}function ir(m,e,o,u,c){if(e){const p=g.ae(m);return g.K(p,p,[c,c,1]),o||g.ad(p,p,-u.angle),p}return u.glCoordMatrix}function se(m,e,o,u){let c;u?(c=[m,e,u(m,e),1],g.af(c,c,o)):(c=[m,e,0,1],ki(c,c,o));const p=c[3];return{point:new g.P(c[0]/p,c[1]/p),signedDistanceFromCamera:p,isOccluded:!1}}function V(m,e){return .5+m/e*.5}function j(m,e){return m.x>=-e[0]&&m.x<=e[0]&&m.y>=-e[1]&&m.y<=e[1]}function W(m,e,o,u,c,p,b,T,C,M,R,B,$,X,Y){const Q=u?m.textSizeData:m.iconSizeData,ie=g.ag(Q,o.transform.zoom),oe=[256/o.width*2+1,256/o.height*2+1],de=u?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;de.clear();const ee=m.lineVertexArray,ye=u?m.text.placedSymbolArray:m.icon.placedSymbolArray,be=o.transform.width/o.transform.height;let Ce=!1;for(let Ve=0;Ve<ye.length;Ve++){const et=ye.get(Ve);if(et.hidden||et.writingMode===g.ah.vertical&&!Ce){zt(et.numGlyphs,de);continue}Ce=!1;const at=se(et.anchorX,et.anchorY,e,Y);if(!j(at.point,oe)){zt(et.numGlyphs,de);continue}const pt=V(o.transform.cameraToCenterDistance,at.signedDistanceFromCamera),lt=g.ai(Q,ie,et),rt=b?lt/pt:lt*pt,bt={getElevation:Y,labelPlaneMatrix:c,lineVertexArray:ee,pitchWithMap:b,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:M,tileAnchorPoint:new g.P(et.anchorX,et.anchorY),unwrappedTileID:R,width:B,height:$,translation:X},Kt=ve(bt,et,rt,!1,T,e,p,m.glyphOffsetArray,de,be,C);Ce=Kt.useVertical,(Kt.notEnoughRoom||Ce||Kt.needsFlipping&&ve(bt,et,rt,!0,T,e,p,m.glyphOffsetArray,de,be,C).notEnoughRoom)&&zt(et.numGlyphs,de)}u?m.text.dynamicLayoutVertexBuffer.updateData(de):m.icon.dynamicLayoutVertexBuffer.updateData(de)}function te(m,e,o,u,c,p,b,T){const C=p.glyphStartIndex+p.numGlyphs,M=p.lineStartIndex,R=p.lineStartIndex+p.lineLength,B=e.getoffsetX(p.glyphStartIndex),$=e.getoffsetX(C-1),X=De(m*B,o,u,c,p.segment,M,R,T,b);if(!X)return null;const Y=De(m*$,o,u,c,p.segment,M,R,T,b);return Y?T.projectionCache.anyProjectionOccluded?null:{first:X,last:Y}:null}function fe(m,e,o,u){return m===g.ah.horizontal&&Math.abs(o.y-e.y)>Math.abs(o.x-e.x)*u?{useVertical:!0}:(m===g.ah.vertical?e.y<o.y:e.x>o.x)?{needsFlipping:!0}:null}function ve(m,e,o,u,c,p,b,T,C,M,R){const B=o/24,$=e.lineOffsetX*B,X=e.lineOffsetY*B;let Y;if(e.numGlyphs>1){const Q=e.glyphStartIndex+e.numGlyphs,ie=e.lineStartIndex,oe=e.lineStartIndex+e.lineLength,de=te(B,T,$,X,u,e,R,m);if(!de)return{notEnoughRoom:!0};const ee=se(de.first.point.x,de.first.point.y,b,m.getElevation).point,ye=se(de.last.point.x,de.last.point.y,b,m.getElevation).point;if(c&&!u){const be=fe(e.writingMode,ee,ye,M);if(be)return be}Y=[de.first];for(let be=e.glyphStartIndex+1;be<Q-1;be++)Y.push(De(B*T.getoffsetX(be),$,X,u,e.segment,ie,oe,m,R));Y.push(de.last)}else{if(c&&!u){const ie=se(m.tileAnchorPoint.x,m.tileAnchorPoint.y,p,m.getElevation).point,oe=e.lineStartIndex+e.segment+1,de=new g.P(m.lineVertexArray.getx(oe),m.lineVertexArray.gety(oe)),ee=se(de.x,de.y,p,m.getElevation),ye=ee.signedDistanceFromCamera>0?ee.point:function(Ce,Ve,et,at,pt,lt){return Se(Ce,Ve,et,1,pt,lt)}(m.tileAnchorPoint,de,ie,0,p,m),be=fe(e.writingMode,ie,ye,M);if(be)return be}const Q=De(B*T.getoffsetX(e.glyphStartIndex),$,X,u,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,m,R);if(!Q||m.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Y=[Q]}for(const Q of Y)g.aj(C,Q.point,Q.angle);return{}}function Se(m,e,o,u,c,p){const b=m.add(m.sub(e)._unit()),T=c!==void 0?se(b.x,b.y,c,p.getElevation).point:Be(b.x,b.y,p).point,C=o.sub(T);return o.add(C._mult(u/C.mag()))}function he(m,e,o){const u=e.projectionCache;if(u.projections[m])return u.projections[m];const c=new g.P(e.lineVertexArray.getx(m),e.lineVertexArray.gety(m)),p=Be(c.x,c.y,e);if(p.signedDistanceFromCamera>0)return u.projections[m]=p.point,u.anyProjectionOccluded=u.anyProjectionOccluded||p.isOccluded,p.point;const b=m-o.direction;return function(T,C,M,R,B){return Se(T,C,M,R,void 0,B)}(o.distanceFromAnchor===0?e.tileAnchorPoint:new g.P(e.lineVertexArray.getx(b),e.lineVertexArray.gety(b)),c,o.previousVertex,o.absOffsetX-o.distanceFromAnchor+1,e)}function Be(m,e,o){const u=m+o.translation[0],c=e+o.translation[1];let p;return!o.pitchWithMap&&o.projection.useSpecialProjectionForSymbols?(p=o.projection.projectTileCoordinates(u,c,o.unwrappedTileID,o.getElevation),p.point.x=(.5*p.point.x+.5)*o.width,p.point.y=(.5*-p.point.y+.5)*o.height):(p=se(u,c,o.labelPlaneMatrix,o.getElevation),p.isOccluded=!1),p}function Ze(m,e,o){return m._unit()._perp()._mult(e*o)}function Ie(m,e,o,u,c,p,b,T,C){if(T.projectionCache.offsets[m])return T.projectionCache.offsets[m];const M=o.add(e);if(m+C.direction<u||m+C.direction>=c)return T.projectionCache.offsets[m]=M,M;const R=he(m+C.direction,T,C),B=Ze(R.sub(o),b,C.direction),$=o.add(B),X=R.add(B);return T.projectionCache.offsets[m]=g.ak(p,M,$,X)||M,T.projectionCache.offsets[m]}function De(m,e,o,u,c,p,b,T,C){const M=u?m-e:m+e;let R=M>0?1:-1,B=0;u&&(R*=-1,B=Math.PI),R<0&&(B+=Math.PI);let $,X=R>0?p+c:p+c+1;T.projectionCache.cachedAnchorPoint?$=T.projectionCache.cachedAnchorPoint:($=Be(T.tileAnchorPoint.x,T.tileAnchorPoint.y,T).point,T.projectionCache.cachedAnchorPoint=$);let Y,Q,ie=$,oe=$,de=0,ee=0;const ye=Math.abs(M),be=[];let Ce;for(;de+ee<=ye;){if(X+=R,X<p||X>=b)return null;de+=ee,oe=ie,Q=Y;const at={absOffsetX:ye,direction:R,distanceFromAnchor:de,previousVertex:oe};if(ie=he(X,T,at),o===0)be.push(oe),Ce=ie.sub(oe);else{let pt;const lt=ie.sub(oe);pt=lt.mag()===0?Ze(he(X+R,T,at).sub(ie),o,R):Ze(lt,o,R),Q||(Q=oe.add(pt)),Y=Ie(X,pt,ie,p,b,Q,o,T,at),be.push(Q),Ce=Y.sub(Q)}ee=Ce.mag()}const Ve=Ce._mult((ye-de)/ee)._add(Q||oe),et=B+Math.atan2(ie.y-oe.y,ie.x-oe.x);return be.push(Ve),{point:Ve,angle:C?et:0,path:be}}const Pt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function zt(m,e){for(let o=0;o<m;o++){const u=e.length;e.resize(u+4),e.float32.set(Pt,3*u)}}function ki(m,e,o){const u=e[0],c=e[1];return m[0]=o[0]*u+o[4]*c+o[12],m[1]=o[1]*u+o[5]*c+o[13],m[3]=o[3]*u+o[7]*c+o[15],m}const ei=100;class bi{constructor(e,o,u=new Yr(e.width+200,e.height+200,25),c=new Yr(e.width+200,e.height+200,25)){this.transform=e,this.mapProjection=o,this.grid=u,this.ignoredGrid=c,this.pitchFactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+ei,this.screenBottomBoundary=e.height+ei,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,o,u,c,p,b,T,C,M,R,B){const $=e.anchorPointX+C[0],X=e.anchorPointY+C[1],Y=this.projectAndGetPerspectiveRatio(c,$,X,p,R),Q=u*Y.perspectiveRatio;let ie;if(b||T)ie=this._projectCollisionBox(e,Q,c,p,b,T,C,Y,R,B);else{const be=Y.point.x+(B?B.x*Q:0),Ce=Y.point.y+(B?B.y*Q:0);ie={allPointsOccluded:!1,box:[be+e.x1*Q,Ce+e.y1*Q,be+e.x2*Q,Ce+e.y2*Q]}}const[oe,de,ee,ye]=ie.box;return this.mapProjection.useSpecialProjectionForSymbols&&(b?ie.allPointsOccluded:this.mapProjection.isOccluded($,X,p))||Y.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(oe,de,ee,ye)||o!=="always"&&this.grid.hitTest(oe,de,ee,ye,o,M)?{box:[oe,de,ee,ye],placeable:!1,offscreen:!1}:{box:[oe,de,ee,ye],placeable:!0,offscreen:this.isOffscreen(oe,de,ee,ye)}}placeCollisionCircles(e,o,u,c,p,b,T,C,M,R,B,$,X,Y,Q,ie){const oe=[],de=new g.P(o.anchorX,o.anchorY),ee=this.getPerspectiveRatio(b,de.x,de.y,T,ie),ye=(B?p/ee:p*ee)/g.ap,be={getElevation:ie,labelPlaneMatrix:C,lineVertexArray:u,pitchWithMap:B,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:de,unwrappedTileID:T,width:this.transform.width,height:this.transform.height,translation:Q},Ce=te(ye,c,o.lineOffsetX*ye,o.lineOffsetY*ye,!1,o,!1,be);let Ve=!1,et=!1,at=!0;if(Ce){const pt=.5*X*ee+Y,lt=new g.P(-100,-100),rt=new g.P(this.screenRightBoundary,this.screenBottomBoundary),bt=new Wt,Kt=Ce.first,ut=Ce.last;let ht=[];for(let ai=Kt.path.length-1;ai>=1;ai--)ht.push(Kt.path[ai]);for(let ai=1;ai<ut.path.length;ai++)ht.push(ut.path[ai]);const Gt=2.5*pt;if(M){const ai=this.projectPathToScreenSpace(ht,be,M);ht=ai.some(mi=>mi.signedDistanceFromCamera<=0)?[]:ai.map(mi=>mi.point)}let Wi=[];if(ht.length>0){const ai=ht[0].clone(),mi=ht[0].clone();for(let Qi=1;Qi<ht.length;Qi++)ai.x=Math.min(ai.x,ht[Qi].x),ai.y=Math.min(ai.y,ht[Qi].y),mi.x=Math.max(mi.x,ht[Qi].x),mi.y=Math.max(mi.y,ht[Qi].y);Wi=ai.x>=lt.x&&mi.x<=rt.x&&ai.y>=lt.y&&mi.y<=rt.y?[ht]:mi.x<lt.x||ai.x>rt.x||mi.y<lt.y||ai.y>rt.y?[]:g.al([ht],lt.x,lt.y,rt.x,rt.y)}for(const ai of Wi){bt.reset(ai,.25*pt);let mi=0;mi=bt.length<=.5*pt?1:Math.ceil(bt.paddedLength/Gt)+1;for(let Qi=0;Qi<mi;Qi++){const or=Qi/Math.max(mi-1,1),zs=bt.lerp(or),en=zs.x+ei,Kn=zs.y+ei;oe.push(en,Kn,pt,0);const cn=en-pt,Cn=Kn-pt,gr=en+pt,Po=Kn+pt;if(at=at&&this.isOffscreen(cn,Cn,gr,Po),et=et||this.isInsideGrid(cn,Cn,gr,Po),e!=="always"&&this.grid.hitTestCircle(en,Kn,pt,e,$)&&(Ve=!0,!R))return{circles:[],offscreen:!1,collisionDetected:Ve}}}}return{circles:!R&&Ve||!et||ee<this.perspectiveRatioCutoff?[]:oe,offscreen:at,collisionDetected:Ve}}projectPathToScreenSpace(e,o,u){return e.map(c=>se(c.x,c.y,u,o.getElevation))}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const o=[];let u=1/0,c=1/0,p=-1/0,b=-1/0;for(const R of e){const B=new g.P(R.x+ei,R.y+ei);u=Math.min(u,B.x),c=Math.min(c,B.y),p=Math.max(p,B.x),b=Math.max(b,B.y),o.push(B)}const T=this.grid.query(u,c,p,b).concat(this.ignoredGrid.query(u,c,p,b)),C={},M={};for(const R of T){const B=R.key;if(C[B.bucketInstanceId]===void 0&&(C[B.bucketInstanceId]={}),C[B.bucketInstanceId][B.featureIndex])continue;const $=[new g.P(R.x1,R.y1),new g.P(R.x2,R.y1),new g.P(R.x2,R.y2),new g.P(R.x1,R.y2)];g.am(o,$)&&(C[B.bucketInstanceId][B.featureIndex]=!0,M[B.bucketInstanceId]===void 0&&(M[B.bucketInstanceId]=[]),M[B.bucketInstanceId].push(B.featureIndex))}return M}insertCollisionBox(e,o,u,c,p,b){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:c,featureIndex:p,collisionGroupID:b,overlapMode:o},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,o,u,c,p,b){const T=u?this.ignoredGrid:this.grid,C={bucketInstanceId:c,featureIndex:p,collisionGroupID:b,overlapMode:o};for(let M=0;M<e.length;M+=4)T.insertCircle(C,e[M],e[M+1],e[M+2])}projectAndGetPerspectiveRatio(e,o,u,c,p){let b;p?(b=[o,u,p(o,u),1],g.af(b,b,e)):(b=[o,u,0,1],ki(b,b,e));const T=b[3];return{point:new g.P((b[0]/T+1)/2*this.transform.width+ei,(-b[1]/T+1)/2*this.transform.height+ei),perspectiveRatio:.5+this.transform.cameraToCenterDistance/T*.5,isOccluded:!1,signedDistanceFromCamera:T}}getPerspectiveRatio(e,o,u,c,p){const b=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(o,u,c,p):se(o,u,e,p);return .5+this.transform.cameraToCenterDistance/b.signedDistanceFromCamera*.5}isOffscreen(e,o,u,c){return u<ei||e>=this.screenRightBoundary||c<ei||o>this.screenBottomBoundary}isInsideGrid(e,o,u,c){return u>=0&&e<this.gridRightBoundary&&c>=0&&o<this.gridBottomBoundary}getViewportMatrix(){const e=g.an([]);return g.J(e,e,[-100,-100,0]),e}_projectCollisionBox(e,o,u,c,p,b,T,C,M,R){let B=new g.P(1,0),$=new g.P(0,1);const X=new g.P(e.anchorPointX+T[0],e.anchorPointY+T[1]);if(b&&!p){const at=this.projectAndGetPerspectiveRatio(u,X.x+1,X.y,c,M).point.sub(C.point).unit(),pt=Math.atan(at.y/at.x)+(at.x<0?Math.PI:0),lt=Math.sin(pt),rt=Math.cos(pt);B=new g.P(rt,lt),$=new g.P(-lt,rt)}else if(!b&&p){const at=-this.transform.angle,pt=Math.sin(at),lt=Math.cos(at);B=new g.P(lt,pt),$=new g.P(-pt,lt)}let Y=C.point,Q=o;if(p){Y=X;const at=this.transform.zoom-Math.floor(this.transform.zoom);Q=Math.pow(2,-at),Q*=this.mapProjection.getPitchedTextCorrection(this.transform,X,c),R||(Q*=g.ac(.5+C.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}R&&(Y=Y.add(B.mult(R.x*Q)).add($.mult(R.y*Q)));const ie=e.x1*Q,oe=e.x2*Q,de=(ie+oe)/2,ee=e.y1*Q,ye=e.y2*Q,be=(ee+ye)/2,Ce=[{offsetX:ie,offsetY:ee},{offsetX:de,offsetY:ee},{offsetX:oe,offsetY:ee},{offsetX:oe,offsetY:be},{offsetX:oe,offsetY:ye},{offsetX:de,offsetY:ye},{offsetX:ie,offsetY:ye},{offsetX:ie,offsetY:be}];let Ve=[];for(const{offsetX:at,offsetY:pt}of Ce)Ve.push(new g.P(Y.x+B.x*at+$.x*pt,Y.y+B.y*at+$.y*pt));let et=!1;if(p){const at=Ve.map(pt=>this.projectAndGetPerspectiveRatio(u,pt.x,pt.y,c,M));et=at.some(pt=>!pt.isOccluded),Ve=at.map(pt=>pt.point)}else et=!0;return{box:g.ao(Ve),allPointsOccluded:!et}}}function si(m,e,o){return e*(g.X/(m.tileSize*Math.pow(2,o-m.tileID.overscaledZ)))}class Xi{constructor(e,o,u,c){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?o:-o))):c&&u?1:0,this.placed=u}isHidden(){return this.opacity===0&&!this.placed}}class rn{constructor(e,o,u,c,p){this.text=new Xi(e?e.text:null,o,u,p),this.icon=new Xi(e?e.icon:null,o,c,p)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class fi{constructor(e,o,u){this.text=e,this.icon=o,this.skipFade=u}}class Fi{constructor(){this.invProjMatrix=g.H(),this.viewportMatrix=g.H(),this.circles=[]}}class Ki{constructor(e,o,u,c,p){this.bucketInstanceId=e,this.featureIndex=o,this.sourceLayerIndex=u,this.bucketIndex=c,this.tileID=p}}class En{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const o=++this.maxGroupID;this.collisionGroups[e]={ID:o,predicate:u=>u.collisionGroupID===o}}return this.collisionGroups[e]}}function Mn(m,e,o,u,c){const{horizontalAlign:p,verticalAlign:b}=g.au(m);return new g.P(-(p-.5)*e+u[0]*c,-(b-.5)*o+u[1]*c)}class cr{constructor(e,o,u,c,p,b){this.transform=e.clone(),this.terrain=u,this.collisionIndex=new bi(this.transform,o),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new En(p),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const o=this.terrain;return o?(u,c)=>o.getElevation(e,u,c):null}getBucketParts(e,o,u,c){const p=u.getBucket(o),b=u.latestFeatureIndex;if(!p||!b||o.id!==p.layerIds[0])return;const T=u.collisionBoxArray,C=p.layers[0].layout,M=p.layers[0].paint,R=Math.pow(2,this.transform.zoom-u.tileID.overscaledZ),B=u.tileSize/g.X,$=u.tileID.toUnwrapped(),X=this.transform.calculatePosMatrix($),Y=C.get("text-pitch-alignment")==="map",Q=C.get("text-rotation-alignment")==="map",ie=si(u,1,this.transform.zoom),oe=this.collisionIndex.mapProjection.translatePosition(this.transform,u,M.get("text-translate"),M.get("text-translate-anchor")),de=this.collisionIndex.mapProjection.translatePosition(this.transform,u,M.get("icon-translate"),M.get("icon-translate-anchor")),ee=br(X,Y,Q,this.transform,ie);let ye=null;if(Y){const Ce=ir(X,Y,Q,this.transform,ie);ye=g.L([],this.transform.labelPlaneMatrix,Ce)}this.retainedQueryData[p.bucketInstanceId]=new Ki(p.bucketInstanceId,b,p.sourceLayerIndex,p.index,u.tileID);const be={bucket:p,layout:C,translationText:oe,translationIcon:de,posMatrix:X,unwrappedTileID:$,textLabelPlaneMatrix:ee,labelToScreenMatrix:ye,scale:R,textPixelRatio:B,holdingForFade:u.holdingForFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:g.ag(p.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(p.sourceID)};if(c)for(const Ce of p.sortKeyRanges){const{sortKey:Ve,symbolInstanceStart:et,symbolInstanceEnd:at}=Ce;e.push({sortKey:Ve,symbolInstanceStart:et,symbolInstanceEnd:at,parameters:be})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:p.symbolInstances.length,parameters:be})}attemptAnchorPlacement(e,o,u,c,p,b,T,C,M,R,B,$,X,Y,Q,ie,oe,de,ee){const ye=g.aq[e.textAnchor],be=[e.textOffset0,e.textOffset1],Ce=Mn(ye,u,c,be,p),Ve=this.collisionIndex.placeCollisionBox(o,$,C,M,R,T,b,ie,B.predicate,ee,Ce);if((!de||this.collisionIndex.placeCollisionBox(de,$,C,M,R,T,b,oe,B.predicate,ee,Ce).placeable)&&Ve.placeable){let et;if(this.prevPlacement&&this.prevPlacement.variableOffsets[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID].text&&(et=this.prevPlacement.variableOffsets[X.crossTileID].anchor),X.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[X.crossTileID]={textOffset:be,width:u,height:c,anchor:ye,textBoxScale:p,prevAnchor:et},this.markUsedJustification(Y,ye,X,Q),Y.allowVerticalPlacement&&(this.markUsedOrientation(Y,Q,X),this.placedOrientations[X.crossTileID]=Q),{shift:Ce,placedGlyphBoxes:Ve}}}placeLayerBucketPart(e,o,u){const{bucket:c,layout:p,translationText:b,translationIcon:T,posMatrix:C,unwrappedTileID:M,textLabelPlaneMatrix:R,labelToScreenMatrix:B,textPixelRatio:$,holdingForFade:X,collisionBoxArray:Y,partiallyEvaluatedTextSize:Q,collisionGroup:ie}=e.parameters,oe=p.get("text-optional"),de=p.get("icon-optional"),ee=g.ar(p,"text-overlap","text-allow-overlap"),ye=ee==="always",be=g.ar(p,"icon-overlap","icon-allow-overlap"),Ce=be==="always",Ve=p.get("text-rotation-alignment")==="map",et=p.get("text-pitch-alignment")==="map",at=p.get("icon-text-fit")!=="none",pt=p.get("symbol-z-order")==="viewport-y",lt=ye&&(Ce||!c.hasIconData()||de),rt=Ce&&(ye||!c.hasTextData()||oe);!c.collisionArrays&&Y&&c.deserializeCollisionBoxes(Y);const bt=this._getTerrainElevationFunc(this.retainedQueryData[c.bucketInstanceId].tileID),Kt=(ut,ht,Gt)=>{var Wi,ai;if(o[ut.crossTileID])return;if(X)return void(this.placements[ut.crossTileID]=new fi(!1,!1,!1));let mi=!1,Qi=!1,or=!0,zs=null,en={box:null,placeable:!1,offscreen:null},Kn={placeable:!1},cn=null,Cn=null,gr=null,Po=0,ss=0,ko=0;ht.textFeatureIndex?Po=ht.textFeatureIndex:ut.useRuntimeCollisionCircles&&(Po=ut.featureIndex),ht.verticalTextFeatureIndex&&(ss=ht.verticalTextFeatureIndex);const Na=ht.textBox;if(Na){const Hr=Ln=>{let fn=g.ah.horizontal;if(c.allowVerticalPlacement&&!Ln&&this.prevPlacement){const yr=this.prevPlacement.placedOrientations[ut.crossTileID];yr&&(this.placedOrientations[ut.crossTileID]=yr,fn=yr,this.markUsedOrientation(c,fn,ut))}return fn},Ls=(Ln,fn)=>{if(c.allowVerticalPlacement&&ut.numVerticalGlyphVertices>0&&ht.verticalTextBox){for(const yr of c.writingModes)if(yr===g.ah.vertical?(en=fn(),Kn=en):en=Ln(),en&&en.placeable)break}else en=Ln()},Co=ut.textAnchorOffsetStartIndex,Qs=ut.textAnchorOffsetEndIndex;if(Qs===Co){const Ln=(fn,yr)=>{const vi=this.collisionIndex.placeCollisionBox(fn,ee,$,C,M,et,Ve,b,ie.predicate,bt);return vi&&vi.placeable&&(this.markUsedOrientation(c,yr,ut),this.placedOrientations[ut.crossTileID]=yr),vi};Ls(()=>Ln(Na,g.ah.horizontal),()=>{const fn=ht.verticalTextBox;return c.allowVerticalPlacement&&ut.numVerticalGlyphVertices>0&&fn?Ln(fn,g.ah.vertical):{box:null,offscreen:null}}),Hr(en&&en.placeable)}else{let Ln=g.aq[(ai=(Wi=this.prevPlacement)===null||Wi===void 0?void 0:Wi.variableOffsets[ut.crossTileID])===null||ai===void 0?void 0:ai.anchor];const fn=(vi,Ds,ja)=>{const Io=vi.x2-vi.x1,ec=vi.y2-vi.y1,tc=ut.textBoxScale,yn=at&&be==="never"?Ds:null;let Eo=null,Lu=ee==="never"?1:2,Ll="never";Ln&&Lu++;for(let Va=0;Va<Lu;Va++){for(let Dl=Co;Dl<Qs;Dl++){const Qo=c.textAnchorOffsets.get(Dl);if(Ln&&Qo.textAnchor!==Ln)continue;const tn=this.attemptAnchorPlacement(Qo,vi,Io,ec,tc,Ve,et,$,C,M,ie,Ll,ut,c,ja,b,T,yn,bt);if(tn&&(Eo=tn.placedGlyphBoxes,Eo&&Eo.placeable))return mi=!0,zs=tn.shift,Eo}Ln?Ln=null:Ll=ee}return u&&!Eo&&(Eo={box:this.collisionIndex.placeCollisionBox(Na,"always",$,C,M,et,Ve,b,ie.predicate,bt,new g.P(0,0)).box,offscreen:!1,placeable:!1}),Eo};Ls(()=>fn(Na,ht.iconBox,g.ah.horizontal),()=>{const vi=ht.verticalTextBox;return c.allowVerticalPlacement&&(!en||!en.placeable)&&ut.numVerticalGlyphVertices>0&&vi?fn(vi,ht.verticalIconBox,g.ah.vertical):{box:null,occluded:!0,offscreen:null}}),en&&(mi=en.placeable,or=en.offscreen);const yr=Hr(en&&en.placeable);if(!mi&&this.prevPlacement){const vi=this.prevPlacement.variableOffsets[ut.crossTileID];vi&&(this.variableOffsets[ut.crossTileID]=vi,this.markUsedJustification(c,vi.anchor,ut,yr))}}}if(cn=en,mi=cn&&cn.placeable,or=cn&&cn.offscreen,ut.useRuntimeCollisionCircles){const Hr=c.text.placedSymbolArray.get(ut.centerJustifiedTextSymbolIndex),Ls=g.ai(c.textSizeData,Q,Hr),Co=p.get("text-padding");Cn=this.collisionIndex.placeCollisionCircles(ee,Hr,c.lineVertexArray,c.glyphOffsetArray,Ls,C,M,R,B,u,et,ie.predicate,ut.collisionCircleDiameter,Co,b,bt),Cn.circles.length&&Cn.collisionDetected&&!u&&g.w("Collisions detected, but collision boxes are not shown"),mi=ye||Cn.circles.length>0&&!Cn.collisionDetected,or=or&&Cn.offscreen}if(ht.iconFeatureIndex&&(ko=ht.iconFeatureIndex),ht.iconBox){const Hr=Ls=>this.collisionIndex.placeCollisionBox(Ls,be,$,C,M,et,Ve,T,ie.predicate,bt,at&&zs?zs:void 0);Kn&&Kn.placeable&&ht.verticalIconBox?(gr=Hr(ht.verticalIconBox),Qi=gr.placeable):(gr=Hr(ht.iconBox),Qi=gr.placeable),or=or&&gr.offscreen}const As=oe||ut.numHorizontalGlyphVertices===0&&ut.numVerticalGlyphVertices===0,Ys=de||ut.numIconVertices===0;As||Ys?Ys?As||(Qi=Qi&&mi):mi=Qi&&mi:Qi=mi=Qi&&mi;const Yo=Qi&&gr.placeable;if(mi&&cn.placeable&&this.collisionIndex.insertCollisionBox(cn.box,ee,p.get("text-ignore-placement"),c.bucketInstanceId,Kn&&Kn.placeable&&ss?ss:Po,ie.ID),Yo&&this.collisionIndex.insertCollisionBox(gr.box,be,p.get("icon-ignore-placement"),c.bucketInstanceId,ko,ie.ID),Cn&&mi&&this.collisionIndex.insertCollisionCircles(Cn.circles,ee,p.get("text-ignore-placement"),c.bucketInstanceId,Po,ie.ID),u&&this.storeCollisionData(c.bucketInstanceId,Gt,ht,cn,gr,Cn),ut.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(c.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[ut.crossTileID]=new fi(mi||lt,Qi||rt,or||c.justReloaded),o[ut.crossTileID]=!0};if(pt){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const ut=c.getSortedSymbolIndexes(this.transform.angle);for(let ht=ut.length-1;ht>=0;--ht){const Gt=ut[ht];Kt(c.symbolInstances.get(Gt),c.collisionArrays[Gt],Gt)}}else for(let ut=e.symbolInstanceStart;ut<e.symbolInstanceEnd;ut++)Kt(c.symbolInstances.get(ut),c.collisionArrays[ut],ut);if(u&&c.bucketInstanceId in this.collisionCircleArrays){const ut=this.collisionCircleArrays[c.bucketInstanceId];g.as(ut.invProjMatrix,C),ut.viewportMatrix=this.collisionIndex.getViewportMatrix()}c.justReloaded=!1}storeCollisionData(e,o,u,c,p,b){if(u.textBox||u.iconBox){let T,C;this.collisionBoxArrays.has(e)?T=this.collisionBoxArrays.get(e):(T=new Map,this.collisionBoxArrays.set(e,T)),T.has(o)?C=T.get(o):(C={text:null,icon:null},T.set(o,C)),u.textBox&&(C.text=c.box),u.iconBox&&(C.icon=p.box)}if(b){let T=this.collisionCircleArrays[e];T===void 0&&(T=this.collisionCircleArrays[e]=new Fi);for(let C=0;C<b.circles.length;C+=4)T.circles.push(b.circles[C+0]),T.circles.push(b.circles[C+1]),T.circles.push(b.circles[C+2]),T.circles.push(b.collisionDetected?1:0)}}markUsedJustification(e,o,u,c){let p;p=c===g.ah.vertical?u.verticalPlacedTextSymbolIndex:{left:u.leftJustifiedTextSymbolIndex,center:u.centerJustifiedTextSymbolIndex,right:u.rightJustifiedTextSymbolIndex}[g.at(o)];const b=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex,u.verticalPlacedTextSymbolIndex];for(const T of b)T>=0&&(e.text.placedSymbolArray.get(T).crossTileID=p>=0&&T!==p?0:u.crossTileID)}markUsedOrientation(e,o,u){const c=o===g.ah.horizontal||o===g.ah.horizontalOnly?o:0,p=o===g.ah.vertical?o:0,b=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex];for(const T of b)e.text.placedSymbolArray.get(T).placedOrientation=c;u.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(u.verticalPlacedTextSymbolIndex).placedOrientation=p)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const o=this.prevPlacement;let u=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;const c=o?o.symbolFadeChange(e):1,p=o?o.opacities:{},b=o?o.variableOffsets:{},T=o?o.placedOrientations:{};for(const C in this.placements){const M=this.placements[C],R=p[C];R?(this.opacities[C]=new rn(R,c,M.text,M.icon),u=u||M.text!==R.text.placed||M.icon!==R.icon.placed):(this.opacities[C]=new rn(null,c,M.text,M.icon,M.skipFade),u=u||M.text||M.icon)}for(const C in p){const M=p[C];if(!this.opacities[C]){const R=new rn(M,c,!1,!1);R.isHidden()||(this.opacities[C]=R,u=u||M.text.placed||M.icon.placed)}}for(const C in b)this.variableOffsets[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.variableOffsets[C]=b[C]);for(const C in T)this.placedOrientations[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.placedOrientations[C]=T[C]);if(o&&o.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");u?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:e)}updateLayerOpacities(e,o){const u={};for(const c of o){const p=c.getBucket(e);p&&c.latestFeatureIndex&&e.id===p.layerIds[0]&&this.updateBucketOpacities(p,c.tileID,u,c.collisionBoxArray)}}updateBucketOpacities(e,o,u,c){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const p=e.layers[0],b=p.layout,T=new rn(null,0,!1,!1,!0),C=b.get("text-allow-overlap"),M=b.get("icon-allow-overlap"),R=p._unevaluatedLayout.hasValue("text-variable-anchor")||p._unevaluatedLayout.hasValue("text-variable-anchor-offset"),B=b.get("text-rotation-alignment")==="map",$=b.get("text-pitch-alignment")==="map",X=b.get("icon-text-fit")!=="none",Y=new rn(null,0,C&&(M||!e.hasIconData()||b.get("icon-optional")),M&&(C||!e.hasTextData()||b.get("text-optional")),!0);!e.collisionArrays&&c&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(c);const Q=(oe,de,ee)=>{for(let ye=0;ye<de/4;ye++)oe.opacityVertexArray.emplaceBack(ee);oe.hasVisibleVertices=oe.hasVisibleVertices||ee!==rr},ie=this.collisionBoxArrays.get(e.bucketInstanceId);for(let oe=0;oe<e.symbolInstances.length;oe++){const de=e.symbolInstances.get(oe),{numHorizontalGlyphVertices:ee,numVerticalGlyphVertices:ye,crossTileID:be}=de;let Ce=this.opacities[be];u[be]?Ce=T:Ce||(Ce=Y,this.opacities[be]=Ce),u[be]=!0;const Ve=de.numIconVertices>0,et=this.placedOrientations[de.crossTileID],at=et===g.ah.vertical,pt=et===g.ah.horizontal||et===g.ah.horizontalOnly;if(ee>0||ye>0){const rt=Hn(Ce.text);Q(e.text,ee,at?rr:rt),Q(e.text,ye,pt?rr:rt);const bt=Ce.text.isHidden();[de.rightJustifiedTextSymbolIndex,de.centerJustifiedTextSymbolIndex,de.leftJustifiedTextSymbolIndex].forEach(ht=>{ht>=0&&(e.text.placedSymbolArray.get(ht).hidden=bt||at?1:0)}),de.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(de.verticalPlacedTextSymbolIndex).hidden=bt||pt?1:0);const Kt=this.variableOffsets[de.crossTileID];Kt&&this.markUsedJustification(e,Kt.anchor,de,et);const ut=this.placedOrientations[de.crossTileID];ut&&(this.markUsedJustification(e,"left",de,ut),this.markUsedOrientation(e,ut,de))}if(Ve){const rt=Hn(Ce.icon),bt=!(X&&de.verticalPlacedIconSymbolIndex&&at);de.placedIconSymbolIndex>=0&&(Q(e.icon,de.numIconVertices,bt?rt:rr),e.icon.placedSymbolArray.get(de.placedIconSymbolIndex).hidden=Ce.icon.isHidden()),de.verticalPlacedIconSymbolIndex>=0&&(Q(e.icon,de.numVerticalIconVertices,bt?rr:rt),e.icon.placedSymbolArray.get(de.verticalPlacedIconSymbolIndex).hidden=Ce.icon.isHidden())}const lt=ie&&ie.has(oe)?ie.get(oe):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const rt=e.collisionArrays[oe];if(rt){let bt=new g.P(0,0);if(rt.textBox||rt.verticalTextBox){let Kt=!0;if(R){const ut=this.variableOffsets[be];ut?(bt=Mn(ut.anchor,ut.width,ut.height,ut.textOffset,ut.textBoxScale),B&&bt._rotate($?this.transform.angle:-this.transform.angle)):Kt=!1}if(rt.textBox||rt.verticalTextBox){let ut;rt.textBox&&(ut=at),rt.verticalTextBox&&(ut=pt),co(e.textCollisionBox.collisionVertexArray,Ce.text.placed,!Kt||ut,lt.text,bt.x,bt.y)}}if(rt.iconBox||rt.verticalIconBox){const Kt=!!(!pt&&rt.verticalIconBox);let ut;rt.iconBox&&(ut=Kt),rt.verticalIconBox&&(ut=!Kt),co(e.iconCollisionBox.collisionVertexArray,Ce.icon.placed,ut,lt.icon,X?bt.x:0,X?bt.y:0)}}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);if(e.bucketInstanceId in this.collisionCircleArrays){const oe=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=oe.invProjMatrix,e.placementViewportMatrix=oe.viewportMatrix,e.collisionCircleArray=oe.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,o){const u=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*u>e}setStale(){this.stale=!0}}function co(m,e,o,u,c,p){u&&u.length!==0||(u=[0,0,0,0]);const b=u[0]-ei,T=u[1]-ei,C=u[2]-ei,M=u[3]-ei;m.emplaceBack(e?1:0,o?1:0,c||0,p||0,b,T),m.emplaceBack(e?1:0,o?1:0,c||0,p||0,C,T),m.emplaceBack(e?1:0,o?1:0,c||0,p||0,C,M),m.emplaceBack(e?1:0,o?1:0,c||0,p||0,b,M)}const Xt=Math.pow(2,25),Kl=Math.pow(2,24),Ha=Math.pow(2,17),Sr=Math.pow(2,16),nr=Math.pow(2,9),Jl=Math.pow(2,8),qn=Math.pow(2,1);function Hn(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const e=m.placed?1:0,o=Math.floor(127*m.opacity);return o*Xt+e*Kl+o*Ha+e*Sr+o*nr+e*Jl+o*qn+e}const rr=0;function ys(){return{isOccluded:(m,e,o)=>!1,getPitchedTextCorrection:(m,e,o)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(m,e,o,u){throw new Error("Not implemented.")},translatePosition:(m,e,o,u)=>function(c,p,b,T,C=!1){if(!b[0]&&!b[1])return[0,0];const M=C?T==="map"?c.angle:0:T==="viewport"?-c.angle:0;if(M){const R=Math.sin(M),B=Math.cos(M);b=[b[0]*B-b[1]*R,b[0]*R+b[1]*B]}return[C?b[0]:si(p,b[0],c.zoom),C?b[1]:si(p,b[1],c.zoom)]}(m,e,o,u),getCircleRadiusCorrection:m=>1}}class Lt{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,o,u,c,p){const b=this._bucketParts;for(;this._currentTileIndex<e.length;)if(o.getBucketParts(b,c,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,p())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,b.sort((T,C)=>T.sortKey-C.sortKey));this._currentPartIndex<b.length;)if(o.placeLayerBucketPart(b[this._currentPartIndex],this._seenCrossTileIDs,u),this._currentPartIndex++,p())return!0;return!1}}class Gi{constructor(e,o,u,c,p,b,T,C){this.placement=new cr(e,ys(),o,b,T,C),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=c,this._showCollisionBoxes=p,this._done=!1}isDone(){return this._done}continuePlacement(e,o,u){const c=xe.now(),p=()=>!this._forceFullPlacement&&xe.now()-c>2;for(;this._currentPlacementIndex>=0;){const b=o[e[this._currentPlacementIndex]],T=this.placement.collisionIndex.transform.zoom;if(b.type==="symbol"&&(!b.minzoom||b.minzoom<=T)&&(!b.maxzoom||b.maxzoom>T)){if(this._inProgressLayer||(this._inProgressLayer=new Lt(b)),this._inProgressLayer.continuePlacement(u[b.source],this.placement,this._showCollisionBoxes,b,p))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Tr=512/g.X/2;class Ji{constructor(e,o,u){this.tileID=e,this.bucketInstanceId=u,this._symbolsByKey={};const c=new Map;for(let p=0;p<o.length;p++){const b=o.get(p),T=b.key,C=c.get(T);C?C.push(b):c.set(T,[b])}for(const[p,b]of c){const T={positions:b.map(C=>({x:Math.floor(C.anchorX*Tr),y:Math.floor(C.anchorY*Tr)})),crossTileIDs:b.map(C=>C.crossTileID)};if(T.positions.length>128){const C=new g.av(T.positions.length,16,Uint16Array);for(const{x:M,y:R}of T.positions)C.add(M,R);C.finish(),delete T.positions,T.index=C}this._symbolsByKey[p]=T}}getScaledCoordinates(e,o){const{x:u,y:c,z:p}=this.tileID.canonical,{x:b,y:T,z:C}=o.canonical,M=Tr/Math.pow(2,C-p),R=(T*g.X+e.anchorY)*M,B=c*g.X*Tr;return{x:Math.floor((b*g.X+e.anchorX)*M-u*g.X*Tr),y:Math.floor(R-B)}}findMatches(e,o,u){const c=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z);for(let p=0;p<e.length;p++){const b=e.get(p);if(b.crossTileID)continue;const T=this._symbolsByKey[b.key];if(!T)continue;const C=this.getScaledCoordinates(b,o);if(T.index){const M=T.index.range(C.x-c,C.y-c,C.x+c,C.y+c).sort();for(const R of M){const B=T.crossTileIDs[R];if(!u[B]){u[B]=!0,b.crossTileID=B;break}}}else if(T.positions)for(let M=0;M<T.positions.length;M++){const R=T.positions[M],B=T.crossTileIDs[M];if(Math.abs(R.x-C.x)<=c&&Math.abs(R.y-C.y)<=c&&!u[B]){u[B]=!0,b.crossTileID=B;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class Qr{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class sr{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const o=Math.round((e-this.lng)/360);if(o!==0)for(const u in this.indexes){const c=this.indexes[u],p={};for(const b in c){const T=c[b];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+o),p[T.tileID.key]=T}this.indexes[u]=p}this.lng=e}addBucket(e,o,u){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let p=0;p<o.symbolInstances.length;p++)o.symbolInstances.get(p).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const c=this.usedCrossTileIDs[e.overscaledZ];for(const p in this.indexes){const b=this.indexes[p];if(Number(p)>e.overscaledZ)for(const T in b){const C=b[T];C.tileID.isChildOf(e)&&C.findMatches(o.symbolInstances,e,c)}else{const T=b[e.scaledTo(Number(p)).key];T&&T.findMatches(o.symbolInstances,e,c)}}for(let p=0;p<o.symbolInstances.length;p++){const b=o.symbolInstances.get(p);b.crossTileID||(b.crossTileID=u.generate(),c[b.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Ji(e,o.symbolInstances,o.bucketInstanceId),!0}removeBucketCrossTileIDs(e,o){for(const u of o.getCrossTileIDsLists())for(const c of u)delete this.usedCrossTileIDs[e][c]}removeStaleBuckets(e){let o=!1;for(const u in this.indexes){const c=this.indexes[u];for(const p in c)e[c[p].bucketInstanceId]||(this.removeBucketCrossTileIDs(u,c[p]),delete c[p],o=!0)}return o}}class oi{constructor(){this.layerIndexes={},this.crossTileIDs=new Qr,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,o,u){let c=this.layerIndexes[e.id];c===void 0&&(c=this.layerIndexes[e.id]=new sr);let p=!1;const b={};c.handleWrapJump(u);for(const T of o){const C=T.getBucket(e);C&&e.id===C.layerIds[0]&&(C.bucketInstanceId||(C.bucketInstanceId=++this.maxBucketInstanceId),c.addBucket(T.tileID,C,this.crossTileIDs)&&(p=!0),b[C.bucketInstanceId]=!0)}return c.removeStaleBuckets(b)&&(p=!0),p}pruneUnusedLayers(e){const o={};e.forEach(u=>{o[u]=!0});for(const u in this.layerIndexes)o[u]||delete this.layerIndexes[u]}}const Ai=(m,e)=>g.t(m,e&&e.filter(o=>o.identifier!=="source.canvas")),Yl=g.aw();class sa extends g.E{constructor(e,o={}){super(),this._rtlPluginLoaded=()=>{for(const u in this.sourceCaches){const c=this.sourceCaches[u].getSource().type;c!=="vector"&&c!=="geojson"||this.sourceCaches[u].reload()}},this.map=e,this.dispatcher=new wn(Oi(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(u,c)=>this.getGlyphs(u,c)),this.dispatcher.registerMessageHandler("GI",(u,c)=>this.getImages(u,c)),this.imageManager=new Di,this.imageManager.setEventedParent(this),this.glyphManager=new Ei(e._requestManager,o.localIdeographFontFamily),this.lineAtlas=new Ft(256,512),this.crossTileSymbolIndex=new oi,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new g.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",g.ay()),ur().on(Qe,this._rtlPluginLoaded),this.on("data",u=>{if(u.dataType!=="source"||u.sourceDataType!=="metadata")return;const c=this.sourceCaches[u.sourceId];if(!c)return;const p=c.getSource();if(p&&p.vectorLayerIds)for(const b in this._layers){const T=this._layers[b];T.source===p.id&&this._validateLayer(T)}})}loadURL(e,o={},u){this.fire(new g.k("dataloading",{dataType:"style"})),o.validate=typeof o.validate!="boolean"||o.validate;const c=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const p=this._loadStyleRequest;g.h(c,this._loadStyleRequest).then(b=>{this._loadStyleRequest=null,this._load(b.data,o,u)}).catch(b=>{this._loadStyleRequest=null,b&&!p.signal.aborted&&this.fire(new g.j(b))})}loadJSON(e,o={},u){this.fire(new g.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,xe.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,o.validate=o.validate!==!1,this._load(e,o,u)}).catch(()=>{})}loadEmpty(){this.fire(new g.k("dataloading",{dataType:"style"})),this._load(Yl,{validate:!1})}_load(e,o,u){var c;const p=o.transformStyle?o.transformStyle(u,e):e;if(!o.validate||!Ai(this,g.u(p))){this._loaded=!0,this.stylesheet=p;for(const b in p.sources)this.addSource(b,p.sources[b],{validate:!1});p.sprite?this._loadSprite(p.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(p.glyphs),this._createLayers(),this.light=new He(this.stylesheet.light),this.sky=new Ne(this.stylesheet.sky),this.map.setTerrain((c=this.stylesheet.terrain)!==null&&c!==void 0?c:null),this.fire(new g.k("data",{dataType:"style"})),this.fire(new g.k("style.load"))}}_createLayers(){const e=g.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(o=>o.id),this._layers={},this._serializedLayers=null;for(const o of e){const u=g.aA(o);u.setEventedParent(this,{layer:{id:o.id}}),this._layers[o.id]=u}}_loadSprite(e,o=!1,u=void 0){let c;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(p,b,T,C){return g._(this,void 0,void 0,function*(){const M=an(p),R=T>1?"@2x":"",B={},$={};for(const{id:X,url:Y}of M){const Q=b.transformRequest(Zn(Y,R,".json"),"SpriteJSON");B[X]=g.h(Q,C);const ie=b.transformRequest(Zn(Y,R,".png"),"SpriteImage");$[X]=Mt.getImage(ie,C)}return yield Promise.all([...Object.values(B),...Object.values($)]),function(X,Y){return g._(this,void 0,void 0,function*(){const Q={};for(const ie in X){Q[ie]={};const oe=xe.getImageCanvasContext((yield Y[ie]).data),de=(yield X[ie]).data;for(const ee in de){const{width:ye,height:be,x:Ce,y:Ve,sdf:et,pixelRatio:at,stretchX:pt,stretchY:lt,content:rt,textFitWidth:bt,textFitHeight:Kt}=de[ee];Q[ie][ee]={data:null,pixelRatio:at,sdf:et,stretchX:pt,stretchY:lt,content:rt,textFitWidth:bt,textFitHeight:Kt,spriteData:{width:ye,height:be,x:Ce,y:Ve,context:oe}}}}return Q})}(B,$)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(p=>{if(this._spriteRequest=null,p)for(const b in p){this._spritesImagesIds[b]=[];const T=this._spritesImagesIds[b]?this._spritesImagesIds[b].filter(C=>!(C in p)):[];for(const C of T)this.imageManager.removeImage(C),this._changedImages[C]=!0;for(const C in p[b]){const M=b==="default"?C:`${b}:${C}`;this._spritesImagesIds[b].push(M),M in this.imageManager.images?this.imageManager.updateImage(M,p[b][C],!1):this.imageManager.addImage(M,p[b][C]),o&&(this._changedImages[M]=!0)}}}).catch(p=>{this._spriteRequest=null,c=p,this.fire(new g.j(c))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),o&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new g.k("data",{dataType:"style"})),u&&u(c)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new g.k("data",{dataType:"style"}))}_validateLayer(e){const o=this.sourceCaches[e.source];if(!o)return;const u=e.sourceLayer;if(!u)return;const c=o.getSource();(c.type==="geojson"||c.vectorLayerIds&&c.vectorLayerIds.indexOf(u)===-1)&&this.fire(new g.j(new Error(`Source layer "${u}" does not exist on source "${c.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,o=!1){const u=this._serializedAllLayers();if(!e||e.length===0)return Object.values(o?g.aB(u):u);const c=[];for(const p of e)if(u[p]){const b=o?g.aB(u[p]):u[p];c.push(b)}return c}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const o=Object.keys(this._layers);for(const u of o){const c=this._layers[u];c.type!=="custom"&&(e[u]=c.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const o=this._changed;if(o){const c=Object.keys(this._updatedLayers),p=Object.keys(this._removedLayers);(c.length||p.length)&&this._updateWorkerLayers(c,p);for(const b in this._updatedSources){const T=this._updatedSources[b];if(T==="reload")this._reloadSource(b);else{if(T!=="clear")throw new Error(`Invalid action ${T}`);this._clearSource(b)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const b in this._updatedPaintProps)this._layers[b].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const u={};for(const c in this.sourceCaches){const p=this.sourceCaches[c];u[c]=p.used,p.used=!1}for(const c of this._order){const p=this._layers[c];p.recalculate(e,this._availableImages),!p.isHidden(e.zoom)&&p.source&&(this.sourceCaches[p.source].used=!0)}for(const c in u){const p=this.sourceCaches[c];!!u[c]!=!!p.used&&p.fire(new g.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:c}))}this.light.recalculate(e),this.sky.recalculate(e),this.z=e.zoom,o&&this.fire(new g.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,o){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:o})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,o={}){var u;this._checkLoaded();const c=this.serialize();if(e=o.transformStyle?o.transformStyle(c,e):e,((u=o.validate)===null||u===void 0||u)&&Ai(this,g.u(e)))return!1;(e=g.aB(e)).layers=g.az(e.layers);const p=g.aC(c,e),b=this._getOperationsToPerform(p);if(b.unimplemented.length>0)throw new Error(`Unimplemented: ${b.unimplemented.join(", ")}.`);if(b.operations.length===0)return!1;for(const T of b.operations)T();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const o=[],u=[];for(const c of e)switch(c.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":o.push(()=>this.addLayer.apply(this,c.args));break;case"removeLayer":o.push(()=>this.removeLayer.apply(this,c.args));break;case"setPaintProperty":o.push(()=>this.setPaintProperty.apply(this,c.args));break;case"setLayoutProperty":o.push(()=>this.setLayoutProperty.apply(this,c.args));break;case"setFilter":o.push(()=>this.setFilter.apply(this,c.args));break;case"addSource":o.push(()=>this.addSource.apply(this,c.args));break;case"removeSource":o.push(()=>this.removeSource.apply(this,c.args));break;case"setLayerZoomRange":o.push(()=>this.setLayerZoomRange.apply(this,c.args));break;case"setLight":o.push(()=>this.setLight.apply(this,c.args));break;case"setGeoJSONSourceData":o.push(()=>this.setGeoJSONSourceData.apply(this,c.args));break;case"setGlyphs":o.push(()=>this.setGlyphs.apply(this,c.args));break;case"setSprite":o.push(()=>this.setSprite.apply(this,c.args));break;case"setSky":o.push(()=>this.setSky.apply(this,c.args));break;case"setTerrain":o.push(()=>this.map.setTerrain.apply(this,c.args));break;case"setTransition":o.push(()=>{});break;default:u.push(c.command)}return{operations:o,unimplemented:u}}addImage(e,o){if(this.getImage(e))return this.fire(new g.j(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,o),this._afterImageUpdated(e)}updateImage(e,o){this.imageManager.updateImage(e,o)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new g.j(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new g.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,o,u={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!o.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(o).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(o.type)>=0&&this._validate(g.u.source,`sources.${e}`,o,null,u))return;this.map&&this.map._collectResourceTiming&&(o.collectResourceTiming=!0);const c=this.sourceCaches[e]=new Ut(e,o,this.dispatcher);c.style=this,c.setEventedParent(this,()=>({isSourceLoaded:c.loaded(),source:c.serialize(),sourceId:e})),c.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const u in this._layers)if(this._layers[u].source===e)return this.fire(new g.j(new Error(`Source "${e}" cannot be removed while layer "${u}" is using it.`)));const o=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],o.fire(new g.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),o.setEventedParent(null),o.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,o){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const u=this.sourceCaches[e].getSource();if(u.type!=="geojson")throw new Error(`geojsonSource.type is ${u.type}, which is !== 'geojson`);u.setData(o),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,o,u={}){this._checkLoaded();const c=e.id;if(this.getLayer(c))return void this.fire(new g.j(new Error(`Layer "${c}" already exists on this map.`)));let p;if(e.type==="custom"){if(Ai(this,g.aD(e)))return;p=g.aA(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(c,e.source),e=g.aB(e),e=g.e(e,{source:c})),this._validate(g.u.layer,`layers.${c}`,e,{arrayIndex:-1},u))return;p=g.aA(e),this._validateLayer(p),p.setEventedParent(this,{layer:{id:c}})}const b=o?this._order.indexOf(o):this._order.length;if(o&&b===-1)this.fire(new g.j(new Error(`Cannot add layer "${c}" before non-existing layer "${o}".`)));else{if(this._order.splice(b,0,c),this._layerOrderChanged=!0,this._layers[c]=p,this._removedLayers[c]&&p.source&&p.type!=="custom"){const T=this._removedLayers[c];delete this._removedLayers[c],T.type!==p.type?this._updatedSources[p.source]="clear":(this._updatedSources[p.source]="reload",this.sourceCaches[p.source].pause())}this._updateLayer(p),p.onAdd&&p.onAdd(this.map)}}moveLayer(e,o){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new g.j(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===o)return;const u=this._order.indexOf(e);this._order.splice(u,1);const c=o?this._order.indexOf(o):this._order.length;o&&c===-1?this.fire(new g.j(new Error(`Cannot move layer "${e}" before non-existing layer "${o}".`))):(this._order.splice(c,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const o=this._layers[e];if(!o)return void this.fire(new g.j(new Error(`Cannot remove non-existing layer "${e}".`)));o.setEventedParent(null);const u=this._order.indexOf(e);this._order.splice(u,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=o,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],o.onRemove&&o.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,o,u){this._checkLoaded();const c=this.getLayer(e);c?c.minzoom===o&&c.maxzoom===u||(o!=null&&(c.minzoom=o),u!=null&&(c.maxzoom=u),this._updateLayer(c)):this.fire(new g.j(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,o,u={}){this._checkLoaded();const c=this.getLayer(e);if(c){if(!g.aE(c.filter,o))return o==null?(c.filter=void 0,void this._updateLayer(c)):void(this._validate(g.u.filter,`layers.${c.id}.filter`,o,null,u)||(c.filter=g.aB(o),this._updateLayer(c)))}else this.fire(new g.j(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return g.aB(this.getLayer(e).filter)}setLayoutProperty(e,o,u,c={}){this._checkLoaded();const p=this.getLayer(e);p?g.aE(p.getLayoutProperty(o),u)||(p.setLayoutProperty(o,u,c),this._updateLayer(p)):this.fire(new g.j(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,o){const u=this.getLayer(e);if(u)return u.getLayoutProperty(o);this.fire(new g.j(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,o,u,c={}){this._checkLoaded();const p=this.getLayer(e);p?g.aE(p.getPaintProperty(o),u)||(p.setPaintProperty(o,u,c)&&this._updateLayer(p),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new g.j(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,o){return this.getLayer(e).getPaintProperty(o)}setFeatureState(e,o){this._checkLoaded();const u=e.source,c=e.sourceLayer,p=this.sourceCaches[u];if(p===void 0)return void this.fire(new g.j(new Error(`The source '${u}' does not exist in the map's style.`)));const b=p.getSource().type;b==="geojson"&&c?this.fire(new g.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):b!=="vector"||c?(e.id===void 0&&this.fire(new g.j(new Error("The feature id parameter must be provided."))),p.setFeatureState(c,e.id,o)):this.fire(new g.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,o){this._checkLoaded();const u=e.source,c=this.sourceCaches[u];if(c===void 0)return void this.fire(new g.j(new Error(`The source '${u}' does not exist in the map's style.`)));const p=c.getSource().type,b=p==="vector"?e.sourceLayer:void 0;p!=="vector"||b?o&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new g.j(new Error("A feature id is required to remove its specific state property."))):c.removeFeatureState(b,e.id,o):this.fire(new g.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const o=e.source,u=e.sourceLayer,c=this.sourceCaches[o];if(c!==void 0)return c.getSource().type!=="vector"||u?(e.id===void 0&&this.fire(new g.j(new Error("The feature id parameter must be provided."))),c.getFeatureState(u,e.id)):void this.fire(new g.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new g.j(new Error(`The source '${o}' does not exist in the map's style.`)))}getTransition(){return g.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=g.aF(this.sourceCaches,p=>p.serialize()),o=this._serializeByIds(this._order,!0),u=this.map.getTerrain()||void 0,c=this.stylesheet;return g.aG({version:c.version,name:c.name,metadata:c.metadata,light:c.light,sky:c.sky,center:c.center,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch,sprite:c.sprite,glyphs:c.glyphs,transition:c.transition,sources:e,layers:o,terrain:u},p=>p!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const o=b=>this._layers[b].type==="fill-extrusion",u={},c=[];for(let b=this._order.length-1;b>=0;b--){const T=this._order[b];if(o(T)){u[T]=b;for(const C of e){const M=C[T];if(M)for(const R of M)c.push(R)}}}c.sort((b,T)=>T.intersectionZ-b.intersectionZ);const p=[];for(let b=this._order.length-1;b>=0;b--){const T=this._order[b];if(o(T))for(let C=c.length-1;C>=0;C--){const M=c[C].feature;if(u[M.layer.id]<b)break;p.push(M),c.pop()}else for(const C of e){const M=C[T];if(M)for(const R of M)p.push(R.feature)}}return p}queryRenderedFeatures(e,o,u){o&&o.filter&&this._validate(g.u.filter,"queryRenderedFeatures.filter",o.filter,null,o);const c={};if(o&&o.layers){if(!Array.isArray(o.layers))return this.fire(new g.j(new Error("parameters.layers must be an Array."))),[];for(const T of o.layers){const C=this._layers[T];if(!C)return this.fire(new g.j(new Error(`The layer '${T}' does not exist in the map's style and cannot be queried for features.`))),[];c[C.source]=!0}}const p=[];o.availableImages=this._availableImages;const b=this._serializedAllLayers();for(const T in this.sourceCaches)o.layers&&!c[T]||p.push(Fr(this.sourceCaches[T],this._layers,b,e,o,u));return this.placement&&p.push(function(T,C,M,R,B,$,X){const Y={},Q=$.queryRenderedSymbols(R),ie=[];for(const oe of Object.keys(Q).map(Number))ie.push(X[oe]);ie.sort(Vs);for(const oe of ie){const de=oe.featureIndex.lookupSymbolFeatures(Q[oe.bucketInstanceId],C,oe.bucketIndex,oe.sourceLayerIndex,B.filter,B.layers,B.availableImages,T);for(const ee in de){const ye=Y[ee]=Y[ee]||[],be=de[ee];be.sort((Ce,Ve)=>{const et=oe.featureSortOrder;if(et){const at=et.indexOf(Ce.featureIndex);return et.indexOf(Ve.featureIndex)-at}return Ve.featureIndex-Ce.featureIndex});for(const Ce of be)ye.push(Ce)}}for(const oe in Y)Y[oe].forEach(de=>{const ee=de.feature,ye=M[T[oe].source].getFeatureState(ee.layer["source-layer"],ee.id);ee.source=ee.layer.source,ee.layer["source-layer"]&&(ee.sourceLayer=ee.layer["source-layer"]),ee.state=ye});return Y}(this._layers,b,this.sourceCaches,e,o,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(p)}querySourceFeatures(e,o){o&&o.filter&&this._validate(g.u.filter,"querySourceFeatures.filter",o.filter,null,o);const u=this.sourceCaches[e];return u?function(c,p){const b=c.getRenderableIds().map(M=>c.getTileByID(M)),T=[],C={};for(let M=0;M<b.length;M++){const R=b[M],B=R.tileID.canonical.key;C[B]||(C[B]=!0,R.querySourceFeatures(T,p))}return T}(u,o):[]}getLight(){return this.light.getLight()}setLight(e,o={}){this._checkLoaded();const u=this.light.getLight();let c=!1;for(const b in e)if(!g.aE(e[b],u[b])){c=!0;break}if(!c)return;const p={now:xe.now(),transition:g.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,o),this.light.updateTransitions(p)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,o={}){const u=this.getSky();let c=!1;if(!e&&!u)return;if(e&&!u)c=!0;else if(!e&&u)c=!0;else for(const b in e)if(!g.aE(e[b],u[b])){c=!0;break}if(!c)return;const p={now:xe.now(),transition:g.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,o),this.sky.updateTransitions(p)}_validate(e,o,u,c,p={}){return(!p||p.validate!==!1)&&Ai(this,e.call(g.u,g.e({key:o,style:this.serialize(),value:u,styleSpec:g.v},c)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),ur().off(Qe,this._rtlPluginLoaded);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this.sourceCaches){const u=this.sourceCaches[o];u.setEventedParent(null),u.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const o in this.sourceCaches)this.sourceCaches[o].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,o,u,c,p=!1){let b=!1,T=!1;const C={};for(const M of this._order){const R=this._layers[M];if(R.type!=="symbol")continue;if(!C[R.source]){const $=this.sourceCaches[R.source];C[R.source]=$.getRenderableIds(!0).map(X=>$.getTileByID(X)).sort((X,Y)=>Y.tileID.overscaledZ-X.tileID.overscaledZ||(X.tileID.isLessThan(Y.tileID)?-1:1))}const B=this.crossTileSymbolIndex.addLayer(R,C[R.source],e.center.lng);b=b||B}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((p=p||this._layerOrderChanged||u===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(xe.now(),e.zoom))&&(this.pauseablePlacement=new Gi(e,this.map.terrain,this._order,p,o,u,c,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,C),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(xe.now()),T=!0),b&&this.pauseablePlacement.placement.setStale()),T||b)for(const M of this._order){const R=this._layers[M];R.type==="symbol"&&this.placement.updateLayerOpacities(R,C[R.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(xe.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,o){return g._(this,void 0,void 0,function*(){const u=yield this.imageManager.getImages(o.icons);this._updateTilesForChangedImages();const c=this.sourceCaches[o.source];return c&&c.setDependencies(o.tileID.key,o.type,o.icons),u})}getGlyphs(e,o){return g._(this,void 0,void 0,function*(){const u=yield this.glyphManager.getGlyphs(o.stacks),c=this.sourceCaches[o.source];return c&&c.setDependencies(o.tileID.key,o.type,[""]),u})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,o={}){this._checkLoaded(),e&&this._validate(g.u.glyphs,"glyphs",e,null,o)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,o,u={},c){this._checkLoaded();const p=[{id:e,url:o}],b=[...an(this.stylesheet.sprite),...p];this._validate(g.u.sprite,"sprite",b,null,u)||(this.stylesheet.sprite=b,this._loadSprite(p,!0,c))}removeSprite(e){this._checkLoaded();const o=an(this.stylesheet.sprite);if(o.find(u=>u.id===e)){if(this._spritesImagesIds[e])for(const u of this._spritesImagesIds[e])this.imageManager.removeImage(u),this._changedImages[u]=!0;o.splice(o.findIndex(u=>u.id===e),1),this.stylesheet.sprite=o.length>0?o:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new g.k("data",{dataType:"style"}))}else this.fire(new g.j(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return an(this.stylesheet.sprite)}setSprite(e,o={},u){this._checkLoaded(),e&&this._validate(g.u.sprite,"sprite",e,null,o)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,u):(this._unloadSprite(),u&&u(null)))}}var Pn=g.Y([{name:"a_pos",type:"Int16",components:2}]);const ho={prelude:wi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:wi(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:wi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:wi(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:wi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:wi(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:wi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:wi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:wi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:wi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:wi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:wi(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:wi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:wi(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:wi(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:wi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:wi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:wi(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:wi(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:wi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:wi(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:wi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:wi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:wi(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:wi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:wi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:wi("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:wi("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:wi("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:wi("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function wi(m,e){const o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=e.match(/attribute ([\w]+) ([\w]+)/g),c=m.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),p=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=p?p.concat(c):c,T={};return{fragmentSource:m=m.replace(o,(C,M,R,B,$)=>(T[$]=!0,M==="define"?`
#ifndef HAS_UNIFORM_u_${$}
varying ${R} ${B} ${$};
#else
uniform ${R} ${B} u_${$};
#endif
`:`
#ifdef HAS_UNIFORM_u_${$}
    ${R} ${B} ${$} = u_${$};
#endif
`)),vertexSource:e=e.replace(o,(C,M,R,B,$)=>{const X=B==="float"?"vec2":"vec4",Y=$.match(/color/)?"color":X;return T[$]?M==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
attribute ${R} ${X} a_${$};
varying ${R} ${B} ${$};
#else
uniform ${R} ${B} u_${$};
#endif
`:Y==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = a_${$};
#else
    ${R} ${B} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = unpack_mix_${Y}(a_${$}, u_${$}_t);
#else
    ${R} ${B} ${$} = u_${$};
#endif
`:M==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
attribute ${R} ${X} a_${$};
#else
uniform ${R} ${B} u_${$};
#endif
`:Y==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${R} ${B} ${$} = a_${$};
#else
    ${R} ${B} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${R} ${B} ${$} = unpack_mix_${Y}(a_${$}, u_${$}_t);
#else
    ${R} ${B} ${$} = u_${$};
#endif
`}),staticAttributes:u,staticUniforms:b}}class jr{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,o,u,c,p,b,T,C,M){this.context=e;let R=this.boundPaintVertexBuffers.length!==c.length;for(let B=0;!R&&B<c.length;B++)this.boundPaintVertexBuffers[B]!==c[B]&&(R=!0);!this.vao||this.boundProgram!==o||this.boundLayoutVertexBuffer!==u||R||this.boundIndexBuffer!==p||this.boundVertexOffset!==b||this.boundDynamicVertexBuffer!==T||this.boundDynamicVertexBuffer2!==C||this.boundDynamicVertexBuffer3!==M?this.freshBind(o,u,c,p,b,T,C,M):(e.bindVertexArray.set(this.vao),T&&T.bind(),p&&p.dynamicDraw&&p.bind(),C&&C.bind(),M&&M.bind())}freshBind(e,o,u,c,p,b,T,C){const M=e.numAttributes,R=this.context,B=R.gl;this.vao&&this.destroy(),this.vao=R.createVertexArray(),R.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=u,this.boundIndexBuffer=c,this.boundVertexOffset=p,this.boundDynamicVertexBuffer=b,this.boundDynamicVertexBuffer2=T,this.boundDynamicVertexBuffer3=C,o.enableAttributes(B,e);for(const $ of u)$.enableAttributes(B,e);b&&b.enableAttributes(B,e),T&&T.enableAttributes(B,e),C&&C.enableAttributes(B,e),o.bind(),o.setVertexAttribPointers(B,e,p);for(const $ of u)$.bind(),$.setVertexAttribPointers(B,e,p);b&&(b.bind(),b.setVertexAttribPointers(B,e,p)),c&&c.bind(),T&&(T.bind(),T.setVertexAttribPointers(B,e,p)),C&&(C.bind(),C.setVertexAttribPointers(B,e,p)),R.currentNumAttributes=M}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const mn=(m,e,o,u,c)=>({u_matrix:m,u_texture:0,u_ele_delta:e,u_fog_matrix:o,u_fog_color:u?u.properties.get("fog-color"):g.aM.white,u_fog_ground_blend:u?u.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:u?u.calculateFogBlendOpacity(c):0,u_horizon_color:u?u.properties.get("horizon-color"):g.aM.white,u_horizon_fog_blend:u?u.properties.get("horizon-fog-blend"):1});function Pr(m){const e=[];for(let o=0;o<m.length;o++){if(m[o]===null)continue;const u=m[o].split(" ");e.push(u.pop())}return e}class zi{constructor(e,o,u,c,p,b){const T=e.gl;this.program=T.createProgram();const C=Pr(o.staticAttributes),M=u?u.getBinderAttributes():[],R=C.concat(M),B=ho.prelude.staticUniforms?Pr(ho.prelude.staticUniforms):[],$=o.staticUniforms?Pr(o.staticUniforms):[],X=u?u.getBinderUniforms():[],Y=B.concat($).concat(X),Q=[];for(const Ce of Y)Q.indexOf(Ce)<0&&Q.push(Ce);const ie=u?u.defines():[];p&&ie.push("#define OVERDRAW_INSPECTOR;"),b&&ie.push("#define TERRAIN3D;");const oe=ie.concat(ho.prelude.fragmentSource,o.fragmentSource).join(`
`),de=ie.concat(ho.prelude.vertexSource,o.vertexSource).join(`
`),ee=T.createShader(T.FRAGMENT_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);if(T.shaderSource(ee,oe),T.compileShader(ee),!T.getShaderParameter(ee,T.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${T.getShaderInfoLog(ee)}`);T.attachShader(this.program,ee);const ye=T.createShader(T.VERTEX_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);if(T.shaderSource(ye,de),T.compileShader(ye),!T.getShaderParameter(ye,T.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${T.getShaderInfoLog(ye)}`);T.attachShader(this.program,ye),this.attributes={};const be={};this.numAttributes=R.length;for(let Ce=0;Ce<this.numAttributes;Ce++)R[Ce]&&(T.bindAttribLocation(this.program,Ce,R[Ce]),this.attributes[R[Ce]]=Ce);if(T.linkProgram(this.program),!T.getProgramParameter(this.program,T.LINK_STATUS))throw new Error(`Program failed to link: ${T.getProgramInfoLog(this.program)}`);T.deleteShader(ye),T.deleteShader(ee);for(let Ce=0;Ce<Q.length;Ce++){const Ve=Q[Ce];if(Ve&&!be[Ve]){const et=T.getUniformLocation(this.program,Ve);et&&(be[Ve]=et)}}this.fixedUniforms=c(e,be),this.terrainUniforms=((Ce,Ve)=>({u_depth:new g.aH(Ce,Ve.u_depth),u_terrain:new g.aH(Ce,Ve.u_terrain),u_terrain_dim:new g.aI(Ce,Ve.u_terrain_dim),u_terrain_matrix:new g.aJ(Ce,Ve.u_terrain_matrix),u_terrain_unpack:new g.aK(Ce,Ve.u_terrain_unpack),u_terrain_exaggeration:new g.aI(Ce,Ve.u_terrain_exaggeration)}))(e,be),this.binderUniforms=u?u.getUniforms(e,be):[]}draw(e,o,u,c,p,b,T,C,M,R,B,$,X,Y,Q,ie,oe,de){const ee=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(u),e.setStencilMode(c),e.setColorMode(p),e.setCullFace(b),C){e.activeTexture.set(ee.TEXTURE2),ee.bindTexture(ee.TEXTURE_2D,C.depthTexture),e.activeTexture.set(ee.TEXTURE3),ee.bindTexture(ee.TEXTURE_2D,C.texture);for(const be in this.terrainUniforms)this.terrainUniforms[be].set(C[be])}for(const be in this.fixedUniforms)this.fixedUniforms[be].set(T[be]);Q&&Q.setUniforms(e,this.binderUniforms,X,{zoom:Y});let ye=0;switch(o){case ee.LINES:ye=2;break;case ee.TRIANGLES:ye=3;break;case ee.LINE_STRIP:ye=1}for(const be of $.get()){const Ce=be.vaos||(be.vaos={});(Ce[M]||(Ce[M]=new jr)).bind(e,this,R,Q?Q.getPaintVertexBuffers():[],B,be.vertexOffset,ie,oe,de),ee.drawElements(o,be.primitiveLength*ye,ee.UNSIGNED_SHORT,be.primitiveOffset*ye*2)}}}function fo(m,e,o){const u=1/si(o,1,e.transform.tileZoom),c=Math.pow(2,o.tileID.overscaledZ),p=o.tileSize*Math.pow(2,e.transform.tileZoom)/c,b=p*(o.tileID.canonical.x+o.tileID.wrap*c),T=p*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[u,m.fromScale,m.toScale],u_fade:m.t,u_pixel_coord_upper:[b>>16,T>>16],u_pixel_coord_lower:[65535&b,65535&T]}}const jo=(m,e,o,u)=>{const c=e.style.light,p=c.properties.get("position"),b=[p.x,p.y,p.z],T=function(){var M=new g.A(9);return g.A!=Float32Array&&(M[1]=0,M[2]=0,M[3]=0,M[5]=0,M[6]=0,M[7]=0),M[0]=1,M[4]=1,M[8]=1,M}();c.properties.get("anchor")==="viewport"&&function(M,R){var B=Math.sin(R),$=Math.cos(R);M[0]=$,M[1]=B,M[2]=0,M[3]=-B,M[4]=$,M[5]=0,M[6]=0,M[7]=0,M[8]=1}(T,-e.transform.angle),function(M,R,B){var $=R[0],X=R[1],Y=R[2];M[0]=$*B[0]+X*B[3]+Y*B[6],M[1]=$*B[1]+X*B[4]+Y*B[7],M[2]=$*B[2]+X*B[5]+Y*B[8]}(b,b,T);const C=c.properties.get("color");return{u_matrix:m,u_lightpos:b,u_lightintensity:c.properties.get("intensity"),u_lightcolor:[C.r,C.g,C.b],u_vertical_gradient:+o,u_opacity:u}},Us=(m,e,o,u,c,p,b)=>g.e(jo(m,e,o,u),fo(p,e,b),{u_height_factor:-Math.pow(2,c.overscaledZ)/b.tileSize/8}),po=m=>({u_matrix:m}),Ga=(m,e,o,u)=>g.e(po(m),fo(o,e,u)),Wa=(m,e)=>({u_matrix:m,u_world:e}),Ia=(m,e,o,u,c)=>g.e(Ga(m,e,o,u),{u_world:c}),Ea=(m,e,o,u)=>{const c=m.transform;let p,b;if(u.paint.get("circle-pitch-alignment")==="map"){const T=si(o,1,c.zoom);p=!0,b=[T,T]}else p=!1,b=c.pixelsToGLUnits;return{u_camera_to_center_distance:c.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_matrix:m.translatePosMatrix(e.posMatrix,o,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_pitch_with_map:+p,u_device_pixel_ratio:m.pixelRatio,u_extrude_scale:b}},Gn=(m,e,o)=>({u_matrix:m,u_inv_matrix:e,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}),Vr=(m,e,o=1)=>({u_matrix:m,u_color:e,u_overlay:0,u_overlay_scale:o}),dn=m=>({u_matrix:m}),On=(m,e,o,u)=>({u_matrix:m,u_extrude_scale:si(e,1,o),u_intensity:u}),Jt=(m,e,o,u)=>{const c=g.H();g.aP(c,0,m.width,m.height,0,0,1);const p=m.context.gl;return{u_matrix:c,u_world:[p.drawingBufferWidth,p.drawingBufferHeight],u_image:o,u_color_ramp:u,u_opacity:e.paint.get("heatmap-opacity")}};function kn(m,e){const o=Math.pow(2,e.canonical.z),u=e.canonical.y;return[new g.Z(0,u/o).toLngLat().lat,new g.Z(0,(u+1)/o).toLngLat().lat]}const Ui=(m,e,o,u)=>{const c=m.transform;return{u_matrix:vs(m,e,o,u),u_ratio:1/si(e,1,c.zoom),u_device_pixel_ratio:m.pixelRatio,u_units_to_pixels:[1/c.pixelsToGLUnits[0],1/c.pixelsToGLUnits[1]]}},_l=(m,e,o,u,c)=>g.e(Ui(m,e,o,c),{u_image:0,u_image_height:u}),es=(m,e,o,u,c)=>{const p=m.transform,b=Xa(e,p);return{u_matrix:vs(m,e,o,c),u_texsize:e.imageAtlasTexture.size,u_ratio:1/si(e,1,p.zoom),u_device_pixel_ratio:m.pixelRatio,u_image:0,u_scale:[b,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},Ql=(m,e,o,u,c,p)=>{const b=m.lineAtlas,T=Xa(e,m.transform),C=o.layout.get("line-cap")==="round",M=b.getDash(u.from,C),R=b.getDash(u.to,C),B=M.width*c.fromScale,$=R.width*c.toScale;return g.e(Ui(m,e,o,p),{u_patternscale_a:[T/B,-M.height/2],u_patternscale_b:[T/$,-R.height/2],u_sdfgamma:b.width/(256*Math.min(B,$)*m.pixelRatio)/2,u_image:0,u_tex_y_a:M.y,u_tex_y_b:R.y,u_mix:c.t})};function Xa(m,e){return 1/si(m,1,e.tileZoom)}function vs(m,e,o,u){return m.translatePosMatrix(u?u.posMatrix:e.tileID.posMatrix,e,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const gl=(m,e,o,u,c)=>{return{u_matrix:m,u_tl_parent:e,u_scale_parent:o,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*c.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:c.paint.get("raster-brightness-min"),u_brightness_high:c.paint.get("raster-brightness-max"),u_saturation_factor:(b=c.paint.get("raster-saturation"),b>0?1-1/(1.001-b):-b),u_contrast_factor:(p=c.paint.get("raster-contrast"),p>0?1/(1-p):1+p),u_spin_weights:Ka(c.paint.get("raster-hue-rotate"))};var p,b};function Ka(m){m*=Math.PI/180;const e=Math.sin(m),o=Math.cos(m);return[(2*o+1)/3,(-Math.sqrt(3)*e-o+1)/3,(Math.sqrt(3)*e-o+1)/3]}const _n=(m,e,o,u,c,p,b,T,C,M,R,B,$,X)=>{const Y=b.transform;return{u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:Y.cameraToCenterDistance,u_pitch:Y.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:Y.width/Y.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:C,u_coord_matrix:M,u_is_text:+B,u_pitch_with_map:+u,u_is_along_line:c,u_is_variable_anchor:p,u_texsize:$,u_texture:0,u_translation:R,u_pitched_scale:X}},hr=(m,e,o,u,c,p,b,T,C,M,R,B,$,X,Y)=>{const Q=b.transform;return g.e(_n(m,e,o,u,c,p,b,T,C,M,R,B,$,Y),{u_gamma_scale:u?Math.cos(Q._pitch)*Q.cameraToCenterDistance:1,u_device_pixel_ratio:b.pixelRatio,u_is_halo:1})},mo=(m,e,o,u,c,p,b,T,C,M,R,B,$,X)=>g.e(hr(m,e,o,u,c,p,b,T,C,M,R,!0,B,!0,X),{u_texsize_icon:$,u_texture_icon:1}),Vo=(m,e,o)=>({u_matrix:m,u_opacity:e,u_color:o}),eu=(m,e,o,u,c,p)=>g.e(function(b,T,C,M){const R=C.imageManager.getPattern(b.from.toString()),B=C.imageManager.getPattern(b.to.toString()),{width:$,height:X}=C.imageManager.getPixelSize(),Y=Math.pow(2,M.tileID.overscaledZ),Q=M.tileSize*Math.pow(2,C.transform.tileZoom)/Y,ie=Q*(M.tileID.canonical.x+M.tileID.wrap*Y),oe=Q*M.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:R.tl,u_pattern_br_a:R.br,u_pattern_tl_b:B.tl,u_pattern_br_b:B.br,u_texsize:[$,X],u_mix:T.t,u_pattern_size_a:R.displaySize,u_pattern_size_b:B.displaySize,u_scale_a:T.fromScale,u_scale_b:T.toScale,u_tile_units_to_pixels:1/si(M,1,C.transform.tileZoom),u_pixel_coord_upper:[ie>>16,oe>>16],u_pixel_coord_lower:[65535&ie,65535&oe]}}(u,p,o,c),{u_matrix:m,u_opacity:e}),yl={fillExtrusion:(m,e)=>({u_matrix:new g.aJ(m,e.u_matrix),u_lightpos:new g.aN(m,e.u_lightpos),u_lightintensity:new g.aI(m,e.u_lightintensity),u_lightcolor:new g.aN(m,e.u_lightcolor),u_vertical_gradient:new g.aI(m,e.u_vertical_gradient),u_opacity:new g.aI(m,e.u_opacity)}),fillExtrusionPattern:(m,e)=>({u_matrix:new g.aJ(m,e.u_matrix),u_lightpos:new g.aN(m,e.u_lightpos),u_lightintensity:new g.aI(m,e.u_lightintensity),u_lightcolor:new g.aN(m,e.u_lightcolor),u_vertical_gradient:new g.aI(m,e.u_vertical_gradient),u_height_factor:new g.aI(m,e.u_height_factor),u_image:new g.aH(m,e.u_image),u_texsize:new g.aO(m,e.u_texsize),u_pixel_coord_upper:new g.aO(m,e.u_pixel_coord_upper),u_pixel_coord_lower:new g.aO(m,e.u_pixel_coord_lower),u_scale:new g.aN(m,e.u_scale),u_fade:new g.aI(m,e.u_fade),u_opacity:new g.aI(m,e.u_opacity)}),fill:(m,e)=>({u_matrix:new g.aJ(m,e.u_matrix)}),fillPattern:(m,e)=>({u_matrix:new g.aJ(m,e.u_matrix),u_image:new g.aH(m,e.u_image),u_texsize:new g.aO(m,e.u_texsize),u_pixel_coord_upper:new g.aO(m,e.u_pixel_coord_upper),u_pixel_coord_lower:new g.aO(m,e.u_pixel_coord_lower),u_scale:new g.aN(m,e.u_scale),u_fade:new g.aI(m,e.u_fade)}),fillOutline:(m,e)=>({u_matrix:new g.aJ(m,e.u_matrix),u_world:new g.aO(m,e.u_world)}),fillOutlinePattern:(m,e)=>({u_matrix:new g.aJ(m,e.u_matrix),u_world:new g.aO(m,e.u_world),u_image:new g.aH(m,e.u_image),u_texsize:new g.aO(m,e.u_texsize),u_pixel_coord_upper:new g.aO(m,e.u_pixel_coord_upper),u_pixel_coord_lower:new g.aO(m,e.u_pixel_coord_lower),u_scale:new g.aN(m,e.u_scale),u_fade:new g.aI(m,e.u_fade)}),circle:(m,e)=>({u_camera_to_center_distance:new g.aI(m,e.u_camera_to_center_distance),u_scale_with_map:new g.aH(m,e.u_scale_with_map),u_pitch_with_map:new g.aH(m,e.u_pitch_with_map),u_extrude_scale:new g.aO(m,e.u_extrude_scale),u_device_pixel_ratio:new g.aI(m,e.u_device_pixel_ratio),u_matrix:new g.aJ(m,e.u_matrix)}),collisionBox:(m,e)=>({u_matrix:new g.aJ(m,e.u_matrix),u_pixel_extrude_scale:new g.aO(m,e.u_pixel_extrude_scale)}),collisionCircle:(m,e)=>({u_matrix:new g.aJ(m,e.u_matrix),u_inv_matrix:new g.aJ(m,e.u_inv_matrix),u_camera_to_center_distance:new g.aI(m,e.u_camera_to_center_distance),u_viewport_size:new g.aO(m,e.u_viewport_size)}),debug:(m,e)=>({u_color:new g.aL(m,e.u_color),u_matrix:new g.aJ(m,e.u_matrix),u_overlay:new g.aH(m,e.u_overlay),u_overlay_scale:new g.aI(m,e.u_overlay_scale)}),clippingMask:(m,e)=>({u_matrix:new g.aJ(m,e.u_matrix)}),heatmap:(m,e)=>({u_extrude_scale:new g.aI(m,e.u_extrude_scale),u_intensity:new g.aI(m,e.u_intensity),u_matrix:new g.aJ(m,e.u_matrix)}),heatmapTexture:(m,e)=>({u_matrix:new g.aJ(m,e.u_matrix),u_world:new g.aO(m,e.u_world),u_image:new g.aH(m,e.u_image),u_color_ramp:new g.aH(m,e.u_color_ramp),u_opacity:new g.aI(m,e.u_opacity)}),hillshade:(m,e)=>({u_matrix:new g.aJ(m,e.u_matrix),u_image:new g.aH(m,e.u_image),u_latrange:new g.aO(m,e.u_latrange),u_light:new g.aO(m,e.u_light),u_shadow:new g.aL(m,e.u_shadow),u_highlight:new g.aL(m,e.u_highlight),u_accent:new g.aL(m,e.u_accent)}),hillshadePrepare:(m,e)=>({u_matrix:new g.aJ(m,e.u_matrix),u_image:new g.aH(m,e.u_image),u_dimension:new g.aO(m,e.u_dimension),u_zoom:new g.aI(m,e.u_zoom),u_unpack:new g.aK(m,e.u_unpack)}),line:(m,e)=>({u_matrix:new g.aJ(m,e.u_matrix),u_ratio:new g.aI(m,e.u_ratio),u_device_pixel_ratio:new g.aI(m,e.u_device_pixel_ratio),u_units_to_pixels:new g.aO(m,e.u_units_to_pixels)}),lineGradient:(m,e)=>({u_matrix:new g.aJ(m,e.u_matrix),u_ratio:new g.aI(m,e.u_ratio),u_device_pixel_ratio:new g.aI(m,e.u_device_pixel_ratio),u_units_to_pixels:new g.aO(m,e.u_units_to_pixels),u_image:new g.aH(m,e.u_image),u_image_height:new g.aI(m,e.u_image_height)}),linePattern:(m,e)=>({u_matrix:new g.aJ(m,e.u_matrix),u_texsize:new g.aO(m,e.u_texsize),u_ratio:new g.aI(m,e.u_ratio),u_device_pixel_ratio:new g.aI(m,e.u_device_pixel_ratio),u_image:new g.aH(m,e.u_image),u_units_to_pixels:new g.aO(m,e.u_units_to_pixels),u_scale:new g.aN(m,e.u_scale),u_fade:new g.aI(m,e.u_fade)}),lineSDF:(m,e)=>({u_matrix:new g.aJ(m,e.u_matrix),u_ratio:new g.aI(m,e.u_ratio),u_device_pixel_ratio:new g.aI(m,e.u_device_pixel_ratio),u_units_to_pixels:new g.aO(m,e.u_units_to_pixels),u_patternscale_a:new g.aO(m,e.u_patternscale_a),u_patternscale_b:new g.aO(m,e.u_patternscale_b),u_sdfgamma:new g.aI(m,e.u_sdfgamma),u_image:new g.aH(m,e.u_image),u_tex_y_a:new g.aI(m,e.u_tex_y_a),u_tex_y_b:new g.aI(m,e.u_tex_y_b),u_mix:new g.aI(m,e.u_mix)}),raster:(m,e)=>({u_matrix:new g.aJ(m,e.u_matrix),u_tl_parent:new g.aO(m,e.u_tl_parent),u_scale_parent:new g.aI(m,e.u_scale_parent),u_buffer_scale:new g.aI(m,e.u_buffer_scale),u_fade_t:new g.aI(m,e.u_fade_t),u_opacity:new g.aI(m,e.u_opacity),u_image0:new g.aH(m,e.u_image0),u_image1:new g.aH(m,e.u_image1),u_brightness_low:new g.aI(m,e.u_brightness_low),u_brightness_high:new g.aI(m,e.u_brightness_high),u_saturation_factor:new g.aI(m,e.u_saturation_factor),u_contrast_factor:new g.aI(m,e.u_contrast_factor),u_spin_weights:new g.aN(m,e.u_spin_weights)}),symbolIcon:(m,e)=>({u_is_size_zoom_constant:new g.aH(m,e.u_is_size_zoom_constant),u_is_size_feature_constant:new g.aH(m,e.u_is_size_feature_constant),u_size_t:new g.aI(m,e.u_size_t),u_size:new g.aI(m,e.u_size),u_camera_to_center_distance:new g.aI(m,e.u_camera_to_center_distance),u_pitch:new g.aI(m,e.u_pitch),u_rotate_symbol:new g.aH(m,e.u_rotate_symbol),u_aspect_ratio:new g.aI(m,e.u_aspect_ratio),u_fade_change:new g.aI(m,e.u_fade_change),u_matrix:new g.aJ(m,e.u_matrix),u_label_plane_matrix:new g.aJ(m,e.u_label_plane_matrix),u_coord_matrix:new g.aJ(m,e.u_coord_matrix),u_is_text:new g.aH(m,e.u_is_text),u_pitch_with_map:new g.aH(m,e.u_pitch_with_map),u_is_along_line:new g.aH(m,e.u_is_along_line),u_is_variable_anchor:new g.aH(m,e.u_is_variable_anchor),u_texsize:new g.aO(m,e.u_texsize),u_texture:new g.aH(m,e.u_texture),u_translation:new g.aO(m,e.u_translation),u_pitched_scale:new g.aI(m,e.u_pitched_scale)}),symbolSDF:(m,e)=>({u_is_size_zoom_constant:new g.aH(m,e.u_is_size_zoom_constant),u_is_size_feature_constant:new g.aH(m,e.u_is_size_feature_constant),u_size_t:new g.aI(m,e.u_size_t),u_size:new g.aI(m,e.u_size),u_camera_to_center_distance:new g.aI(m,e.u_camera_to_center_distance),u_pitch:new g.aI(m,e.u_pitch),u_rotate_symbol:new g.aH(m,e.u_rotate_symbol),u_aspect_ratio:new g.aI(m,e.u_aspect_ratio),u_fade_change:new g.aI(m,e.u_fade_change),u_matrix:new g.aJ(m,e.u_matrix),u_label_plane_matrix:new g.aJ(m,e.u_label_plane_matrix),u_coord_matrix:new g.aJ(m,e.u_coord_matrix),u_is_text:new g.aH(m,e.u_is_text),u_pitch_with_map:new g.aH(m,e.u_pitch_with_map),u_is_along_line:new g.aH(m,e.u_is_along_line),u_is_variable_anchor:new g.aH(m,e.u_is_variable_anchor),u_texsize:new g.aO(m,e.u_texsize),u_texture:new g.aH(m,e.u_texture),u_gamma_scale:new g.aI(m,e.u_gamma_scale),u_device_pixel_ratio:new g.aI(m,e.u_device_pixel_ratio),u_is_halo:new g.aH(m,e.u_is_halo),u_translation:new g.aO(m,e.u_translation),u_pitched_scale:new g.aI(m,e.u_pitched_scale)}),symbolTextAndIcon:(m,e)=>({u_is_size_zoom_constant:new g.aH(m,e.u_is_size_zoom_constant),u_is_size_feature_constant:new g.aH(m,e.u_is_size_feature_constant),u_size_t:new g.aI(m,e.u_size_t),u_size:new g.aI(m,e.u_size),u_camera_to_center_distance:new g.aI(m,e.u_camera_to_center_distance),u_pitch:new g.aI(m,e.u_pitch),u_rotate_symbol:new g.aH(m,e.u_rotate_symbol),u_aspect_ratio:new g.aI(m,e.u_aspect_ratio),u_fade_change:new g.aI(m,e.u_fade_change),u_matrix:new g.aJ(m,e.u_matrix),u_label_plane_matrix:new g.aJ(m,e.u_label_plane_matrix),u_coord_matrix:new g.aJ(m,e.u_coord_matrix),u_is_text:new g.aH(m,e.u_is_text),u_pitch_with_map:new g.aH(m,e.u_pitch_with_map),u_is_along_line:new g.aH(m,e.u_is_along_line),u_is_variable_anchor:new g.aH(m,e.u_is_variable_anchor),u_texsize:new g.aO(m,e.u_texsize),u_texsize_icon:new g.aO(m,e.u_texsize_icon),u_texture:new g.aH(m,e.u_texture),u_texture_icon:new g.aH(m,e.u_texture_icon),u_gamma_scale:new g.aI(m,e.u_gamma_scale),u_device_pixel_ratio:new g.aI(m,e.u_device_pixel_ratio),u_is_halo:new g.aH(m,e.u_is_halo),u_translation:new g.aO(m,e.u_translation),u_pitched_scale:new g.aI(m,e.u_pitched_scale)}),background:(m,e)=>({u_matrix:new g.aJ(m,e.u_matrix),u_opacity:new g.aI(m,e.u_opacity),u_color:new g.aL(m,e.u_color)}),backgroundPattern:(m,e)=>({u_matrix:new g.aJ(m,e.u_matrix),u_opacity:new g.aI(m,e.u_opacity),u_image:new g.aH(m,e.u_image),u_pattern_tl_a:new g.aO(m,e.u_pattern_tl_a),u_pattern_br_a:new g.aO(m,e.u_pattern_br_a),u_pattern_tl_b:new g.aO(m,e.u_pattern_tl_b),u_pattern_br_b:new g.aO(m,e.u_pattern_br_b),u_texsize:new g.aO(m,e.u_texsize),u_mix:new g.aI(m,e.u_mix),u_pattern_size_a:new g.aO(m,e.u_pattern_size_a),u_pattern_size_b:new g.aO(m,e.u_pattern_size_b),u_scale_a:new g.aI(m,e.u_scale_a),u_scale_b:new g.aI(m,e.u_scale_b),u_pixel_coord_upper:new g.aO(m,e.u_pixel_coord_upper),u_pixel_coord_lower:new g.aO(m,e.u_pixel_coord_lower),u_tile_units_to_pixels:new g.aI(m,e.u_tile_units_to_pixels)}),terrain:(m,e)=>({u_matrix:new g.aJ(m,e.u_matrix),u_texture:new g.aH(m,e.u_texture),u_ele_delta:new g.aI(m,e.u_ele_delta),u_fog_matrix:new g.aJ(m,e.u_fog_matrix),u_fog_color:new g.aL(m,e.u_fog_color),u_fog_ground_blend:new g.aI(m,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new g.aI(m,e.u_fog_ground_blend_opacity),u_horizon_color:new g.aL(m,e.u_horizon_color),u_horizon_fog_blend:new g.aI(m,e.u_horizon_fog_blend)}),terrainDepth:(m,e)=>({u_matrix:new g.aJ(m,e.u_matrix),u_ele_delta:new g.aI(m,e.u_ele_delta)}),terrainCoords:(m,e)=>({u_matrix:new g.aJ(m,e.u_matrix),u_texture:new g.aH(m,e.u_texture),u_terrain_coords_id:new g.aI(m,e.u_terrain_coords_id),u_ele_delta:new g.aI(m,e.u_ele_delta)}),sky:(m,e)=>({u_sky_color:new g.aL(m,e.u_sky_color),u_horizon_color:new g.aL(m,e.u_horizon_color),u_horizon:new g.aI(m,e.u_horizon),u_sky_horizon_blend:new g.aI(m,e.u_sky_horizon_blend)})};class kr{constructor(e,o,u){this.context=e;const c=e.gl;this.buffer=c.createBuffer(),this.dynamicDraw=!!u,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),c.bufferData(c.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?c.DYNAMIC_DRAW:c.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const o=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const vl={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ma{constructor(e,o,u,c){this.length=o.length,this.attributes=u,this.itemSize=o.bytesPerElement,this.dynamicDraw=c,this.context=e;const p=e.gl;this.buffer=p.createBuffer(),e.bindVertexBuffer.set(this.buffer),p.bufferData(p.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,o){for(let u=0;u<this.attributes.length;u++){const c=o.attributes[this.attributes[u].name];c!==void 0&&e.enableVertexAttribArray(c)}}setVertexAttribPointers(e,o,u){for(let c=0;c<this.attributes.length;c++){const p=this.attributes[c],b=o.attributes[p.name];b!==void 0&&e.vertexAttribPointer(b,p.components,e[vl[p.type]],!1,this.itemSize,p.offset+this.itemSize*(u||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const gi=new WeakMap;function dr(m){var e;if(gi.has(m))return gi.get(m);{const o=(e=m.getParameter(m.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return gi.set(m,o),o}}class ui{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class xs extends ui{getDefault(){return g.aM.transparent}set(e){const o=this.current;(e.r!==o.r||e.g!==o.g||e.b!==o.b||e.a!==o.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class tu extends ui{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class _o extends ui{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class za extends ui{getDefault(){return[!0,!0,!0,!0]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||e[2]!==o[2]||e[3]!==o[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class iu extends ui{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class Cr extends ui{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class oa extends ui{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const o=this.current;(e.func!==o.func||e.ref!==o.ref||e.mask!==o.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Ja extends ui{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||e[2]!==o[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Uo extends ui{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST),this.current=e,this.dirty=!1}}class Eu extends ui{getDefault(){return[0,1]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Ur extends ui{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),this.current=e,this.dirty=!1}}class xl extends ui{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class ts extends ui{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.BLEND):o.disable(o.BLEND),this.current=e,this.dirty=!1}}class is extends ui{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class nu extends ui{getDefault(){return g.aM.transparent}set(e){const o=this.current;(e.r!==o.r||e.g!==o.g||e.b!==o.b||e.a!==o.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class ru extends ui{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class aa extends ui{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE),this.current=e,this.dirty=!1}}class Xu extends ui{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class la extends ui{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class Mu extends ui{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class Ku extends ui{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class zu extends ui{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||e[2]!==o[2]||e[3]!==o[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class wl extends ui{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class Au extends ui{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindRenderbuffer(o.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Ya extends ui{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindTexture(o.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class su extends ui{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class ua extends ui{getDefault(){return null}set(e){const o=this.gl;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class fr extends ui{getDefault(){return null}set(e){var o;if(e===this.current&&!this.dirty)return;const u=this.gl;dr(u)?u.bindVertexArray(e):(o=u.getExtension("OES_vertex_array_object"))===null||o===void 0||o.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class ou extends ui{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class go extends ui{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class Ir extends ui{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Qa extends ui{constructor(e,o){super(e),this.context=e,this.parent=o}getDefault(){return null}}class bl extends Qa{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class Zo extends Qa{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class el extends Qa{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class au{constructor(e,o,u,c,p){this.context=e,this.width=o,this.height=u;const b=e.gl,T=this.framebuffer=b.createFramebuffer();if(this.colorAttachment=new bl(e,T),c)this.depthAttachment=p?new el(e,T):new Zo(e,T);else if(p)throw new Error("Stencil cannot be set without depth");if(b.checkFramebufferStatus(b.FRAMEBUFFER)!==b.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const e=this.context.gl,o=this.colorAttachment.get();if(o&&e.deleteTexture(o),this.depthAttachment){const u=this.depthAttachment.get();u&&e.deleteRenderbuffer(u)}e.deleteFramebuffer(this.framebuffer)}}class gn{constructor(e,o,u){this.blendFunction=e,this.blendColor=o,this.mask=u}}gn.Replace=[1,0],gn.disabled=new gn(gn.Replace,g.aM.transparent,[!1,!1,!1,!1]),gn.unblended=new gn(gn.Replace,g.aM.transparent,[!0,!0,!0,!0]),gn.alphaBlended=new gn([1,771],g.aM.transparent,[!0,!0,!0,!0]);class Ju{constructor(e){var o,u;if(this.gl=e,this.clearColor=new xs(this),this.clearDepth=new tu(this),this.clearStencil=new _o(this),this.colorMask=new za(this),this.depthMask=new iu(this),this.stencilMask=new Cr(this),this.stencilFunc=new oa(this),this.stencilOp=new Ja(this),this.stencilTest=new Uo(this),this.depthRange=new Eu(this),this.depthTest=new Ur(this),this.depthFunc=new xl(this),this.blend=new ts(this),this.blendFunc=new is(this),this.blendColor=new nu(this),this.blendEquation=new ru(this),this.cullFace=new aa(this),this.cullFaceSide=new Xu(this),this.frontFace=new la(this),this.program=new Mu(this),this.activeTexture=new Ku(this),this.viewport=new zu(this),this.bindFramebuffer=new wl(this),this.bindRenderbuffer=new Au(this),this.bindTexture=new Ya(this),this.bindVertexBuffer=new su(this),this.bindElementBuffer=new ua(this),this.bindVertexArray=new fr(this),this.pixelStoreUnpack=new ou(this),this.pixelStoreUnpackPremultiplyAlpha=new go(this),this.pixelStoreUnpackFlipY=new Ir(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),dr(e)){this.HALF_FLOAT=e.HALF_FLOAT;const c=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(o=e.RGBA16F)!==null&&o!==void 0?o:c?.RGBA16F_EXT,this.RGB16F=(u=e.RGB16F)!==null&&u!==void 0?u:c?.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const c=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=c?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,o){return new kr(this,e,o)}createVertexBuffer(e,o,u){return new Ma(this,e,o,u)}createRenderbuffer(e,o,u){const c=this.gl,p=c.createRenderbuffer();return this.bindRenderbuffer.set(p),c.renderbufferStorage(c.RENDERBUFFER,e,o,u),this.bindRenderbuffer.set(null),p}createFramebuffer(e,o,u,c){return new au(this,e,o,u,c)}clear({color:e,depth:o,stencil:u}){const c=this.gl;let p=0;e&&(p|=c.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(p|=c.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),u!==void 0&&(p|=c.STENCIL_BUFFER_BIT,this.clearStencil.set(u),this.stencilMask.set(255)),c.clear(p)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){g.aE(e.blendFunction,gn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return dr(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var o;return dr(this.gl)?this.gl.deleteVertexArray(e):(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}class pi{constructor(e,o,u){this.func=e,this.mask=o,this.range=u}}pi.ReadOnly=!1,pi.ReadWrite=!0,pi.disabled=new pi(519,pi.ReadOnly,[0,1]);const Sl=7680;class Si{constructor(e,o,u,c,p,b){this.test=e,this.ref=o,this.mask=u,this.fail=c,this.depthFail=p,this.pass=b}}Si.disabled=new Si({func:519,mask:0},0,0,Sl,Sl,Sl);class Ci{constructor(e,o,u){this.enable=e,this.mode=o,this.frontFace=u}}let ws;function Zr(m,e,o,u,c){const p=m.context,b=p.gl,T=m.useProgram("collisionBox"),C=[];let M=0,R=0;for(let oe=0;oe<u.length;oe++){const de=u[oe],ee=e.getTile(de).getBucket(o);if(!ee)continue;const ye=c?ee.textCollisionBox:ee.iconCollisionBox,be=ee.collisionCircleArray;if(be.length>0){const Ce=g.H();g.aQ(Ce,ee.placementInvProjMatrix,m.transform.glCoordMatrix),g.aQ(Ce,Ce,ee.placementViewportMatrix),C.push({circleArray:be,circleOffset:R,transform:de.posMatrix,invTransform:Ce,coord:de}),M+=be.length/4,R=M}ye&&T.draw(p,b.LINES,pi.disabled,Si.disabled,m.colorModeForRenderPass(),Ci.disabled,{u_matrix:de.posMatrix,u_pixel_extrude_scale:[1/(B=m.transform).width,1/B.height]},m.style.map.terrain&&m.style.map.terrain.getTerrainData(de),o.id,ye.layoutVertexBuffer,ye.indexBuffer,ye.segments,null,m.transform.zoom,null,null,ye.collisionVertexBuffer)}var B;if(!c||!C.length)return;const $=m.useProgram("collisionCircle"),X=new g.aR;X.resize(4*M),X._trim();let Y=0;for(const oe of C)for(let de=0;de<oe.circleArray.length/4;de++){const ee=4*de,ye=oe.circleArray[ee+0],be=oe.circleArray[ee+1],Ce=oe.circleArray[ee+2],Ve=oe.circleArray[ee+3];X.emplace(Y++,ye,be,Ce,Ve,0),X.emplace(Y++,ye,be,Ce,Ve,1),X.emplace(Y++,ye,be,Ce,Ve,2),X.emplace(Y++,ye,be,Ce,Ve,3)}(!ws||ws.length<2*M)&&(ws=function(oe){const de=2*oe,ee=new g.aT;ee.resize(de),ee._trim();for(let ye=0;ye<de;ye++){const be=6*ye;ee.uint16[be+0]=4*ye+0,ee.uint16[be+1]=4*ye+1,ee.uint16[be+2]=4*ye+2,ee.uint16[be+3]=4*ye+2,ee.uint16[be+4]=4*ye+3,ee.uint16[be+5]=4*ye+0}return ee}(M));const Q=p.createIndexBuffer(ws,!0),ie=p.createVertexBuffer(X,g.aS.members,!0);for(const oe of C){const de=Gn(oe.transform,oe.invTransform,m.transform);$.draw(p,b.TRIANGLES,pi.disabled,Si.disabled,m.colorModeForRenderPass(),Ci.disabled,de,m.style.map.terrain&&m.style.map.terrain.getTerrainData(oe.coord),o.id,ie,Q,g.a0.simpleSegment(0,2*oe.circleOffset,oe.circleArray.length,oe.circleArray.length/2),null,m.transform.zoom,null,null,null)}ie.destroy(),Q.destroy()}Ci.disabled=new Ci(!1,1029,2305),Ci.backCCW=new Ci(!0,1029,2305);const Aa=g.an(new Float32Array(16));function yo(m,e,o,u,c,p){const{horizontalAlign:b,verticalAlign:T}=g.au(m);return new g.P((-(b-.5)*e/c+u[0])*p,(-(T-.5)*o/c+u[1])*p)}function $o(m,e,o,u,c,p){const b=e.tileAnchorPoint.add(new g.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let T=u.mult(p);o||(T=T.rotate(-c));const C=b.add(T);return se(C.x,C.y,e.labelPlaneMatrix,e.getElevation).point}if(o){const T=Be(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(m),C=Math.atan(T.y/T.x)+(T.x<0?Math.PI:0);return m.add(u.rotate(C))}return m.add(u)}function bs(m,e,o,u,c,p,b,T,C,M,R,B,$,X){const Y=m.text.placedSymbolArray,Q=m.text.dynamicLayoutVertexArray,ie=m.icon.dynamicLayoutVertexArray,oe={};Q.clear();for(let de=0;de<Y.length;de++){const ee=Y.get(de),ye=ee.hidden||!ee.crossTileID||m.allowVerticalPlacement&&!ee.placedOrientation?null:u[ee.crossTileID];if(ye){const be=new g.P(ee.anchorX,ee.anchorY),Ce={getElevation:X,width:c.width,height:c.height,labelPlaneMatrix:p,pitchWithMap:o,projection:R,tileAnchorPoint:be,translation:B,unwrappedTileID:$},Ve=o?se(be.x,be.y,b,X):Be(be.x,be.y,Ce),et=V(c.cameraToCenterDistance,Ve.signedDistanceFromCamera);let at=g.ai(m.textSizeData,C,ee)*et/g.ap;o&&(at*=m.tilePixelRatio/T);const{width:pt,height:lt,anchor:rt,textOffset:bt,textBoxScale:Kt}=ye,ut=yo(rt,pt,lt,bt,Kt,at),ht=R.getPitchedTextCorrection(c,be.add(new g.P(B[0],B[1])),$),Gt=$o(Ve.point,Ce,e,ut,c.angle,ht),Wi=m.allowVerticalPlacement&&ee.placedOrientation===g.ah.vertical?Math.PI/2:0;for(let ai=0;ai<ee.numGlyphs;ai++)g.aj(Q,Gt,Wi);M&&ee.associatedIconIndex>=0&&(oe[ee.associatedIconIndex]={shiftedAnchor:Gt,angle:Wi})}else zt(ee.numGlyphs,Q)}if(M){ie.clear();const de=m.icon.placedSymbolArray;for(let ee=0;ee<de.length;ee++){const ye=de.get(ee);if(ye.hidden)zt(ye.numGlyphs,ie);else{const be=oe[ee];if(be)for(let Ce=0;Ce<ye.numGlyphs;Ce++)g.aj(ie,be.shiftedAnchor,be.angle);else zt(ye.numGlyphs,ie)}}m.icon.dynamicLayoutVertexBuffer.updateData(ie)}m.text.dynamicLayoutVertexBuffer.updateData(Q)}function Er(m,e,o){return o.iconsInText&&e?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function Ss(m,e,o,u,c,p,b,T,C,M,R,B){const $=m.context,X=$.gl,Y=m.transform,Q=ys(),ie=T==="map",oe=C==="map",de=T!=="viewport"&&o.layout.get("symbol-placement")!=="point",ee=ie&&!oe&&!de,ye=!oe&&de,be=!o.layout.get("symbol-sort-key").isConstant();let Ce=!1;const Ve=m.depthModeForSublayer(0,pi.ReadOnly),et=o._unevaluatedLayout.hasValue("text-variable-anchor")||o._unevaluatedLayout.hasValue("text-variable-anchor-offset"),at=[],pt=Q.getCircleRadiusCorrection(Y);for(const lt of u){const rt=e.getTile(lt),bt=rt.getBucket(o);if(!bt)continue;const Kt=c?bt.text:bt.icon;if(!Kt||!Kt.segments.get().length||!Kt.hasVisibleVertices)continue;const ut=Kt.programConfigurations.get(o.id),ht=c||bt.sdfIcons,Gt=c?bt.textSizeData:bt.iconSizeData,Wi=oe||Y.pitch!==0,ai=m.useProgram(Er(ht,c,bt),ut),mi=g.ag(Gt,Y.zoom),Qi=m.style.map.terrain&&m.style.map.terrain.getTerrainData(lt);let or,zs,en,Kn,cn=[0,0],Cn=null;if(c)zs=rt.glyphAtlasTexture,en=X.LINEAR,or=rt.glyphAtlasTexture.size,bt.iconsInText&&(cn=rt.imageAtlasTexture.size,Cn=rt.imageAtlasTexture,Kn=Wi||m.options.rotating||m.options.zooming||Gt.kind==="composite"||Gt.kind==="camera"?X.LINEAR:X.NEAREST);else{const vi=o.layout.get("icon-size").constantOr(0)!==1||bt.iconsNeedLinear;zs=rt.imageAtlasTexture,en=ht||m.options.rotating||m.options.zooming||vi||Wi?X.LINEAR:X.NEAREST,or=rt.imageAtlasTexture.size}const gr=si(rt,1,m.transform.zoom),Po=ye?lt.posMatrix:Aa,ss=br(Po,oe,ie,m.transform,gr),ko=ir(Po,oe,ie,m.transform,gr),Na=ir(lt.posMatrix,oe,ie,m.transform,gr),As=Q.translatePosition(m.transform,rt,p,b),Ys=et&&bt.hasTextData(),Yo=o.layout.get("icon-text-fit")!=="none"&&Ys&&bt.hasIconData();if(de){const vi=m.style.map.terrain?(ja,Io)=>m.style.map.terrain.getElevation(lt,ja,Io):null,Ds=o.layout.get("text-rotation-alignment")==="map";W(bt,lt.posMatrix,m,c,ss,Na,oe,M,Ds,Q,lt.toUnwrapped(),Y.width,Y.height,As,vi)}const Hr=lt.posMatrix,Ls=c&&et||Yo,Co=de||Ls?Aa:ss,Qs=ko,Ln=ht&&o.paint.get(c?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let fn;fn=ht?bt.iconsInText?mo(Gt.kind,mi,ee,oe,de,Ls,m,Hr,Co,Qs,As,or,cn,pt):hr(Gt.kind,mi,ee,oe,de,Ls,m,Hr,Co,Qs,As,c,or,!0,pt):_n(Gt.kind,mi,ee,oe,de,Ls,m,Hr,Co,Qs,As,c,or,pt);const yr={program:ai,buffers:Kt,uniformValues:fn,atlasTexture:zs,atlasTextureIcon:Cn,atlasInterpolation:en,atlasInterpolationIcon:Kn,isSDF:ht,hasHalo:Ln};if(be&&bt.canOverlap){Ce=!0;const vi=Kt.segments.get();for(const Ds of vi)at.push({segments:new g.a0([Ds]),sortKey:Ds.sortKey,state:yr,terrainData:Qi})}else at.push({segments:Kt.segments,sortKey:0,state:yr,terrainData:Qi})}Ce&&at.sort((lt,rt)=>lt.sortKey-rt.sortKey);for(const lt of at){const rt=lt.state;if($.activeTexture.set(X.TEXTURE0),rt.atlasTexture.bind(rt.atlasInterpolation,X.CLAMP_TO_EDGE),rt.atlasTextureIcon&&($.activeTexture.set(X.TEXTURE1),rt.atlasTextureIcon&&rt.atlasTextureIcon.bind(rt.atlasInterpolationIcon,X.CLAMP_TO_EDGE)),rt.isSDF){const bt=rt.uniformValues;rt.hasHalo&&(bt.u_is_halo=1,lu(rt.buffers,lt.segments,o,m,rt.program,Ve,R,B,bt,lt.terrainData)),bt.u_is_halo=0}lu(rt.buffers,lt.segments,o,m,rt.program,Ve,R,B,rt.uniformValues,lt.terrainData)}}function lu(m,e,o,u,c,p,b,T,C,M){const R=u.context;c.draw(R,R.gl.TRIANGLES,p,b,T,Ci.disabled,C,M,o.id,m.layoutVertexBuffer,m.indexBuffer,e,o.paint,u.transform.zoom,m.programConfigurations.get(o.id),m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer)}function Zs(m,e,o,u){const c=m.context,p=c.gl,b=Si.disabled,T=new gn([p.ONE,p.ONE],g.aM.transparent,[!0,!0,!0,!0]),C=e.getBucket(o);if(!C)return;const M=u.key;let R=o.heatmapFbos.get(M);R||(R=La(c,e.tileSize,e.tileSize),o.heatmapFbos.set(M,R)),c.bindFramebuffer.set(R.framebuffer),c.viewport.set([0,0,e.tileSize,e.tileSize]),c.clear({color:g.aM.transparent});const B=C.programConfigurations.get(o.id),$=m.useProgram("heatmap",B),X=m.style.map.terrain.getTerrainData(u);$.draw(c,p.TRIANGLES,pi.disabled,b,T,Ci.disabled,On(u.posMatrix,e,m.transform.zoom,o.paint.get("heatmap-intensity")),X,o.id,C.layoutVertexBuffer,C.indexBuffer,C.segments,o.paint,m.transform.zoom,B)}function $s(m,e,o){const u=m.context,c=u.gl;u.setColorMode(m.colorModeForRenderPass());const p=qo(u,e),b=o.key,T=e.heatmapFbos.get(b);T&&(u.activeTexture.set(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,T.colorAttachment.get()),u.activeTexture.set(c.TEXTURE1),p.bind(c.LINEAR,c.CLAMP_TO_EDGE),m.useProgram("heatmapTexture").draw(u,c.TRIANGLES,pi.disabled,Si.disabled,m.colorModeForRenderPass(),Ci.disabled,Jt(m,e,0,1),null,e.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments,e.paint,m.transform.zoom),T.destroy(),e.heatmapFbos.delete(b))}function La(m,e,o){var u,c;const p=m.gl,b=p.createTexture();p.bindTexture(p.TEXTURE_2D,b),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR);const T=(u=m.HALF_FLOAT)!==null&&u!==void 0?u:p.UNSIGNED_BYTE,C=(c=m.RGBA16F)!==null&&c!==void 0?c:p.RGBA;p.texImage2D(p.TEXTURE_2D,0,C,e,o,0,p.RGBA,T,null);const M=m.createFramebuffer(e,o,!1,!1);return M.colorAttachment.set(b),M}function qo(m,e){return e.colorRampTexture||(e.colorRampTexture=new qt(m,e.colorRamp,m.gl.RGBA)),e.colorRampTexture}function qs(m,e,o,u,c){if(!o||!u||!u.imageAtlas)return;const p=u.imageAtlas.patternPositions;let b=p[o.to.toString()],T=p[o.from.toString()];if(!b&&T&&(b=T),!T&&b&&(T=b),!b||!T){const C=c.getPaintProperty(e);b=p[C],T=p[C]}b&&T&&m.setConstantPatternPositions(b,T)}function Wn(m,e,o,u,c,p,b){const T=m.context.gl,C="fill-pattern",M=o.paint.get(C),R=M&&M.constantOr(1),B=o.getCrossfadeParameters();let $,X,Y,Q,ie;b?(X=R&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=T.LINES):(X=R?"fillPattern":"fill",$=T.TRIANGLES);const oe=M.constantOr(null);for(const de of u){const ee=e.getTile(de);if(R&&!ee.patternsLoaded())continue;const ye=ee.getBucket(o);if(!ye)continue;const be=ye.programConfigurations.get(o.id),Ce=m.useProgram(X,be),Ve=m.style.map.terrain&&m.style.map.terrain.getTerrainData(de);R&&(m.context.activeTexture.set(T.TEXTURE0),ee.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),be.updatePaintBuffers(B)),qs(be,C,oe,ee,o);const et=Ve?de:null,at=m.translatePosMatrix(et?et.posMatrix:de.posMatrix,ee,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(b){Q=ye.indexBuffer2,ie=ye.segments2;const pt=[T.drawingBufferWidth,T.drawingBufferHeight];Y=X==="fillOutlinePattern"&&R?Ia(at,m,B,ee,pt):Wa(at,pt)}else Q=ye.indexBuffer,ie=ye.segments,Y=R?Ga(at,m,B,ee):po(at);Ce.draw(m.context,$,c,m.stencilModeForClipping(de),p,Ci.disabled,Y,Ve,o.id,ye.layoutVertexBuffer,Q,ie,o.paint,m.transform.zoom,be)}}function Tl(m,e,o,u,c,p,b){const T=m.context,C=T.gl,M="fill-extrusion-pattern",R=o.paint.get(M),B=R.constantOr(1),$=o.getCrossfadeParameters(),X=o.paint.get("fill-extrusion-opacity"),Y=R.constantOr(null);for(const Q of u){const ie=e.getTile(Q),oe=ie.getBucket(o);if(!oe)continue;const de=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Q),ee=oe.programConfigurations.get(o.id),ye=m.useProgram(B?"fillExtrusionPattern":"fillExtrusion",ee);B&&(m.context.activeTexture.set(C.TEXTURE0),ie.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),ee.updatePaintBuffers($)),qs(ee,M,Y,ie,o);const be=m.translatePosMatrix(Q.posMatrix,ie,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Ce=o.paint.get("fill-extrusion-vertical-gradient"),Ve=B?Us(be,m,Ce,X,Q,$,ie):jo(be,m,Ce,X);ye.draw(T,T.gl.TRIANGLES,c,p,b,Ci.backCCW,Ve,de,o.id,oe.layoutVertexBuffer,oe.indexBuffer,oe.segments,o.paint,m.transform.zoom,ee,m.style.map.terrain&&oe.centroidVertexBuffer)}}function Mr(m,e,o,u,c,p,b){const T=m.context,C=T.gl,M=o.fbo;if(!M)return;const R=m.useProgram("hillshade"),B=m.style.map.terrain&&m.style.map.terrain.getTerrainData(e);T.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,M.colorAttachment.get()),R.draw(T,C.TRIANGLES,c,p,b,Ci.disabled,(($,X,Y,Q)=>{const ie=Y.paint.get("hillshade-shadow-color"),oe=Y.paint.get("hillshade-highlight-color"),de=Y.paint.get("hillshade-accent-color");let ee=Y.paint.get("hillshade-illumination-direction")*(Math.PI/180);Y.paint.get("hillshade-illumination-anchor")==="viewport"&&(ee-=$.transform.angle);const ye=!$.options.moving;return{u_matrix:Q?Q.posMatrix:$.transform.calculatePosMatrix(X.tileID.toUnwrapped(),ye),u_image:0,u_latrange:kn(0,X.tileID),u_light:[Y.paint.get("hillshade-exaggeration"),ee],u_shadow:ie,u_highlight:oe,u_accent:de}})(m,o,u,B?e:null),B,u.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}function Da(m,e,o,u,c,p){const b=m.context,T=b.gl,C=e.dem;if(C&&C.data){const M=C.dim,R=C.stride,B=C.getPixels();if(b.activeTexture.set(T.TEXTURE1),b.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||m.getTileTexture(R),e.demTexture){const X=e.demTexture;X.update(B,{premultiply:!1}),X.bind(T.NEAREST,T.CLAMP_TO_EDGE)}else e.demTexture=new qt(b,B,T.RGBA,{premultiply:!1}),e.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE);b.activeTexture.set(T.TEXTURE0);let $=e.fbo;if(!$){const X=new qt(b,{width:M,height:M,data:null},T.RGBA);X.bind(T.LINEAR,T.CLAMP_TO_EDGE),$=e.fbo=b.createFramebuffer(M,M,!0,!1),$.colorAttachment.set(X.texture)}b.bindFramebuffer.set($.framebuffer),b.viewport.set([0,0,M,M]),m.useProgram("hillshadePrepare").draw(b,T.TRIANGLES,u,c,p,Ci.disabled,((X,Y)=>{const Q=Y.stride,ie=g.H();return g.aP(ie,0,g.X,-g.X,0,0,1),g.J(ie,ie,[0,-g.X,0]),{u_matrix:ie,u_image:1,u_dimension:[Q,Q],u_zoom:X.overscaledZ,u_unpack:Y.getUnpackVector()}})(e.tileID,C),null,o.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments),e.needsHillshadePrepare=!1}}function Ts(m,e,o,u,c,p){const b=u.paint.get("raster-fade-duration");if(!p&&b>0){const T=xe.now(),C=(T-m.timeAdded)/b,M=e?(T-e.timeAdded)/b:-1,R=o.getSource(),B=c.coveringZoomLevel({tileSize:R.tileSize,roundZoom:R.roundZoom}),$=!e||Math.abs(e.tileID.overscaledZ-B)>Math.abs(m.tileID.overscaledZ-B),X=$&&m.refreshedUponExpiration?1:g.ac($?C:1-M,0,1);return m.refreshedUponExpiration&&C>=1&&(m.refreshedUponExpiration=!1),e?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}const Ho=new g.aM(1,0,0,1),Ti=new g.aM(0,1,0,1),ca=new g.aM(0,0,1,1),tl=new g.aM(1,0,1,1),il=new g.aM(0,1,1,1);function vo(m,e,o,u){da(m,0,e+o/2,m.transform.width,o,u)}function ha(m,e,o,u){da(m,e-o/2,0,o,m.transform.height,u)}function da(m,e,o,u,c,p){const b=m.context,T=b.gl;T.enable(T.SCISSOR_TEST),T.scissor(e*m.pixelRatio,o*m.pixelRatio,u*m.pixelRatio,c*m.pixelRatio),b.clear({color:p}),T.disable(T.SCISSOR_TEST)}function Pl(m,e,o){const u=m.context,c=u.gl,p=o.posMatrix,b=m.useProgram("debug"),T=pi.disabled,C=Si.disabled,M=m.colorModeForRenderPass(),R="$debug",B=m.style.map.terrain&&m.style.map.terrain.getTerrainData(o);u.activeTexture.set(c.TEXTURE0);const $=e.getTileByID(o.key).latestRawTileData,X=Math.floor(($&&$.byteLength||0)/1024),Y=e.getTile(o).tileSize,Q=512/Math.min(Y,512)*(o.overscaledZ/m.transform.zoom)*.5;let ie=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(ie+=` => ${o.overscaledZ}`),function(oe,de){oe.initDebugOverlayCanvas();const ee=oe.debugOverlayCanvas,ye=oe.context.gl,be=oe.debugOverlayCanvas.getContext("2d");be.clearRect(0,0,ee.width,ee.height),be.shadowColor="white",be.shadowBlur=2,be.lineWidth=1.5,be.strokeStyle="white",be.textBaseline="top",be.font="bold 36px Open Sans, sans-serif",be.fillText(de,5,5),be.strokeText(de,5,5),oe.debugOverlayTexture.update(ee),oe.debugOverlayTexture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE)}(m,`${ie} ${X}kB`),b.draw(u,c.TRIANGLES,T,C,gn.alphaBlended,Ci.disabled,Vr(p,g.aM.transparent,Q),null,R,m.debugBuffer,m.quadTriangleIndexBuffer,m.debugSegments),b.draw(u,c.LINE_STRIP,T,C,M,Ci.disabled,Vr(p,g.aM.red),B,R,m.debugBuffer,m.tileBorderIndexBuffer,m.debugSegments)}function uu(m,e,o){const u=m.context,c=u.gl,p=m.colorModeForRenderPass(),b=new pi(c.LEQUAL,pi.ReadWrite,m.depthRangeFor3D),T=m.useProgram("terrain"),C=e.getTerrainMesh();u.bindFramebuffer.set(null),u.viewport.set([0,0,m.width,m.height]);for(const M of o){const R=m.renderToTexture.getTexture(M),B=e.getTerrainData(M.tileID);u.activeTexture.set(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,R.texture);const $=m.transform.calculatePosMatrix(M.tileID.toUnwrapped()),X=e.getMeshFrameDelta(m.transform.zoom),Y=m.transform.calculateFogMatrix(M.tileID.toUnwrapped()),Q=mn($,X,Y,m.style.sky,m.transform.pitch);T.draw(u,c.TRIANGLES,b,Si.disabled,p,Ci.backCCW,Q,B,"terrain",C.vertexBuffer,C.indexBuffer,C.segments)}}class zr{constructor(e,o,u){this.vertexBuffer=e,this.indexBuffer=o,this.segments=u}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class Ps{constructor(e,o){this.context=new Ju(e),this.transform=o,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:g.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ut.maxUnderzooming+Ut.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new oi}resize(e,o,u){if(this.width=Math.floor(e*u),this.height=Math.floor(o*u),this.pixelRatio=u,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const c of this.style._order)this.style._layers[c].resize()}setup(){const e=this.context,o=new g.aX;o.emplaceBack(0,0),o.emplaceBack(g.X,0),o.emplaceBack(0,g.X),o.emplaceBack(g.X,g.X),this.tileExtentBuffer=e.createVertexBuffer(o,Pn.members),this.tileExtentSegments=g.a0.simpleSegment(0,0,4,2);const u=new g.aX;u.emplaceBack(0,0),u.emplaceBack(g.X,0),u.emplaceBack(0,g.X),u.emplaceBack(g.X,g.X),this.debugBuffer=e.createVertexBuffer(u,Pn.members),this.debugSegments=g.a0.simpleSegment(0,0,4,5);const c=new g.$;c.emplaceBack(0,0,0,0),c.emplaceBack(g.X,0,g.X,0),c.emplaceBack(0,g.X,0,g.X),c.emplaceBack(g.X,g.X,g.X,g.X),this.rasterBoundsBuffer=e.createVertexBuffer(c,ms.members),this.rasterBoundsSegments=g.a0.simpleSegment(0,0,4,2);const p=new g.aX;p.emplaceBack(0,0),p.emplaceBack(1,0),p.emplaceBack(0,1),p.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(p,Pn.members),this.viewportSegments=g.a0.simpleSegment(0,0,4,2);const b=new g.aZ;b.emplaceBack(0),b.emplaceBack(1),b.emplaceBack(3),b.emplaceBack(2),b.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(b);const T=new g.aY;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(T);const C=this.context.gl;this.stencilClearMode=new Si({func:C.ALWAYS,mask:0},0,255,C.ZERO,C.ZERO,C.ZERO)}clearStencil(){const e=this.context,o=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const u=g.H();g.aP(u,0,this.width,this.height,0,0,1),g.K(u,u,[o.drawingBufferWidth,o.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,o.TRIANGLES,pi.disabled,this.stencilClearMode,gn.disabled,Ci.disabled,dn(u),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,o){if(this.currentStencilSource===e.source||!e.isTileClipped()||!o||!o.length)return;this.currentStencilSource=e.source;const u=this.context,c=u.gl;this.nextStencilID+o.length>256&&this.clearStencil(),u.setColorMode(gn.disabled),u.setDepthMode(pi.disabled);const p=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const b of o){const T=this._tileClippingMaskIDs[b.key]=this.nextStencilID++,C=this.style.map.terrain&&this.style.map.terrain.getTerrainData(b);p.draw(u,c.TRIANGLES,pi.disabled,new Si({func:c.ALWAYS,mask:0},T,255,c.KEEP,c.KEEP,c.REPLACE),gn.disabled,Ci.disabled,dn(b.posMatrix),C,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,o=this.context.gl;return new Si({func:o.NOTEQUAL,mask:255},e,255,o.KEEP,o.KEEP,o.REPLACE)}stencilModeForClipping(e){const o=this.context.gl;return new Si({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,o.KEEP,o.KEEP,o.REPLACE)}stencilConfigForOverlap(e){const o=this.context.gl,u=e.sort((b,T)=>T.overscaledZ-b.overscaledZ),c=u[u.length-1].overscaledZ,p=u[0].overscaledZ-c+1;if(p>1){this.currentStencilSource=void 0,this.nextStencilID+p>256&&this.clearStencil();const b={};for(let T=0;T<p;T++)b[T+c]=new Si({func:o.GEQUAL,mask:255},T+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=p,[b,u]}return[{[c]:Si.disabled},u]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new gn([e.CONSTANT_COLOR,e.ONE],new g.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?gn.unblended:gn.alphaBlended}depthModeForSublayer(e,o,u){if(!this.opaquePassEnabledForLayer())return pi.disabled;const c=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new pi(u||this.context.gl.LEQUAL,o,[c,c])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,o){this.style=e,this.options=o,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(xe.now()),this.imageManager.beginFrame();const u=this.style._order,c=this.style.sourceCaches,p={},b={},T={};for(const C in c){const M=c[C];M.used&&M.prepare(this.context),p[C]=M.getVisibleCoordinates(),b[C]=p[C].slice().reverse(),T[C]=M.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let C=0;C<u.length;C++)if(this.style._layers[u[C]].is3D()){this.opaquePassCutoff=C;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const C of u){const M=this.style._layers[C];if(!M.hasOffscreenPass()||M.isHidden(this.transform.zoom))continue;const R=b[M.source];(M.type==="custom"||R.length)&&this.renderLayer(this,c[M.source],M,R)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?g.aM.black:g.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(C,M){const R=C.context,B=R.gl,$=((oe,de,ee)=>({u_sky_color:oe.properties.get("sky-color"),u_horizon_color:oe.properties.get("horizon-color"),u_horizon:(de.height/2+de.getHorizon())*ee,u_sky_horizon_blend:oe.properties.get("sky-horizon-blend")*de.height/2*ee}))(M,C.style.map.transform,C.pixelRatio),X=new pi(B.LEQUAL,pi.ReadWrite,[0,1]),Y=Si.disabled,Q=C.colorModeForRenderPass(),ie=C.useProgram("sky");if(!M.mesh){const oe=new g.aX;oe.emplaceBack(-1,-1),oe.emplaceBack(1,-1),oe.emplaceBack(1,1),oe.emplaceBack(-1,1);const de=new g.aY;de.emplaceBack(0,1,2),de.emplaceBack(0,2,3),M.mesh=new zr(R.createVertexBuffer(oe,Pn.members),R.createIndexBuffer(de),g.a0.simpleSegment(0,0,oe.length,de.length))}ie.draw(R,B.TRIANGLES,X,Y,Q,Ci.disabled,$,void 0,"sky",M.mesh.vertexBuffer,M.mesh.indexBuffer,M.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){const C=this.style._layers[u[this.currentLayer]],M=c[C.source],R=p[C.source];this._renderTileClippingMasks(C,R),this.renderLayer(this,M,C,R)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){const C=this.style._layers[u[this.currentLayer]],M=c[C.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(C))continue;const R=(C.type==="symbol"?T:b)[C.source];this._renderTileClippingMasks(C,p[C.source]),this.renderLayer(this,M,C,R)}if(this.options.showTileBoundaries){const C=function(M,R){let B=null;const $=Object.values(M._layers).flatMap(ie=>ie.source&&!ie.isHidden(R)?[M.sourceCaches[ie.source]]:[]),X=$.filter(ie=>ie.getSource().type==="vector"),Y=$.filter(ie=>ie.getSource().type!=="vector"),Q=ie=>{(!B||B.getSource().maxzoom<ie.getSource().maxzoom)&&(B=ie)};return X.forEach(ie=>Q(ie)),B||Y.forEach(ie=>Q(ie)),B}(this.style,this.transform.zoom);C&&function(M,R,B){for(let $=0;$<B.length;$++)Pl(M,R,B[$])}(this,C,C.getVisibleCoordinates())}this.options.showPadding&&function(C){const M=C.transform.padding;vo(C,C.transform.height-(M.top||0),3,Ho),vo(C,M.bottom||0,3,Ti),ha(C,M.left||0,3,ca),ha(C,C.transform.width-(M.right||0),3,tl);const R=C.transform.centerPoint;(function(B,$,X,Y){da(B,$-1,X-10,2,20,Y),da(B,$-10,X-1,20,2,Y)})(C,R.x,C.transform.height-R.y,il)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const o=this.terrainFacilitator.matrix,u=this.transform.modelViewProjectionMatrix;let c=this.terrainFacilitator.dirty;c||(c=e?!g.a_(o,u):!g.a$(o,u)),c||(c=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),c&&(g.b0(o,u),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(p,b){const T=p.context,C=T.gl,M=gn.unblended,R=new pi(C.LEQUAL,pi.ReadWrite,[0,1]),B=b.getTerrainMesh(),$=b.sourceCache.getRenderableTiles(),X=p.useProgram("terrainDepth");T.bindFramebuffer.set(b.getFramebuffer("depth").framebuffer),T.viewport.set([0,0,p.width/devicePixelRatio,p.height/devicePixelRatio]),T.clear({color:g.aM.transparent,depth:1});for(const Y of $){const Q=b.getTerrainData(Y.tileID),ie={u_matrix:p.transform.calculatePosMatrix(Y.tileID.toUnwrapped()),u_ele_delta:b.getMeshFrameDelta(p.transform.zoom)};X.draw(T,C.TRIANGLES,R,Si.disabled,M,Ci.backCCW,ie,Q,"terrain",B.vertexBuffer,B.indexBuffer,B.segments)}T.bindFramebuffer.set(null),T.viewport.set([0,0,p.width,p.height])}(this,this.style.map.terrain),function(p,b){const T=p.context,C=T.gl,M=gn.unblended,R=new pi(C.LEQUAL,pi.ReadWrite,[0,1]),B=b.getTerrainMesh(),$=b.getCoordsTexture(),X=b.sourceCache.getRenderableTiles(),Y=p.useProgram("terrainCoords");T.bindFramebuffer.set(b.getFramebuffer("coords").framebuffer),T.viewport.set([0,0,p.width/devicePixelRatio,p.height/devicePixelRatio]),T.clear({color:g.aM.transparent,depth:1}),b.coordsIndex=[];for(const Q of X){const ie=b.getTerrainData(Q.tileID);T.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,$.texture);const oe={u_matrix:p.transform.calculatePosMatrix(Q.tileID.toUnwrapped()),u_terrain_coords_id:(255-b.coordsIndex.length)/255,u_texture:0,u_ele_delta:b.getMeshFrameDelta(p.transform.zoom)};Y.draw(T,C.TRIANGLES,R,Si.disabled,M,Ci.backCCW,oe,ie,"terrain",B.vertexBuffer,B.indexBuffer,B.segments),b.coordsIndex.push(Q.tileID.key)}T.bindFramebuffer.set(null),T.viewport.set([0,0,p.width,p.height])}(this,this.style.map.terrain))}renderLayer(e,o,u,c){if(!u.isHidden(this.transform.zoom)&&(u.type==="background"||u.type==="custom"||(c||[]).length))switch(this.id=u.id,u.type){case"symbol":(function(p,b,T,C,M){if(p.renderPass!=="translucent")return;const R=Si.disabled,B=p.colorModeForRenderPass();(T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function($,X,Y,Q,ie,oe,de,ee,ye){const be=X.transform,Ce=ys(),Ve=ie==="map",et=oe==="map";for(const at of $){const pt=Q.getTile(at),lt=pt.getBucket(Y);if(!lt||!lt.text||!lt.text.segments.get().length)continue;const rt=g.ag(lt.textSizeData,be.zoom),bt=si(pt,1,X.transform.zoom),Kt=br(at.posMatrix,et,Ve,X.transform,bt),ut=Y.layout.get("icon-text-fit")!=="none"&&lt.hasIconData();if(rt){const ht=Math.pow(2,be.zoom-pt.tileID.overscaledZ),Gt=X.style.map.terrain?(ai,mi)=>X.style.map.terrain.getElevation(at,ai,mi):null,Wi=Ce.translatePosition(be,pt,de,ee);bs(lt,Ve,et,ye,be,Kt,at.posMatrix,ht,rt,ut,Ce,Wi,at.toUnwrapped(),Gt)}}}(C,p,T,b,T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),M),T.paint.get("icon-opacity").constantOr(1)!==0&&Ss(p,b,T,C,!1,T.paint.get("icon-translate"),T.paint.get("icon-translate-anchor"),T.layout.get("icon-rotation-alignment"),T.layout.get("icon-pitch-alignment"),T.layout.get("icon-keep-upright"),R,B),T.paint.get("text-opacity").constantOr(1)!==0&&Ss(p,b,T,C,!0,T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.layout.get("text-keep-upright"),R,B),b.map.showCollisionBoxes&&(Zr(p,b,T,C,!0),Zr(p,b,T,C,!1))})(e,o,u,c,this.style.placement.variableOffsets);break;case"circle":(function(p,b,T,C){if(p.renderPass!=="translucent")return;const M=T.paint.get("circle-opacity"),R=T.paint.get("circle-stroke-width"),B=T.paint.get("circle-stroke-opacity"),$=!T.layout.get("circle-sort-key").isConstant();if(M.constantOr(1)===0&&(R.constantOr(1)===0||B.constantOr(1)===0))return;const X=p.context,Y=X.gl,Q=p.depthModeForSublayer(0,pi.ReadOnly),ie=Si.disabled,oe=p.colorModeForRenderPass(),de=[];for(let ee=0;ee<C.length;ee++){const ye=C[ee],be=b.getTile(ye),Ce=be.getBucket(T);if(!Ce)continue;const Ve=Ce.programConfigurations.get(T.id),et=p.useProgram("circle",Ve),at=Ce.layoutVertexBuffer,pt=Ce.indexBuffer,lt=p.style.map.terrain&&p.style.map.terrain.getTerrainData(ye),rt={programConfiguration:Ve,program:et,layoutVertexBuffer:at,indexBuffer:pt,uniformValues:Ea(p,ye,be,T),terrainData:lt};if($){const bt=Ce.segments.get();for(const Kt of bt)de.push({segments:new g.a0([Kt]),sortKey:Kt.sortKey,state:rt})}else de.push({segments:Ce.segments,sortKey:0,state:rt})}$&&de.sort((ee,ye)=>ee.sortKey-ye.sortKey);for(const ee of de){const{programConfiguration:ye,program:be,layoutVertexBuffer:Ce,indexBuffer:Ve,uniformValues:et,terrainData:at}=ee.state;be.draw(X,Y.TRIANGLES,Q,ie,oe,Ci.disabled,et,at,T.id,Ce,Ve,ee.segments,T.paint,p.transform.zoom,ye)}})(e,o,u,c);break;case"heatmap":(function(p,b,T,C){if(T.paint.get("heatmap-opacity")===0)return;const M=p.context;if(p.style.map.terrain){for(const R of C){const B=b.getTile(R);b.hasRenderableParent(R)||(p.renderPass==="offscreen"?Zs(p,B,T,R):p.renderPass==="translucent"&&$s(p,T,R))}M.viewport.set([0,0,p.width,p.height])}else p.renderPass==="offscreen"?function(R,B,$,X){const Y=R.context,Q=Y.gl,ie=Si.disabled,oe=new gn([Q.ONE,Q.ONE],g.aM.transparent,[!0,!0,!0,!0]);(function(de,ee,ye){const be=de.gl;de.activeTexture.set(be.TEXTURE1),de.viewport.set([0,0,ee.width/4,ee.height/4]);let Ce=ye.heatmapFbos.get(g.aU);Ce?(be.bindTexture(be.TEXTURE_2D,Ce.colorAttachment.get()),de.bindFramebuffer.set(Ce.framebuffer)):(Ce=La(de,ee.width/4,ee.height/4),ye.heatmapFbos.set(g.aU,Ce))})(Y,R,$),Y.clear({color:g.aM.transparent});for(let de=0;de<X.length;de++){const ee=X[de];if(B.hasRenderableParent(ee))continue;const ye=B.getTile(ee),be=ye.getBucket($);if(!be)continue;const Ce=be.programConfigurations.get($.id),Ve=R.useProgram("heatmap",Ce),{zoom:et}=R.transform;Ve.draw(Y,Q.TRIANGLES,pi.disabled,ie,oe,Ci.disabled,On(ee.posMatrix,ye,et,$.paint.get("heatmap-intensity")),null,$.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,$.paint,R.transform.zoom,Ce)}Y.viewport.set([0,0,R.width,R.height])}(p,b,T,C):p.renderPass==="translucent"&&function(R,B){const $=R.context,X=$.gl;$.setColorMode(R.colorModeForRenderPass());const Y=B.heatmapFbos.get(g.aU);Y&&($.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,Y.colorAttachment.get()),$.activeTexture.set(X.TEXTURE1),qo($,B).bind(X.LINEAR,X.CLAMP_TO_EDGE),R.useProgram("heatmapTexture").draw($,X.TRIANGLES,pi.disabled,Si.disabled,R.colorModeForRenderPass(),Ci.disabled,Jt(R,B,0,1),null,B.id,R.viewportBuffer,R.quadTriangleIndexBuffer,R.viewportSegments,B.paint,R.transform.zoom))}(p,T)})(e,o,u,c);break;case"line":(function(p,b,T,C){if(p.renderPass!=="translucent")return;const M=T.paint.get("line-opacity"),R=T.paint.get("line-width");if(M.constantOr(1)===0||R.constantOr(1)===0)return;const B=p.depthModeForSublayer(0,pi.ReadOnly),$=p.colorModeForRenderPass(),X=T.paint.get("line-dasharray"),Y=T.paint.get("line-pattern"),Q=Y.constantOr(1),ie=T.paint.get("line-gradient"),oe=T.getCrossfadeParameters(),de=Q?"linePattern":X?"lineSDF":ie?"lineGradient":"line",ee=p.context,ye=ee.gl;let be=!0;for(const Ce of C){const Ve=b.getTile(Ce);if(Q&&!Ve.patternsLoaded())continue;const et=Ve.getBucket(T);if(!et)continue;const at=et.programConfigurations.get(T.id),pt=p.context.program.get(),lt=p.useProgram(de,at),rt=be||lt.program!==pt,bt=p.style.map.terrain&&p.style.map.terrain.getTerrainData(Ce),Kt=Y.constantOr(null);if(Kt&&Ve.imageAtlas){const Gt=Ve.imageAtlas,Wi=Gt.patternPositions[Kt.to.toString()],ai=Gt.patternPositions[Kt.from.toString()];Wi&&ai&&at.setConstantPatternPositions(Wi,ai)}const ut=bt?Ce:null,ht=Q?es(p,Ve,T,oe,ut):X?Ql(p,Ve,T,X,oe,ut):ie?_l(p,Ve,T,et.lineClipsArray.length,ut):Ui(p,Ve,T,ut);if(Q)ee.activeTexture.set(ye.TEXTURE0),Ve.imageAtlasTexture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE),at.updatePaintBuffers(oe);else if(X&&(rt||p.lineAtlas.dirty))ee.activeTexture.set(ye.TEXTURE0),p.lineAtlas.bind(ee);else if(ie){const Gt=et.gradients[T.id];let Wi=Gt.texture;if(T.gradientVersion!==Gt.version){let ai=256;if(T.stepInterpolant){const mi=b.getSource().maxzoom,Qi=Ce.canonical.z===mi?Math.ceil(1<<p.transform.maxZoom-Ce.canonical.z):1;ai=g.ac(g.aV(et.maxLineLength/g.X*1024*Qi),256,ee.maxTextureSize)}Gt.gradient=g.aW({expression:T.gradientExpression(),evaluationKey:"lineProgress",resolution:ai,image:Gt.gradient||void 0,clips:et.lineClipsArray}),Gt.texture?Gt.texture.update(Gt.gradient):Gt.texture=new qt(ee,Gt.gradient,ye.RGBA),Gt.version=T.gradientVersion,Wi=Gt.texture}ee.activeTexture.set(ye.TEXTURE0),Wi.bind(T.stepInterpolant?ye.NEAREST:ye.LINEAR,ye.CLAMP_TO_EDGE)}lt.draw(ee,ye.TRIANGLES,B,p.stencilModeForClipping(Ce),$,Ci.disabled,ht,bt,T.id,et.layoutVertexBuffer,et.indexBuffer,et.segments,T.paint,p.transform.zoom,at,et.layoutVertexBuffer2),be=!1}})(e,o,u,c);break;case"fill":(function(p,b,T,C){const M=T.paint.get("fill-color"),R=T.paint.get("fill-opacity");if(R.constantOr(1)===0)return;const B=p.colorModeForRenderPass(),$=T.paint.get("fill-pattern"),X=p.opaquePassEnabledForLayer()&&!$.constantOr(1)&&M.constantOr(g.aM.transparent).a===1&&R.constantOr(0)===1?"opaque":"translucent";if(p.renderPass===X){const Y=p.depthModeForSublayer(1,p.renderPass==="opaque"?pi.ReadWrite:pi.ReadOnly);Wn(p,b,T,C,Y,B,!1)}if(p.renderPass==="translucent"&&T.paint.get("fill-antialias")){const Y=p.depthModeForSublayer(T.getPaintProperty("fill-outline-color")?2:0,pi.ReadOnly);Wn(p,b,T,C,Y,B,!0)}})(e,o,u,c);break;case"fill-extrusion":(function(p,b,T,C){const M=T.paint.get("fill-extrusion-opacity");if(M!==0&&p.renderPass==="translucent"){const R=new pi(p.context.gl.LEQUAL,pi.ReadWrite,p.depthRangeFor3D);if(M!==1||T.paint.get("fill-extrusion-pattern").constantOr(1))Tl(p,b,T,C,R,Si.disabled,gn.disabled),Tl(p,b,T,C,R,p.stencilModeFor3D(),p.colorModeForRenderPass());else{const B=p.colorModeForRenderPass();Tl(p,b,T,C,R,Si.disabled,B)}}})(e,o,u,c);break;case"hillshade":(function(p,b,T,C){if(p.renderPass!=="offscreen"&&p.renderPass!=="translucent")return;const M=p.context,R=p.depthModeForSublayer(0,pi.ReadOnly),B=p.colorModeForRenderPass(),[$,X]=p.renderPass==="translucent"?p.stencilConfigForOverlap(C):[{},C];for(const Y of X){const Q=b.getTile(Y);Q.needsHillshadePrepare!==void 0&&Q.needsHillshadePrepare&&p.renderPass==="offscreen"?Da(p,Q,T,R,Si.disabled,B):p.renderPass==="translucent"&&Mr(p,Y,Q,T,R,$[Y.overscaledZ],B)}M.viewport.set([0,0,p.width,p.height])})(e,o,u,c);break;case"raster":(function(p,b,T,C){if(p.renderPass!=="translucent"||T.paint.get("raster-opacity")===0||!C.length)return;const M=p.context,R=M.gl,B=b.getSource(),$=p.useProgram("raster"),X=p.colorModeForRenderPass(),[Y,Q]=B instanceof _s?[{},C]:p.stencilConfigForOverlap(C),ie=Q[Q.length-1].overscaledZ,oe=!p.options.moving;for(const de of Q){const ee=p.depthModeForSublayer(de.overscaledZ-ie,T.paint.get("raster-opacity")===1?pi.ReadWrite:pi.ReadOnly,R.LESS),ye=b.getTile(de);ye.registerFadeDuration(T.paint.get("raster-fade-duration"));const be=b.findLoadedParent(de,0),Ce=b.findLoadedSibling(de),Ve=Ts(ye,be||Ce||null,b,T,p.transform,p.style.map.terrain);let et,at;const pt=T.paint.get("raster-resampling")==="nearest"?R.NEAREST:R.LINEAR;M.activeTexture.set(R.TEXTURE0),ye.texture.bind(pt,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),M.activeTexture.set(R.TEXTURE1),be?(be.texture.bind(pt,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),et=Math.pow(2,be.tileID.overscaledZ-ye.tileID.overscaledZ),at=[ye.tileID.canonical.x*et%1,ye.tileID.canonical.y*et%1]):ye.texture.bind(pt,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),ye.texture.useMipmap&&M.extTextureFilterAnisotropic&&p.transform.pitch>20&&R.texParameterf(R.TEXTURE_2D,M.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,M.extTextureFilterAnisotropicMax);const lt=p.style.map.terrain&&p.style.map.terrain.getTerrainData(de),rt=lt?de:null,bt=rt?rt.posMatrix:p.transform.calculatePosMatrix(de.toUnwrapped(),oe),Kt=gl(bt,at||[0,0],et||1,Ve,T);B instanceof _s?$.draw(M,R.TRIANGLES,ee,Si.disabled,X,Ci.disabled,Kt,lt,T.id,B.boundsBuffer,p.quadTriangleIndexBuffer,B.boundsSegments):$.draw(M,R.TRIANGLES,ee,Y[de.overscaledZ],X,Ci.disabled,Kt,lt,T.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments)}})(e,o,u,c);break;case"background":(function(p,b,T,C){const M=T.paint.get("background-color"),R=T.paint.get("background-opacity");if(R===0)return;const B=p.context,$=B.gl,X=p.transform,Y=X.tileSize,Q=T.paint.get("background-pattern");if(p.isPatternMissing(Q))return;const ie=!Q&&M.a===1&&R===1&&p.opaquePassEnabledForLayer()?"opaque":"translucent";if(p.renderPass!==ie)return;const oe=Si.disabled,de=p.depthModeForSublayer(0,ie==="opaque"?pi.ReadWrite:pi.ReadOnly),ee=p.colorModeForRenderPass(),ye=p.useProgram(Q?"backgroundPattern":"background"),be=C||X.coveringTiles({tileSize:Y,terrain:p.style.map.terrain});Q&&(B.activeTexture.set($.TEXTURE0),p.imageManager.bind(p.context));const Ce=T.getCrossfadeParameters();for(const Ve of be){const et=C?Ve.posMatrix:p.transform.calculatePosMatrix(Ve.toUnwrapped()),at=Q?eu(et,R,p,Q,{tileID:Ve,tileSize:Y},Ce):Vo(et,R,M),pt=p.style.map.terrain&&p.style.map.terrain.getTerrainData(Ve);ye.draw(B,$.TRIANGLES,de,oe,ee,Ci.disabled,at,pt,T.id,p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}})(e,0,u,c);break;case"custom":(function(p,b,T){const C=p.context,M=T.implementation;if(p.renderPass==="offscreen"){const R=M.prerender;R&&(p.setCustomLayerDefaults(),C.setColorMode(p.colorModeForRenderPass()),R.call(M,C.gl,p.transform.customLayerMatrix()),C.setDirty(),p.setBaseState())}else if(p.renderPass==="translucent"){p.setCustomLayerDefaults(),C.setColorMode(p.colorModeForRenderPass()),C.setStencilMode(Si.disabled);const R=M.renderingMode==="3d"?new pi(p.context.gl.LEQUAL,pi.ReadWrite,p.depthRangeFor3D):p.depthModeForSublayer(0,pi.ReadOnly);C.setDepthMode(R),M.render(C.gl,p.transform.customLayerMatrix(),{farZ:p.transform.farZ,nearZ:p.transform.nearZ,fov:p.transform._fov,modelViewProjectionMatrix:p.transform.modelViewProjectionMatrix,projectionMatrix:p.transform.projectionMatrix}),C.setDirty(),p.setBaseState(),C.bindFramebuffer.set(null)}})(e,0,u)}}translatePosMatrix(e,o,u,c,p){if(!u[0]&&!u[1])return e;const b=p?c==="map"?this.transform.angle:0:c==="viewport"?-this.transform.angle:0;if(b){const M=Math.sin(b),R=Math.cos(b);u=[u[0]*R-u[1]*M,u[0]*M+u[1]*R]}const T=[p?u[0]:si(o,u[0],this.transform.zoom),p?u[1]:si(o,u[1],this.transform.zoom),0],C=new Float32Array(16);return g.J(C,e,T),C}saveTileTexture(e){const o=this._tileTextures[e.size[0]];o?o.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const o=this._tileTextures[e];return o&&o.length>0?o.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const o=this.imageManager.getPattern(e.from.toString()),u=this.imageManager.getPattern(e.to.toString());return!o||!u}useProgram(e,o){this.cache=this.cache||{};const u=e+(o?o.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[u]||(this.cache[u]=new zi(this.context,ho[e],o,yl[e],this._showOverdrawInspector,this.style.map.terrain)),this.cache[u]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new qt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:o}=this.context.gl;return this.width!==e||this.height!==o}}class fa{constructor(e,o){this.points=e,this.planes=o}static fromInvProjectionMatrix(e,o,u){const c=Math.pow(2,u),p=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(T=>{const C=1/(T=g.af([],T,e))[3]/o*c;return g.b1(T,T,[C,C,1/T[3],C])}),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(T=>{const C=function($,X){var Y=X[0],Q=X[1],ie=X[2],oe=Y*Y+Q*Q+ie*ie;return oe>0&&(oe=1/Math.sqrt(oe)),$[0]=X[0]*oe,$[1]=X[1]*oe,$[2]=X[2]*oe,$}([],function($,X,Y){var Q=X[0],ie=X[1],oe=X[2],de=Y[0],ee=Y[1],ye=Y[2];return $[0]=ie*ye-oe*ee,$[1]=oe*de-Q*ye,$[2]=Q*ee-ie*de,$}([],_i([],p[T[0]],p[T[1]]),_i([],p[T[2]],p[T[1]]))),M=-((R=C)[0]*(B=p[T[1]])[0]+R[1]*B[1]+R[2]*B[2]);var R,B;return C.concat(M)});return new fa(p,b)}}class Go{constructor(e,o){this.min=e,this.max=o,this.center=function(u,c,p){return u[0]=.5*c[0],u[1]=.5*c[1],u[2]=.5*c[2],u}([],function(u,c,p){return u[0]=c[0]+p[0],u[1]=c[1]+p[1],u[2]=c[2]+p[2],u}([],this.min,this.max))}quadrant(e){const o=[e%2==0,e<2],u=li(this.min),c=li(this.max);for(let p=0;p<o.length;p++)u[p]=o[p]?this.min[p]:this.center[p],c[p]=o[p]?this.center[p]:this.max[p];return c[2]=this.max[2],new Go(u,c)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersects(e){const o=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let u=!0;for(let c=0;c<e.planes.length;c++){const p=e.planes[c];let b=0;for(let T=0;T<o.length;T++)g.b2(p,o[T])>=0&&b++;if(b===0)return 0;b!==o.length&&(u=!1)}if(u)return 2;for(let c=0;c<3;c++){let p=Number.MAX_VALUE,b=-Number.MAX_VALUE;for(let T=0;T<e.points.length;T++){const C=e.points[T][c]-this.min[c];p=Math.min(p,C),b=Math.max(b,C)}if(b<0||p>this.max[c]-this.min[c])return 0}return 1}}class pa{constructor(e=0,o=0,u=0,c=0){if(isNaN(e)||e<0||isNaN(o)||o<0||isNaN(u)||u<0||isNaN(c)||c<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=o,this.left=u,this.right=c}interpolate(e,o,u){return o.top!=null&&e.top!=null&&(this.top=g.y.number(e.top,o.top,u)),o.bottom!=null&&e.bottom!=null&&(this.bottom=g.y.number(e.bottom,o.bottom,u)),o.left!=null&&e.left!=null&&(this.left=g.y.number(e.left,o.left,u)),o.right!=null&&e.right!=null&&(this.right=g.y.number(e.right,o.right,u)),this}getCenter(e,o){const u=g.ac((this.left+e-this.right)/2,0,e),c=g.ac((this.top+o-this.bottom)/2,0,o);return new g.P(u,c)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new pa(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const nl=85.051129;class Wo{constructor(e,o,u,c,p){this.tileSize=512,this._renderWorldCopies=p===void 0||!!p,this._minZoom=e||0,this._maxZoom=o||22,this._minPitch=u??0,this._maxPitch=c??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new g.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new pa,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const e=new Wo(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.apply(this),e}apply(e){this.tileSize=e.tileSize,this.latRange=e.latRange,this.lngRange=e.lngRange,this.width=e.width,this.height=e.height,this._center=e._center,this._elevation=e._elevation,this.minElevationForCurrentTile=e.minElevationForCurrentTile,this.zoom=e.zoom,this.angle=e.angle,this._fov=e._fov,this._pitch=e._pitch,this._unmodified=e._unmodified,this._edgeInsets=e._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new g.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){const o=-g.b3(e,-180,180)*Math.PI/180;this.angle!==o&&(this._unmodified=!1,this.angle=o,this._calcMatrices(),this.rotationMatrix=function(){var u=new g.A(4);return g.A!=Float32Array&&(u[1]=0,u[2]=0),u[0]=1,u[3]=1,u}(),function(u,c,p){var b=c[0],T=c[1],C=c[2],M=c[3],R=Math.sin(p),B=Math.cos(p);u[0]=b*B+C*R,u[1]=T*B+M*R,u[2]=b*-R+C*B,u[3]=T*-R+M*B}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const o=g.ac(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==o&&(this._unmodified=!1,this._pitch=o,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(e){const o=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this.tileZoom=Math.max(0,Math.floor(o)),this.scale=this.zoomScale(o),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,o,u){this._unmodified=!1,this._edgeInsets.interpolate(e,o,u),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){const o=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,o)}getVisibleUnwrappedCoordinates(e){const o=[new g.b4(0,e)];if(this._renderWorldCopies){const u=this.pointCoordinate(new g.P(0,0)),c=this.pointCoordinate(new g.P(this.width,0)),p=this.pointCoordinate(new g.P(this.width,this.height)),b=this.pointCoordinate(new g.P(0,this.height)),T=Math.floor(Math.min(u.x,c.x,p.x,b.x)),C=Math.floor(Math.max(u.x,c.x,p.x,b.x)),M=1;for(let R=T-M;R<=C+M;R++)R!==0&&o.push(new g.b4(R,e))}return o}coveringTiles(e){var o,u;let c=this.coveringZoomLevel(e);const p=c;if(e.minzoom!==void 0&&c<e.minzoom)return[];e.maxzoom!==void 0&&c>e.maxzoom&&(c=e.maxzoom);const b=this.pointCoordinate(this.getCameraPoint()),T=g.Z.fromLngLat(this.center),C=Math.pow(2,c),M=[C*b.x,C*b.y,0],R=[C*T.x,C*T.y,0],B=fa.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,c);let $=e.minzoom||0;!e.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&($=c);const X=e.terrain?2/Math.min(this.tileSize,e.tileSize)*this.tileSize:3,Y=ee=>({aabb:new Go([ee*C,0,0],[(ee+1)*C,C,0]),zoom:0,x:0,y:0,wrap:ee,fullyVisible:!1}),Q=[],ie=[],oe=c,de=e.reparseOverscaled?p:c;if(this._renderWorldCopies)for(let ee=1;ee<=3;ee++)Q.push(Y(-ee)),Q.push(Y(ee));for(Q.push(Y(0));Q.length>0;){const ee=Q.pop(),ye=ee.x,be=ee.y;let Ce=ee.fullyVisible;if(!Ce){const lt=ee.aabb.intersects(B);if(lt===0)continue;Ce=lt===2}const Ve=e.terrain?M:R,et=ee.aabb.distanceX(Ve),at=ee.aabb.distanceY(Ve),pt=Math.max(Math.abs(et),Math.abs(at));if(ee.zoom===oe||pt>X+(1<<oe-ee.zoom)-2&&ee.zoom>=$){const lt=oe-ee.zoom,rt=M[0]-.5-(ye<<lt),bt=M[1]-.5-(be<<lt);ie.push({tileID:new g.S(ee.zoom===oe?de:ee.zoom,ee.wrap,ee.zoom,ye,be),distanceSq:nn([R[0]-.5-ye,R[1]-.5-be]),tileDistanceToCamera:Math.sqrt(rt*rt+bt*bt)})}else for(let lt=0;lt<4;lt++){const rt=(ye<<1)+lt%2,bt=(be<<1)+(lt>>1),Kt=ee.zoom+1;let ut=ee.aabb.quadrant(lt);if(e.terrain){const ht=new g.S(Kt,ee.wrap,Kt,rt,bt),Gt=e.terrain.getMinMaxElevation(ht),Wi=(o=Gt.minElevation)!==null&&o!==void 0?o:this.elevation,ai=(u=Gt.maxElevation)!==null&&u!==void 0?u:this.elevation;ut=new Go([ut.min[0],ut.min[1],Wi],[ut.max[0],ut.max[1],ai])}Q.push({aabb:ut,zoom:Kt,x:rt,y:bt,wrap:ee.wrap,fullyVisible:Ce})}}return ie.sort((ee,ye)=>ee.distanceSq-ye.distanceSq).map(ee=>ee.tileID)}resize(e,o){this.width=e,this.height=o,this.pixelsToGLUnits=[2/e,-2/o],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(e){const o=g.ac(e.lat,-85.051129,nl);return new g.P(g.O(e.lng)*this.worldSize,g.Q(o)*this.worldSize)}unproject(e){return new g.Z(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(e){const o=this.elevation,u=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,c=this.pointLocation(this.centerPoint,e),p=e.getElevationForLngLatZoom(c,this.tileZoom);if(!(this.elevation-p))return;const b=u+o-p,T=Math.cos(this._pitch)*this.cameraToCenterDistance/b/g.b5(1,c.lat),C=this.scaleZoom(T/this.tileSize);this._elevation=p,this._center=c,this.zoom=C}setLocationAtPoint(e,o){const u=this.pointCoordinate(o),c=this.pointCoordinate(this.centerPoint),p=this.locationCoordinate(e),b=new g.Z(p.x-(u.x-c.x),p.y-(u.y-c.y));this.center=this.coordinateLocation(b),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(e,o){return o?this.coordinatePoint(this.locationCoordinate(e),o.getElevationForLngLatZoom(e,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(e))}pointLocation(e,o){return this.coordinateLocation(this.pointCoordinate(e,o))}locationCoordinate(e){return g.Z.fromLngLat(e)}coordinateLocation(e){return e&&e.toLngLat()}pointCoordinate(e,o){if(o){const $=o.pointCoordinate(e);if($!=null)return $}const u=[e.x,e.y,0,1],c=[e.x,e.y,1,1];g.af(u,u,this.pixelMatrixInverse),g.af(c,c,this.pixelMatrixInverse);const p=u[3],b=c[3],T=u[1]/p,C=c[1]/b,M=u[2]/p,R=c[2]/b,B=M===R?0:(0-M)/(R-M);return new g.Z(g.y.number(u[0]/p,c[0]/b,B)/this.worldSize,g.y.number(T,C,B)/this.worldSize)}coordinatePoint(e,o=0,u=this.pixelMatrix){const c=[e.x*this.worldSize,e.y*this.worldSize,o,1];return g.af(c,c,u),new g.P(c[0]/c[3],c[1]/c[3])}getBounds(){const e=Math.max(0,this.height/2-this.getHorizon());return new Le().extend(this.pointLocation(new g.P(0,e))).extend(this.pointLocation(new g.P(this.width,e))).extend(this.pointLocation(new g.P(this.width,this.height))).extend(this.pointLocation(new g.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Le([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,nl])}calculateTileMatrix(e){const o=e.canonical,u=this.worldSize/this.zoomScale(o.z),c=o.x+Math.pow(2,o.z)*e.wrap,p=g.an(new Float64Array(16));return g.J(p,p,[c*u,o.y*u,0]),g.K(p,p,[u/g.X,u/g.X,1]),p}calculatePosMatrix(e,o=!1){const u=e.key,c=o?this._alignedPosMatrixCache:this._posMatrixCache;if(c[u])return c[u];const p=this.calculateTileMatrix(e);return g.L(p,o?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,p),c[u]=new Float32Array(p),c[u]}calculateFogMatrix(e){const o=e.key,u=this._fogMatrixCache;if(u[o])return u[o];const c=this.calculateTileMatrix(e);return g.L(c,this.fogMatrix,c),u[o]=new Float32Array(c),u[o]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(e,o){o=g.ac(+o,this.minZoom,this.maxZoom);const u={center:new g.N(e.lng,e.lat),zoom:o};let c=this.lngRange;if(!this._renderWorldCopies&&c===null){const ee=179.9999999999;c=[-ee,ee]}const p=this.tileSize*this.zoomScale(u.zoom);let b=0,T=p,C=0,M=p,R=0,B=0;const{x:$,y:X}=this.size;if(this.latRange){const ee=this.latRange;b=g.Q(ee[1])*p,T=g.Q(ee[0])*p,T-b<X&&(R=X/(T-b))}c&&(C=g.b3(g.O(c[0])*p,0,p),M=g.b3(g.O(c[1])*p,0,p),M<C&&(M+=p),M-C<$&&(B=$/(M-C)));const{x:Y,y:Q}=this.project.call({worldSize:p},e);let ie,oe;const de=Math.max(B||0,R||0);if(de){const ee=new g.P(B?(M+C)/2:Y,R?(T+b)/2:Q);return u.center=this.unproject.call({worldSize:p},ee).wrap(),u.zoom+=this.scaleZoom(de),u}if(this.latRange){const ee=X/2;Q-ee<b&&(oe=b+ee),Q+ee>T&&(oe=T-ee)}if(c){const ee=(C+M)/2;let ye=Y;this._renderWorldCopies&&(ye=g.b3(Y,ee-p/2,ee+p/2));const be=$/2;ye-be<C&&(ie=C+be),ye+be>M&&(ie=M-be)}if(ie!==void 0||oe!==void 0){const ee=new g.P(ie??Y,oe??Q);u.center=this.unproject.call({worldSize:p},ee).wrap()}return u}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:o,zoom:u}=this.getConstrained(this.center,this.zoom);this.center=o,this.zoom=u,this._unmodified=e,this._constraining=!1}_calcMatrices(){if(!this.height)return;const e=this.centerOffset,o=this.point.x,u=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=g.b5(1,this.center.lat)*this.worldSize;let c=g.an(new Float64Array(16));g.K(c,c,[this.width/2,-this.height/2,1]),g.J(c,c,[1,-1,0]),this.labelPlaneMatrix=c,c=g.an(new Float64Array(16)),g.K(c,c,[1,-1,1]),g.J(c,c,[-1,-1,0]),g.K(c,c,[2/this.width,2/this.height,1]),this.glCoordMatrix=c;const p=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),b=Math.min(this.elevation,this.minElevationForCurrentTile),T=p-b*this._pixelPerMeter/Math.cos(this._pitch),C=b<0?T:p,M=Math.PI/2+this._pitch,R=this._fov*(.5+e.y/this.height),B=Math.sin(R)*C/Math.sin(g.ac(Math.PI-M-R,.01,Math.PI-.01)),$=this.getHorizon(),X=2*Math.atan($/this.cameraToCenterDistance)*(.5+e.y/(2*$)),Y=Math.sin(X)*C/Math.sin(g.ac(Math.PI-M-X,.01,Math.PI-.01)),Q=Math.min(B,Y);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*Q+C),this.nearZ=this.height/50,c=new Float64Array(16),g.b6(c,this._fov,this.width/this.height,this.nearZ,this.farZ),c[8]=2*-e.x/this.width,c[9]=2*e.y/this.height,this.projectionMatrix=g.ae(c),g.K(c,c,[1,-1,1]),g.J(c,c,[0,0,-this.cameraToCenterDistance]),g.b7(c,c,this._pitch),g.ad(c,c,this.angle),g.J(c,c,[-o,-u,0]),this.mercatorMatrix=g.K([],c,[this.worldSize,this.worldSize,this.worldSize]),g.K(c,c,[1,1,this._pixelPerMeter]),this.pixelMatrix=g.L(new Float64Array(16),this.labelPlaneMatrix,c),g.J(c,c,[0,0,-this.elevation]),this.modelViewProjectionMatrix=c,this.invModelViewProjectionMatrix=g.as([],c),this.fogMatrix=new Float64Array(16),g.b6(this.fogMatrix,this._fov,this.width/this.height,p,this.farZ),this.fogMatrix[8]=2*-e.x/this.width,this.fogMatrix[9]=2*e.y/this.height,g.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),g.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),g.b7(this.fogMatrix,this.fogMatrix,this._pitch),g.ad(this.fogMatrix,this.fogMatrix,this.angle),g.J(this.fogMatrix,this.fogMatrix,[-o,-u,0]),g.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),g.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=g.L(new Float64Array(16),this.labelPlaneMatrix,c);const ie=this.width%2/2,oe=this.height%2/2,de=Math.cos(this.angle),ee=Math.sin(this.angle),ye=o-Math.round(o)+de*ie+ee*oe,be=u-Math.round(u)+de*oe+ee*ie,Ce=new Float64Array(c);if(g.J(Ce,Ce,[ye>.5?ye-1:ye,be>.5?be-1:be,0]),this.alignedModelViewProjectionMatrix=Ce,c=g.as(new Float64Array(16),this.pixelMatrix),!c)throw new Error("failed to invert matrix");this.pixelMatrixInverse=c,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const e=this.pointCoordinate(new g.P(0,0)),o=[e.x*this.worldSize,e.y*this.worldSize,0,1];return g.af(o,o,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new g.P(0,e))}getCameraQueryGeometry(e){const o=this.getCameraPoint();if(e.length===1)return[e[0],o];{let u=o.x,c=o.y,p=o.x,b=o.y;for(const T of e)u=Math.min(u,T.x),c=Math.min(c,T.y),p=Math.max(p,T.x),b=Math.max(b,T.y);return[new g.P(u,c),new g.P(p,c),new g.P(p,b),new g.P(u,b),new g.P(u,c)]}}lngLatToCameraDepth(e,o){const u=this.locationCoordinate(e),c=[u.x*this.worldSize,u.y*this.worldSize,o,1];return g.af(c,c,this.modelViewProjectionMatrix),c[2]/c[3]}}function Ar(m,e){let o,u=!1,c=null,p=null;const b=()=>{c=null,u&&(m.apply(p,o),c=setTimeout(b,e),u=!1)};return(...T)=>(u=!0,p=this,o=T,c||b(),c)}class ma{constructor(e){this._getCurrentHash=()=>{const o=window.location.hash.replace("#","");if(this._hashName){let u;return o.split("&").map(c=>c.split("=")).forEach(c=>{c[0]===this._hashName&&(u=c)}),(u&&u[1]||"").split("/")}return o.split("/")},this._onHashChange=()=>{const o=this._getCurrentHash();if(o.length>=3&&!o.some(u=>isNaN(u))){const u=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(o[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:u,pitch:+(o[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const o=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,o)},this._removeHash=()=>{const o=this._getCurrentHash();if(o.length===0)return;const u=o.join("/");let c=u;c.split("&").length>0&&(c=c.split("&")[0]),this._hashName&&(c=`${this._hashName}=${u}`);let p=window.location.hash.replace(c,"");p.startsWith("#&")?p=p.slice(0,1)+p.slice(2):p==="#"&&(p="");let b=window.location.href.replace(/(#.+)?$/,p);b=b.replace("&&","&"),window.history.replaceState(window.history.state,null,b)},this._updateHash=Ar(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const o=this._map.getCenter(),u=Math.round(100*this._map.getZoom())/100,c=Math.ceil((u*Math.LN2+Math.log(512/360/.5))/Math.LN10),p=Math.pow(10,c),b=Math.round(o.lng*p)/p,T=Math.round(o.lat*p)/p,C=this._map.getBearing(),M=this._map.getPitch();let R="";if(R+=e?`/${b}/${T}/${u}`:`${u}/${T}/${b}`,(C||M)&&(R+="/"+Math.round(10*C)/10),M&&(R+=`/${Math.round(M)}`),this._hashName){const B=this._hashName;let $=!1;const X=window.location.hash.slice(1).split("&").map(Y=>{const Q=Y.split("=")[0];return Q===B?($=!0,`${Q}=${R}`):Y}).filter(Y=>Y);return $||X.push(`${B}=${R}`),`#${X.join("&")}`}return`#${R}`}}const xo={linearity:.3,easing:g.b8(0,0,.3,1)},Xo=g.e({deceleration:2500,maxSpeed:1400},xo),rl=g.e({deceleration:20,maxSpeed:1400},xo),sl=g.e({deceleration:1e3,maxSpeed:360},xo),ol=g.e({deceleration:1e3,maxSpeed:90},xo);class Hs{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:xe.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,o=xe.now();for(;e.length>0&&o-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const o={zoom:0,bearing:0,pitch:0,pan:new g.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:p}of this._inertiaBuffer)o.zoom+=p.zoomDelta||0,o.bearing+=p.bearingDelta||0,o.pitch+=p.pitchDelta||0,p.panDelta&&o.pan._add(p.panDelta),p.around&&(o.around=p.around),p.pinchAround&&(o.pinchAround=p.pinchAround);const u=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,c={};if(o.pan.mag()){const p=ns(o.pan.mag(),u,g.e({},Xo,e||{}));c.offset=o.pan.mult(p.amount/o.pan.mag()),c.center=this._map.transform.center,Gs(c,p)}if(o.zoom){const p=ns(o.zoom,u,rl);c.zoom=this._map.transform.zoom+p.amount,Gs(c,p)}if(o.bearing){const p=ns(o.bearing,u,sl);c.bearing=this._map.transform.bearing+g.ac(p.amount,-179,179),Gs(c,p)}if(o.pitch){const p=ns(o.pitch,u,ol);c.pitch=this._map.transform.pitch+p.amount,Gs(c,p)}if(c.zoom||c.bearing){const p=o.pinchAround===void 0?o.around:o.pinchAround;c.around=p?this._map.unproject(p):this._map.getCenter()}return this.clear(),g.e(c,{noMoveStart:!0})}}function Gs(m,e){(!m.duration||m.duration<e.duration)&&(m.duration=e.duration,m.easing=e.easing)}function ns(m,e,o){const{maxSpeed:u,linearity:c,deceleration:p}=o,b=g.ac(m*c/(e/1e3),-u,u),T=Math.abs(b)/(p*c);return{easing:o.easing,duration:1e3*T,amount:b*(T/2)}}class Fn extends g.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,o,u,c={}){const p=me.mousePos(o.getCanvas(),u),b=o.unproject(p);super(e,g.e({point:p,lngLat:b,originalEvent:u},c)),this._defaultPrevented=!1,this.target=o}}class ks extends g.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,o,u){const c=e==="touchend"?u.changedTouches:u.touches,p=me.touchPos(o.getCanvasContainer(),c),b=p.map(C=>o.unproject(C)),T=p.reduce((C,M,R,B)=>C.add(M.div(B.length)),new g.P(0,0));super(e,{points:p,point:T,lngLats:b,lngLat:o.unproject(T),originalEvent:u}),this._defaultPrevented=!1}}class cu extends g.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,o,u){super(e,{originalEvent:u}),this._defaultPrevented=!1}}class Cs{constructor(e,o){this._map=e,this._clickTolerance=o.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new cu(e.type,this._map,e))}mousedown(e,o){return this._mousedownPos=o,this._firePreventable(new Fn(e.type,this._map,e))}mouseup(e){this._map.fire(new Fn(e.type,this._map,e))}click(e,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new Fn(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Fn(e.type,this._map,e))}mouseover(e){this._map.fire(new Fn(e.type,this._map,e))}mouseout(e){this._map.fire(new Fn(e.type,this._map,e))}touchstart(e){return this._firePreventable(new ks(e.type,this._map,e))}touchmove(e){this._map.fire(new ks(e.type,this._map,e))}touchend(e){this._map.fire(new ks(e.type,this._map,e))}touchcancel(e){this._map.fire(new ks(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ln{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Fn(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Fn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Fn(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class $r{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.pointLocation(g.P.convert(e),this._map.terrain)}}class Nn{constructor(e,o){this._map=e,this._tr=new $r(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=o.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,o){this.isEnabled()&&e.shiftKey&&e.button===0&&(me.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)}mousemoveWindow(e,o){if(!this._active)return;const u=o;if(this._lastPos.equals(u)||!this._box&&u.dist(this._startPos)<this._clickTolerance)return;const c=this._startPos;this._lastPos=u,this._box||(this._box=me.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const p=Math.min(c.x,u.x),b=Math.max(c.x,u.x),T=Math.min(c.y,u.y),C=Math.max(c.y,u.y);me.setTransform(this._box,`translate(${p}px,${T}px)`),this._box.style.width=b-p+"px",this._box.style.height=C-T+"px"}mouseupWindow(e,o){if(!this._active||e.button!==0)return;const u=this._startPos,c=o;if(this.reset(),me.suppressClick(),u.x!==c.x||u.y!==c.y)return this._map.fire(new g.k("boxzoomend",{originalEvent:e})),{cameraAnimation:p=>p.fitScreenCoordinates(u,c,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(me.remove(this._box),this._box=null),me.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,o){return this._map.fire(new g.k(e,{originalEvent:o}))}}function Ra(m,e){if(m.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${m.length}, points ${e.length}`);const o={};for(let u=0;u<m.length;u++)o[m[u].identifier]=e[u];return o}class qr{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,o,u){(this.centroid||u.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),u.length===this.numTouches&&(this.centroid=function(c){const p=new g.P(0,0);for(const b of c)p._add(b);return p.div(c.length)}(o),this.touches=Ra(u,o)))}touchmove(e,o,u){if(this.aborted||!this.centroid)return;const c=Ra(u,o);for(const p in this.touches){const b=c[p];(!b||b.dist(this.touches[p])>30)&&(this.aborted=!0)}}touchend(e,o,u){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),u.length===0){const c=!this.aborted&&this.centroid;if(this.reset(),c)return c}}}class Ws{constructor(e){this.singleTap=new qr(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,o,u){this.singleTap.touchstart(e,o,u)}touchmove(e,o,u){this.singleTap.touchmove(e,o,u)}touchend(e,o,u){const c=this.singleTap.touchend(e,o,u);if(c){const p=e.timeStamp-this.lastTime<500,b=!this.lastTap||this.lastTap.dist(c)<30;if(p&&b||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=c,this.count===this.numTaps)return this.reset(),c}}}class wo{constructor(e){this._tr=new $r(e),this._zoomIn=new Ws({numTouches:1,numTaps:2}),this._zoomOut=new Ws({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,o,u){this._zoomIn.touchstart(e,o,u),this._zoomOut.touchstart(e,o,u)}touchmove(e,o,u){this._zoomIn.touchmove(e,o,u),this._zoomOut.touchmove(e,o,u)}touchend(e,o,u){const c=this._zoomIn.touchend(e,o,u),p=this._zoomOut.touchend(e,o,u),b=this._tr;return c?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:b.zoom+1,around:b.unproject(c)},{originalEvent:e})}):p?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:b.zoom-1,around:b.unproject(p)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xs{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const o=this._moveFunction(...e);if(o.bearingDelta||o.pitchDelta||o.around||o.panDelta)return this._active=!0,o}dragStart(e,o){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=o.length?o[0]:o,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,o){if(!this.isEnabled())return;const u=this._lastPoint;if(!u)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const c=o.length?o[0]:o;return!this._moved&&c.dist(u)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=c,this._move(u,c))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&me.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const hu={0:1,2:2};class bo{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const o=me.mouseButton(e);this._eventButton=o}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(o,u){const c=hu[u];return o.buttons===void 0||(o.buttons&c)!==c}(e,this._eventButton)}isValidEndEvent(e){return me.mouseButton(e)===this._eventButton}}class kl{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}const Ba=m=>{m.mousedown=m.dragStart,m.mousemoveWindow=m.dragMove,m.mouseup=m.dragEnd,m.contextmenu=e=>{e.preventDefault()}},al=({enable:m,clickTolerance:e,bearingDegreesPerPixelMoved:o=.8})=>{const u=new bo({checkCorrectEvent:c=>me.mouseButton(c)===0&&c.ctrlKey||me.mouseButton(c)===2});return new Xs({clickTolerance:e,move:(c,p)=>({bearingDelta:(p.x-c.x)*o}),moveStateManager:u,enable:m,assignEvents:Ba})},qi=({enable:m,clickTolerance:e,pitchDegreesPerPixelMoved:o=-.5})=>{const u=new bo({checkCorrectEvent:c=>me.mouseButton(c)===0&&c.ctrlKey||me.mouseButton(c)===2});return new Xs({clickTolerance:e,move:(c,p)=>({pitchDelta:(p.y-c.y)*o}),moveStateManager:u,enable:m,assignEvents:Ba})};class So{constructor(e,o){this._clickTolerance=e.clickTolerance||1,this._map=o,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new g.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,o,u){return this._calculateTransform(e,o,u)}touchmove(e,o,u){if(this._active){if(!this._shouldBePrevented(u.length))return e.preventDefault(),this._calculateTransform(e,o,u);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,o,u){this._calculateTransform(e,o,u),this._active&&this._shouldBePrevented(u.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,o,u){u.length>0&&(this._active=!0);const c=Ra(u,o),p=new g.P(0,0),b=new g.P(0,0);let T=0;for(const M in c){const R=c[M],B=this._touches[M];B&&(p._add(R),b._add(R.sub(B)),T++,c[M]=R)}if(this._touches=c,this._shouldBePrevented(T)||!b.mag())return;const C=b.div(T);return this._sum._add(C),this._sum.mag()<this._clickTolerance?void 0:{around:p.div(T),panDelta:C}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ko{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,o,u){this._firstTwoTouches||u.length<2||(this._firstTwoTouches=[u[0].identifier,u[1].identifier],this._start([o[0],o[1]]))}touchmove(e,o,u){if(!this._firstTwoTouches)return;e.preventDefault();const[c,p]=this._firstTwoTouches,b=Ks(u,o,c),T=Ks(u,o,p);if(!b||!T)return;const C=this._aroundCenter?null:b.add(T).div(2);return this._move([b,T],C,e)}touchend(e,o,u){if(!this._firstTwoTouches)return;const[c,p]=this._firstTwoTouches,b=Ks(u,o,c),T=Ks(u,o,p);b&&T||(this._active&&me.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Ks(m,e,o){for(let u=0;u<m.length;u++)if(m[u].identifier===o)return e[u]}function Cl(m,e){return Math.log(m/e)/Math.LN2}class s extends Ko{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,o){const u=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Cl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Cl(this._distance,u),pinchAround:o}}}function d(m,e){return 180*m.angleWith(e)/Math.PI}class v extends Ko{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,o,u){const c=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:d(this._vector,c),pinchAround:o}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const o=25/(Math.PI*this._minDiameter)*360,u=d(e,this._startVector);return Math.abs(u)<o}}function P(m){return Math.abs(m.y)>Math.abs(m.x)}class A extends Ko{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,o,u){super.touchstart(e,o,u),this._currentTouchCount=u.length}_start(e){this._lastPoints=e,P(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,o,u){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const c=e[0].sub(this._lastPoints[0]),p=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(c,p,u.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(c.y+p.y)/2*-.5}):void 0}gestureBeginsVertically(e,o,u){if(this._valid!==void 0)return this._valid;const c=e.mag()>=2,p=o.mag()>=2;if(!c&&!p)return;if(!c||!p)return this._firstMove===void 0&&(this._firstMove=u),u-this._firstMove<100&&void 0;const b=e.y>0==o.y>0;return P(e)&&P(o)&&b}}const G={panStep:100,bearingStep:15,pitchStep:10};class ue{constructor(e){this._tr=new $r(e);const o=G;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let o=0,u=0,c=0,p=0,b=0;switch(e.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:e.shiftKey?u=-1:(e.preventDefault(),p=-1);break;case 39:e.shiftKey?u=1:(e.preventDefault(),p=1);break;case 38:e.shiftKey?c=1:(e.preventDefault(),b=-1);break;case 40:e.shiftKey?c=-1:(e.preventDefault(),b=1);break;default:return}return this._rotationDisabled&&(u=0,c=0),{cameraAnimation:T=>{const C=this._tr;T.easeTo({duration:300,easeId:"keyboardHandler",easing:Pe,zoom:o?Math.round(C.zoom)+o*(e.shiftKey?2:1):C.zoom,bearing:C.bearing+u*this._bearingStep,pitch:C.pitch+c*this._pitchStep,offset:[-p*this._panStep,-b*this._panStep],center:C.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Pe(m){return m*(2-m)}const Re=4.000244140625;class $e{constructor(e,o){this._onTimeout=u=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)},this._map=e,this._tr=new $r(e),this._triggerRenderFrame=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let o=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const u=xe.now(),c=u-(this._lastWheelEventTime||0);this._lastWheelEventTime=u,o!==0&&o%Re==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":c>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(c*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),e.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=e,this._delta-=o,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const o=me.mousePos(this._map.getCanvas(),e),u=this._tr;this._around=o.y>u.transform.height/2-u.transform.getHorizon()?g.N.convert(this._aroundCenter?u.center:u.unproject(o)):g.N.convert(u.center),this._aroundPoint=u.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(this._delta!==0){const C=this._type==="wheel"&&Math.abs(this._delta)>Re?this._wheelZoomRate:this._defaultZoomRate;let M=2/(1+Math.exp(-Math.abs(this._delta*C)));this._delta<0&&M!==0&&(M=1/M);const R=typeof this._targetZoom=="number"?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(R*M))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const o=typeof this._targetZoom=="number"?this._targetZoom:e.zoom,u=this._startZoom,c=this._easing;let p,b=!1;const T=xe.now()-this._lastWheelEventTime;if(this._type==="wheel"&&u&&c&&T){const C=Math.min(T/200,1),M=c(C);p=g.y.number(u,o,M),C<1?this._frameId||(this._frameId=!0):b=!0}else p=o,b=!0;return this._active=!0,b&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!b,zoomDelta:p-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let o=g.b9;if(this._prevEase){const u=this._prevEase,c=(xe.now()-u.start)/u.duration,p=u.easing(c+.01)-u.easing(c),b=.27/Math.sqrt(p*p+1e-4)*.01,T=Math.sqrt(.0729-b*b);o=g.b8(b,T,.25,1)}return this._prevEase={start:xe.now(),duration:e,easing:o},o}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class ft{constructor(e,o){this._clickZoom=e,this._tapZoom=o}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ht{constructor(e){this._tr=new $r(e),this.reset()}reset(){this._active=!1}dblclick(e,o){return e.preventDefault(),{cameraAnimation:u=>{u.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(o)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class yi{constructor(){this._tap=new Ws({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,o,u){if(!this._swipePoint)if(this._tapTime){const c=o[0],p=e.timeStamp-this._tapTime<500,b=this._tapPoint.dist(c)<30;p&&b?u.length>0&&(this._swipePoint=c,this._swipeTouch=u[0].identifier):this.reset()}else this._tap.touchstart(e,o,u)}touchmove(e,o,u){if(this._tapTime){if(this._swipePoint){if(u[0].identifier!==this._swipeTouch)return;const c=o[0],p=c.y-this._swipePoint.y;return this._swipePoint=c,e.preventDefault(),this._active=!0,{zoomDelta:p/128}}}else this._tap.touchmove(e,o,u)}touchend(e,o,u){if(this._tapTime)this._swipePoint&&u.length===0&&this.reset();else{const c=this._tap.touchend(e,o,u);c&&(this._tapTime=e.timeStamp,this._tapPoint=c)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class jn{constructor(e,o,u){this._el=e,this._mousePan=o,this._touchPan=u}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class zn{constructor(e,o,u){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=o,this._mousePitch=u}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class pr{constructor(e,o,u,c){this._el=e,this._touchZoom=o,this._touchRotate=u,this._tapDragZoom=c,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class An{constructor(e,o){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=o,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=me.create("div","maplibregl-cooperative-gesture-screen",e);let o=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(o=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const u=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),c=document.createElement("div");c.className="maplibregl-desktop-message",c.textContent=o,this._container.appendChild(c);const p=document.createElement("div");p.className="maplibregl-mobile-message",p.textContent=u,this._container.appendChild(p),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(me.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,o){this._enabled&&(this._map.fire(new g.k("cooperativegestureprevented",{gestureType:e,originalEvent:o})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Xn=m=>m.zoom||m.drag||m.pitch||m.rotate;class gt extends g.k{}function Is(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class Il{constructor(e,o){this.handleWindowEvent=c=>{this.handleEvent(c,`${c.type}Window`)},this.handleEvent=(c,p)=>{if(c.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const b=c.type==="renderFrame"?void 0:c,T={needsRenderFrame:!1},C={},M={},R=c.touches,B=R?this._getMapTouches(R):void 0,$=B?me.touchPos(this._map.getCanvas(),B):me.mousePos(this._map.getCanvas(),c);for(const{handlerName:Q,handler:ie,allowed:oe}of this._handlers){if(!ie.isEnabled())continue;let de;this._blockedByActive(M,oe,Q)?ie.reset():ie[p||c.type]&&(de=ie[p||c.type](c,$,B),this.mergeHandlerResult(T,C,de,Q,b),de&&de.needsRenderFrame&&this._triggerRenderFrame()),(de||ie.isActive())&&(M[Q]=ie)}const X={};for(const Q in this._previousActiveHandlers)M[Q]||(X[Q]=b);this._previousActiveHandlers=M,(Object.keys(X).length||Is(T))&&(this._changes.push([T,C,X]),this._triggerRenderFrame()),(Object.keys(M).length||Is(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Y}=T;Y&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Y(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Hs(e),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(o);const u=this._el;this._listeners=[[u,"touchstart",{passive:!0}],[u,"touchmove",{passive:!1}],[u,"touchend",void 0],[u,"touchcancel",void 0],[u,"mousedown",void 0],[u,"mousemove",void 0],[u,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[u,"mouseover",void 0],[u,"mouseout",void 0],[u,"dblclick",void 0],[u,"click",void 0],[u,"keydown",{capture:!1}],[u,"keyup",void 0],[u,"wheel",{passive:!1}],[u,"contextmenu",void 0],[window,"blur",void 0]];for(const[c,p,b]of this._listeners)me.addEventListener(c,p,c===document?this.handleWindowEvent:this.handleEvent,b)}destroy(){for(const[e,o,u]of this._listeners)me.removeEventListener(e,o,e===document?this.handleWindowEvent:this.handleEvent,u)}_addDefaultHandlers(e){const o=this._map,u=o.getCanvasContainer();this._add("mapEvent",new Cs(o,e));const c=o.boxZoom=new Nn(o,e);this._add("boxZoom",c),e.interactive&&e.boxZoom&&c.enable();const p=o.cooperativeGestures=new An(o,e.cooperativeGestures);this._add("cooperativeGestures",p),e.cooperativeGestures&&p.enable();const b=new wo(o),T=new Ht(o);o.doubleClickZoom=new ft(T,b),this._add("tapZoom",b),this._add("clickZoom",T),e.interactive&&e.doubleClickZoom&&o.doubleClickZoom.enable();const C=new yi;this._add("tapDragZoom",C);const M=o.touchPitch=new A(o);this._add("touchPitch",M),e.interactive&&e.touchPitch&&o.touchPitch.enable(e.touchPitch);const R=al(e),B=qi(e);o.dragRotate=new zn(e,R,B),this._add("mouseRotate",R,["mousePitch"]),this._add("mousePitch",B,["mouseRotate"]),e.interactive&&e.dragRotate&&o.dragRotate.enable();const $=(({enable:de,clickTolerance:ee})=>{const ye=new bo({checkCorrectEvent:be=>me.mouseButton(be)===0&&!be.ctrlKey});return new Xs({clickTolerance:ee,move:(be,Ce)=>({around:Ce,panDelta:Ce.sub(be)}),activateOnStart:!0,moveStateManager:ye,enable:de,assignEvents:Ba})})(e),X=new So(e,o);o.dragPan=new jn(u,$,X),this._add("mousePan",$),this._add("touchPan",X,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&o.dragPan.enable(e.dragPan);const Y=new v,Q=new s;o.touchZoomRotate=new pr(u,Q,Y,C),this._add("touchRotate",Y,["touchPan","touchZoom"]),this._add("touchZoom",Q,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&o.touchZoomRotate.enable(e.touchZoomRotate);const ie=o.scrollZoom=new $e(o,()=>this._triggerRenderFrame());this._add("scrollZoom",ie,["mousePan"]),e.interactive&&e.scrollZoom&&o.scrollZoom.enable(e.scrollZoom);const oe=o.keyboard=new ue(o);this._add("keyboard",oe),e.interactive&&e.keyboard&&o.keyboard.enable(),this._add("blockableMapEvent",new ln(o))}_add(e,o,u){this._handlers.push({handlerName:e,handler:o,allowed:u}),this._handlersById[e]=o}stop(e){if(!this._updatingCamera){for(const{handler:o}of this._handlers)o.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Xn(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,o,u){for(const c in e)if(c!==u&&(!o||o.indexOf(c)<0))return!0;return!1}_getMapTouches(e){const o=[];for(const u of e)this._el.contains(u.target)&&o.push(u);return o}mergeHandlerResult(e,o,u,c,p){if(!u)return;g.e(e,u);const b={handlerName:c,originalEvent:u.originalEvent||p};u.zoomDelta!==void 0&&(o.zoom=b),u.panDelta!==void 0&&(o.drag=b),u.pitchDelta!==void 0&&(o.pitch=b),u.bearingDelta!==void 0&&(o.rotate=b)}_applyChanges(){const e={},o={},u={};for(const[c,p,b]of this._changes)c.panDelta&&(e.panDelta=(e.panDelta||new g.P(0,0))._add(c.panDelta)),c.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+c.zoomDelta),c.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+c.bearingDelta),c.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+c.pitchDelta),c.around!==void 0&&(e.around=c.around),c.pinchAround!==void 0&&(e.pinchAround=c.pinchAround),c.noInertia&&(e.noInertia=c.noInertia),g.e(o,p),g.e(u,b);this._updateMapTransform(e,o,u),this._changes=[]}_updateMapTransform(e,o,u){const c=this._map,p=c._getTransformForUpdate(),b=c.terrain;if(!(Is(e)||b&&this._terrainMovement))return this._fireEvents(o,u,!0);let{panDelta:T,zoomDelta:C,bearingDelta:M,pitchDelta:R,around:B,pinchAround:$}=e;$!==void 0&&(B=$),c._stop(!0),B=B||c.transform.centerPoint;const X=p.pointLocation(T?B.sub(T):B);M&&(p.bearing+=M),R&&(p.pitch+=R),C&&(p.zoom+=C),b?this._terrainMovement||!o.drag&&!o.zoom?o.drag&&this._terrainMovement?p.center=p.pointLocation(p.centerPoint.sub(T)):p.setLocationAtPoint(X,B):(this._terrainMovement=!0,this._map._elevationFreeze=!0,p.setLocationAtPoint(X,B)):p.setLocationAtPoint(X,B),c._applyUpdatedTransform(p),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(o,u,!0)}_fireEvents(e,o,u){const c=Xn(this._eventsInProgress),p=Xn(e),b={};for(const B in e){const{originalEvent:$}=e[B];this._eventsInProgress[B]||(b[`${B}start`]=$),this._eventsInProgress[B]=e[B]}!c&&p&&this._fireEvent("movestart",p.originalEvent);for(const B in b)this._fireEvent(B,b[B]);p&&this._fireEvent("move",p.originalEvent);for(const B in e){const{originalEvent:$}=e[B];this._fireEvent(B,$)}const T={};let C;for(const B in this._eventsInProgress){const{handlerName:$,originalEvent:X}=this._eventsInProgress[B];this._handlersById[$].isActive()||(delete this._eventsInProgress[B],C=o[$]||X,T[`${B}end`]=C)}for(const B in T)this._fireEvent(B,T[B]);const M=Xn(this._eventsInProgress),R=(c||p)&&!M;if(R&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const B=this._map._getTransformForUpdate();B.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(B)}if(u&&R){this._updatingCamera=!0;const B=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),$=X=>X!==0&&-this._bearingSnap<X&&X<this._bearingSnap;!B||!B.essential&&xe.prefersReducedMotion?(this._map.fire(new g.k("moveend",{originalEvent:C})),$(this._map.getBearing())&&this._map.resetNorth()):($(B.bearing||this._map.getBearing())&&(B.bearing=0),B.freezeElevation=!0,this._map.easeTo(B,{originalEvent:C})),this._updatingCamera=!1}}_fireEvent(e,o){this._map.fire(new g.k(e,o?{originalEvent:o}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new gt("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Jo extends g.E{constructor(e,o){super(),this._renderFrameCallback=()=>{const u=Math.min((xe.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(u)),u<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=o.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new g.N(this.transform.center.lng,this.transform.center.lat)}setCenter(e,o){return this.jumpTo({center:e},o)}panBy(e,o,u){return e=g.P.convert(e).mult(-1),this.panTo(this.transform.center,g.e({offset:e},o),u)}panTo(e,o,u){return this.easeTo(g.e({center:e},o),u)}getZoom(){return this.transform.zoom}setZoom(e,o){return this.jumpTo({zoom:e},o),this}zoomTo(e,o,u){return this.easeTo(g.e({zoom:e},o),u)}zoomIn(e,o){return this.zoomTo(this.getZoom()+1,e,o),this}zoomOut(e,o){return this.zoomTo(this.getZoom()-1,e,o),this}getBearing(){return this.transform.bearing}setBearing(e,o){return this.jumpTo({bearing:e},o),this}getPadding(){return this.transform.padding}setPadding(e,o){return this.jumpTo({padding:e},o),this}rotateTo(e,o,u){return this.easeTo(g.e({bearing:e},o),u)}resetNorth(e,o){return this.rotateTo(0,g.e({duration:1e3},e),o),this}resetNorthPitch(e,o){return this.easeTo(g.e({bearing:0,pitch:0,duration:1e3},e),o),this}snapToNorth(e,o){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,o):this}getPitch(){return this.transform.pitch}setPitch(e,o){return this.jumpTo({pitch:e},o),this}cameraForBounds(e,o){e=Le.convert(e).adjustAntiMeridian();const u=o&&o.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),u,o)}_cameraForBoxAndBearing(e,o,u,c){const p={top:0,bottom:0,right:0,left:0};if(typeof(c=g.e({padding:p,offset:[0,0],maxZoom:this.transform.maxZoom},c)).padding=="number"){const lt=c.padding;c.padding={top:lt,bottom:lt,right:lt,left:lt}}c.padding=g.e(p,c.padding);const b=this.transform,T=b.padding,C=new Le(e,o),M=b.project(C.getNorthWest()),R=b.project(C.getNorthEast()),B=b.project(C.getSouthEast()),$=b.project(C.getSouthWest()),X=g.ba(-u),Y=M.rotate(X),Q=R.rotate(X),ie=B.rotate(X),oe=$.rotate(X),de=new g.P(Math.max(Y.x,Q.x,oe.x,ie.x),Math.max(Y.y,Q.y,oe.y,ie.y)),ee=new g.P(Math.min(Y.x,Q.x,oe.x,ie.x),Math.min(Y.y,Q.y,oe.y,ie.y)),ye=de.sub(ee),be=(b.width-(T.left+T.right+c.padding.left+c.padding.right))/ye.x,Ce=(b.height-(T.top+T.bottom+c.padding.top+c.padding.bottom))/ye.y;if(Ce<0||be<0)return void g.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Ve=Math.min(b.scaleZoom(b.scale*Math.min(be,Ce)),c.maxZoom),et=g.P.convert(c.offset),at=new g.P((c.padding.left-c.padding.right)/2,(c.padding.top-c.padding.bottom)/2).rotate(g.ba(u)),pt=et.add(at).mult(b.scale/b.zoomScale(Ve));return{center:b.unproject(M.add(B).div(2).sub(pt)),zoom:Ve,bearing:u}}fitBounds(e,o,u){return this._fitInternal(this.cameraForBounds(e,o),o,u)}fitScreenCoordinates(e,o,u,c,p){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(g.P.convert(e)),this.transform.pointLocation(g.P.convert(o)),u,c),c,p)}_fitInternal(e,o,u){return e?(delete(o=g.e(e,o)).padding,o.linear?this.easeTo(o,u):this.flyTo(o,u)):this}jumpTo(e,o){this.stop();const u=this._getTransformForUpdate();let c=!1,p=!1,b=!1;return"zoom"in e&&u.zoom!==+e.zoom&&(c=!0,u.zoom=+e.zoom),e.center!==void 0&&(u.center=g.N.convert(e.center)),"bearing"in e&&u.bearing!==+e.bearing&&(p=!0,u.bearing=+e.bearing),"pitch"in e&&u.pitch!==+e.pitch&&(b=!0,u.pitch=+e.pitch),e.padding==null||u.isPaddingEqual(e.padding)||(u.padding=e.padding),this._applyUpdatedTransform(u),this.fire(new g.k("movestart",o)).fire(new g.k("move",o)),c&&this.fire(new g.k("zoomstart",o)).fire(new g.k("zoom",o)).fire(new g.k("zoomend",o)),p&&this.fire(new g.k("rotatestart",o)).fire(new g.k("rotate",o)).fire(new g.k("rotateend",o)),b&&this.fire(new g.k("pitchstart",o)).fire(new g.k("pitch",o)).fire(new g.k("pitchend",o)),this.fire(new g.k("moveend",o))}calculateCameraOptionsFromTo(e,o,u,c=0){const p=g.Z.fromLngLat(e,o),b=g.Z.fromLngLat(u,c),T=b.x-p.x,C=b.y-p.y,M=b.z-p.z,R=Math.hypot(T,C,M);if(R===0)throw new Error("Can't calculate camera options with same From and To");const B=Math.hypot(T,C),$=this.transform.scaleZoom(this.transform.cameraToCenterDistance/R/this.transform.tileSize),X=180*Math.atan2(T,-C)/Math.PI;let Y=180*Math.acos(B/R)/Math.PI;return Y=M<0?90-Y:90+Y,{center:b.toLngLat(),zoom:$,pitch:Y,bearing:X}}easeTo(e,o){var u;this._stop(!1,e.easeId),((e=g.e({offset:[0,0],duration:500,easing:g.b9},e)).animate===!1||!e.essential&&xe.prefersReducedMotion)&&(e.duration=0);const c=this._getTransformForUpdate(),p=c.zoom,b=c.bearing,T=c.pitch,C=c.padding,M="bearing"in e?this._normalizeBearing(e.bearing,b):b,R="pitch"in e?+e.pitch:T,B="padding"in e?e.padding:c.padding,$=g.P.convert(e.offset);let X=c.centerPoint.add($);const Y=c.pointLocation(X),{center:Q,zoom:ie}=c.getConstrained(g.N.convert(e.center||Y),(u=e.zoom)!==null&&u!==void 0?u:p);this._normalizeCenter(Q,c);const oe=c.project(Y),de=c.project(Q).sub(oe),ee=c.zoomScale(ie-p);let ye,be;e.around&&(ye=g.N.convert(e.around),be=c.locationPoint(ye));const Ce={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||ie!==p,this._rotating=this._rotating||b!==M,this._pitching=this._pitching||R!==T,this._padding=!c.isPaddingEqual(B),this._easeId=e.easeId,this._prepareEase(o,e.noMoveStart,Ce),this.terrain&&this._prepareElevation(Q),this._ease(Ve=>{if(this._zooming&&(c.zoom=g.y.number(p,ie,Ve)),this._rotating&&(c.bearing=g.y.number(b,M,Ve)),this._pitching&&(c.pitch=g.y.number(T,R,Ve)),this._padding&&(c.interpolatePadding(C,B,Ve),X=c.centerPoint.add($)),this.terrain&&!e.freezeElevation&&this._updateElevation(Ve),ye)c.setLocationAtPoint(ye,be);else{const et=c.zoomScale(c.zoom-p),at=ie>p?Math.min(2,ee):Math.max(.5,ee),pt=Math.pow(at,1-Ve),lt=c.unproject(oe.add(de.mult(Ve*pt)).mult(et));c.setLocationAtPoint(c.renderWorldCopies?lt.wrap():lt,X)}this._applyUpdatedTransform(c),this._fireMoveEvents(o)},Ve=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(o,Ve)},e),this}_prepareEase(e,o,u={}){this._moving=!0,o||u.moving||this.fire(new g.k("movestart",e)),this._zooming&&!u.zooming&&this.fire(new g.k("zoomstart",e)),this._rotating&&!u.rotating&&this.fire(new g.k("rotatestart",e)),this._pitching&&!u.pitching&&this.fire(new g.k("pitchstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const o=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&o!==this._elevationTarget){const u=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(u-(o-(u*e+this._elevationStart))/(1-e)),this._elevationTarget=o}this.transform.elevation=g.y.number(this._elevationStart,this._elevationTarget,e)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){const o=e.getCameraPosition(),u=this.terrain.getElevationForLngLatZoom(o.lngLat,e.zoom);if(o.altitude<u){const c=this.calculateCameraOptionsFromTo(o.lngLat,u,e.center,e.elevation);return{pitch:c.pitch,zoom:c.zoom}}return{}}_applyUpdatedTransform(e){const o=[];if(this.terrain&&o.push(c=>this._elevateCameraIfInsideTerrain(c)),this.transformCameraUpdate&&o.push(c=>this.transformCameraUpdate(c)),!o.length)return;const u=e.clone();for(const c of o){const p=u.clone(),{center:b,zoom:T,pitch:C,bearing:M,elevation:R}=c(p);b&&(p.center=b),T!==void 0&&(p.zoom=T),C!==void 0&&(p.pitch=C),M!==void 0&&(p.bearing=M),R!==void 0&&(p.elevation=R),u.apply(p)}this.transform.apply(u)}_fireMoveEvents(e){this.fire(new g.k("move",e)),this._zooming&&this.fire(new g.k("zoom",e)),this._rotating&&this.fire(new g.k("rotate",e)),this._pitching&&this.fire(new g.k("pitch",e))}_afterEase(e,o){if(this._easeId&&o&&this._easeId===o)return;delete this._easeId;const u=this._zooming,c=this._rotating,p=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,u&&this.fire(new g.k("zoomend",e)),c&&this.fire(new g.k("rotateend",e)),p&&this.fire(new g.k("pitchend",e)),this.fire(new g.k("moveend",e))}flyTo(e,o){var u;if(!e.essential&&xe.prefersReducedMotion){const ht=g.M(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ht,o)}this.stop(),e=g.e({offset:[0,0],speed:1.2,curve:1.42,easing:g.b9},e);const c=this._getTransformForUpdate(),p=c.zoom,b=c.bearing,T=c.pitch,C=c.padding,M="bearing"in e?this._normalizeBearing(e.bearing,b):b,R="pitch"in e?+e.pitch:T,B="padding"in e?e.padding:c.padding,$=g.P.convert(e.offset);let X=c.centerPoint.add($);const Y=c.pointLocation(X),{center:Q,zoom:ie}=c.getConstrained(g.N.convert(e.center||Y),(u=e.zoom)!==null&&u!==void 0?u:p);this._normalizeCenter(Q,c);const oe=c.zoomScale(ie-p),de=c.project(Y),ee=c.project(Q).sub(de);let ye=e.curve;const be=Math.max(c.width,c.height),Ce=be/oe,Ve=ee.mag();if("minZoom"in e){const ht=g.ac(Math.min(e.minZoom,p,ie),c.minZoom,c.maxZoom),Gt=be/c.zoomScale(ht-p);ye=Math.sqrt(Gt/Ve*2)}const et=ye*ye;function at(ht){const Gt=(Ce*Ce-be*be+(ht?-1:1)*et*et*Ve*Ve)/(2*(ht?Ce:be)*et*Ve);return Math.log(Math.sqrt(Gt*Gt+1)-Gt)}function pt(ht){return(Math.exp(ht)-Math.exp(-ht))/2}function lt(ht){return(Math.exp(ht)+Math.exp(-ht))/2}const rt=at(!1);let bt=function(ht){return lt(rt)/lt(rt+ye*ht)},Kt=function(ht){return be*((lt(rt)*(pt(Gt=rt+ye*ht)/lt(Gt))-pt(rt))/et)/Ve;var Gt},ut=(at(!0)-rt)/ye;if(Math.abs(Ve)<1e-6||!isFinite(ut)){if(Math.abs(be-Ce)<1e-6)return this.easeTo(e,o);const ht=Ce<be?-1:1;ut=Math.abs(Math.log(Ce/be))/ye,Kt=()=>0,bt=Gt=>Math.exp(ht*ye*Gt)}return e.duration="duration"in e?+e.duration:1e3*ut/("screenSpeed"in e?+e.screenSpeed/ye:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=b!==M,this._pitching=R!==T,this._padding=!c.isPaddingEqual(B),this._prepareEase(o,!1),this.terrain&&this._prepareElevation(Q),this._ease(ht=>{const Gt=ht*ut,Wi=1/bt(Gt);c.zoom=ht===1?ie:p+c.scaleZoom(Wi),this._rotating&&(c.bearing=g.y.number(b,M,ht)),this._pitching&&(c.pitch=g.y.number(T,R,ht)),this._padding&&(c.interpolatePadding(C,B,ht),X=c.centerPoint.add($)),this.terrain&&!e.freezeElevation&&this._updateElevation(ht);const ai=ht===1?Q:c.unproject(de.add(ee.mult(Kt(Gt))).mult(Wi));c.setLocationAtPoint(c.renderWorldCopies?ai.wrap():ai,X),this._applyUpdatedTransform(c),this._fireMoveEvents(o)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(o)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,o){var u;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const c=this._onEaseEnd;delete this._onEaseEnd,c.call(this,o)}return e||(u=this.handlers)===null||u===void 0||u.stop(!1),this}_ease(e,o,u){u.animate===!1||u.duration===0?(e(1),o()):(this._easeStart=xe.now(),this._easeOptions=u,this._onEaseFrame=e,this._onEaseEnd=o,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,o){e=g.b3(e,-180,180);const u=Math.abs(e-o);return Math.abs(e-360-o)<u&&(e-=360),Math.abs(e+360-o)<u&&(e+=360),e}_normalizeCenter(e,o){if(!o.renderWorldCopies||o.lngRange)return;const u=e.lng-o.center.lng;e.lng+=u>180?-360:u<-180?360:0}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(g.N.convert(e),this.transform.tileZoom)-this.transform.elevation:null}}const mr={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Es{constructor(e=mr){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=o=>{!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"&&o.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=me.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=me.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=me.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){me.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,o){const u=this._map._getUIString(`AttributionControl.${o}`);e.title=u,e.setAttribute("aria-label",u)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(c=>typeof c!="string"?"":c)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const c=this._map.style.stylesheet;this.styleOwner=c.owner,this.styleId=c.id}const o=this._map.style.sourceCaches;for(const c in o){const p=o[c];if(p.used||p.usedForTerrain){const b=p.getSource();b.attribution&&e.indexOf(b.attribution)<0&&e.push(b.attribution)}}e=e.filter(c=>String(c).trim()),e.sort((c,p)=>c.length-p.length),e=e.filter((c,p)=>{for(let b=p+1;b<e.length;b++)if(e[b].indexOf(c)>=0)return!1;return!0});const u=e.join(" | ");u!==this._attribHTML&&(this._attribHTML=u,e.length?(this._innerContainer.innerHTML=u,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Ni{constructor(e={}){this._updateCompact=()=>{const o=this._container.children;if(o.length){const u=o[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&u.classList.add("maplibregl-compact"):u.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=me.create("div","maplibregl-ctrl");const o=me.create("a","maplibregl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://maplibre.org/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){me.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class di{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const o=++this._id;return this._queue.push({callback:e,id:o,cancelled:!1}),o}remove(e){const o=this._currentlyRunning,u=o?this._queue.concat(o):this._queue;for(const c of u)if(c.id===e)return void(c.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const o=this._currentlyRunning=this._queue;this._queue=[];for(const u of o)if(!u.cancelled&&(u.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var du=g.Y([{name:"a_pos3d",type:"Int16",components:3}]);class Yu extends g.E{constructor(e){super(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,e.usedForTerrain=!0,e.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,o){this.sourceCache.update(e,o),this._renderableTilesKeys=[];const u={};for(const c of e.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:o}))u[c.key]=!0,this._renderableTilesKeys.push(c.key),this._tiles[c.key]||(c.posMatrix=new Float64Array(16),g.aP(c.posMatrix,0,g.X,0,g.X,0,1),this._tiles[c.key]=new No(c,this.tileSize));for(const c in this._tiles)u[c]||delete this._tiles[c]}freeRtt(e){for(const o in this._tiles){const u=this._tiles[o];(!e||u.tileID.equals(e)||u.tileID.isChildOf(e)||e.isChildOf(u.tileID))&&(u.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){const o={};for(const u of this._renderableTilesKeys){const c=this._tiles[u].tileID;if(c.canonical.equals(e.canonical)){const p=e.clone();p.posMatrix=new Float64Array(16),g.aP(p.posMatrix,0,g.X,0,g.X,0,1),o[u]=p}else if(c.canonical.isChildOf(e.canonical)){const p=e.clone();p.posMatrix=new Float64Array(16);const b=c.canonical.z-e.canonical.z,T=c.canonical.x-(c.canonical.x>>b<<b),C=c.canonical.y-(c.canonical.y>>b<<b),M=g.X>>b;g.aP(p.posMatrix,0,M,0,M,0,1),g.J(p.posMatrix,p.posMatrix,[-T*M,-C*M,0]),o[u]=p}else if(e.canonical.isChildOf(c.canonical)){const p=e.clone();p.posMatrix=new Float64Array(16);const b=e.canonical.z-c.canonical.z,T=e.canonical.x-(e.canonical.x>>b<<b),C=e.canonical.y-(e.canonical.y>>b<<b),M=g.X>>b;g.aP(p.posMatrix,0,g.X,0,g.X,0,1),g.J(p.posMatrix,p.posMatrix,[T*M,C*M,0]),g.K(p.posMatrix,p.posMatrix,[1/2**b,1/2**b,0]),o[u]=p}}return o}getSourceTile(e,o){const u=this.sourceCache._source;let c=e.overscaledZ-this.deltaZoom;if(c>u.maxzoom&&(c=u.maxzoom),c<u.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(c).key);let p=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!p||!p.dem)&&o)for(;c>=u.minzoom&&(!p||!p.dem);)p=this.sourceCache.getTileByID(e.scaledTo(c--).key);return p}tilesAfterTime(e=Date.now()){return Object.values(this._tiles).filter(o=>o.timeAdded>=e)}}class To{constructor(e,o,u){this.painter=e,this.sourceCache=new Yu(o),this.options=u,this.exaggeration=typeof u.exaggeration=="number"?u.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,o,u,c=g.X){var p;if(!(o>=0&&o<c&&u>=0&&u<c))return 0;const b=this.getTerrainData(e),T=(p=b.tile)===null||p===void 0?void 0:p.dem;if(!T)return 0;const C=function(Y,Q,ie){var oe=Q[0],de=Q[1];return Y[0]=ie[0]*oe+ie[4]*de+ie[12],Y[1]=ie[1]*oe+ie[5]*de+ie[13],Y}([],[o/c*g.X,u/c*g.X],b.u_terrain_matrix),M=[C[0]*T.dim,C[1]*T.dim],R=Math.floor(M[0]),B=Math.floor(M[1]),$=M[0]-R,X=M[1]-B;return T.get(R,B)*(1-$)*(1-X)+T.get(R+1,B)*$*(1-X)+T.get(R,B+1)*(1-$)*X+T.get(R+1,B+1)*$*X}getElevationForLngLatZoom(e,o){if(!g.bb(o,e.wrap()))return 0;const{tileID:u,mercatorX:c,mercatorY:p}=this._getOverscaledTileIDFromLngLatZoom(e,o);return this.getElevation(u,c%g.X,p%g.X,g.X)}getElevation(e,o,u,c=g.X){return this.getDEMElevation(e,o,u,c)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const c=this.painter.context,p=new g.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new qt(c,p,c.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new qt(c,new g.R({width:1,height:1}),c.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(c.gl.NEAREST,c.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=g.an([])}const o=this.sourceCache.getSourceTile(e,!0);if(o&&o.dem&&(!o.demTexture||o.needsTerrainPrepare)){const c=this.painter.context;o.demTexture=this.painter.getTileTexture(o.dem.stride),o.demTexture?o.demTexture.update(o.dem.getPixels(),{premultiply:!1}):o.demTexture=new qt(c,o.dem.getPixels(),c.gl.RGBA,{premultiply:!1}),o.demTexture.bind(c.gl.NEAREST,c.gl.CLAMP_TO_EDGE),o.needsTerrainPrepare=!1}const u=o&&o+o.tileID.key+e.key;if(u&&!this._demMatrixCache[u]){const c=this.sourceCache.sourceCache._source.maxzoom;let p=e.canonical.z-o.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=c?p=e.canonical.z-c:g.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const b=e.canonical.x-(e.canonical.x>>p<<p),T=e.canonical.y-(e.canonical.y>>p<<p),C=g.bc(new Float64Array(16),[1/(g.X<<p),1/(g.X<<p),0]);g.J(C,C,[b*g.X,T*g.X,0]),this._demMatrixCache[e.key]={matrix:C,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:o&&o.dem&&o.dem.dim||1,u_terrain_matrix:u?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:o&&o.dem&&o.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(o&&o.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:o}}getFramebuffer(e){const o=this.painter,u=o.width/devicePixelRatio,c=o.height/devicePixelRatio;return!this._fbo||this._fbo.width===u&&this._fbo.height===c||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new qt(o.context,{width:u,height:c,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new qt(o.context,{width:u,height:c,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=o.context.createFramebuffer(u,c,!0,!1),this._fbo.depthAttachment.set(o.context.createRenderbuffer(o.context.gl.DEPTH_COMPONENT16,u,c))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const o=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let p=0,b=0;p<this._coordsTextureSize;p++)for(let T=0;T<this._coordsTextureSize;T++,b+=4)o[b+0]=255&T,o[b+1]=255&p,o[b+2]=T>>8<<4|p>>8,o[b+3]=0;const u=new g.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(o.buffer)),c=new qt(e,u,e.gl.RGBA,{premultiply:!1});return c.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=c,c}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const o=new Uint8Array(4),u=this.painter.context,c=u.gl,p=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),b=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),T=Math.round(this.painter.height/devicePixelRatio);u.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),c.readPixels(p,T-b-1,1,1,c.RGBA,c.UNSIGNED_BYTE,o),u.bindFramebuffer.set(null);const C=o[0]+(o[2]>>4<<8),M=o[1]+((15&o[2])<<8),R=this.coordsIndex[255-o[3]],B=R&&this.sourceCache.getTileByID(R);if(!B)return null;const $=this._coordsTextureSize,X=(1<<B.tileID.canonical.z)*$;return new g.Z((B.tileID.canonical.x*$+C)/X+B.tileID.wrap,(B.tileID.canonical.y*$+M)/X,this.getElevation(B.tileID,C,M,$))}depthAtPoint(e){const o=new Uint8Array(4),u=this.painter.context,c=u.gl;return u.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),c.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,c.RGBA,c.UNSIGNED_BYTE,o),u.bindFramebuffer.set(null),(o[0]/16777216+o[1]/65536+o[2]/256+o[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const e=this.painter.context,o=new g.bd,u=new g.aY,c=this.meshSize,p=g.X/c,b=c*c;for(let B=0;B<=c;B++)for(let $=0;$<=c;$++)o.emplaceBack($*p,B*p,0);for(let B=0;B<b;B+=c+1)for(let $=0;$<c;$++)u.emplaceBack($+B,c+$+B+1,c+$+B+2),u.emplaceBack($+B,c+$+B+2,$+B+1);const T=o.length,C=T+2*(c+1);for(const B of[0,1])for(let $=0;$<=c;$++)for(const X of[0,1])o.emplaceBack($*p,B*g.X,X);for(let B=0;B<2*c;B+=2)u.emplaceBack(C+B,C+B+1,C+B+3),u.emplaceBack(C+B,C+B+3,C+B+2),u.emplaceBack(T+B,T+B+3,T+B+1),u.emplaceBack(T+B,T+B+2,T+B+3);const M=o.length,R=M+2*(c+1);for(const B of[0,1])for(let $=0;$<=c;$++)for(const X of[0,1])o.emplaceBack(B*g.X,$*p,X);for(let B=0;B<2*c;B+=2)u.emplaceBack(M+B,M+B+1,M+B+3),u.emplaceBack(M+B,M+B+3,M+B+2),u.emplaceBack(R+B,R+B+3,R+B+1),u.emplaceBack(R+B,R+B+2,R+B+3);return this._mesh=new zr(e.createVertexBuffer(o,du.members),e.createIndexBuffer(u),g.a0.simpleSegment(0,0,o.length,u.length)),this._mesh}getMeshFrameDelta(e){return 2*Math.PI*g.be/Math.pow(2,e)/5}getMinTileElevationForLngLatZoom(e,o){var u;const{tileID:c}=this._getOverscaledTileIDFromLngLatZoom(e,o);return(u=this.getMinMaxElevation(c).minElevation)!==null&&u!==void 0?u:0}getMinMaxElevation(e){const o=this.getTerrainData(e).tile,u={minElevation:null,maxElevation:null};return o&&o.dem&&(u.minElevation=o.dem.min*this.exaggeration,u.maxElevation=o.dem.max*this.exaggeration),u}_getOverscaledTileIDFromLngLatZoom(e,o){const u=g.Z.fromLngLat(e.wrap()),c=(1<<o)*g.X,p=u.x*c,b=u.y*c,T=Math.floor(p/g.X),C=Math.floor(b/g.X);return{tileID:new g.S(o,0,o,T,C),mercatorX:p,mercatorY:b}}}class _a{constructor(e,o,u){this._context=e,this._size=o,this._tileSize=u,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const o=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),u=new qt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return u.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),o.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),o.colorAttachment.set(u.texture),{id:e,fbo:o,texture:u,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(o=>e.id!==o),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const o of this._recentlyUsed)if(!this._objects[o].inUse)return this._objects[o];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const rs={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class ll{constructor(e,o){this.painter=e,this.terrain=o,this.pool=new _a(e.context,30,o.sourceCache.tileSize*o.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,o){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(u=>!e._layers[u].isHidden(o)),this._coordsDescendingInv={};for(const u in e.sourceCaches){this._coordsDescendingInv[u]={};const c=e.sourceCaches[u].getVisibleCoordinates();for(const p of c){const b=this.terrain.sourceCache.getTerrainCoords(p);for(const T in b)this._coordsDescendingInv[u][T]||(this._coordsDescendingInv[u][T]=[]),this._coordsDescendingInv[u][T].push(b[T])}}this._coordsDescendingInvStr={};for(const u of e._order){const c=e._layers[u],p=c.source;if(rs[c.type]&&!this._coordsDescendingInvStr[p]){this._coordsDescendingInvStr[p]={};for(const b in this._coordsDescendingInv[p])this._coordsDescendingInvStr[p][b]=this._coordsDescendingInv[p][b].map(T=>T.key).sort().join()}}for(const u of this._renderableTiles)for(const c in this._coordsDescendingInvStr){const p=this._coordsDescendingInvStr[c][u.tileID.key];p&&p!==u.rttCoords[c]&&(u.rtt=[])}}renderLayer(e){if(e.isHidden(this.painter.transform.zoom))return!1;const o=e.type,u=this.painter,c=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(rs[o]&&(this._prevType&&rs[this._prevType]||this._stacks.push([]),this._prevType=o,this._stacks[this._stacks.length-1].push(e.id),!c))return!0;if(rs[this._prevType]||rs[o]&&c){this._prevType=o;const p=this._stacks.length-1,b=this._stacks[p]||[];for(const T of this._renderableTiles){if(this.pool.isFull()&&(uu(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(T),T.rtt[p]){const M=this.pool.getObjectForId(T.rtt[p].id);if(M.stamp===T.rtt[p].stamp){this.pool.useObject(M);continue}}const C=this.pool.getOrCreateFreeObject();this.pool.useObject(C),this.pool.stampObject(C),T.rtt[p]={id:C.id,stamp:C.stamp},u.context.bindFramebuffer.set(C.fbo.framebuffer),u.context.clear({color:g.aM.transparent,stencil:0}),u.currentStencilSource=void 0;for(let M=0;M<b.length;M++){const R=u.style._layers[b[M]],B=R.source?this._coordsDescendingInv[R.source][T.tileID.key]:[T.tileID];u.context.viewport.set([0,0,C.fbo.width,C.fbo.height]),u._renderTileClippingMasks(R,B),u.renderLayer(u,u.style.sourceCaches[R.source],R,B),R.source&&(T.rttCoords[R.source]=this._coordsDescendingInvStr[R.source][T.tileID.key])}}return uu(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),rs[o]}return!1}}const fu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},ul=ze,Oa={hash:!1,interactive:!0,bearingSnap:7,attributionControl:mr,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:g.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},sn=m=>{m.touchstart=m.dragStart,m.touchmoveWindow=m.dragMove,m.touchend=m.dragEnd},un={showCompass:!0,showZoom:!0,visualizePitch:!1};class Fa{constructor(e,o,u=!1){this.mousedown=b=>{this.startMouse(g.e({},b,{ctrlKey:!0,preventDefault:()=>b.preventDefault()}),me.mousePos(this.element,b)),me.addEventListener(window,"mousemove",this.mousemove),me.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=b=>{this.moveMouse(b,me.mousePos(this.element,b))},this.mouseup=b=>{this.mouseRotate.dragEnd(b),this.mousePitch&&this.mousePitch.dragEnd(b),this.offTemp()},this.touchstart=b=>{b.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=me.touchPos(this.element,b.targetTouches)[0],this.startTouch(b,this._startPos),me.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),me.addEventListener(window,"touchend",this.touchend))},this.touchmove=b=>{b.targetTouches.length!==1?this.reset():(this._lastPos=me.touchPos(this.element,b.targetTouches)[0],this.moveTouch(b,this._lastPos))},this.touchend=b=>{b.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const c=e.dragRotate._mouseRotate.getClickTolerance(),p=e.dragRotate._mousePitch.getClickTolerance();this.element=o,this.mouseRotate=al({clickTolerance:c,enable:!0}),this.touchRotate=(({enable:b,clickTolerance:T,bearingDegreesPerPixelMoved:C=.8})=>{const M=new kl;return new Xs({clickTolerance:T,move:(R,B)=>({bearingDelta:(B.x-R.x)*C}),moveStateManager:M,enable:b,assignEvents:sn})})({clickTolerance:c,enable:!0}),this.map=e,u&&(this.mousePitch=qi({clickTolerance:p,enable:!0}),this.touchPitch=(({enable:b,clickTolerance:T,pitchDegreesPerPixelMoved:C=-.5})=>{const M=new kl;return new Xs({clickTolerance:T,move:(R,B)=>({pitchDelta:(B.y-R.y)*C}),moveStateManager:M,enable:b,assignEvents:sn})})({clickTolerance:p,enable:!0})),me.addEventListener(o,"mousedown",this.mousedown),me.addEventListener(o,"touchstart",this.touchstart,{passive:!1}),me.addEventListener(o,"touchcancel",this.reset)}startMouse(e,o){this.mouseRotate.dragStart(e,o),this.mousePitch&&this.mousePitch.dragStart(e,o),me.disableDrag()}startTouch(e,o){this.touchRotate.dragStart(e,o),this.touchPitch&&this.touchPitch.dragStart(e,o),me.disableDrag()}moveMouse(e,o){const u=this.map,{bearingDelta:c}=this.mouseRotate.dragMove(e,o)||{};if(c&&u.setBearing(u.getBearing()+c),this.mousePitch){const{pitchDelta:p}=this.mousePitch.dragMove(e,o)||{};p&&u.setPitch(u.getPitch()+p)}}moveTouch(e,o){const u=this.map,{bearingDelta:c}=this.touchRotate.dragMove(e,o)||{};if(c&&u.setBearing(u.getBearing()+c),this.touchPitch){const{pitchDelta:p}=this.touchPitch.dragMove(e,o)||{};p&&u.setPitch(u.getPitch()+p)}}off(){const e=this.element;me.removeEventListener(e,"mousedown",this.mousedown),me.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),me.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),me.removeEventListener(window,"touchend",this.touchend),me.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){me.enableDrag(),me.removeEventListener(window,"mousemove",this.mousemove),me.removeEventListener(window,"mouseup",this.mouseup),me.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),me.removeEventListener(window,"touchend",this.touchend)}}let Yi;function Pi(m,e,o){const u=new g.N(m.lng,m.lat);if(m=new g.N(m.lng,m.lat),e){const c=new g.N(m.lng-360,m.lat),p=new g.N(m.lng+360,m.lat),b=o.locationPoint(m).distSqr(e);o.locationPoint(c).distSqr(e)<b?m=c:o.locationPoint(p).distSqr(e)<b&&(m=p)}for(;Math.abs(m.lng-o.center.lng)>180;){const c=o.locationPoint(m);if(c.x>=0&&c.y>=0&&c.x<=o.width&&c.y<=o.height)break;m.lng>o.center.lng?m.lng-=360:m.lng+=360}return m.lng!==u.lng&&o.locationPoint(m).y>o.height/2-o.getHorizon()?m:u}const Js={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ga(m,e,o){const u=m.classList;for(const c in Js)u.remove(`maplibregl-${o}-anchor-${c}`);u.add(`maplibregl-${o}-anchor-${e}`)}class _r extends g.E{constructor(e){if(super(),this._onKeyPress=o=>{const u=o.code,c=o.charCode||o.keyCode;u!=="Space"&&u!=="Enter"&&c!==32&&c!==13||this.togglePopup()},this._onMapClick=o=>{const u=o.originalEvent.target,c=this._element;this._popup&&(u===c||c.contains(u))&&this.togglePopup()},this._update=o=>{var u;if(!this._map)return;const c=this._map.loaded()&&!this._map.isMoving();(o?.type==="terrain"||o?.type==="render"&&!c)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?Pi(this._lngLat,this._flatPos,this._map.transform):(u=this._lngLat)===null||u===void 0?void 0:u.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let p="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?p=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(p=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let b="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?b="rotateX(0deg)":this._pitchAlignment==="map"&&(b=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||o&&o.type!=="moveend"||(this._pos=this._pos.round()),me.setTransform(this._element,`${Js[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${b} ${p}`),xe.frameAsync(new AbortController).then(()=>{this._updateOpacity(o&&o.type==="moveend")}).catch(()=>{})},this._onMove=o=>{if(!this._isDragging){const u=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new g.k("dragstart"))),this.fire(new g.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new g.k("dragend")),this._state="inactive"},this._addDragHandler=o=>{this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(e?.opacity,e?.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=g.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=me.create("div");const o=me.createNS("http://www.w3.org/2000/svg","svg"),u=41,c=27;o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height",`${u}px`),o.setAttributeNS(null,"width",`${c}px`),o.setAttributeNS(null,"viewBox",`0 0 ${c} ${u}`);const p=me.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"stroke","none"),p.setAttributeNS(null,"stroke-width","1"),p.setAttributeNS(null,"fill","none"),p.setAttributeNS(null,"fill-rule","evenodd");const b=me.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"fill-rule","nonzero");const T=me.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(3.0, 29.0)"),T.setAttributeNS(null,"fill","#000000");const C=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const oe of C){const de=me.createNS("http://www.w3.org/2000/svg","ellipse");de.setAttributeNS(null,"opacity","0.04"),de.setAttributeNS(null,"cx","10.5"),de.setAttributeNS(null,"cy","5.80029008"),de.setAttributeNS(null,"rx",oe.rx),de.setAttributeNS(null,"ry",oe.ry),T.appendChild(de)}const M=me.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"fill",this._color);const R=me.createNS("http://www.w3.org/2000/svg","path");R.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),M.appendChild(R);const B=me.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"opacity","0.25"),B.setAttributeNS(null,"fill","#000000");const $=me.createNS("http://www.w3.org/2000/svg","path");$.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),B.appendChild($);const X=me.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"transform","translate(6.0, 7.0)"),X.setAttributeNS(null,"fill","#FFFFFF");const Y=me.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Q=me.createNS("http://www.w3.org/2000/svg","circle");Q.setAttributeNS(null,"fill","#000000"),Q.setAttributeNS(null,"opacity","0.25"),Q.setAttributeNS(null,"cx","5.5"),Q.setAttributeNS(null,"cy","5.5"),Q.setAttributeNS(null,"r","5.4999962");const ie=me.createNS("http://www.w3.org/2000/svg","circle");ie.setAttributeNS(null,"fill","#FFFFFF"),ie.setAttributeNS(null,"cx","5.5"),ie.setAttributeNS(null,"cy","5.5"),ie.setAttributeNS(null,"r","5.4999962"),Y.appendChild(Q),Y.appendChild(ie),b.appendChild(T),b.appendChild(M),b.appendChild(B),b.appendChild(X),b.appendChild(Y),o.appendChild(b),o.setAttributeNS(null,"height",u*this._scale+"px"),o.setAttributeNS(null,"width",c*this._scale+"px"),this._element.appendChild(o),this._offset=g.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",o=>{o.preventDefault()}),this._element.addEventListener("mousedown",o=>{o.preventDefault()}),ga(this._element,this._anchor,"marker"),e&&e.className)for(const o of e.className.split(" "))this._element.classList.add(o);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),me.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=g.N.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const c=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[c,-1*(38.1-13.5+c)],"bottom-right":[-c,-1*(38.1-13.5+c)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var o,u;if(!(!((o=this._map)===null||o===void 0)&&o.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const c=this._map,p=c.terrain.depthAtPoint(this._pos),b=c.terrain.getElevationForLngLatZoom(this._lngLat,c.transform.tileZoom);if(c.transform.lngLatToCameraDepth(this._lngLat,b)-p<.006)return void(this._element.style.opacity=this._opacity);const T=-this._offset.y/c.transform._pixelPerMeter,C=Math.sin(c.getPitch()*Math.PI/180)*T,M=c.terrain.depthAtPoint(new g.P(this._pos.x,this._pos.y-this._offset.y)),R=c.transform.lngLatToCameraDepth(this._lngLat,b+C)-M>.006;!((u=this._popup)===null||u===void 0)&&u.isOpen()&&R&&this._popup.remove(),this._element.style.opacity=R?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=g.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,o){return e===void 0&&o===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),o!==void 0&&(this._opacityWhenCovered=o),this._map&&this._updateOpacity(!0),this}}const pu={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let El=0,Ml=!1;const Ms={maxWidth:100,unit:"metric"};function zl(m,e,o){const u=o&&o.maxWidth||100,c=m._container.clientHeight/2,p=m.unproject([0,c]),b=m.unproject([u,c]),T=p.distanceTo(b);if(o&&o.unit==="imperial"){const C=3.2808*T;C>5280?vt(e,u,C/5280,m._getUIString("ScaleControl.Miles")):vt(e,u,C,m._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?vt(e,u,T/1852,m._getUIString("ScaleControl.NauticalMiles")):T>=1e3?vt(e,u,T/1e3,m._getUIString("ScaleControl.Kilometers")):vt(e,u,T,m._getUIString("ScaleControl.Meters"))}function vt(m,e,o,u){const c=function(p){const b=Math.pow(10,`${Math.floor(p)}`.length-1);let T=p/b;return T=T>=10?10:T>=5?5:T>=3?3:T>=2?2:T>=1?1:function(C){const M=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10));return Math.round(C*M)/M}(T),b*T}(o);m.style.width=e*(c/o)+"px",m.innerHTML=`${c}&nbsp;${u}`}const Bt={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Al=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function mu(m){if(m){if(typeof m=="number"){const e=Math.round(Math.abs(m)/Math.SQRT2);return{center:new g.P(0,0),top:new g.P(0,m),"top-left":new g.P(e,e),"top-right":new g.P(-e,e),bottom:new g.P(0,-m),"bottom-left":new g.P(e,-e),"bottom-right":new g.P(-e,-e),left:new g.P(m,0),right:new g.P(-m,0)}}if(m instanceof g.P||Array.isArray(m)){const e=g.P.convert(m);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:g.P.convert(m.center||[0,0]),top:g.P.convert(m.top||[0,0]),"top-left":g.P.convert(m["top-left"]||[0,0]),"top-right":g.P.convert(m["top-right"]||[0,0]),bottom:g.P.convert(m.bottom||[0,0]),"bottom-left":g.P.convert(m["bottom-left"]||[0,0]),"bottom-right":g.P.convert(m["bottom-right"]||[0,0]),left:g.P.convert(m.left||[0,0]),right:g.P.convert(m.right||[0,0])}}return mu(new g.P(0,0))}const Qu=ze;O.AJAXError=g.bh,O.Evented=g.E,O.LngLat=g.N,O.MercatorCoordinate=g.Z,O.Point=g.P,O.addProtocol=g.bi,O.config=g.a,O.removeProtocol=g.bj,O.AttributionControl=Es,O.BoxZoomHandler=Nn,O.CanvasSource=Nr,O.CooperativeGesturesHandler=An,O.DoubleClickZoomHandler=ft,O.DragPanHandler=jn,O.DragRotateHandler=zn,O.EdgeInsets=pa,O.FullscreenControl=class extends g.E{constructor(m={}){super(),this._onFullscreenChange=()=>{var e;let o=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=o?.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)o=o.shadowRoot.fullscreenElement;o===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:g.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=me.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){me.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const m=this._fullscreenButton=me.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);me.create("span","maplibregl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.title=m}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new g.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new g.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},O.GeoJSONSource=Kr,O.GeolocateControl=class extends g.E{constructor(m){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new g.k("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new g.k("geolocate",e)),this._finish()}},this._updateCamera=e=>{const o=new g.N(e.coords.longitude,e.coords.latitude),u=e.coords.accuracy,c=this._map.getBearing(),p=g.e({bearing:c},this.options.fitBoundsOptions),b=Le.fromLngLat(o,u);this._map.fitBounds(b,p,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const o=new g.N(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&Ml)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new g.k("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=me.create("button","maplibregl-ctrl-geolocate",this._container),me.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){g.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=me.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new _r({element:this._dotElement}),this._circleElement=me.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new _r({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new g.k("trackuserlocationend")),this.fire(new g.k("userlocationlostfocus")))})}},this.options=g.e({},pu,m)}onAdd(m){return this._map=m,this._container=me.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return g._(this,arguments,void 0,function*(e=!1){if(Yi!==void 0&&!e)return Yi;if(window.navigator.permissions===void 0)return Yi=!!window.navigator.geolocation,Yi;try{Yi=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Yi=!!window.navigator.geolocation}return Yi})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),me.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,El=0,Ml=!1}_isOutOfMapMaxBounds(m){const e=this._map.getMaxBounds(),o=m.coords;return e&&(o.longitude<e.getWest()||o.longitude>e.getEast()||o.latitude<e.getSouth()||o.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const m=this._map.getBounds(),e=m.getSouthEast(),o=m.getNorthEast(),u=e.distanceTo(o),c=Math.ceil(this._accuracy/(u/this._map._container.clientHeight)*2);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}trigger(){if(!this._setup)return g.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new g.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":El--,Ml=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new g.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new g.k("trackuserlocationstart")),this.fire(new g.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),El++,El>1?(m={maximumAge:6e5,timeout:0},Ml=!0):(m=this.options.positionOptions,Ml=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,m)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},O.Hash=ma,O.ImageSource=_s,O.KeyboardHandler=ue,O.LngLatBounds=Le,O.LogoControl=Ni,O.Map=class extends Jo{constructor(m){g.bf.mark(g.bg.create);const e=Object.assign(Object.assign({},Oa),m);if(e.minZoom!=null&&e.maxZoom!=null&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(e.minPitch!=null&&e.maxPitch!=null&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(e.minPitch!=null&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(e.maxPitch!=null&&e.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Wo(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),{bearingSnap:e.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new di,this._controls=[],this._mapId=g.a4(),this._contextLost=o=>{o.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new g.k("webglcontextlost",{originalEvent:o}))},this._contextRestored=o=>{this._setupPainter(),this.resize(),this._update(),this.fire(new g.k("webglcontextrestored",{originalEvent:o}))},this._onMapScroll=o=>{if(o.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._maxTileCacheZoomLevels=e.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=e.preserveDrawingBuffer===!0,this._antialias=e.antialias===!0,this._trackResize=e.trackResize===!0,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles===!0,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions===!0,this._collectResourceTiming=e.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},fu),e.locale),this._clickTolerance=e.clickTolerance,this._overridePixelRatio=e.pixelRatio,this._maxCanvasSize=e.maxCanvasSize,this.transformCameraUpdate=e.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=e.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=Mt.addThrottleControl(()=>this.isMoving()),this._requestManager=new hi(e.transformRequest),typeof e.container=="string"){if(this._container=document.getElementById(e.container),!this._container)throw new Error(`Container '${e.container}' not found.`)}else{if(!(e.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let o=!1;const u=Ar(c=>{this._trackResize&&!this._removed&&(this.resize(c),this.redraw())},50);this._resizeObserver=new ResizeObserver(c=>{o?u(c):o=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Il(this,e),this._hash=e.hash&&new ma(typeof e.hash=="string"&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,g.e({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,this._validateStyle=e.validateStyle,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new Es(typeof e.attributionControl=="boolean"?void 0:e.attributionControl)),e.maplibreLogo&&this.addControl(new Ni,e.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",o=>{this._update(o.dataType==="style"),this.fire(new g.k(`${o.dataType}data`,o))}),this.on("dataloading",o=>{this.fire(new g.k(`${o.dataType}dataloading`,o))}),this.on("dataabort",o=>{this.fire(new g.k("sourcedataabort",o))})}_getMapId(){return this._mapId}addControl(m,e){if(e===void 0&&(e=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new g.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=m.onAdd(this);this._controls.push(m);const u=this._controlPositions[e];return e.indexOf("bottom")!==-1?u.insertBefore(o,u.firstChild):u.appendChild(o),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new g.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(m);return e>-1&&this._controls.splice(e,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}calculateCameraOptionsFromTo(m,e,o,u){return u==null&&this.terrain&&(u=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(m,e,o,u)}resize(m){var e;const o=this._containerDimensions(),u=o[0],c=o[1],p=this._getClampedPixelRatio(u,c);if(this._resizeCanvas(u,c,p),this.painter.resize(u,c,p),this.painter.overLimit()){const T=this.painter.context.gl;this._maxCanvasSize=[T.drawingBufferWidth,T.drawingBufferHeight];const C=this._getClampedPixelRatio(u,c);this._resizeCanvas(u,c,C),this.painter.resize(u,c,C)}this.transform.resize(u,c),(e=this._requestedCameraState)===null||e===void 0||e.resize(u,c);const b=!this._moving;return b&&(this.stop(),this.fire(new g.k("movestart",m)).fire(new g.k("move",m))),this.fire(new g.k("resize",m)),b&&this.fire(new g.k("moveend",m)),this}_getClampedPixelRatio(m,e){const{0:o,1:u}=this._maxCanvasSize,c=this.getPixelRatio(),p=m*c,b=e*c;return Math.min(p>o?o/p:1,b>u?u/b:1)*c}getPixelRatio(){var m;return(m=this._overridePixelRatio)!==null&&m!==void 0?m:devicePixelRatio}setPixelRatio(m){this._overridePixelRatio=m,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(m){return this.transform.setMaxBounds(Le.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m&&this.setZoom(m),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m&&this.setZoom(m),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this._update()}project(m){return this.transform.locationPoint(g.N.convert(m),this.style&&this.terrain)}unproject(m){return this.transform.pointLocation(g.P.convert(m),this.terrain)}isMoving(){var m;return this._moving||((m=this.handlers)===null||m===void 0?void 0:m.isMoving())}isZooming(){var m;return this._zooming||((m=this.handlers)===null||m===void 0?void 0:m.isZooming())}isRotating(){var m;return this._rotating||((m=this.handlers)===null||m===void 0?void 0:m.isRotating())}_createDelegatedListener(m,e,o){if(m==="mouseenter"||m==="mouseover"){let u=!1;return{layers:e,listener:o,delegates:{mousemove:p=>{const b=e.filter(C=>this.getLayer(C)),T=b.length!==0?this.queryRenderedFeatures(p.point,{layers:b}):[];T.length?u||(u=!0,o.call(this,new Fn(m,this,p.originalEvent,{features:T}))):u=!1},mouseout:()=>{u=!1}}}}if(m==="mouseleave"||m==="mouseout"){let u=!1;return{layers:e,listener:o,delegates:{mousemove:b=>{const T=e.filter(C=>this.getLayer(C));(T.length!==0?this.queryRenderedFeatures(b.point,{layers:T}):[]).length?u=!0:u&&(u=!1,o.call(this,new Fn(m,this,b.originalEvent)))},mouseout:b=>{u&&(u=!1,o.call(this,new Fn(m,this,b.originalEvent)))}}}}{const u=c=>{const p=e.filter(T=>this.getLayer(T)),b=p.length!==0?this.queryRenderedFeatures(c.point,{layers:p}):[];b.length&&(c.features=b,o.call(this,c),delete c.features)};return{layers:e,listener:o,delegates:{[m]:u}}}}_saveDelegatedListener(m,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(e)}_removeDelegatedListener(m,e,o){if(!this._delegatedListeners||!this._delegatedListeners[m])return;const u=this._delegatedListeners[m];for(let c=0;c<u.length;c++){const p=u[c];if(p.listener===o&&p.layers.length===e.length&&p.layers.every(b=>e.includes(b))){for(const b in p.delegates)this.off(b,p.delegates[b]);return void u.splice(c,1)}}}on(m,e,o){if(o===void 0)return super.on(m,e);const u=this._createDelegatedListener(m,typeof e=="string"?[e]:e,o);this._saveDelegatedListener(m,u);for(const c in u.delegates)this.on(c,u.delegates[c]);return this}once(m,e,o){if(o===void 0)return super.once(m,e);const u=typeof e=="string"?[e]:e,c=this._createDelegatedListener(m,u,o);for(const p in c.delegates){const b=c.delegates[p];c.delegates[p]=(...T)=>{this._removeDelegatedListener(m,u,o),b(...T)}}this._saveDelegatedListener(m,c);for(const p in c.delegates)this.once(p,c.delegates[p]);return this}off(m,e,o){return o===void 0?super.off(m,e):(this._removeDelegatedListener(m,typeof e=="string"?[e]:e,o),this)}queryRenderedFeatures(m,e){if(!this.style)return[];let o;const u=m instanceof g.P||Array.isArray(m),c=u?m:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(u?{}:m)||{},c instanceof g.P||typeof c[0]=="number")o=[g.P.convert(c)];else{const p=g.P.convert(c[0]),b=g.P.convert(c[1]);o=[p,new g.P(b.x,p.y),b,new g.P(p.x,b.y),p]}return this.style.queryRenderedFeatures(o,e,this.transform)}querySourceFeatures(m,e){return this.style.querySourceFeatures(m,e)}setStyle(m,e){return(e=g.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&m?(this._diffStyle(m,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(m,e))}setTransformRequest(m){return this._requestManager.setTransformRequest(m),this}_getUIString(m){const e=this._locale[m];if(e==null)throw new Error(`Missing UI string '${m}'`);return e}_updateStyle(m,e){if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(m,e));const o=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!m)),m?(this.style=new sa(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m,e,o):this.style.loadJSON(m,e,o),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new sa(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,e){if(typeof m=="string"){const o=this._requestManager.transformRequest(m,"Style");g.h(o,new AbortController).then(u=>{this._updateDiff(u.data,e)}).catch(u=>{u&&this.fire(new g.j(u))})}else typeof m=="object"&&this._updateDiff(m,e)}_updateDiff(m,e){try{this.style.setState(m,e)&&this._update(!0)}catch(o){g.w(`Unable to perform style diff: ${o.message||o.error||o}.  Rebuilding the style from scratch.`),this._updateStyle(m,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():g.w("There is no style added to the map.")}addSource(m,e){return this._lazyInitEmptyStyle(),this.style.addSource(m,e),this._update(!0)}isSourceLoaded(m){const e=this.style&&this.style.sourceCaches[m];if(e!==void 0)return e.loaded();this.fire(new g.j(new Error(`There is no source with ID '${m}'`)))}setTerrain(m){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),m){const e=this.style.sourceCaches[m.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${m.source}`);this.terrain===null&&e.reload();for(const o in this.style._layers){const u=this.style._layers[o];u.type==="hillshade"&&u.source===m.source&&g.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new To(this.painter,e,m),this.painter.renderToTexture=new ll(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=o=>{o.dataType==="style"?this.terrain.sourceCache.freeRtt():o.dataType==="source"&&o.tile&&(o.sourceId!==m.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(o.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new g.k("terrain",{terrain:m})),this}getTerrain(){var m,e;return(e=(m=this.terrain)===null||m===void 0?void 0:m.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const m=this.style&&this.style.sourceCaches;for(const e in m){const o=m[e]._tiles;for(const u in o){const c=o[u];if(c.state!=="loaded"&&c.state!=="errored")return!1}}return!0}removeSource(m){return this.style.removeSource(m),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,e,o={}){const{pixelRatio:u=1,sdf:c=!1,stretchX:p,stretchY:b,content:T,textFitWidth:C,textFitHeight:M}=o;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||g.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new g.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:R,height:B,data:$}=e,X=e;return this.style.addImage(m,{data:new g.R({width:R,height:B},new Uint8Array($)),pixelRatio:u,stretchX:p,stretchY:b,content:T,textFitWidth:C,textFitHeight:M,sdf:c,version:0,userImage:X}),X.onAdd&&X.onAdd(this,m),this}}{const{width:R,height:B,data:$}=xe.getImageData(e);this.style.addImage(m,{data:new g.R({width:R,height:B},$),pixelRatio:u,stretchX:p,stretchY:b,content:T,textFitWidth:C,textFitHeight:M,sdf:c,version:0})}}updateImage(m,e){const o=this.style.getImage(m);if(!o)return this.fire(new g.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const u=e instanceof HTMLImageElement||g.b(e)?xe.getImageData(e):e,{width:c,height:p,data:b}=u;if(c===void 0||p===void 0)return this.fire(new g.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(c!==o.data.width||p!==o.data.height)return this.fire(new g.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const T=!(e instanceof HTMLImageElement||g.b(e));return o.data.replace(b,T),this.style.updateImage(m,o),this}getImage(m){return this.style.getImage(m)}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new g.j(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m){return Mt.getImage(this._requestManager.transformRequest(m,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(m,e){return this._lazyInitEmptyStyle(),this.style.addLayer(m,e),this._update(!0)}moveLayer(m,e){return this.style.moveLayer(m,e),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(m,e,o){return this.style.setLayerZoomRange(m,e,o),this._update(!0)}setFilter(m,e,o={}){return this.style.setFilter(m,e,o),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,e,o,u={}){return this.style.setPaintProperty(m,e,o,u),this._update(!0)}getPaintProperty(m,e){return this.style.getPaintProperty(m,e)}setLayoutProperty(m,e,o,u={}){return this.style.setLayoutProperty(m,e,o,u),this._update(!0)}getLayoutProperty(m,e){return this.style.getLayoutProperty(m,e)}setGlyphs(m,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(m,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(m,e,o={}){return this._lazyInitEmptyStyle(),this.style.addSprite(m,e,o,u=>{u||this._update(!0)}),this}removeSprite(m){return this._lazyInitEmptyStyle(),this.style.removeSprite(m),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(m,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(m,e,o=>{o||this._update(!0)}),this}setLight(m,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(m){return this._lazyInitEmptyStyle(),this.style.setSky(m),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(m,e){return this.style.setFeatureState(m,e),this._update()}removeFeatureState(m,e){return this.style.removeFeatureState(m,e),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let m=0,e=0;return this._container&&(m=this._container.clientWidth||400,e=this._container.clientHeight||300),[m,e]}_setupContainer(){const m=this._container;m.classList.add("maplibregl-map");const e=this._canvasContainer=me.create("div","maplibregl-canvas-container",m);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=me.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const o=this._containerDimensions(),u=this._getClampedPixelRatio(o[0],o[1]);this._resizeCanvas(o[0],o[1],u);const c=this._controlContainer=me.create("div","maplibregl-control-container",m),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(b=>{p[b]=me.create("div",`maplibregl-ctrl-${b} `,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,e,o){this._canvas.width=Math.floor(o*m),this._canvas.height=Math.floor(o*e),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const m={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let e=null;this._canvas.addEventListener("webglcontextcreationerror",u=>{e={requestedAttributes:m},u&&(e.statusMessage=u.statusMessage,e.type=u.type)},{once:!0});const o=this._canvas.getContext("webgl2",m)||this._canvas.getContext("webgl",m);if(!o){const u="Failed to initialize WebGL";throw e?(e.message=u,new Error(JSON.stringify(e))):new Error(u)}this.painter=new Ps(o,this.transform),Ot.testSupport(o)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_render(m){const e=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),this._removed)return;let o=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const c=this.transform.zoom,p=xe.now();this.style.zoomHistory.update(c,p);const b=new g.z(c,{now:p,fadeDuration:e,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),T=b.crossFadingFactor();T===1&&T===this._crossFadingFactor||(o=!0,this._crossFadingFactor=T),this.style.update(b)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,e,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:e,showPadding:this.showPadding}),this.fire(new g.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,g.bf.mark(g.bg.load),this.fire(new g.k("load"))),this.style&&(this.style.hasTransitions()||o)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const u=this._sourcesDirty||this._styleDirty||this._placementDirty;return u||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new g.k("idle")),!this._loaded||this._fullyLoaded||u||(this._fullyLoaded=!0,g.bf.mark(g.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var m;this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Mt.removeThrottleControl(this._imageQueueHandle),(m=this._resizeObserver)===null||m===void 0||m.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e?.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),me.remove(this._canvasContainer),me.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),g.bf.clearMetrics(),this._removed=!0,this.fire(new g.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,xe.frameAsync(this._frameRequest).then(m=>{g.bf.frame(m),this._frameRequest=null,this._render(m)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get version(){return ul}getCameraTargetElevation(){return this.transform.elevation}},O.MapMouseEvent=Fn,O.MapTouchEvent=ks,O.MapWheelEvent=cu,O.Marker=_r,O.NavigationControl=class{constructor(m){this._updateZoomButtons=()=>{const e=this._map.getZoom(),o=e===this._map.getMaxZoom(),u=e===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=u,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",u.toString())},this._rotateCompassArrow=()=>{const e=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=e},this._setButtonTitle=(e,o)=>{const u=this._map._getUIString(`NavigationControl.${o}`);e.title=u,e.setAttribute("aria-label",u)},this.options=g.e({},un,m),this._container=me.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),me.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),me.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=me.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Fa(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){me.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(m,e){const o=me.create("button",m,this._container);return o.type="button",o.addEventListener("click",e),o}},O.Popup=class extends g.E{constructor(m){super(),this.remove=()=>(this._content&&me.remove(this._content),this._container&&(me.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new g.k("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var o;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=me.create("div","maplibregl-popup",this._map.getContainer()),this._tip=me.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const T of this.options.className.split(" "))this._container.classList.add(T);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?Pi(this._lngLat,this._flatPos,this._map.transform):(o=this._lngLat)===null||o===void 0?void 0:o.wrap(),this._trackPointer&&!e)return;const u=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationPoint(this._lngLat));let c=this.options.anchor;const p=mu(this.options.offset);if(!c){const T=this._container.offsetWidth,C=this._container.offsetHeight;let M;M=u.y+p.bottom.y<C?["top"]:u.y>this._map.transform.height-C?["bottom"]:[],u.x<T/2?M.push("left"):u.x>this._map.transform.width-T/2&&M.push("right"),c=M.length===0?"bottom":M.join("-")}let b=u.add(p[c]);this.options.subpixelPositioning||(b=b.round()),me.setTransform(this._container,`${Js[c]} translate(${b.x}px,${b.y}px)`),ga(this._container,c,"popup")},this._onClose=()=>{this.remove()},this.options=g.e(Object.create(Bt),m)}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new g.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(m){return this._lngLat=g.N.convert(m),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){const e=document.createDocumentFragment(),o=document.createElement("body");let u;for(o.innerHTML=m;u=o.firstChild,u;)e.appendChild(u);return this.setDOMContent(e)}getMaxWidth(){var m;return(m=this._container)===null||m===void 0?void 0:m.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=me.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(m),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(m){return this._container&&this._container.classList.add(m),this}removeClassName(m){return this._container&&this._container.classList.remove(m),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){if(this._container)return this._container.classList.toggle(m)}setSubpixelPositioning(m){this.options.subpixelPositioning=m}_createCloseButton(){this.options.closeButton&&(this._closeButton=me.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(Al);m&&m.focus()}},O.RasterDEMTileSource=$i,O.RasterTileSource=Mi,O.ScaleControl=class{constructor(m){this._onMove=()=>{zl(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,zl(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Ms),m)}getDefaultPosition(){return"bottom-left"}onAdd(m){return this._map=m,this._container=me.create("div","maplibregl-ctrl maplibregl-ctrl-scale",m.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){me.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},O.ScrollZoomHandler=$e,O.Style=sa,O.TerrainControl=class{constructor(m){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=m}onAdd(m){return this._map=m,this._container=me.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=me.create("button","maplibregl-ctrl-terrain",this._container),me.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){me.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},O.TwoFingersTouchPitchHandler=A,O.TwoFingersTouchRotateHandler=v,O.TwoFingersTouchZoomHandler=s,O.TwoFingersTouchZoomRotateHandler=pr,O.VectorTileSource=uo,O.VideoSource=ra,O.addSourceType=(m,e)=>g._(void 0,void 0,void 0,function*(){if(Fo(m))throw new Error(`A source type called "${m}" already exists.`);((o,u)=>{Oo[o]=u})(m,e)}),O.clearPrewarmedResources=function(){const m=ii;m&&(m.isPreloaded()&&m.numActive()===1?(m.release(It),ii=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},O.getMaxParallelImageRequests=function(){return g.a.MAX_PARALLEL_IMAGE_REQUESTS},O.getRTLTextPluginStatus=function(){return ur().getRTLTextPluginStatus()},O.getVersion=function(){return Qu},O.getWorkerCount=function(){return Tt.workerCount},O.getWorkerUrl=function(){return g.a.WORKER_URL},O.importScriptInWorkers=function(m){return js().broadcast("IS",m)},O.prewarm=function(){Oi().acquire(It)},O.setMaxParallelImageRequests=function(m){g.a.MAX_PARALLEL_IMAGE_REQUESTS=m},O.setRTLTextPlugin=function(m,e){return ur().setRTLTextPlugin(m,e)},O.setWorkerCount=function(m){Tt.workerCount=m},O.setWorkerUrl=function(m){g.a.WORKER_URL=m}});var Me=N;return Me})}(qd)),qd.exports}var W_=G_();const X_=Rf(W_);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K_=Z=>Z.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Gp=(...Z)=>Z.filter((J,N,re)=>!!J&&re.indexOf(J)===N).join(" ");/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var J_={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y_=Xe.forwardRef(({color:Z="currentColor",size:J=24,strokeWidth:N=2,absoluteStrokeWidth:re,className:ce="",children:Me,iconNode:O,...g},ze)=>Xe.createElement("svg",{ref:ze,...J_,width:J,height:J,stroke:Z,strokeWidth:re?Number(N)*24/Number(J):N,className:Gp("lucide",ce),...g},[...O.map(([nt,tt])=>Xe.createElement(nt,tt)),...Array.isArray(Me)?Me:[Me]]));/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iu=(Z,J)=>{const N=Xe.forwardRef(({className:re,...ce},Me)=>Xe.createElement(Y_,{ref:Me,iconNode:J,className:Gp(`lucide-${K_(Z)}`,re),...ce}));return N.displayName=`${Z}`,N};/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q_=Iu("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eg=Iu("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bp=Iu("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sp=Iu("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tg=Iu("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ig=Iu("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ng=Iu("MousePointer",[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rg=Iu("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.439.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sg=Iu("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),Lf=[54.5,-3],Wp=6,Df="https://api.tomtom.com/map/1/tile/basic/main/{z}/{x}/{y}.png?view=Unified&key={key}",og="https://api.tomtom.com/traffic/map/4/tile/flow/{style}/{z}/{x}/{y}.png?key={key}&thickness=32&tileSize=256",ag="https://api.tomtom.com/traffic/map/4/tile/incidents/{z}/{x}/{y}.png?key={key}",lg="https://api.tomtom.com/traffic/map/4/tile/incidents/{z}/{x}/{y}.pbf?key={key}";function Dc(Z,J){const[N,re]=Xe.useState(()=>{try{const ce=localStorage.getItem(Z);return ce?JSON.parse(ce):J}catch{return J}});return Xe.useEffect(()=>{try{localStorage.setItem(Z,JSON.stringify(N))}catch{}},[Z,N]),[N,re]}function Tp(Z){return new URLSearchParams(window.location.search).get(Z)}function ug({dark:Z,setDark:J}){return Ge.jsxs("button",{onClick:()=>J(!Z),className:"inline-flex items-center gap-2 rounded-xl px-3 py-2 text-sm border border-black/10 dark:border-white/15 hover:shadow-sm","aria-label":"Toggle theme",children:[Z?Ge.jsx(sg,{size:16}):Ge.jsx(ig,{size:16})," ",Z?"Light":"Dark"]})}function cg({dark:Z,setDark:J}){return Ge.jsxs("header",{className:"w-full flex items-center justify-between py-4",children:[Ge.jsxs("div",{className:"flex items-center gap-3",children:[Ge.jsx("img",{src:"/uk-traffic-viewer/logo.png",alt:"CDA",className:"h-9 w-9 rounded-2xl object-contain"}),Ge.jsx("span",{className:"font-semibold text-lg tracking-tight",children:"CDA UK Traffic"})]}),Ge.jsx("div",{className:"flex items-center gap-2",children:Ge.jsx(ug,{dark:Z,setDark:J})})]})}function hg({active:Z,setActive:J}){const N=[{id:"leaflet",label:"Raster (Leaflet)"},{id:"vector",label:"Vector (MapLibre)"}];return Ge.jsx("div",{className:"flex gap-2 flex-wrap",children:N.map(re=>Ge.jsx("button",{onClick:()=>J(re.id),className:`px-3 py-2 rounded-xl text-sm border ${Z===re.id?"bg-black text-white dark:bg-white dark:text-black":"border-black/10 dark:border-white/15 hover:bg-black/5 dark:hover:bg-white/10"}`,children:re.label},re.id))})}function dg({active:Z,onClick:J,children:N}){return Ge.jsx("button",{onClick:J,className:`px-3 py-1.5 rounded-full text-xs border transition ${Z?"bg-black text-white dark:bg-white dark:text-black":"border-black/10 dark:border-white/15 hover:bg-black/5 dark:hover:bg-white/10"}`,children:N})}function fg({apiKey:Z,setApiKey:J,flowStyle:N,setFlowStyle:re,showFlow:ce,setShowFlow:Me,showIncidents:O,setShowIncidents:g,autoRefresh:ze,setAutoRefresh:nt,refreshNow:tt,roadTypes:xe,setRoadTypes:me}){const[Ot,st]=Xe.useState(!0);return Ge.jsx("div",{className:"absolute top-3 left-3 z-[1000] w-[360px] max-w-[94vw]",children:Ge.jsxs("div",{className:"rounded-2xl border border-black/10 dark:border-white/15 bg-white/80 dark:bg-black/40 backdrop-blur shadow",children:[Ge.jsxs("button",{onClick:()=>st(!Ot),className:"w-full flex items-center justify-between px-4 py-3",children:[Ge.jsxs("div",{className:"flex items-center gap-2",children:[Ge.jsx(tg,{size:16}),Ge.jsx("span",{className:"font-semibold text-sm",children:"Layers & Settings"})]}),Ge.jsx(eg,{className:`transition ${Ot?"rotate-180":""}`,size:16})]}),Ot&&Ge.jsxs("div",{className:"px-4 pb-4 space-y-3",children:[Ge.jsxs("div",{children:[Ge.jsx("label",{className:"text-xs opacity-70",children:"TomTom API key"}),Ge.jsx("input",{type:"password",value:Z,onChange:Ue=>J(Ue.target.value.trim()),placeholder:"Paste your TomTom key",className:"mt-1 w-full rounded-xl border border-black/10 dark:border-white/15 bg-transparent px-3 py-2 text-sm"}),Ge.jsx("div",{className:"mt-1 text-[11px] opacity-70",children:"Reads from ?key= or ?tomtomKey= in the URL. Stored only in this browser."})]}),Ge.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[Ge.jsx("span",{className:"text-xs opacity-70",children:"Traffic Flow (raster)"}),["relative0-dark","relative0","relative","absolute","relative-delay","reduced-sensitivity"].map(Ue=>Ge.jsx(dg,{active:N===Ue,onClick:()=>re(Ue),children:Ue},Ue)),Ge.jsxs("button",{onClick:()=>Me(!ce),className:"ml-auto inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs border border-black/10 dark:border-white/15",children:[ce?Ge.jsx(Sp,{size:14}):Ge.jsx(bp,{size:14})," ",ce?"Hide":"Show"]})]}),Ge.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[Ge.jsx("span",{className:"text-xs opacity-70",children:"Road types (vector):"}),Ge.jsx("input",{value:xe,onChange:Ue=>me(Ue.target.value.trim()),placeholder:"e.g. M,A",className:"px-2 py-1 rounded border text-xs bg-transparent border-black/10 dark:border-white/15"})]}),Ge.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[Ge.jsx("span",{className:"text-xs opacity-70",children:"Incident Tiles (raster)"}),Ge.jsxs("button",{onClick:()=>g(!O),className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs border border-black/10 dark:border-white/15",children:[O?Ge.jsx(Sp,{size:14}):Ge.jsx(bp,{size:14})," ",O?"Hide":"Show"]})]}),Ge.jsxs("div",{className:"flex items-center gap-3",children:[Ge.jsxs("button",{onClick:tt,className:"inline-flex items-center gap-2 rounded-xl px-3 py-2 text-xs border border-black/10 dark:border-white/15 hover:shadow-sm",children:[Ge.jsx(rg,{size:14})," Refresh incidents"]}),Ge.jsxs("label",{className:"inline-flex items-center gap-2 text-xs",children:[Ge.jsx("input",{type:"checkbox",checked:ze,onChange:Ue=>nt(Ue.target.checked)}),"Auto-refresh every 60s"]})]}),Ge.jsx("div",{className:"text-[11px] opacity-70",children:"Data © TomTom. Don’t commit keys to public repos."})]})]})})}function pg({apiKey:Z,onCount:J}){const[N,re]=Xe.useState(null),[ce,Me]=Xe.useState(""),O=111.32,g=st=>111.32*Math.cos(st*Math.PI/180);function ze({west:st,south:Ue,east:Je,north:$t},Qt=9e3){const Mt=(Ue+$t)/2,hi=Math.max(0,Je-st)*g(Mt),li=Math.max(0,$t-Ue)*O;if(hi*li<=Qt)return[{west:st,south:Ue,east:Je,north:$t}];const _i=Math.max(60,Math.sqrt(Qt)),nn=Math.max(1,Math.ceil(hi/_i)),an=Math.max(1,Math.ceil(li/_i)),Zn=(Je-st)/nn,qt=($t-Ue)/an,Hi=[];for(let Di=0;Di<nn;Di++)for(let xi=0;xi<an;xi++)Hi.push({west:st+Di*Zn,east:st+(Di+1)*Zn,south:Ue+xi*qt,north:Ue+(xi+1)*qt});return Hi}function nt(st){return st?st.incidents&&st.incidents.type==="FeatureCollection"?st.incidents:Array.isArray(st.incidents)?{type:"FeatureCollection",features:st.incidents}:st.type==="FeatureCollection"&&Array.isArray(st.features)?st:{type:"FeatureCollection",features:[]}:{type:"FeatureCollection",features:[]}}async function tt(st,Ue,Je){const $t=new Array(st.length);let Qt=0;const Mt=new Array(Math.min(Ue,st.length)).fill(0).map(async()=>{for(;Qt<st.length;){const hi=Qt++;$t[hi]=await Je(st[hi],hi)}});return await Promise.all(Mt),$t}function xe(){const st=qp({moveend:()=>me(st),zoomend:()=>me(st),load:()=>me(st),"traffic-refresh":()=>me(st)});return Xe.useEffect(()=>{const Ue=()=>me(st);return window.addEventListener("traffic-refresh",Ue),()=>window.removeEventListener("traffic-refresh",Ue)},[st]),null}async function me(st){if(!Z)return;const Ue=st.getBounds(),Je={west:Ue.getWest(),south:Ue.getSouth(),east:Ue.getEast(),north:Ue.getNorth()},$t=ze(Je,9e3);if($t.length>24){Me("Zoom in to view incidents (viewport too wide)."),re(null),J?.(0);return}try{Me("");const Qt=await tt($t,6,async li=>{const Ii=[li.west,li.south,li.east,li.north].join(","),_i=`https://api.tomtom.com/traffic/services/5/incidentDetails?key=${Z}&bbox=${Ii}&language=en-GB&timeValidityFilter=present`,nn=await fetch(_i);if(!nn.ok)return{type:"FeatureCollection",features:[]};const an=await nn.json();return nt(an)}),Mt=new Set,hi={type:"FeatureCollection",features:[]};for(const li of Qt)for(const Ii of li.features||[]){const _i=Ii?.properties?.id??JSON.stringify(Ii.geometry);Mt.has(_i)||(Mt.add(_i),hi.features.push(Ii))}re(hi),J?.(hi.features.length||0)}catch(Qt){Me(Qt.message||"Failed to load incidents"),re(null),J?.(0)}}const Ot=st=>({1:"💥",6:"🚗",7:"🛑",8:"⛔",9:"🚧",10:"💨",11:"🌊"})[st]||"⚠️";return Ge.jsxs(Ge.Fragment,{children:[Ge.jsx(xe,{}),ce&&Ge.jsx("div",{className:"absolute top-3 right-3 z-[1000] rounded-xl bg-red-600 text-white text-xs px-3 py-2 shadow",children:ce}),N&&Ge.jsx(Z_,{data:N,pointToLayer:(st,Ue)=>{const Je=xp.divIcon({html:`<div class="text-base">${Ot(st?.properties?.iconCategory)}</div>`});return xp.marker(Ue,{icon:Je})},onEachFeature:(st,Ue)=>{const Je=st.properties||{};Ue.bindPopup(`<div style="min-width:240px">
                <div style="font-weight:600;margin-bottom:4px">${Je.events?.[0]?.description||"Incident"}</div>
                <div style="font-size:12px;opacity:.8">Delay: ${Je.delay??"n/a"} sec • Magnitude: ${Je.magnitudeOfDelay??"?"}</div>
                <div style="font-size:12px;opacity:.8">From: ${Je.from??"?"}</div>
                <div style="font-size:12px;opacity:.8">To: ${Je.to??"?"}</div>
                <div style="font-size:12px;opacity:.8">Roads: ${(Je.roadNumbers||[]).join(", ")}</div>
              </div>`)}},`incidents-${(N.features||[]).length}`)]})}function mg({probe:Z}){if(!Z)return null;const{currentSpeed:J,freeFlowSpeed:N,currentTravelTime:re,freeFlowTravelTime:ce,confidence:Me,frc:O}=Z,g=N?J/N:null;return Ge.jsxs("div",{className:"absolute bottom-3 left-3 z-[1000] rounded-xl border border-black/10 dark:border-white/15 bg-white/90 dark:bg-black/60 backdrop-blur px-3 py-2 text-xs shadow",children:[Ge.jsxs("div",{className:"font-semibold mb-1 flex items-center gap-2",children:[Ge.jsx(ng,{size:14})," Segment probe"]}),Ge.jsxs("div",{children:["Speed: ",Ge.jsx("b",{children:J})," vs FF ",Ge.jsx("b",{children:N})," (ratio ",g?g.toFixed(2):"-",")"]}),Ge.jsxs("div",{children:["Travel time: ",Ge.jsxs("b",{children:[re,"s"]})," vs FF ",Ge.jsxs("b",{children:[ce,"s"]})]}),Me!=null&&Ge.jsxs("div",{children:["Confidence: ",Ge.jsx("b",{children:Me})]}),O!=null&&Ge.jsxs("div",{children:["FRC: ",Ge.jsx("b",{children:O})]})]})}function _g({apiKey:Z,flowStyle:J,showFlow:N,showIncidents:re,onIncidentCount:ce,onProbe:Me}){function O(){const g=qp({click:async ze=>{if(Z)try{const tt=`https://api.tomtom.com/traffic/services/4/flowSegmentData/relative0/${Math.max(6,Math.round(g.getZoom()))}/json?key=${Z}&point=${ze.latlng.lat},${ze.latlng.lng}&unit=KMPH&openLr=false`,me=await(await fetch(tt)).json();Me?.(me.flowSegmentData||null)}catch{Me?.(null)}}});return null}return Ge.jsx("div",{className:"rounded-2xl overflow-hidden border border-black/10 dark:border-white/15 shadow relative",children:Ge.jsx(q_,{center:Lf,zoom:Wp,style:{height:"72vh",width:"100%"},children:Z?Ge.jsxs(Ge.Fragment,{children:[Ge.jsx($d,{url:Df.replace("{key}",Z),attribution:"Map © TomTom",zIndex:600}),N&&Ge.jsx($d,{url:og.replace("{style}",J).replace("{key}",Z),opacity:.9,attribution:"Traffic Flow © TomTom",zIndex:650}),re&&Ge.jsx($d,{url:ag.replace("{key}",Z),opacity:1,attribution:"Incidents © TomTom",zIndex:700}),Ge.jsx(pg,{apiKey:Z,onCount:ce}),Ge.jsx(O,{})]}):Ge.jsx($d,{url:Df.replace("{key}","Your_API_Key"),attribution:"Map © TomTom"})})})}function gg({apiKey:Z,flowType:J,roadTypes:N}){const re=Xe.useRef(null),ce=Xe.useRef(null);return Xe.useEffect(()=>{if(!re.current||!Z)return;const Me=`https://api.tomtom.com/traffic/map/4/tile/flow/${J}/{z}/{x}/{y}.pbf?key=${Z}`+(N?`&roadTypes=${encodeURIComponent(N)}`:""),O=new X_.Map({container:re.current,style:{version:8,sources:{base:{type:"raster",tiles:[Df.replace("{key}",Z)],tileSize:256,attribution:"Map © TomTom"},flow:{type:"vector",tiles:[Me],minzoom:0,maxzoom:22,attribution:"Traffic Flow © TomTom"},incidents:{type:"vector",tiles:[lg.replace("{key}",Z)],minzoom:0,maxzoom:22,attribution:"Incidents © TomTom"}},layers:[{id:"base",type:"raster",source:"base"},{id:"traffic-flow",type:"line",source:"flow","source-layer":"Traffic flow",paint:{"line-width":["interpolate",["linear"],["zoom"],6,1,10,2,14,3],"line-color":["case",["has","traffic_level"],["interpolate",["linear"],["get","traffic_level"],0,"#8b0000",.25,"#ff4500",.5,"#ffa500",.75,"#ffff00",1,"#00c853"],"#999999"],"line-opacity":.9}},{id:"incidents-poi",type:"circle",source:"incidents","source-layer":"Traffic incidents POI",paint:{"circle-radius":["interpolate",["linear"],["zoom"],6,2,12,6],"circle-opacity":.85}}]},center:[Lf[1],Lf[0]],zoom:Wp,attributionControl:!0});return ce.current=O,()=>O.remove()},[Z,J,N]),Ge.jsx("div",{className:"rounded-2xl overflow-hidden border border-black/10 dark:border-white/15 shadow",children:Ge.jsx("div",{ref:re,style:{height:"72vh",width:"100%"}})})}function yg(){const Z=Tp("key")||Tp("tomtomKey"),[J,N]=Dc("tomtom_api_key",Z||""),[re,ce]=Xe.useState(!0),[Me,O]=Dc("tab","leaflet"),[g,ze]=Dc("flow_style","relative0-dark"),[nt,tt]=Dc("show_flow",!0),[xe,me]=Dc("show_incidents",!0),[Ot,st]=Dc("auto_refresh",!0),[Ue,Je]=Xe.useState(0),[$t,Qt]=Xe.useState(null),[Mt,hi]=Dc("road_types",""),[li,Ii]=Xe.useState(null);return Xe.useMemo(()=>{const _i=document.documentElement;re?_i.classList.add("dark"):_i.classList.remove("dark")},[re]),Xe.useEffect(()=>{if(!Ot)return;const _i=setInterval(()=>window.dispatchEvent(new Event("traffic-refresh")),6e4);return()=>clearInterval(_i)},[Ot]),Xe.useEffect(()=>{if(!J)return;const _i=`https://api.tomtom.com/traffic/map/4/flow/1/unified/metadata.json?key=${J}`;fetch(_i).then(nn=>nn.ok?nn.json():null).then(Ii).catch(()=>{})},[J]),Ge.jsx("div",{className:"min-h-screen bg-[#EEE2C9] dark:bg-[#2A2418]",children:Ge.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[Ge.jsx(cg,{dark:re,setDark:ce}),Ge.jsx("div",{className:"flex items-center gap-3 mt-2",children:Ge.jsx(hg,{active:Me,setActive:O})}),Ge.jsxs("div",{className:"mt-4 relative",children:[Me==="leaflet"&&Ge.jsxs(Ge.Fragment,{children:[Ge.jsx(_g,{apiKey:J,flowStyle:g,showFlow:nt,showIncidents:xe,onIncidentCount:Je,onProbe:Qt}),Ge.jsx(fg,{apiKey:J,setApiKey:N,flowStyle:g,setFlowStyle:ze,showFlow:nt,setShowFlow:tt,showIncidents:xe,setShowIncidents:me,autoRefresh:Ot,setAutoRefresh:st,refreshNow:()=>window.dispatchEvent(new Event("traffic-refresh")),roadTypes:Mt,setRoadTypes:hi}),Ge.jsxs("div",{className:"mt-3 text-sm opacity-80 flex items-center gap-3",children:[Ge.jsx(Q_,{size:16})," ",Ge.jsxs("span",{children:["Incidents in view: ",Ue]}),Ge.jsx("span",{className:"mx-2",children:"•"}),Ge.jsx("span",{className:"opacity-60",children:"Zoom out is OK — bbox tiler merges multiple requests."})]}),Ge.jsx(mg,{probe:$t})]}),Me==="vector"&&(J?Ge.jsx(gg,{apiKey:J,flowType:g.includes("absolute")?"absolute":"relative",roadTypes:Mt}):Ge.jsx("div",{className:"rounded-2xl border border-black/10 dark:border-white/15 p-6 text-sm opacity-80",children:"Add your API key to view Vector Flow & Incident tiles."}))]}),Ge.jsx("footer",{className:"py-8 text-sm opacity-70",children:Ge.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[Ge.jsxs("span",{children:["© ",new Date().getFullYear()," Coach Drivers App, Version 1.0.0, Developed by Stephen Lewis."]}),Ge.jsx("span",{className:"mx-1",children:"•"}),Ge.jsx("a",{className:"underline hover:opacity-100",href:"https://developer.tomtom.com/traffic-api/documentation/traffic-flow/vector-flow-tiles",target:"_blank",rel:"noreferrer",children:"Vector Flow Tiles"}),Ge.jsx("span",{className:"mx-1",children:"•"}),Ge.jsx("a",{className:"underline hover:opacity-100",href:"https://developer.tomtom.com/traffic-api/documentation/traffic-incidents/vector-incident-tiles",target:"_blank",rel:"noreferrer",children:"Vector Incident Tiles"}),Ge.jsx("span",{className:"mx-1",children:"•"}),Ge.jsx("a",{className:"underline hover:opacity-100",href:"https://developer.tomtom.com/traffic-api/documentation/traffic-flow/flow-segment-data",target:"_blank",rel:"noreferrer",children:"Flow Segment Data"}),li?.version&&Ge.jsxs(Ge.Fragment,{children:[Ge.jsx("span",{className:"mx-1",children:"•"}),Ge.jsxs("span",{className:"opacity-70",children:["Flow meta v",li.version]})]})]})})]})})}function Xp(){return Ge.jsx(Fp,{basename:"/uk-traffic-viewer",children:Ge.jsxs(m_,{children:[Ge.jsx(Ef,{path:"/",element:Ge.jsx(C_,{})}),Ge.jsx(Ef,{path:"/traffic",element:Ge.jsx(yg,{})})," "]})})}ReactDOM.createRoot(document.getElementById("root")).render(Ge.jsx(Fp,{basename:"/uk-traffic-viewer",children:Ge.jsx(Xp,{})}));Sm.createRoot(document.getElementById("root")).render(Ge.jsx(Xp,{}));
